they added a new tool for remote access, Syncro, to their arsenal.
SYS01 Stealer Will Steal Your Facebook Info
SSH brute forcing code with the more usual Telnet equivalent.
and finds the trust relationships and jump hosts, attempting to move into the other domains and security zones.
the malware enumerates the running processes on the system and compiles a list of process names and IDs.
is executed by the victim
decodes 0x3E8 bytes with that key
issuing the following command line
Valid credentials
are sent using separate POST requests.
cmd.exe /c
In order to unpack the legitimate binary,
defaultChanges the Windows Shell from Explorer to their malicious script
S0054 CloudDuke
S0048 PinchDuke
Manually executing the lnk file triggers
After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network,
The contents of hidden folder “me”, included several files and folders that were used for the execution
decrypted with RC4 algorithm
not see them in the imported function list, and they not even be part of the strings in the sample.
using the MoveFileExW() API function,
deletes the intermediate DLL library and encrypted ransomware
Data view of the section containing the encrypted malware.
Then it runs the following to attempt to clear file system cache memory:\n%windir%\system32\rundll32.exe
LoadLibraryW loads the module, VirtualAlloc allocates the memory, CreateProcessW created a process, and ZwUnmapViewOfSection is used
T1027
Software Deployment Tools
UAC bypass implementation
compressed binary
Collection
string-decryption code
This call instructs LSASS to load and execute pc.dll, which then stages the getHashFlsa64.dll credential theft component.
Right after its execution, the wab.exe process created two remote threads in order to inject code into explorer.exe and rundll32.exe:
usually at port 5028/TCP
HTTP POST request that contains\nthe command output.
is unpacked from the CHM file.
G1007 Aoqin Dragon
Manipulates (creates, lists, starts, stops and deletes) services.
Ransom Cartel Ransomware A Possible Connection With REvil
C :\Windows\system32\cmd.exe /C shell
loading a fresh copy of “ntdll.dll” from disk to avoid process hollowing detection
Then, it creates and sets a new value for the registry key HKCU\Software\Microsoft\Windows\CurrentVersion\Run.
uses PowerShell to pull and run
S0108 netsh
G1018 TA2541
DLL sideloading
invoking comsvcs.dll with rundll32.exe,
from a process that was injected with Cobalt Strike.
S0187 Daserf
Uncommon infection methodspart 2
The decrypted payload
carries out process injections
S0176 Wingbird
From that host, the team moved laterally to a misconfigured server, from which they compromised the domain controller (DC).
G0069 MuddyWater
scripts to download additional scripts.
numerous batch (.bat) files on impacted systems
phishing emails have similar topics and pretend to come from some of the same entities
Iranian GovernmentSponsored APT Actors Compromise Federal Network Deploy Crypto Miner Credential Harvester
to crawl through different paths in the system
executes an export function called "Entry" from UpdateTask.dll via rundll32.exe
legitimize the package in the eyes of the victim
T1053.005
S0612 WastedLocker
remote access tool
run under the name “tmp.exe” by unpacking itself to the “C:\Users\admin\AppData\Local\Temp\” file path.
Themida-packed
the decryption key for the ZIP folder and access the tool
download the PowerShell downloader script from the attacker-controlled server
was decoded
show the transfer of files using SMB.
uses cmd.exe and .bat files to run commands
The algorithm to decrypt the data is simple.
uses the Microsoft Graph API
The actors manually disabled Windows Defender via the GUI.
creates a listener that listens for connections to port 443 at the path https://*:
enables the TAs to create customized documents containing embedded objects that exploit vulnerabilities in Microsoft Word’s Equation Editor
Domain fronting can be achieved with a redirect between the malicious server and the target.
SFX archive
replacing the human-readable names of functions (such as "CreateMutexW") with a hash value,
collects sensitive information from the victim’s machine
S0671 Tomiris
cmd"  /c
process list
Encrypting communications using AES and RSA public key cryptography
decrypting them
can collect files from local drives.
CreateProcessInternalW creates a new process.
all the decrypted C2 URLs
S0692 SILENTTRINITY
S1024 CreepySnail
S0533 SLOTHFULMEDIA
extraction of the resources leads to the final payloads
takes a screenshot
Curl is used to download the malicious DLL file
executable that dropped a legitimate WD Discovery app to side-load the malicious WDLocal.dll
T1072
Network-level protocol
S0043 BUBBLEWRAP
S0058 SslMM
S0188 Starloader
taking screenshots
G0107 Whitefly
encrypted with a different, single byte XOR key
S0435 PLEAD
utilize legitimate file paths to mask their execution.
HTTP variant
keylogging,
It is also able to communicate through different network protocols such as UDP (User Datagram Protocol) and TCP (Transmission Control Protocol).
output of ipconfig was sent to one of two addresses
loads the decrypted DLL file
This script called a combination of QueueUserAPC, GetCurrentThreadId, OpenThread, and VirtualAlloc to perform process injection of shellcode
there is indeed some sort of unpacking happening.
both use CreateFile and WriteFile APIs
deploying a malicious kernel mode driver (“bring your own vulnerable driver” or BYOVD method) via exploiting a vulnerable Intel driver
C:\Windows\system32\cmd.exe /C powershell.exe -nop -w hidden -c
creates a scheduled task on the system that provides persistence.
C:\Windows\System32\cmd.exe /c
"cmd"  /c
One scheduled task (shown below) runs every 15 minutes
Commands executed by WMI on new hosts
spear phishing attachments for Initial Access
send phishing emails with malicious HTML attachments to all addresses in the victim’s mailbox.
it searches for the .vnc.lnk affix to steal VNC credentials.
executes it through the PowerShell commands.
S0045 ADVSTORESHELL
When the data was gathered on a local system using the backdoor
Executable that accepts an executable as an argument and executes it with hidden console
DeviceControl API methods
covert channel that can be used to exfiltrate data from the victim device
in an effort to evade any detection and prevention mechanisms, they disabled Windows Defender
This attachment (unless zipped) is the MyDoom executable.
that would cause registry changes
the configuration file will be deleted
This can be useful to determine drives, including mounted network shares.
T1574.002
unpacked payload
Spike in LokiBot Activity During Final Week of 2022
The exclusion rule allowlisted the entire c:\drive, enabling threat actors to download tools to the c:\drive without virus scans.
the decrypted data matches\nthe payload
Overall available space\nSpace available to current user (may be less than overall available space due to quotas)\nDisk capacity
there was only one stage being decrypted in memory
DLL is then executed using rundll32
the threat actor could have easily used a second domain administrator account
wmic
include the ability to collect mouse movements, keyboard activity
The operators made a consistent effort to\ndelete these tools and remove any residual forensic artifacts from\ncompromised systems.
It creates directory listings
“wmic os get LocalDateTime /value”.
S0493 GoldenSpy
the embedded .NET injector
S1049 SUGARUSH
that have Base64 and AES encrypted C2’s appended to them
S0587 Penquin
XOR-decrypts an embedded PE file
creates two different scheduled tasks.
USING ".BAT" FILES
unpacks three files
download a “.VBS” file
to store and retrieve binary data with\nthe Windows API.
showing wab.exe executed by WMI
S0568 EVILNUM
examples of the command line syntax used for the performance of this activity
Once decoded
persistence is established by using the ITaskService COM interface to create the \Microsoft\Windows\CertificateServicesClient\NetTask scheduled task
The group uses DLL sideloading
backdoor is a basic remote shell
decrypting
cmd.exe
S0393 PowerStallion
the malware attempts to retrieve additional malicious artifacts
by side-loading dr.dll, used by a legitimate, signed binary
Once the file was unpacked
S0528 Javali
This shellcode has complex obfuscation, consisting of junk code
performs a BXOR to decode the bytes
the adversary gained credentials in the network
S0159 SNUGRIDE
Initial access to targets is obtained by exploiting vulnerable internet-facing applications such as Microsoft Exchange,
the user account used to connect to the victim’s O365 tenant
DLL decryption routine
reviewed Group Policy Objects for the domain.
S0265 Kazuar
C0006 Operation Honeybee
G0092 TA505
S0172 Reaver
Tracking Traces of Malware Disguised as Hancom Office Document File and Being Distributed RedEyes
C0001 Frankenstein
Remote access tools used by the attackers may use application layer protocols (HTTP, HTTPS,
remote desktop protocol (RDP) and secure shell (SSH) accesses
some defense evasion batch scripts.
inject it’s modules into various processes.
computer name
established persistence via a run key.
Returns the path to the user’s temporary folder.
The malware will continue to read and decrypt goopdate
the code can be injected into other legitimate running processes
The built-in Windows quser-command to show logged on users is also heavily used by them.
removes any files
exploiting vulnerabilities in Apache and Apache Spark (CVE-2021-42013 and CVE-2022-33891
attackers used an innocent-looking email to lure victims into opening an attachment.
use VMProtect or custom packers for its malware
by adding the below to an already linked GPO.
the second decryption stage occurs
flood a remote DNS server with false traffic.
It does so by copying the PE headers and each section according to the current executable’s base address.
decrypted dba user password.
C:\Windows\System32\rundll32.exe
executes, it drops a PHP application with additional files
del
S0025 CALENDAR
Exfiltrate keylogger data
The threat actor used a redirector (38.135.122[.]194:8080) to proxy the RDP traffic being passed
S0258 RGDoor
subsequently download Remcos on the target system
S0013 PlugX
create a legitimate looking folder to drop an illicit version of the System Configuration Utility msconfig.exe
S0217 SHUTTERSPEED
operating system information
Hidden Files and Directories
S0083 Misdat
S0603 Stuxnet
being the payloads stored in the resources
implants made their native Windows executables look like legitimate update tools.
to decrypt it using AES GCM algorithm
records keystrokes.
the API calls
HTTP HEAD request
threat actor is actively exploiting the so-called PrintNightmare vulnerability (CVE-2021-1675 / CVE-2021-34527) in Windows' print spooler service to spread laterally across a victim's network
created a persistence mechanism for NGROK by adding\nVirtualHost.vbs to the WindNT value under the current users Run\nregistry key.
injects shellcode into it
wmic  /node
is decrypted using XOR and a 16-byte key
the import address table and relocation table of the newly injected PE.
G0007 APT28
creating the files and registry keys
running processes
retrieves the MachineGuid of the infected system from the "SOFTWARE\Microsoft\Cryptography\MachineGuid" registry key.
systeminfo
sends an HTTPS request
encoded payload
contains obfuscated VBA scripts or a binary with a JPG extension
the Windows API address and its arguments.
S1125 AcidRain
After bypassing UAC
to gather basic system information, including username,
Returns information about the operating system
a decrypted configuration
The malware proceeds to de-obfuscate strings using a XOR loop
cmd.exe" /c
Decrypted REvil configuration
Base64 Decoded instructions in dropper
To prevent being detected, the attackers end processes and services related to security and antivirus software.
or raw TCP, for C&C server communications.
began their first lateral movement to a server in the environment by copying their Cobalt Strike DLL over to the host and executing it
C:\Windows\system32\cmd.exe /C
T1105
T1557.001
Username
The malicious dropper contains a legitimate version of the software and executes it to give the illusion of a properly behaving application.
Scheduled Task/Job: Scheduled Task
steal credentials by decrypting them from registry values
G1009 Moses Staff
injected into other processes.
The dropper bundle in the applications folder appears legitimate,
The authors used several common techniques to obfuscate this process.
they used compromised workstation and domain admin accounts to upload a payload via SMB on several target Workstations and the DC.
executes an executable using process hollowing
Payload decryption function.
as a hard-coded XOR key
the current process name
packed into a Windows executable file
cmd.exe /c
has attempted to get users to launch malicious documents to deliver its payload.
S0105 dsquery
PDF documents with a CV and IELTS certificate
is unpacked
the threat actor connected via Remote Desktop to a Domain Controller
try to decrypt it using the RC4 encryption scheme with the key
Office documents weaponized
S0335 Carbon
The more common payloads contained within the RAR files are Microsoft Compiled HTML Help (CHM) files
Match Legitimate Name or Location
shellcode decompressing and loading
usage of a highly similar decryption algorithm
Base64-encoded strings
This file is base64 twice,
brute forcing post-infection to automate local and global spreading attempts.
the adversary used the valid account to directly login
WMI activity [T1546.003] was also observed to execute commands on the systems.
hosted the ZIP file containing the payloads
Dissecting One of APT29s Fileless WMI and PowerShell Backdoors POSHSPY
remote monitoring and management (RMM) software
launching the getsystem command in the wrong console (shell console rather than the beacon console).
This module is an obfuscated shellcode.
can read files,
TA0009
abuse legitimate applications vulnerable to DLL side-loading attack.
This function scans VM volumes on an ESXi server.
decrypts the encrypted
StartDownload, StopDownload.
The execution phase started with that password protected zip, which after extracting would show the user an ISO file that after the user double clicks
user opens the CMD file,
actors to execute directory traversal attacks
will need to resolve these APIs dynamically to interact with the Windows operating system
S0486 Bonadan
Windows Service Creation
the full HTTP request to make the first connection to the C&C
S0342 GreyEnergy
started a BITS job to download a Cobalt Strike beacon
S1030 Squirrelwaffle
S0087 Hi-Zor
lateral movement scripts such as WMIExec.
Screenshot grab
Minidump of LSASS process memory
This produces strings including a commandline usage:
used different sets of defense evasion and reconnaissance tools such as GMER and Advance Process Termination to manually uninstall antivirus products on the target system.
archive is unpacked to a temporary folder.
Name of running module\nPID
The packer decompresses and executes
It is unpacked
The GUID returned from the registry value
GetTokenInformation API.
Uses cmd.exe to execute commands.
it searches for .blf files in the\ndefault user’s profile directory
The malicious side loaded DLL
the threat actors first used a compromised, highly privileged account to access the device where the Azure Active Directory (Azure AD) Connect agent is installed.
the use of DLL sideloading for its arrival and execution technique.
HttpConnector and HttpBindConnector are HTTP client with support for proxy and HTTP server.
the adversary now armed with the valid account, was able to access a document stored in SharePoint Online, part of Microsoft Office 365.
Injecting into the rundll32.exe process to hide usage of Mimikatz, as well as injecting into a running legitimate explorer.exe process for lateral movement.
PowerShell downloader script, which the attacker attempts to execute to re-infect the victim’s machine,
S0211 Linfo
ipconfig
decodes the directory path
adding a scheduler task,
an obfuscated VBA macro
Deobfuscate/Decode Files or Information
uses .NET Graphics class CopyFromScreen Function() to transfer a bit block of color data from the screen to the Graphic drawing surface that will be saved in memory stream for data exfiltration.
the attackers copy tools necessary for deployment to the compromised host.
cleanup script used to remove evidence of the attack on a system
LockBit 20 How This RaaS Operates and How to Protect Against It
The actors exploited Log4Shell for initial access to the organization’s VMware Horizon server.
stores collected data in local SQLite databases prior to exfiltration.
to use this tool for remote management of its infrastructure.
S0107 Cherry Picker
System Network Configuration Discovery
Retrieve TCP/UDP tables
“The banking trojan targets the victim’s sensitive information
cmd /c
C:\programdata\procdump64.exe -accepteula -ma lsass.exe C:\ProgramData\lsass.dmp
decrypting the appropriate loader
Files are deleted after use.
cmd /C
Another component collects information about mapped volumes, including mount point, name, drive type, and disk usage data.
plus the folder
Disabling PowerShell logging
these are encrypted and split inside the XML.
Conti Ransomware
exfiltrate files and extract data from specific applications.
credentials are extracted with Mimikatz.
decodes the configuration data and modules.
Command execution
began with an actor signing into an internal user’s Microsoft 365 account from a VPN
operating system version
The krbtgt account is a domain default account
malicious shortcuts
which stored credentials in a database file.
S0149 MoonWind
cmd"  /c
they are instructed to click “Confirm” to view a message from “Express.”
It also embeds a DLL version of the Pafish (aka Paranoid Fish) sandbox and analysis detection tool as one of its encrypted resources
This was achieved by transferring a Cobalt Strike DLL over SMB
cmd /C
The random (PsExec) service runs a rundll32.exe process without any arguments.
storing the names or hashes of the APIs needed, then importing them dynamically at runtime.
Legitimate accounts obtained by the attackers can be used to ensure persistence in the compromised infrastructure.
invoking comsvcs.dll with rundll32.exe, an adversary can create a dump of any process
encrypted payload
The actors downloaded the following tools
cyber actors used RDP
more obfuscation and encryption techniques that lead to the final payload.
along with code that decodes and decrypts the block of base64.
KCP protocol
is also decoded, and placed back
creates a thread in the kernel that injects the next stage into winlogon.exe.
Enumerates files under Steam application directory
S0477 Goopy
S1120 FRAMESTING
This enables the operators to setup a listening port and leverage it to relay traffic to and from the open beacon session
The Shell.Application object provides methods for working with the Windows shell
to obfuscate the source of the\nactivity.
injecting it into an svchost.exe process,
leveraging comsvcs.dll with proxy execution by rundll32.exe.
brute forcing
TLS encrypted data
to identify where the Operative System is stored in the disk
It installs itself by creating an InstallSvc service
the embedded payloads in the IronPython scripts,
Windows registry Run key
S1022 IceApple
to grab the encoded and encrypted master key
Updated New Evidence Emerges to Suggest WatchDog Was Behind Crypto Campaign
This is a multi-stage attack that involves sideloading DLLs,
send the decryption program
Propagation through GPO
used a heavily obfuscated PowerShell script
S0677 AADInternals
WMI Component
files that where downloaded from those sites:
the PowerShell being executed was Base64 encoded
G0027 Threat Group-3390
S0223 POWERSTATS
The model uses the persistence technique utilizing svchost.exe with service.dll to install a rogue service.
text-encoded in base64
the threat actors proceeded to RDP to the domain controller.
sending new emails with attached xls and zip files.
S0273 Socksbot
This adversary starts with obtaining usernames
Unwrapping Ursnifs Gifts  The DFIR Report
allocate memory, change permissions, read the encrypted/packed chunk of code, decrypt it, load it to the allocated memory space and execute it
shellcode from the .data section
they accessed the server via RDP
the executable code used to decrypt the encrypted data
The actors used RDP to move laterally to multiple hosts on the network.
using privileged accounts and then accessed the wiki using a different set of credentials.
information about the database server and the TDS versions used
S0599 Kinsing
S1121 LITTLELAMB.WOOLTEA
it stores three embedded binaries within the unpacked payload.
After resolving the functions
Showing the Transfer of Cobalt Strike Beacons using RDPClip:
a downloader that downloads and executes a payload
The malware then proceeds to decrypt its configuration block,
reg  add "HKLM\SYSTEM\CurrentControlSet\Services\iscsiwmi\Parameters"
The dropper configures\nthe backdoor with a C2 server address, RC4 encryption key,
A snippet of the RC4 key generation function
decrypt the shellcode
to retrieve the malicious payload and download additional resources
S1068 BlackCat
GetSystemTimeAsFileTime Api call
“C:\Windows\System32\cmd.exe” CommandLine: “C:\Windows\system32\cmd.exe /c
injected code in a process
To the victim, the opening process simply looks like a regular directory.
schtasks /create /tn WinSecurity /sc minute /mo 15
One of the techniques to conceal the traffic from DNS-based filtering is Domain Fronting.
is re-encrypted
multiple levels of encoded commands,
cmd /C
Persistence for the downloaded payload is established via the Tendyron value under the Run key HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run.
S1105 COATHANGER
S0634 EnvyScout
used to create scheduled tasks for persistence
usually to the victim’s domain name
designed to stop Cisco AMP.
After successfully decrypting the C2 URLs, the data is sent there using a HTTP POST request adding the constructed query string as data
0x10000025get handle of the process with specified PID
encrypted payload, containing the main functionality of the dropper, is stored in the dropper’s resources as bitmaps named from A to L.
has the ability to drop and execute additional components.
malicious payload
rundll32.exe
S1074 ANDROMEDA
The payload from the project files was a remote access tool (RAT) called Remcos.
S0647 Turian
once decrypted, contained the C2 domains for additional malicious artifacts.
these appear to be maliciously patched versions of the legitimate ffmpeg.dll
now responsible for decoding the configuration.
used to decode the body
usage of Mimikatz
the configuration file encrypted.
Both send information to command and control (C2) servers
will decrypt this file with a single byte in XOR operations, find the PE header, and drop the payload to the specified path.
When byte code bites Who checks the contents of compiled Python files
c:\windows\temp\procdump64.exe -accepteula -ma lsass.exe
the threat actor injected into various processes
Modifies the Windows registry to allow remote desktop connections.
the initial loader/injector winutils.dll is protected with UPX-style packing
stored as obfuscated data in the registry
using the FindFirstFileW() and FindNextFileW() API functions.
Collectors are gadgets that retrieve a value already present in a register, and save it back into the attacker’s counterfeit object
S0066 3PARA RAT
G0028 Threat Group-1314
S0578 SUPERNOVA
The database used a weak password and was susceptible to brute-force attacks.
change the final payload’s section names,
cmd /C
The shellcode is stored in the registry,
the user will continue to execute the dropper
Deploys PDQ Inventory Scanner tool.
Query string containing system information before being sent to the C2.
Once the working directory is prepared,
S0210 Nerex
taking command line arguments
File deletion functions
HTTP Parent Beacon
which decrypts to the following 5 bytes
The organization used default configurations for hosts with Windows Server 2012 R2.
S0686 QuietSieve
Modifies the Windows registry
used a registry run key to maintain persistence.
Drive information retrieval
GetSystem creates a service
C:\Windows\system32\cmd.exe /C
S0232 HOMEFRY
Scheduled Task/Job: Scheduled Task
obtains the victim’s username.
HTTP_HANDLESends HTTP GET requests using a Golang standard library.HTTP_RAWFormats and sends HTTP GET requests.HTTP_BYPASSSends HTTP GET requests with spoofed headers.HTTP_NULLHTTP headers are each one random byte (
obfuscated arithmetic value calculations
S0584 AppleJeus
disabling Windows Defender
encrypted in the backdoor's standard way,
receives a ZIP file containing a benign file in plain sight
downloading
Exfiltration Over C2 Channel
S0685 PowerPunch
powershell -np -w hidden -encodedcommand
The victim double clicks the ISO to mount it
credentials
The response gets decrypted with the IcedID decryption routine,
the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent.
When the payload was executed, there were some telltale registry events observed
Thread Execution Hijacking
collecting information on the system,
This includes browser session and credential data.
Three files are sent to the victim's computer:
S0079 MobileOrder
the encrypted ScrambleCross shellcode
The base64-encoded strings were plaintext again in this version.
malware will attempt to gather specific, sensitive information from targeted systems.
uses an AES CBC (256 bits) encryption algorithm for its loader and configuration files.
run the payloads by sideloading them to the legitimate executables
using stack to decrypt strings
Microsoft Windows Defender AntiSpyware Protection disabled
delete the driver files.
This process was invoked by RunDLL32.exe
used Ngrok to proxy RDP connections and to perform command and control.
downloads the payload
will be decompressed and decrypted
masks your traffic to a certain website by masquerading it as a different domain.
Bypass User Account Control;The attackers may bypass UAC using the ICMLuaUtil COM interface, as well as use the Masquerade PEB method.
PowerShell to connect to third-party file sharing\nsites to download the UltraVNC application
Write a.lnk file in the startup folder
This proxy server is located on the I2P network at the destination of the pool tunnel
S0022 Uroburos
used RATs that can launch a command shell for executing commands.
GuLoader VBScript Variant Returns with PowerShell Updates
another shellcode, XOR-decrypts an embedded PE file – the Dolphin backdoor – and loads and executes it using a custom PE loader.
S0431 HotCroissant
exploited Microsoft SharePoint servers in 2019 to gain code execution, probably by leveraging CVE-2019-0604
C:\Windows\system32\cmd.exe /C mimikatz.exe privilege::debug sekurlsa::logonPasswords full samdump
Computer name
was hiding in non-malicious code,
decrypts it
Another batch file
These credentials used appear to be default credentials for IoT devices.
using UltraVNC to download and store\na file
Sets Run Key with “work/online”
Username and workgroup
enumerates system services to search for ones relating to security
the hidden view attribute in file explorer in reference to the ProgramData folder.
The OneNote file with the embedded HTA file
deletes the directory with the files causing the errors
contains an XOR-encrypted payload, divided into three files
keylogged a user during a mandatory password change
It works by decrypting a shellcode BLOB with AES-256
The team used HTTPS
the malware needs to read\nand decrypt those registry key values
can identify the user and groups the user belongs to on a compromised host.
the “UsingTask” element defines the task that will be compiled by MSBuild.
Write text to a given *.bat file and execute it
The threat actor attempted to remotely list running processes on systems using tasklist.exe
cyber actors used valid accounts to log into a service specifically designed to accept remote connections, such as telnet, SSH, RDP, and Virtual Network Computing (VNC).
HTTP C2 Communication
S0414 BabyShark
RDP sessions
Calling Local Windows RPC Servers from .NET
loads and executes the decrypted
packed versions uploaded to VT
browses a directory
the stolen credentials are used to reach high-value machines like servers
S0347 AuditCred
Domain fronting is a technique used by attackers to circumvent protection based on DNS filtering.
S0498 Cryptoistic
domain fronting
G0043 Group5
G0046 FIN7
following base64 decoded header
the malicious attachment,
Cryptography API:
download additional payloads and C&C commands
it writes a batch file
S1031 PingPull
the document triggers the injection of a custom downloader – a PE executable – into an iexplore.exe process.
The emulated C2 Server is now running an HTTPS server
Windows Batch file
S0614 CostaBricks
including the use of DLL sideloading
obfuscated PowerShell
with SOCKS v5 server
An example of the creation of such a scheduled task by the adversary:\nschtasks /create /ru "SYSTEM" /tn "update" /tr "cmd /c c:\windows\temp\update.bat" /sc once /f /st 06:59:00
batch file
the username
To remotely access the compromised infrastructure, the attackers may use Cobalt Strike, TeamViewer and ScreenConnect
S1087 AsyncRAT
decompress them
It first decrypts the embedded DLL using a byte-oriented XOR-and-ADD scheme
These strings are passed to a decoding function where they are converted from hex to byte and XOR’d with decimal 18.
Both were designed to turn off antivirus and anti-malware software.
there is a custom AntivirusCheck class, which can check running processes against a hardcoded list of XOR-encrypted executable filenames from known security products: 360 Total Security, Avast, Avira, AVG, Bitdefender, ESET, Jiangmin Technology Antivirus, Kingsoft, McAfee, Micropoint, Norton, Rising Antivirus, and Trend Micro.
Stolen certificates in two waves of ransomware and wiper attacks
S0173 FLIPSIDE
injects itself into explorer.exe
Victims will receive and interact with a decoy document containing a Google Drive link and a corresponding password instead of an archive download link embedded in the email.
adds the HIDDEN file attribute to the file:
kernel32.CreateMutexA
Packed Rorschach loader and injector
antivirus check script
G0040 Patchwork
which allowed the threat actor to move freely between domains.
the executables and sideloaded files
attackers have been seen using several methods to distribute the wiper through the domain, like: domain Group Policy Object (GPO)
Malicious service installation is accomplished via the below command line argument:\nsc create WindowsUpdate binPath= C:\Windows\Temp\svchost.exe start= auto obj= LocalSystem DisplayName= windowsupdate
PowerShell encoded commands:
the decrypted payload
malware is designed to steal sensitive information from victims' systems,
Once the initial configuration data has been decrypted
The attacker must know the time to set it in the scheduled task.
use of the .NET framework APIs
Once the malware has de-XOR’d all its strings, it invokes a method named go.
This technique is called self-injection or PE overwrite
S1018 Saint Bot
activity from a network proxy tool
S0192 Pupy
File and Directory Discovery
S0182 FinFisher
network configuration
C:\Windows\System32\cmd.exe /c rundll32.exe C:\ProgramData\x86.dll, StartA
The fernet_decrypt function decrypts an encrypted string
a separate service was created for that agent.
enumerates running processes
G0048 RTM
runs it via rundll32.exe
propagating through brute force attacks on vulnerable devices with insecure configurations that use default or weak credentials
The command to get specific files
the embedded DLL
ViperSoftX Updates Encryption Steals Data
the encrypted config.
S1060 Mafalda
done via the GetAsyncKeyState API,
the threat actor embedded the signed raw disk driver in the wiper executable
S0666 Gelsemium
S0626 P8RAT
the decryption algorithm
dumping their LSASS process
used DLL side-loading to execute their malicious payloads
The command CollectSystemDescription retrieves the following information:\n\nLocal Computer Domain name\nAdministrator Account SID\nHostName
Process Injection
The Blockchain.pdf file is a malicious HTML application file
S0412 ZxShell
S0036 FLASHFLOOD
operators install and execute remote access tools such as Splashtop on targeted systems.
retrieves the same files from the C2
Encoded PowerShell command
It invokes the undocumented API UserAssocSet to update the file association.
"cc.bat" is a simple script
cmd /C "C: & cd \ & dir $temp\ /od"
XOR-decrypts further shellcode carried within itself,
sample uses obfuscation
PeekNamedPipe Windows API function
In February 2022, the threat actors exploited Log4Shell [T1190] for initial access
RDP was also used by the threat actor
The base64 string
SFX archive
the system information gathered by Domino Backdoor and sent to the C2
executes the export function “StartA” from the DLL
looks for
 reads the encrypted configuration filecan
the threat actors accessed it through RDP, which is an open session that evades MFA blocking their activities.
anti-virus software information
GET request with C2 server
injects itself and additional malware(s) into all processes
the attacker's C2 via the HTTP POST method.
S0035 SPACESHIP
the malicious document connects to the remote server and downloads the payload
This is accomplished with a native bootstrapper DLL, which gets injected into the remote process and prepares it so a .NET assembly can be injected afterwards.
appended file\nheaders used to bypass content inspection made this backdoor difficult\nto identify
It also drops and installs
"cmd"  /c
the executable ieinstal.exe was used to bypass UAC.
Mimikatz – a credential theft tool.
S1013 ZxxZ
tries to get access to the server via brute force
unpacks the legitimate PsExec utility
After establishing the reverse SOCKS proxy connection,
T1047
S0590 NBTscan
ROR-13 hash
a regular Bitmap (open matrix image format used by Windows) that can be used by malware to execute code or as a payload dropper
the logging strings are encrypted with a single byte in XOR operations as
call the NtTestAlert function
or Windows Scripting
Files and folders of interest are collected as well and staged for exfiltration.
They issued remote commands using WMIC to conduct discovery, as well as distribute and execute Cobalt Strike beacons.
S0039 Net
it fetched an additional script payload
The threat actor installed Atera and Splashtop remote access software
Use NtQueryInformationProcess API
It was quite common to see scheduled tasks used to create persistence for the ransomware executable,
S0056 Net Crawler
Decompiled code of a function used by a FatalRAT
valid credentials have been used by Vice Society to gain initial access.
establishes persistence through the creation of two keys in CurrentVersion\Run.
S0015 Ixeshe
was abused by the attacker to steal client data.
a batch script used
Decryption function in Python
S0069 BLACKCOFFEE
executed using ShellExecute with the following command line:
the opening of a URL file extracted from the archive.
full-blown PE injection tools able to load a native x86/64 payload reflectively into a remote process.
S0670 WarzoneRAT
adds itself to a scheduled task.
code is protected and obfuscated
How to Detect Cobalt Strike
advapi32.CryptEncrypt
the loader allocates memory within the current process and then loads the PE payload into it using the full PE loading procedure.
S0109 WEBC2
The threat actor created new O365 Service Principals to maintain access to victim’s environments
Threat actors also dropped procdump.exe and procdump64.exe on multiple workstations remotely, dumped LSASS,
S0123 xCmd
Delete a recording with a given filename from the system.
command-line tool
By deactivating UAC, the ransomware gets elevated privileges without requiring user permission or administrator credentials
T1564.001
Python programs that are obfuscated using PyArmor
screenshots
HTTP with long polling
collects local files and information from the victim’s local machine.
Retrieve information about registry keys
The master key is encoded with Base64 and encrypted
Windows Management Instrumentation (WMI).
The WinAPI CryptGenRandom is utilized
payloads are usually shellcode encrypted with a rolling XOR key.
S0428 PoetRAT
From there, the threat actors began connecting to other hosts via RDP, including the a backup server.
uses a custom PL format with encryption
UNC215 Spotlight on a Chinese Espionage Campaign in Israel
spawned with PowerShell via Task Scheduler
, the above files no longer exist on the compromised system, possibly due to the hacker’s evidence deletion.
exfiltrating data from the target device
Before a call to CreateWindowEx, you would usually first need to create a class by calling RegisterClass and then class CreateWindowEx.
S0609 TRITON
possible proxy servers (any indicated in the configuration plus system proxies) and C2 servers
PowerShell to connect to third-party file sharing\nsites to download an NGROK utility
the threat actor must first decrypt them
S0469 ABK
injects it into the created process
Enduring Credential Stuffing
the threat actor used three different tools in order to establish an interactive and persistent command and control channel.
System Information
the group used certutil.exe to download the legitimate WinRAR binary as rar1.exe from the server
Domain fronting uses legitimate or high-reputation domains to remain undetected by defenders.
UNPACKING GULOADER’S SHELLCODE
a heavy emphasis on Remote Desktop Protocols.
full command line argument
uses the same type of strong encryption – AES-GCM
Covers its tracks by overwriting the code previously modified by the malicious library with a useless call to lstrlenW.
"cmd"  /c
keylogs
The decoded command
the malicious batch file
From these injected processes,
S0375 Remexi
The batch file eyewear.bat then executed two commands
S0402 OSX/Shlayer
shellcode that was stored in the .data section is now stored in the .rsc section
decryption of the payload is based on XOR operations
S0266 TrickBot
zip archive
UAC bypass is executed
the list of processes
service was installed in the system
, staged on another system of the victim, and from there copied to a OneDrive-account controlled by the adversary.
keylogging,
, the GetSubDirectoryFileListRecursive function
S0067 pngdowner
PowerShell Empire’s ReflectivePEInjection script
the malware author used phishing emails to deliver malicious OneNote document either as attachment
S0468 Skidmap
modifies the registry
runs WMI queries every second to get all process creation and termination events.
Service Execution
the malware decrypts the saved passwords
S1129 Akira
uses malicious RTF and DOCX attachments to compromise victims.
S0567 Dtrack
Using valid accounts
C:\Windows\system32\cmd.exe /C
uses HTTPS to communicate with Google Drive.
G1019 MoustachedBouncer
the actors used RDP
added to support the Telnet brute force.
domain fronting
Fantasy  a new Agrius wiper deployed through a supplychain attack
Detect and identify source IP
S1117 GLASSTOKEN
The batch file was executed
through the command line as
contains an embedded DLL
launches several processes
Processor architecture
Decrypting and exporting browser data
execution begins with the user clicking on a shortcut file
decompressed
S0547 DropBook
XOR decrypted with key ABCSCDFRWFFSDJJHGYUOIj.
can obtain passwords stored in files from several applications such as Outlook, Filezilla, OpenSSH, OpenVPN and WinSCP.
since each payload will be encrypted with different keys and each configuration will uniquely change the hash value.
cmd.exe /c start
This method speeds up the brute forcing process
S0636 VaporRage
the decrypted\npayload contents
T1083
an encoded payload split across several nodes, further complicating its extraction.
files have XOR-encrypted content to prevent detection
LoadLibraryW, VirtualAlloc, CreateProccessW, and ZwUnmapViewOfSection.
The tool allowlisted the entire c:\drive, enabling the actors to bypass virus scans for tools
attackers placed
using Windows CryptProtectData() API.
a brute-force attack of a Remote Desktop Protocol on a public-facing server.
used a similar XOR-based algorithm as part of its encryption mechanisms during communication with the C2.
uses Windows API functions to execute files
In order to appear as a working copy of Logic Pro X, the dropper contains a legitimate copy of the lure application
content in a batch script:
Obfuscated Files or Information
A scheduled task was then created using this same DLL.
utilizes Telegram for delivering payloads
Download a file from the remote server
techniques like process hollowing where the process is created in suspend mode and then replaced with malicious code.
The decoded DLL
Iron Tigers SysUpdate Reappears Adds Linux Targeting
to trick users into opening the malicious attachments in
two batch files were run.
unpacking
the RDP traffic was being proxied through
It contains Base64-encoded data
G0095 Machete
operators use Splashtop to move laterally and transfer malware between compromised hosts in the victim’s environment.
additional XOR encryption with the key
the threat actors used PsExec, to copy and execute a Cobalt Strike Beacon DLL on most of the systems in the network.
directories with random names of a consistent length were navigated to by the same user that ran the tool.
WTB Remote Mac Exploitation Via Custom URL Schemes
checks if it is running on a 64-bit system
requests using RC4 encryption
leaked the stack pointer and retrieved the this pointer as a static offset from the stack.
received a command-line argument from attacker
it collects usernames
“The reconnaissance data is exfiltrated to the attacker-controlled server through an HTTP POST request
"cmd" /c
Investigation with a twist an accidental APT attack and averted data destruction
The commands retrieved from the server are also encrypted with AES-128
examines all the processes on the system
fetch the next stage payload.
S0130 Unknown Logger
Stops the Microsoft Defender Antivirus Network Inspection Service (WdNisSvc)
to identify any credentials which may be stored in technical documentation
uses .NET Graphics class CopyFromScreen Function()
RAM size and usage
collects file and directory metadata
TA0006
T1074.001
“cmd /c
The beacons are of particular interest due to the domain fronting technique using a government host as the initial DNS lure.
wininet.HttpSendRequestA,
G0049 OilRig
write a batch file to disk that executes the Fantasy wiper, and then run that batch file via PsExec with this command line string
has been obfuscated with the same rel_jmp and fake-jb techniques
Like the earlier SSH brute-forcing campaign
This service executes a malicious binary (Cobalt Strike Cat payload) under “C:\Windows\Temp\svchost.exe” every time the victim device is started.
to steal information from the compromised or targeted host
WMIC /node
prepare the address of the Windows API we want to invoke along with its arguments.
When running the file from the command line,
inject processes that are expected to communicate over the network
attacker dump the LSASS process using Task\nManager to a file named lsass.DMP, and later, zip the dump into two\nfiles named lsass.zip and lsass2.zip located in the\nC:\ProgramData\psh\ directory.
creates another group policy
The batch file would download and execute
S0457 Netwalker
Discovery
RC4 key for decryption
Vice Society leverages PrintNightmare in ransomware attacks
Transport protocol 3, port 8443\nTransport protocol 2, port 80\nTransport protocol 1, port 8080
which is vulnerable to a DLL side-loading vulnerability, and loads a file
Then, a function defined by its hash is retrieved (using the same hashing algorithm that was used to retrieve imports from normally loaded DLLs):
malleable C2 profiles are configured to allow domain fronting using the Fastly and AzureEdge CDNs
searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip.
has the ability to collect or extract various types of system information from a targeted or compromised computer
Lateral Movement
encrypted data is then exfiltrated using the below C&C URL
decrypts the Orchestrator
A service account, with Domain Administration permissions, was used to create a remote service on a Domain Controller to move laterally.
web shell with filenames that masquerade as human.aspx, which is a legitimate component of the MOVEit Transfer software.
S0102 nbtstat
cmd.exe /C reg add
S0355 Final1stspy
Encoded binary payload
to download and execute an intermediate script which then downloaded and executed the Standard IcedID Loader using a non-standard export “init”.
C:\Windows\system32\cmd.exe /C
It collects sensitive data from web browsers,
The POST event included a MIME part indicating file upload
encrypts communication with C&C using AES in CBC mode
to disable remote administration restrictions to facilitate lateral movement and privilege escalation activities
it also tries to delete the wp-sale.js file
the threat actor executed a batch script
two large arrays of decimal bytes were decoded by the function
loads a fresh copy of ntdll.dll,
The Decryption shellcode has three main tasks: first, it extracts the Loader shellcode and the payload, then it decrypts them, and finally, it transfers the execution to the decrypted Loader shellcode.
The team used this root access to move laterally to SBS-connected workstations.
methodDescriptionUDP_RAWSends UDP packets where the payload is customizable.ICMP_FLOODSupposed to be an ICMP flood, but the packet is built incorrectly.TCP_CUSTOMSends TCP packets where the payload and flags are fully customizable.TCP_SYNSends SYN packets.TCP_ACKSends ACK packets.TCP_SYNACKSends SYN-ACK packets.TCP_XMASChristmas tree attack (all TCP flags are set).
cmd /C "C: & cd \ & systeminfo"
using a domain service account.
adding the HIDDEN file attribute
creating a schedule task
This activity group always uses a renamed version of rar.exe.
via the find.bat batch script.
a RAR archive
Decrypts
Gather computer-specific information such as computer name, username, gateway address, network adapter details, Windows version, and user type
the command line provided to the ransomware is parsed.
UAC Bypass via the AppInfo RPC service
Lateral Tool Transfer
executing scripts and commands retrieved from C2 such as ps1, bat, vbs, and exe
Code for the brute forcing implementation is significantly more structured
the adversary had removed the payload file from the system.
cmd /C
is implemented via NtSetInformationFile using FileInformationClass FileRenameInformation,
It decrypts an encrypted payload,
Linux malware strengthens links between Lazarus and the 3CX supplychain attack
simply de-XOR the entire binary
executing a batch-file (.bat) to perform their tasks.
by modifying Group Policy Objects
When downloaded, the initial attachment is a local HTML file.
the malware initiates a download, which delivers an executable
Uses legitimate VPN, RDP, Citrix or VNC credentials to maintain access to an environment.
computer name
adds a custom icon to the registry,
S0516 SoreFang
Explanation of schtask parameters
S0084 Mis-Type
The threat actor accomplished this by using administrative accounts
Word document lure requesting the user to run the VBA macro.
collects cookie information, search histories, and key inputs from browsers
keylogging are enabled by default,
used to dump information from the victim’s Oracle database.
BlueNoroff introduces new methods bypassing MoTW
encrypted archive containing the ransomware,
S1108 PULSECHECK
exploiting vulnerable web-facing devices
Downloading and running further executables
VPN access using Single Factor authentication.
script removes the i2pd Mach-O file from the disk.
domain fronting
downloads the PowerShell downloader script from an attacker-controlled server
ITG10 Likely Targeting South Korean Entities of Interest to the Democratic Peoples Republic of Korea DPRK
archive was distributed
G0013 APT30
This thread is then used to execute the SMB copy and remote execution
G0064 APT33
download a malicious file
TA0010
S0667 Chrommme
After successfully decrypting the C2 URLs
running processes were reviewed
contains the decryption algorithm for the second stage
S0642 BADFLICK
uses PowerShell downloader
Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
finds the API functions it needs
NetServerGetInfoto retrieve the current configuration
G0056 PROMETHIUM
The communications module then downloads the main backdoor module,
copies the payload to the folder C:\Users\Public\Downloads
In addition, the sample generates a scheduled task with multiple triggers.
Hard-coded credentials for brute forcing.
screenshot
The exploit payload then downloaded mdeploy.text
cyber actors have exploited known vulnerabilities in Internet-facing systems
script with embedded .NET injector and ComRAT payload
Returns the current user’s SID.
decrypt the\nData field.
spawns it with the rundll32.exe command with the payload URL
Get AdapterRAM and Graphic Card Name and type by executing  "root\\CIMV2", "SELECT * FROM Win32_VideoController"
collects information about the .NET Framework Setup
Threat actors obtained and abused credentials of privilege domain accounts
These were used to inject the payload into process memory.
SSL encrypted traffic
deletes,
UAC Bypass via the CMSTPLUA COM interface
S0229 Orz
RAR and SFX-RAR files
starts using the Cobalt Strike beacon for remote access and command and control.
decoded into a new script
the deobfuscated SMOKEDHAM dropper.
System Directory
-ReflectivePEInjection” that facilitates reflective PE injection using PowerShell.
RDP connection established
Hooks several functions from ntdll.dll to hide its presence.
S0605 EKANS
S1097 HUI Loader
script that downloads a file from a fixed location and executes it.
malware pulled down and executed a Cobalt Strike payload on
The user account was possibly compromised on the Linux server by using credential stuffing or password spraying:
Download components for the Keylogger
The malware decrypts the configuration data with the RC4 algorithm using an embedded 64-byte key.
to enable Remote Desktop sessions (RDP) using reg.exe.
The team used WMI Event Subscriptions to move laterally between sites.
Nefilim Ransomware
using the WinExec API
Most PowerShell scripts involved in LockBit 2.0 cases are Base64 encoded.
PE file was encoded as an obfuscated hexadecimal string.
abusing API calls in the Operating System.
injectors
an encoded PowerShell command stage, obfuscating the activity further than just simple string concatenation.
It collects the victim’s username
The threat actor regularly interrogated other systems using tasklist.exe
S0195 SDelete
Upon unpacking a sample
the adversary used impacket to execute Windows Management Instrumentation (WMI) to achieve command execution on other systems present in the environment.
The corresponding files are collected
were initiated from the rundll32.exe process
the malware can read HTTP-POST headers
the local disk volumes to be encrypted are also configured in a similar manner.
S0687 Cyclops Blink
control flow obfuscation to hinder analysis
the function used to encrypt and decrypt the embedded module
into the folder c:\programdata
command execution.
S0482 Bundlore
Attackers can use legitimate domains that are registered under the same CDN provider.
checks for a few installed and active antivirus products, namely:\nWindows Defender\nESET
sending spearphishing emails with malicious attachments such as RTF documents created via the Royal Road builder
DLL has an encrypted payload embedded in it.
contains the payload DLLs and a few legitimate executables and DLLs
We have also found that each sideloader DLL has its own pair of executable and byte map,
walks through all mapped file systems and collects files
G0133 Nomadic Octopus
S0562 SUNSPOT
for the Ir8 script to decode.
Self-decrypting DLL
S1075 KOPILUWAK
modifies the victim's system power and lid open/close policies in the registry.
exploits known vulnerabilities in internet-facing applications
Contents of the .img file, including the hidden files
to use WMI for storage and\npersistence.
Second-stage legitimate executable for DLL sideloading
another obfuscated binary carrying an embedded resource
When the user double clicks or opens the lnk file,
download and execute further shellcode
For lateral movement, the attackers made use of the PsExec tool and the net use command for accessing shared resources on remote machines.
The batch file
took place over an unencrypted HTTP channel, the network traffic was plainly visible.
Affiliates have been seen brute forcing
embeds the next stages of the execution inside an additional file, usually an XML or a PDF file.
T1070.004
After the PE is decrypted
uses alphanumeric characters and the special character “_” to generate a random name and creates a folder with the random name in the root directory of the victim’s machine.
executes a batch file
S0400 RobbinHood
utilizes comsvcs.dll to dump credentials from Local Security Authority Subsystem Service.
the command line argument
extract specific information about running processes
S0460 Get2
to terminate security-related processes and services by dropping KILLAV
the threat actor accessed the environment using Tactical RMM to deploy Anydesk on the compromised host.
We’ve seen the payload delivered in diverse ways including DLL side-loading,
G0038 Stealth Falcon
control flow obfuscation.
The threat actor was able to RDP to a backup server
AA21200B Chinese StateSponsored Cyber Operations Observed TTPs
decrypts the next loader stage
the reverse SOCKS proxy activity on the infected device using the open-source tool FRP.
uses the Windows Application Programming Interface (API) call, CreateProcessW(), to manage execution flow.
encrypted payload 
Process injection was observed during the intrusion
cyber actors used valid accounts to log into a service specifically designed to accept remote connections,
is a known indicator of such tools as Mimikatz
command-line syntax was observed being used
S0487 Kessel
actors have also gained initial access to victim networks by distributing phishing emails with malicious attachments
files were then deleted
Sets up persistence by creating an entry in the HKCU\Software\Microsoft\Windows\CurrentVersion\Run registry key.
that all three intermediate C2 servers
RPCConnector and RPCBindConnector
Exploitation for Privilege Escalation
It returns the decrypted message as a decoded string.
three different Remote Access Software were used by the threat actor
compressed archives
Returns OSVERSIONINFOEXW and SYSTEM_INFO structures
to a side-loading vulnerability that
the malware immediately begins to look for EDR and antivirus software.
ransomware uses obfuscation.
shellcode stored in Base64.
The base64 decoded batch file
obfuscation mechanisms during the compilation process.
Reverse Proxy using Cobalt Strike Beacon
To identify if privileged users are active on remote servers, the adversary makes use of PsLogList from Microsoft Sysinternals
The dropper is installed into a legitimate file path, posing as the legitimate application.
cmd /C
The injected process
TA0008
via a ZwCreateSection call
C0021 C0021
Username information
highly obfuscated and contains junk code to impede analysis.
disables AMSI by hijacking the COM server, changing it from "%windir%\system32\amsi.dll" to "C:\IDontExist.dll".
support C2 connections via an external HTTP/SOCKS proxy
decrypts the payload is the same as the function used in FatalRAT to decrypt its configuration
Sending and receiving data with C2 using the RC4 encryption algorithm where the key will be generated at runtime.
The adversary started a password spraying attack against those domain admin accounts,
the embedded DLL
adversary executes Cobalt Strike’s built-in Mimikatz to dump its password hashes.
The info stealer also collects information on infected hosts
the encoded payload
G0014 Night Dragon
T1562.001
Exploiting Internet accessible webservers using webshell small code injections against multiple code languages, including net, asp, apsx, php, japx, and cfm.
DLL sideloading
S0613 PS1
There were several variants of Mimikatz in binary and PowerShell form
downloads and executes a malicious backdoor
Downloading, decrypting, and executing a backdoor payload from an attacker-controlled server
Strings are encrypted
RDP connections were established from the beachhead host to systems throughout the environment
to execute various dropped tools or beacons on the endpoint,
G0054 Sowbug
domain fronting appears to be used by threat actors.
delete files.
the win32 function CreateServiceA was used by the malware
Malicious File
C:\Windows\system32\cmd.exe /c
collect the victim’s login credentials for various online accounts
Malicious commands are executed via WMI as a means of “living off the land” and avoiding detection.
downloading of the next stage.
G0006 APT1
and a batch file 1.bat were dropped on the host and the batch file was executed
Embedded files of ISO image
decrypt
Disables the following Windows Defender features:Intrusion Prevention System\nIO AV Protection (does not scan downloaded files and attachments)\nRealtime monitoring\nScript scanning\nControlled folder access protection\nPUA protection\nScheduled scan
collect information about the computer name and OS version and whether it is 32-bit or 64-bit
Command line flags may be used to change this behavior and invoke one or more of the modules.
AES-128 is the encryption algorithm used.
decrypt the embedded module
C:\Windows\system32\cmd.exe /C
Syncro RMM is a Remote Monitoring and Management tool used to control and manage devices remotely.
The unpacked sample is approximately 540 KB
is protected with DNGuard, a commercial .NET packer.
S0643 Peppy
G0122 Silent Librarian
designed to steal sensitive information, including login data, cookies, and Facebook ad and business account information.
obfuscated trampoline in the .text section.
The second way to execute StealthMutant is through the creation of a scheduled task
T1082
G1026 Malteiro
the attacker-controlled server through an HTTP POST request
used various RATs that can capture screenshots of victim machines
S0169 RawPOS
Encrypted Multi-Hop Proxies
S0398 HyperBro
mining proxy.
The tool allowlisted the entire c:\drive, enabling the actors to bypass virus scans for tools they downloaded to the c:\drive.
may use stolen legitimate accounts specified in the configuration data.
to lure victims into downloading a malicious file
S0466 WindTail
G1017 Volt Typhoon
The following file extensions of interest, specific to media, documents, emails, and certificates,
S0091 Epic
creates directory listings
containing one-byte XOR encrypted sections
PowerShell scripts in charge of downloading a second stage RokRAT shellcode
Besides the use of Mimikatz to dump credentials,
on TCP port 2222.
Manipulate processes (list
attacker also attempted to execute PowerShell scripts on remote systems in the environment while moving system-to-system
Will also skip enumeration and stopping of antivirus software.-
keylogging
A batch file to stop services
and the creation of a schedule task.
Spearphishing emails with malicious attachments
Whether the OS is 32-bit or 64-bit
it locates a packed and compressed payload
:\Windows\system32\cmd.exe /C
recursively removes the implementation of Windows Defender IOfficeAntiVirus under HKLM:\SOFTWARE\Microsoft\AMSI\Providers\{2781761E-28E0-4109-99FE-B9D127C57AFE}.
This is a Windows Native Binary executable embedded inside of UEFI firmware binary
--serviceService Type: user mode serviceService Start Type: auto startService Account: LocalSystem
pack the code’s dependencies into the .NET assembly so it can run self-contained.
is typically executed via command line arguments
Uses OpenSCManagerA and EnumServicesStatusA APIs.
S1063 Brute Ratel C4
manually disabled Windows Defender via the Graphical User Interface (GUI)
extract shellcode
username
encrypted URLs contained in the malware itself.
to enable multiple Remote Desktop\nconnection sessions
which initiates the payload download
injects itself into processes
then sends the AES-encrypted system data.
the RC4 decryption method uses CryptoAPI (CryptDecrypt) instead of the usual substitution box method
the plaintext credentials in PowerShell scripts
can exfiltrate files from local file systems.
With the DLL strings decrypted, the malware then decrypts the loader configuration by taking the first 64 bytes and XORing it against the next 64 bytes.
use UltraVNC to download two LNK\nfiles
install an information stealer.
The current username home folder
System Network Connections Discovery
a second, encrypted component, which carries the payload.
including the computer name and the OS version of the compromised system were sent
injecting itself into a running explorer.exe process.
logs keystrokes
schtasks /create /TN
S0343 Exaramel for Windows
S0332 Remcos
uploading and downloading files
Following the payload header, the malware expects blocks of\nencrypted data with 8-byte headers.
Update 2 3CX users under DLLsideloading attack What you need to know
the Content-Key, which is a custom HTTP header whose value corresponds to a hash generated out of the HTTP header.
Decompressing
opened with the CreateLogFile() API
team attempted to determine valid accounts based on group name and purpose
Before the decryption starts
to decrypt the payload from the .dat file using the AES-256-CTR decryption algorithm and starts to execute.
obfuscated .NET file using process hollowing, which is a code injection technique in which an attacker removes legitimate code from an executable and replaces it with malicious code.
components use registry keys to signal each other.
invoke any API we like,
S0583 Pysa
ZeroDay Vulnerability in MOVEit Transfer Exploited for Data Theft
service was configured to execute the next step of the installation process by running a legitimate application
Downloads and uploads files to and from the victim’s machine.
S0386 Ursnif
the hacker also injects malicious DLLs into the memory,
to push batch files over SMB to other systems within an internal network.
drops an embedded payload, which is a DLL file
use of W4SP crew obfuscation tools such as Hyperion and Kramer
generating a script to decode the legitimate Mach-O file.
Detect and identify source IP
screenshots
checking if a file on the victim’s filesystem exists and gets the file’s attributes, collecting size and version information,
creating SQL queries to produce the database tables to store the stolen data
the injector is its ability to load an assembly into an unmanaged process.
they inject their main bot into a Windows process, and then inject their other modules into different processes according to the module’s purpose
they will submit immediate tasks to the hosts in the domain through GPO
using LNK files to download malware or other malicious files by leveraging legitimate native apps, such as PowerShell.
S0270 RogueRobin
It then performs SQL queries to retrieve files, file size, folders
deletes the ransom note
downloading and executing
This is used as an integrity check for the decryption process.
The Scheduled Task was named  to masquerade as a legitimate Windows task.
S1051 KEYPLUG
Real-time screen monitoring
G0137 Ferocious Kitten
XORed with the first 4 bytes of the AES key used to encrypt the message.
encrypted copy
T1090
stored within the registry
S0569 Explosive
can modify group policy for privilege escalation and defense evasion
side loading “ffmpeg.dll”.
S0055 RARSTONE
It calls OpenProcess on lsass.exe with access flag set to VM_READ, and looks for the modules wdigest.dll and lsasrv.dll loaded in the lsass.exe process.
the malicious executable to unpack itself.
CMD-based scripts
capturing screenshots,
G0099 APT-C-36
sideloading different DLL names, and multiple binary files names being loaded by those DLLs.
The obfuscated registry is then read by MSHTA and the obfuscated code is
S0570 BitPaymer
Remote Access Software
creates a scheduled task on the system that provides persistence.
IronNetInjector Turlas New Malware Loading Tool
to download next stage and execute it"
Side-loaded DLL name
G0010 Turla
The API function located at the beginning of the memory section are resolved using GetProcAddress
communicates with a hardcoded IP address via HTTP.
Windows Management Instrumentation
AdFind was renamed to masquerade as a legitimate Windows binary
implemented process hollowing by first using VirtualProtectEx on the process entrypoint, and then writing the hook stub using WriteProcessMemory.
Registry Editor
archive
The decrypted password
PowerShell script that downloads and executes a dropper
Those files will still get executed, if the user clicks on run
This backdoor executes arbitrary PHP code sent in POST request parameters.
The script then removes any files
S0221 Umbreon
performing password spray,
that contained various bat files,
finds the PID of the target process
S0624 Ecipekac
adversary leveraging a Windows Service to execute PowerShell to stay persistent in the environment.
S0680 LitePower
The DLL is used to create a malicious service
used to steal victims’ sensitive data.
S0085 S-Type
Retrieve the list of files
keystrokes
obtains all entries within the IPs starting with 192., 10., and .172 in the ARP cache table
TCP_HANDSHAKEFloods with TCP handshakes.TCP_SOCKETContinuously sends random payloads on an open TCP socket.
PowerShell downloading malware
can create a new threat with the malicious unpacked payload.
In clicking the photo, the victim unknowingly downloads a malicious JavaScript file that
the threat actors began discovery tasks using Windows utilities
The first .CMD file set seen to use AutoIt in its execution
The asynchronous procedure places a hook on the NtTestAlert function and then exits
shows the three registry keys used
queries the Registry for ORACLE MICROS RES 3700 POS version, database passwords and other configuration data
Conti Team One Splinter Group Resurfaces as Royal Ransomware with Callback Phishing Attacks
HTTP POST or GET methods
file stealer
systeminfo
It still downloads a PowerShell code
is a batch script that creates a new user
kernel32.VirtualALloc
the threat actors proceeded to deploy several remote management tools across the environment.
S0005 Windows Credential Editor
an encrypted Dump.bin file
It sets up a run key for the command C:\programdata\netsky\netsky.exe online for persistence.
the actors used RDP
Then, the malware retrieves information on the compromised computer and sends it to the C&C.
S0178 Truvasys
Attackers may attempt to access LSASS process memory to extract credentials as it stores a variety of credentials.
fileless and executed only in memory after going through several decryptions and decompression routines
The decrypted malicious code
Uses GetComputerName to query the computer name.
24 different IP addresses in use
a beacon injected into a single Rundll32.exe process
Stopping Cisco AMP /  Disabling Microsoft Defender
“Display information about current Windows version
The victim downloads a Trojanized application and executes it.
can send system information
scanning files in a specified or generic path
Registry Key Sets
OneNote file contains an embedded HTA  attachment
used an AutoIt packer that comes heavily obfuscated.
operators were able to access their primary target via RDP connections\nfrom a trusted third party using stolen credentials
keylogging
executes an embedded PowerShell command
T1218.011
C:\Windows\system32\cmd.exe /C
by gathering the username and
tokens, and passwords from various web browsers and applications
G0063 BlackOasis
a malicious attachment sent via phishing emails
cyber actors also used on-premises Identity and Access Management (IdAM) and federation services in hybrid cloud environments in order to pivot to cloud resources.
S1017 OutSteel
uses WMI for lateral movement and information gathering.
The Azure AD Connector account and the compromised administrator account were then used to perform
S0162 Komplex
Do Not Cross The RedLine Stealer Detections and Analysis
This allows it to download and deploy
Multiple injections into the LSASS process were observed on multiple hosts.
the command line argument\nprovided
Once the REvil configuration has decrypted
Once the “.tmp” file is found, it is moved and renamed to the Office templates folder
Screen Capture
injects the main bot into svchost.exe.
then starts a suspended process to perform injection on it.
initial code usually called a stub, decrypts or decompresses the real code
and protocols, such as for Remote Desktop Protocol
executing it via a remote service.
systeminfo
they also used tasklist
API hashing
Searches for specific files prior to encryption.
Also the de-XOR’d strings,
Persistence
With this list of administrator-accounts, the adversary performs another password spraying attack until a valid admin account is compromised
or delete files
injecting it into ieinstall.exe
With Rundll32,
 NtQueueAPCThread function
this snippet of code invokes ptrace with PT_DENY_ATTACH (0x1f) which will kill the process if a debugger is currently attached,
running the malware sets itself up as the service
function and the corresponding library are dynamically loaded at runtime – also known as explicit linking
C:\Windows\system32\cmd.exe /C
download
downloaded code chunk
DLL sideloading
added an exclusion rule to Windows Defender
uses cmd.exe to download files from Alibaba Cloud Object Storage Service.
S0334 DarkComet
C2\nserver via a subsequent HTTP POST request
MSBuild has an inline task feature
details of the RDP session
G0004 Ke3chang
Microsoft Windows Defender AntiVirus Protection disabled
Decoding Function
TA0005
computer name
scan hosts for so-called Eternal* SMB vulnerabilities with SMBTouch and then, where possible, run the EternalBlue exploit and infect the computer
This Windows executable is embedded into UEFI firmware
If the obtained valid account is already member of the domain admins group, the first lateral move in the network is usually to a domain controller
brute-forced devices
S0190 BITSAdmin
S0380 StoneDrill
reg.exe add\nHKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
S0260 InvisiMole
This includes bidirectional file transfers between the C&C and the compromised machine.
examples of command lines
The script will download and decrypt the string that represents the token
Making a ‘POST’ request,
C:\Windows\system32\cmd.exe
The decompression function
dumped from an injection into the SearchIndexer process
Web lnks with two shortcuts:
cyber actors use the VPS as well as small office and home office (SOHO) devices as operational nodes to evade detection.
create scheduled tasks to achieve persistence
This first lateral movement was performed in order to drop and install AnyDesk.
deobfuscate, decompress,
S0247 NavRAT
the self-decrypting DLL,
S0128 BADNEWS
malware creating and executing a normal Hancom Office file with the same filename as the malware within the same directory where the malware was executed.
LSASS process memory is one of the prime targets for attackers, as well as malware armed with lateral movement capabilities since it caches a variety of credentials
G1015 Scattered Spider
and the same key is used to decrypt the MFT.
Adversaries use side-loading attacks for execution
some of the deobfuscated strings from the installer\nare used for logging error messages and
a check against blacklisted processes.
This process is further camouflaged by changing its associated executable filename to one of svchost.exe or dllhost.exe in the same kernel structure.
Windows task XML file
named after legitimate utilities are written into the %ProgramFiles%\MSBuild\Microsoft\Expression\Blend\msole\ subdirectory.
determine if it is running as an account with administrator privileges or simply as a regular user
Internet information,
screenshot capturing
GetRegistrySubKeyAndValueNames
S0410 Fysbis
S0668 TinyTurla
deobfuscates
S0379 Revenge RAT
Connects to a given host via a socket and waits for the server to send data.
C:\Windows\system32\cmd.exe /C
Analyzing Solorigate the compromised DLL file that started a sophisticated cyberattack and how Microsoft Defender helps protect customers
used for decryption:
added an exclusion rule to Windows Defender.
S1114 ZIPLINE
And malicious payloads are also sometimes encrypted/packed or obfuscated
handlers for keyboard and mouse events, the driver simply records IO events to lookaside lists before passing them to the legitimate handler.
S0436 TSCookie
to mirror all directories found in /Applications/Logic Pro X.app/Contents and /Applications/Logic Pro X.app/Contents/MacOS to their respective /tmp/ locations
S1059 metaMain
installing remote access software.
G0022 APT3
DLL sideloading scenario, the malicious loader (ffmpeg.dll) would replace the clean dependency;
has encrypted components.
runs a scheduled task
credentials are accessed and the target organization has not reset corresponding passwords, the actors can log in with stolen credentials and masquerade as legitimate users,
WMI was used to pivot to a domain controller on the network.
to steal the victim’s Facebook information and send it back to the C2.
Download and execute files
exploit vulnerabilities in Microsoft Word’s Equation Editor
OS version information
This version of CEIDPageLock has VMProtect, which makes analysis and unpacking difficult
then downloads its payload via software installed on the compromised device, such as ftpget, wget, curl, or tftp, before executing the payload.
can periodically take screenshots and store them with information about the foreground process and time since the last user input
The packet data was customized and sent through a POST request with several headers towards the C2.
Threat Actors Use MSBuild to Deliver RATs Filelessly
The threat actors then executed Mimikatz on VDI-KMS to harvest credentials
decrypt TLS traffic,
to load a binary into memory that injects
TA0003
scheduled tasks created for the updater,
“The Onion Router” (Tor) is often used by cyber threat actors for anonymity and C2.
used as a lure to entice the victim into opening the malicious file.
has the capability to exploit SMBv1 via the well known EternalBlue exploit.
Remote scheduled tasks to launch their customized PowerShell backdoor
malicious RAR archive
can also manage the system power policies registry keys to set the minimum and maximum sleep times and the lid open and close action policy.
When someone tries to double-click these decoy files, Windows (or the application mapped to the relevant filetype) throws an error because the file isn’t the type of file it appears to be
S0455 Metamorfo
McAfee Defenders Blog NetWalker
string encryption,
enumerating the child files in the check OneDrive subdirectory.
injects shellcode into the processes explorer.exe, winlogon.exe, wmplayer.exe, svchost.exe, and spoolsv.exe
pulls the XMRig payload
two base64 encoded data blobs and code instructions for its execution.
S0663 SysUpdate
Detect and identify source IP
the threat actor primarily focuses on four different known remote code execution (RCE) vulnerabilities during their operations:•    CVE-2023-21839      Oracle WebLogic Server RCE [13]•    CVE-2021-3129      Laravel debug mode RCE [14]•    CVE-2020-2551      Oracle WebLogic RCE [15]•    CVE-2021-44228     Apache Log4j [16]
acquires handles for all running processes on the system, which results in either winlogon.exe or explorer.exe obtaining numerous process handles.
using FindFirstFileW, FindNextFileW, and FindClose APIs
listing directory and file information in the format\n D|-|<Date created> |<Date modified> |<folder or file name>
The threat actors also expressed interest in other access methods such as RDP
The team used the organization’s MDM system to gain root access to machines across the organization’s network without being detected.
S0497 Dacls
a malicious template file is downloaded and executed
HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Monitoring\DisableBehaviorMonitoring \nDeleteValue 
The ISO files that X-Force observed contained a LNK file
Malicious OAuth applications used to compromise email servers and spread spam  Microsoft Security Blog
S0093 Backdoor.Oldrea
uploaded.
cmd /C
This module allows the injection of a PE file into a remote or local process’s memory without writing it to disk
XORed with the value
If the Process Hollowing method is used, a new svchost.exe process is created in a suspended state.
S0445 ShimRatReporter
RAT installer disguised as Google Chrome setup
After the strings are decrypted
leveraging Microsoft’s CryptoAPI
drops suspicious files on the attacked servers
FedEx Phishing Campaign Abusing TrustedForm and PAAY
injects the ProcessWorm into processes
Domain fronting is another method for concealing communication between the endpoint and the command and control servers.
the exfiltration of data on the system, such as OS, Processor (architecture),
can send information about the compromised host to a hardcoded C2 server.
It checks running processes for executables of several known cybersecurity vendors.
TLS encrypted data
MAC address
conceal its true code through either encryption or compression
a malicious actor was observed signing in to a Microsoft 365 account
use of utilities such as proxychains
cmd /C
download of a new payload from the attacker’s remote server
cmd /C
threat actor injected into a dllhost.exe process
CMD-based scripts
download further malware payloads
Self-delete after sending data
which downloaded obfuscated PowerShell and executed it in memory:
disabling security tools
downloads several additional files and saves them to the victim's machine.
Appending a file signature header to all encrypted data,
decrypt its configuration strings
DLL gets injected
The hashing function used for import resolving
several POST requests
the malware’s working directory
The team used domain fronting [T1090.004] to disguise outbound traffic in order to diversify the domains with which the persistent beacons were communicating
The payload, usually shellcode, is injected into another process.
a JPEG decoy file are dropped
Process Hollowing
the newly injected PE
the decryption process starts
sends data to the C2 server
S1026 Mongall
S0337 BadPatch
The Base-64 encoded segment
uses various WinAPI functions to run malicious shellcode in the current process or to inject it into another process
Current processes are checked
they are written to the registry,
send a list of process names and IDs back to the C2
S0576 MegaCortex
sets a hardcoded list of system directories
S0060 Sys10
used Remcos RAT, which uses RC4 for encrypting C&C communications
contains the “whoami” command
the Loader copies the new PE headers to the base address and each section to the relevant location according to the IMAGE_SECTION_HEADER
control flow obfuscation snippet
S0546 SharpStage
gains access to the targets through remote exploitation of an unpatched internet-facing device.
func_GetTotalRAM()
the threat actors dropped several batch scripts on the server:
These emails may contain a malicious link or file that provide the cyber actor access to the victim’s device
and then downloads a second-stage backdoor from the OpenDrive cloud service.
The initial attack phase involves infiltrating Internet-facing Microsoft Exchange servers
S0142 StreamEx
spear phishing attachments.
UAC bypass is executed via token manipulation.
Compressapi
S0669 KOCTOPUS
use this technique to retrieve export functions from loaded libraries
Threat actors used explorer.exe, where they were previously injected into, to initiate a proxied RDP connection to a server:
performs the following actions to alter Windows Defender settings
acquired through the use of Mimikatz, or creating LSASS dumps,
move through the victim environment via RDP
The actors used Ngrok to proxy RDP connections and to perform command and control.
using Command Prompt.
the first lateral movement from the beachhead to the server using RDP with an Administrator account:
it attempts to establish a connection with the remote server to retrieve the subsequent component of the attack
informationAddSecurityPackage64.dll injects pc.dll into LSASS by deploying pc.dll as a Security Package
Returns the user’s profile folder
relied on their victims to execute the malicious MSI installers
In its resources we can find another PE
first checks to see if the registry already contains previously generated values; if so, it will read those values into memory.
The final execution method Hancitor supports is Thread Execution Hijacking.
"cmd"  /c
a function is called that decrypts strings that
creates a batch script
obtain keystrokes, and status of keyboard buffer
The final payload returned is a lightweight PowerShell backdoor,
new encrypted shellcode
S0206 Wiarp
Vulnerability in Essential Addons for Elementor Leads to Mass Infection
makes extensive use of the Windows API to execute commands and launch processes.
G0053 FIN5
the code attempts to decrypt the contents
cmd /C
We observed the use of Mimikatz on this system and saw the hashes of the logged in domain admin account going
malware tries to login and get access to the victim server via brute force.
interacts with remote endpoints via WMI
campaigns typically begin with a phishing email with a ZIP file attachment, containing a LNK file disguised as a Word document
Exfiltration Over C2 Channel
the encrypted strings reside within the function
the threat actors made attempts to proxy RDP traffic
CreateThread
 Gets command from C2 and executes it 
Local and external IP address
used this\naccess to deploy and remotely execute FOCUSFJORD on their primary target.
DeleteRegistryValue
G1011 EXOTIC LILY
kernel32.LoadLibraryA, kernel32.GetProcAddress, kernel32.VirtualAlloc, kernel32.VirtualProtect and ntdll.ZwFlushInstructionCache
Checks for the existence of the anti-virus products such as AVG and Avast by checking for the DLLs avghookx.dll, avghooka.dll and snxhk.dll
memory structure contains executable code.
combination of Base64 and XOR functions.
requests a data stream from the C2 server through the URL
G1005 POLONIUM
Local IP address and port used to send the network packet
This task will run the DLL hijacking target as SYSTEM at each boot.
written to the registry, as a list of keys.
contents are unpacked
G1003 Ember Bear
AtomBombing Injection Technique
Remote Desktop Protocol
the injected code
proxying the traffic
G0139 TeamTNT
saved in the registry
(crawl whole tree), I:, H:, G:, F:, E:, and D:.
Set up proxies
The dropper is executed by the user.
dynamic API resolution
performing antivirus tampering
Cobalt Strike beacon acts as the intermediary to facilitate the Remote Desktop session
It starts with de-obfuscating the next stage (string replacements + base64 decoding)
downloads a malicious ZIP file
The malicious code is written into the newly created process and the suspended thread context instruction pointer is changed using NtGetContextThread/NtSetContextThread.
the ransomware to deploy additional tools
via the MoveFileExW or CopyFileW Windows API.
loading the final payload (PE file) from the third of the encrypted files.
Defense Evasion
also supports command-line arguments,
decryption
scanning selected IP addresses
cyber actors have been observed using multiple implants with file system enumeration and traversal capabilities.
Write a registry Run key
GetSubDirectoryFileListRecursive function
an extracted JS script
the win32 function CreateServiceA was used by the malware in order to create a remote service over RPC on the server.
an encrypted blob
The keylogging utility was configured\nto capture and record keystrokes to C:\ProgramData\psh\System32Log.txt.
DLL Side-Loading
Structure of the encrypted section.
host serial number
This shellcode is used for decrypting
func_GetLanguageTimeZoneOsVersion()
Enumerate files on desktop
the Tor communication capability
"w.bat" as viewed through the bash command "cat":
the threat actor was able to RDP unencumbered across the organization’s infrastructure.
create a scheduled task
It will read the next stage payloads, free.plg and main.plg, and inject them into dllhost.exe.
creates two Windows shortcut files in the Windows startup folder using the Internet Explorer application icon and the target paths pointing to the two dropped batch scripts.
Operates as a file grabber
invokes the following API’s:
to create a ImmediateTask
decoded with Base64
The use of RDP was extensively used throughout the intrusion, using a variety of processes
Attackers use domain fronting technique to target Myanmar with Cobalt Strike
This lures users to double-click the graphic to view the content,
the process into which the shellcode will be injected
do rundll32.exe C:\windows\System32\comsvcs.dll,
threat actors are able to masquerade the dropper or installer
to start the download process
The second stage payload, which was later determined to likely be the penetration testing framework "Brute Ratel," was then downloaded via a connection
leverages a specific set of vulnerabilities, including CVE-2018-0802, CVE-2018-0798, and CVE-2017-11882, within the Equation Editor of Microsoft Office
T1057
Credential extraction from the LSASS process
used redirectors to redirect C2 traffic between the target organization’s network and the team’s C2 servers.
uses the LookupPrivilegeValue and AdjustTokenPrivilege APIs
the service account logged into one of the Domain Controllers from the beachhead.
Decoder routine to decrypt the beacon DLL.
the team compromised a domain admin account and used it to laterally to multiple workstations and the DC.
unpacks and loads the next stage of the malware, namely the main module
S0515 WellMail
the Rijndael decryption key is passed.
Initial Access
data can be collected locally by the corresponding class before it is staged for exfiltration.
system information,
extract sensitive information,
via the API CreateFileTransactedA()
adopting publicly disclosed proof-of-concept (POC) code shortly after it is released to exploit vulnerabilities in internet-facing applications.
encrypted within the main module’s code.
The fronted\ndomain is configured by an earlier stage of execution and the actual\ndomain is hard-coded in the backdoor.
several Zip Archives files hosting multiple lure documents likely sent via phishing campaigns
script extracts two separate binaries from the base64 encoded text
leverages SOCKS5
direct Cobalt Strike processes and the injected processes
shellcode is located in a PE file overlay.
Files dropped in the victim’s environment by Vice Society may have been altered to appear legitimate.
spread the malware laterally across a network by abusing the Server Message Block (SMB) Protocol.
has been seen using the PowerShell module InvokeGPUpdate to update the group policy.
A new batch file, localdisk.bat, was also executed
to trigger the retrieval of the final stage payload
The PE file is downloaded on filesystem and than executed.
S0689 WhisperGate
Base64 encoded RAT execution command
used a compiled remote desktop malware,
replacing an early call instruction to their malicious code, or by overwriting the entry point in the PE header
Returns the list of object names in the \GLOBAL?? directory.
Collected machine information includes the following:\nRandomly generated GUID\nHostname
shows that their offsets within the encrypted region remain the same since they result in a similar shellcode even if they are composed of different bytes per binary.
creates another group policy
abused to side-load the malicious DLL.
gathers the OS version, machine name, CPU type, amount of RAM available from the victim’s machine
Shellcode version and whether it is 32-bit or 64-bit
They then used forged credentials to move to multiple hosts across different sites in the environment and eventually gained root access to all workstations connected to the organization’s mobile device management (MDM) server.
traces of RDP (Remote Desktop Protocol) connections were discovered on multiple compromised hosts utilized for lateral movement
T1113
Microsoft research uncovers new Zerobot capabilities  Microsoft Security Blog
target stored browser data
decryption routine is executed that decrypts the remaining malicious code in the .kxrt section and writes it to the virtual memory.
they accessed the server via Anydesk.
backdoor that is capable of executing commands
the malware uses the “del” command
uses legitimate utilities to load DLLs
Screenshots and keylogging are enabled by default,
to download another remote file
via the interactive shell
a method of lateral movement and a tool for downloading/executing files.
execute a payload via SMB and Windows Service Creation, respectively, on several target Workstations.
facilitates the functionality of WMI in Windows
The certutil.exe program downloads the WinRAR binary
Then it enters a for loop iterating over the drive list to build a recursive directory listing
accesses the memory of its host LSASS process and stores stolen credentials in a Mimikatz log file
sends it to the C2 server.
by side-loading dr.dll, used by a legitimate, signed binary
then uploads this information to an attacker-controlled machine via HTTP POST.
RDP into the target host using reverse proxy
registry run key persistence implementation
Higaisa or Winnti APT41 backdoors old and new
The decryption function
injected first,
S0518 PolyglotDuke
can use .NET framework APIs
the domain fronting functionality before launching the attack.
credentials being picked up and used to pivot to decoy systems in the network
downloader to the compromised device that executes and downloads the primary payload.
Gathering system information
StartSendScreen\nStart screen capture\nStopSendScreen\nStop screen capture
locate high value assets in order to exfiltrate data
Code responsible for downloading cron_script file
Retrieve process list and process information by running 'SELECT * FROM Win32_Process'
forcing its component SmadAVprotect32.exe to side-load their malicious DLL.
be injected with deceptive credentials at multiple places like LSASS process memory
S0208 Pasam
keystroke
SSH brute-forcing campaign,
Username
it searches the drives of compromised systems for interesting files and exfiltrates them to Google Drive.
decrypts another executable
Recording keystrokes in real time with offline logging available
encrypted with the algorithm
to obfuscate their tools
accessed C2 while visiting port 80
proxy server
In an attempt to remain undetected, AddSecurityPackage64.dll disables Windows event logging by killing threads of the Windows Event Log service without stopping the execution of the service itself
C:\Windows\System32\cmd.exe /c
entries point to buffers of randomly generated junk code
modifying the Local Security Authority (LSA)\nregistry key value
S0461 SDBbot
the API Web RESTful that provides access to Microsoft Cloud service resources.
LoadLibrary and GetProcAddress functions
with a button, which, when clicked, downloaded a “malicious” ISO file
for its execution technique of hiding malicious code inside log files.
encrypted with this same XOR-based algorithm
be injected into the winlogon.exe process
used various RATs that can perform remote desktop access.
a malicious batch file with a .cmd extension is downloaded to the user’s machine.
successfully got a valid domain admin account this way.
RDP into the target host
Proxy
S0088 Kasidet
Scheduled task
being able to use the .NET framework APIs directly from Python.
Writing executables to a randomly-selected directory under Program Files, and naming the EXE to match the\nchosen directory name
suspicious section .kxrt with the packed and encoded malicious code.
func_GetHostSerialNumber()
contain an encoded PowerShell,
Threat actors also dropped procdump.exe and procdump64.exe on multiple workstations remotely, dumped LSASS, and deleted them from the ProgramData folder:
It uses the esxcli command to list all VM processes
base64-encoded PowerShell command.
the given task the downloaded file
will check if the process avp.exe exists.
to search for sensitive information for exfiltration purposes.
S0456 Aria-body
taskrun. Path and filename of the task to be run
Returns the list of network adapter types, IP and MAC addresses assigned to them.
WTB Adwind Trojan Circumvents Antivirus Software To Infect Your PC
used HTTPS reverse proxies to redirect C2 traffic between target network and the team’s Cobalt Strike servers.
S0269 QUADAGENT
The configuration is encrypted with a hardcoded DES key and is a few bytes long
WMI Consumers specify an\naction to be performed, including executing a command, running a\nscript, adding an entry to a log, or sending an email
after receiving phishing emails containing malicious PDF documents [T
Subscriptions consist of three core WMI classes: a Filter, a\nConsumer, and a FilterToConsumerBinding.
Base64 encoded string with several string replacements.
S0280 MirageFox
the HTTP C2 Communication section.
Threat actors can use windows binaries and commands
delivered a hidden directory
S0143 Flame
which is unpacked only when run with a unique password, allow evading traditional signature-based detection.
starts with an income tax-themed phishing email written in Spanish, disguising itself as a tax receipt notification
we identified numerous legitimate applications backdoored
the\ncontrol flow obfuscation.
the key that will be used for the decryption is prepared.
T1204.002
Command and Control
A block of base64-encoded, encrypted data comprises almost 150KB of that script,
S0126 ComRAT
After decoding,
KCP protocol
S0284 More_eggs
Manipulates registry
some data exfiltration or interaction with the downloaded second stage from the C2.
Establish a session that originates from a target Workstation system directly to an external host over a clear text protocol, such as HTTP.
decrypts it
WMI\ncan be accessed using a variety of tools, including the Windows WMI\nCommand-line (wmic.exe), or through APIs accessible to programming and\nscripting languages such as PowerShell.
S0050 CosmicDuke
The execution triggers the setting of the following registry key
C :\Windows\system32\cmd.exe /C shell whoami /all
sends a request to the attacker-controlled Telegram channel
domains give attackers the ability to mask malicious traffic as legitimate activity within the company
S0138 OLDBAIT
attacker began adding the lwp-download command as a failover for wget and curl to enable downloading commands
proxy
side-loading a malicious DLL, libpng13.dll
Attempting to use sc stop and taskkill to stop over 100 services related to various areas ranging from remote desktop tools to Windows Defender
the threat actor started their first lateral movement using RDP to pivot to a server using the local Administrator account.
G0120 Evilnum
The threat actors continued by moving laterally to the domain controllers on the network using SMB to transfer and execute a Cobalt Strike Beacon
with username set to the built-in dba and a hardcoded password, which is potentially the default password in some RES 3700 POS versions.
one to get information about the machine, such as the operating system version,
routed through European TOR VPN exit nodes.
HTTP and HTTPS are supported
Then the functions are used to load and decrypt the payload.
injected themselves into Windows Media Player
The threat actor then deployed Anydesk, which was the only observed persistence mechanism used during the intrusion.
The threat actor also used a batch script to collect a list of all computer objects on the domain using C:\Windows\system32\cmd.exe /C adcomp.bat which contained the PowerShell command:
the threat actors executed multiple actions in the cloud using two privileged accounts.
operators use Mimikatz to dump passwords from LSASS.
S1084 QUIETEXIT
gathers basic system information, which it then sends to the C2,
All communications between the server are encrypted with RC4
S0378 PoshC2
detect and remove Alibaba Cloud Security from compromised instances
List of recently opened files and folders on the computer.
deobfuscation, and decompression
 The local module utilizes the LookupPrivilegeValueW and AdjustTokenPrivileges that Windows API calls on its own process via GetCurrentProcess and OpenProcessToken to obtain SeDebugPrivilege privileges.
make use of  the curl utility to download Qakbot and then execute it.
the dropper then downloads a custom XMRig miner
executables attached to its phishing e-mails have an extension hidden by default by most Windows deployments (.cmd, .scr, .com, etc.).
enticing users to open the attached malicious HTML file
copies itself to the Startup folder
func_GetUserName()
successfully obtain the database passwords
Pack it Secretly Earth Pretas Updated Stealthy Strategies
S0062 DustySky
file is a Python program packaged by PyInstaller.
tasklist
encrypted PowerShell.
Threat actors will look for networks that have internet-facing servers running RDP and then exploit vulnerabilities in those servers
Obtain information about processes and services running on the machine
Nationstate threat actor Mint Sandstorm refines tradecraft to attack highvalue targets
Valid Accounts: Domain Accounts
establish another RDP session to a different internal server
Opening the attached “multa_de_transito_502323.html” file triggers the embedded JavaScript
G0119 Indrik Spider
Mimikatz
S1101 LoFiSe
G0138 Andariel
The threat actor renamed their utilities to masquerade as legitimate system binaries (AdFind as svchost.exe), match the system’s role (GoldMax), or appear legitimate (TrailBlazer as an apparent Adobe utility).
the following URLs are hard coded, and obfuscated
Bypass User Account Control
Computer name\nName of running module\nPID
searches for and exfiltrates the following information:\nOS architecture\nBuilt-in admin\nDomain host name\nHostname\nLocal admin\nOperating system\nScreen resolution
malware first generates a key blob randomly, with the key being encrypted in a custom algorithm.
These work in tandem to insert data into the Windows Registry
These files were transferred to the domain controller over SMB.
malware creates the persistence via Registry Run Keys.
obfuscated with VMProtect
obtained credentials for pivoting with Mimikatz
screen capture
will check if the running processes
Keylogger Deployment
Contain an encrypted .NET injector and one or more encrypted PE payloads.
stored in DataS5 (for dba) and DataS6 (for micros) registry values within one of the following registry keys
obfuscated DLL
Malware Disguised as Document from Ukraines Energoatom Delivers Havoc Demon Backdoor
the threat actor was seen establishing RDP connections
calls the NtProtectVirtualMemory function where the NewAccessProtection argument is PAGE_EXECUTE_READWRITE and the BaseAddress argument is an address to a library function
The actor may then perform actions as the logged-on user.
by calling the GetNetworkParams API function
cmd /C
malicious actors spread primarily by spearphishing campaigns using tailored emails that contain malicious attachments
S0034 NETEAGLE
Group Policy Modification
A flight of netlogon authentications were observed from the beachhead host to the domain controller as a possible attempt at exploiting the domain controller.
passes two arguments to the "mw_resolveAPI" function.
checks for the names of the following antivirus vendors: Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender
executes a CMD file
Upon execution of the batch file
cleanup script
calls Stage 1 again via process hollowing with four parameters
Next, they proceeded to transfer a beacon executable over SMB to the remote host’s ProgramData directory.
C0014 Operation Wocao
and obfuscation mechanisms.
Upon clicking the Open button, it drops the HTA file
redirecting to another malicious HTML file from an attacker-controlled AWS EC2 instance.
S1109 PACEMAKER
logs keystrokes
the legitimate website will forward the traffic through the CDN to the original destination according to the host header.
The malware then allocates new memory in the newly-created process, writes the executable to it and executes it in a new thread.
S0171 Felismus
Payload\nObfuscation
stored between data xml tags (<data>%version%</data>) of the response from the service
exe└──cmd.exe: C:\Windows\system32\cmd.exe /c ""rdp.bat"
obtains the list of processes
all running processes are enumerated and logged via EnumProcesses (32-bit processes).
open-source remote administration tool (RAT) with various features such as managing processes, file operations, screenshotting, and running commands.
G0084 Gallmaker
S0028 SHIPSHAPE
encrypted data is then exfiltrated using the below C&C URL
These words are used to build the registry value names.
S1014 DanBot
S0630 Nebulae
attackers also exploited vulnerabilities such as PrintNightmare to escalate privileges
. The name of the created service, “SysmainUpdate”, is usurping the name of the legitimate service “SysMain” which is related to the legitimate DLL sysmain.dll and also to the Superfetch service.
calls the VirtualProtect function
record keystrokes
S0598 P.A.S. Webshell
including adding of registry keys
Native API
decrypts the password for the dba username
S0639 Seth-Locker
proceeds to decrypt
conditional jumps that never run are included
The C2 is constructed with the victim's enumerated data
(encrypted) shellcode
S0631 Chaes
Inject malicious code into legitimate processes
from the decrypted configuration
to exfiltrate data to external C2 servers.
targets victim’s login credentials
The malware also spawns cmd.exe to execute the following command
encrypted resource and XORed with a hardcoded password
S0581 IronNetInjector
public facing systems is compromised
Adversary launched backdoor and some tools as a Windows Service
Returns information about the machine’s BIOS.
To obtain authentication data from the registry and files, the attackers may use NirSoft utilities.
injected thread
Comsvcs.dll is a well-known way to extract LSASS (Local Security Authority Subsystem Service) data
keyboard layout
Using shellcode that injects implants into newly created instances of the Service Host process (svchost)
S0377 Ebury
The sample is obfuscated via the Babadeda crypter.
ransomware attempts to decrypt
Threat actors dumped the LSASS process from the beachhead using the comsvcs.dll MiniDump technique
establishes persistence by creating an autostart service that allows it to run whenever the machine boots.
Decoded CommandLineTemplate PowerShell code
reg.exe ADD\n'HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server' /v\nfSingleSessionPerUser /t REG_DWORD /d 0 /f
the threat actor became active by initiating a proxied RDP connection via the Cobalt Strike beacon to the domain controller.
G0060 BRONZE BUTLER
Files are dropped/downloaded as Base64-encoded archives.
uses the win32api.GetDiskFreeSpaceEx() function to retrieve the disk size in bytes
It utilizes symmetric key cryptography, where the same secret key is used for both encryption and decryption
G0024 Putter Panda
run the payloads by sideloading them to the legitimate executables
Manipulate files and directories (list
S0586 TAINTEDSCRIBE
launches a slightly modified Metasploit Reverse HTTPS stager
deleted the specific history items related to threat actor activity
Masquerades its command-and-control (C2) traffic as legitimate Google Notifications HTTP requests
The actor leveraged Impacket’s wmiexec.py to execute commands with a semi-interactive shell
The malicious document is delivered in either zip files or ISO images to the target through phishing emails.
it use the harcoded password for decryption using the fernet_decrypt function, and returns the decrypted AUTH Token.
disable system defenses
S1115 WIREFIRE
After unpacking, the sample loads
The threat actor was able to RDP to a backup server using the admin credentials they acquired.
due to DLL side-loading, the loader/injector winutils.dll is loaded into memory and runs in the context
the data was stored in a location in the Internet Information Services (IIS) web server and exfiltrated over HTTP using GET requests towards the exact file paths
drop the defenses of the victim, inhibit monitoring, disable networking
the JPEG decoy file
S0090 Rover
S1076 QUIETCANARY
Monitoring file system events to collect new and modified files.
and only decrypted in memory when needed.
the AES 256 decryption key of the payload
decrypted before being written
TA0011
Transparent Tribe APT36  PakistanAligned Threat Actor Expands Interest in Indian Education Sector
decryption function.
strategy to persuade the victim to execute the malicious shortcut file
Decryption is the same across both
gets executed via the “SHELLEXECUTE”.
G0065 Leviathan
SMB exploitation via EternalBlue
S0330 Zeus Panda
downloads and executes
If the data is small enough, it is exfiltrated through the command and control channel of the Cobalt Strike beacons.
S0470 BBK
the batch file
low-level API functions (such as NtEnumerateValueKey or NtQuerySystemInformation)
creates a batch script that,
Duplication of socket with TLS connection
There are two approaches to using valid credentials to copy and execute the malware to a remote host:
the group crafts bespoke phishing emails, often purporting to contain information on security policies that affect countries in the Middle East, to deliver weaponized documents to individuals of interest.
S0574 BendyBear
operating system information
decrypted using the RSA
then the full set of malware is retrieved from C2
obtains the device’s local and external IP address.
Command codes in the PUBLOAD HTTP variant
S0616 DEATHRANSOM
cmd.exe /C hostname
S1102 Pcexter
packing being used to obfuscate the malware.
a check using pgrep for Activity Monitor processes
G0132 CostaRicto
was executed via rundll32.exe
This technique, which also leverages CDNs, allows the beacon to appear to connect to third-party domains, such as nytimes.com, when it is actually connecting to the team’s redirect server
In the footsteps of the Fancy Bear PowerPoint mouseover event abused to deliver Graphite implants
reg.exe ADD\nHKLM\SYSTEM\CurrentControlSet\Control\Lsa /v\nLimitBlankPasswordUse /t REG_DWORD /d 1 /f
cyber actors have also been observed modifying group policies for password exploitation.
then decrypts and communicates to
they connected to a domain controller and dropped three scripts; one to copy the ransomware executable to all hosts, one to reset every users password in the organization, and a final one to execute the staged ransomware payload using PsExec
Command and Scripting Interpreter: Windows Command Shell
malware running via Rundll32
“RClone” was downloaded on the file servers
sends GET requests with pull operations.
malicious actor signing in to a Microsoft 365 account
This vulnerability, registered as “CVE-2018-14327,” allows a low-privileged user account to escalate privileges on any Windows machine that had connected to the EE Mini modem via USB.
Usage of WMI for remote command execution
The batch-files appear to be used to load the Cobalt Strike beacon, but also to perform discovery commands on the compromised system.
use powershell to download the payload
the actor executes Cobalt Strike’s built-in Mimikatz to dump its credentials or password hash
injected into a different process,
using the username
threat actors proceeded to run the net commands
S1052 DEADEYE
call other vfgadgets that are responsible for executing specific operations, like Argument LoadersInvokers and Collectors.
the attacker was observed moving laterally to\ndifferent systems in the environment using Remote Desktop Protocol\n(RDP) connections.
cmd /c
uses local caches to stage data
write in the registry information
be embedded in the loader itself.
performs the functions of LoadLibrary and calls the loaded module’s startModule export.
segments of base64 data
its C2 server consists of\nJSON data exchanged via HTTP POST requests.
It checks that there are no running processes related to security-related software (e.g., Windbg, Autoruns, Wireshark)
S0416 RDFSNIFFER
G1022 ToddyCat
Necessary APIs will be dynamically resolved during execution.
Warning New attack campaign utilized a new 0day RCE vulnerability on Microsoft Exchange Server
downloads and executes
modified the WDigest registry key value\nHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest\UseLogonCredential\nto enable credential caching.
C:\Windows\system32\cmd.exe /C
backdoor with the ability to download and run additional tools
stage collected data  locally
indicating that the user deleted the collected data.
decrypting the rest of the blob once it has been decoded.
enumerating the Process Environment Block (PEB)
to establish new services to enable persistence.
gathers basic system information,
S0274 Calisto
The executable is prepended with 0x4000 random bytes and encrypted with RC4
encrypted portion of the data is decrypted
a call to the CreateWindowExW
performs surveillance on the victim’s machine by collecting system information such as hostnames, IPv4 address, operating system version, disk volume information, disk size and anti-virus software information, and gets the system’s default language.
seeks out files with the following file extensions: .log, .vmdk, .vmem, .vswp and .vmsn.
Task manager was then use to reveal the service running on PID 3488,
The first account was the compromised Azure AD Connector account,
proceeded to dump LSASS memory
hostnames
The decryption function
a GET request is sent to the C2 server.
creates a batch file in %WINDOWS%\Temp called registry.bat.
application-level messages from the server to the client is sent as the body of an HTTP response
disable Microsoft Defender
manually extract the file and execute it
Downloads the miner and watcher.
decoding
Even though the scripts produce many on-disk artifacts, the dropper and scripts are quick to remove them
keylogging functionality.
via the API\nNtCreateSection()
 A heavily obfuscated VBS
AnyDesk logs, %ProgramData%\AnyDesk\ad_svc.trace and %AppData%\AnyDesk\ad.trace, show that it was used during Day 1 and Day 7 of this intrusion
is an obfuscating tool for Python script that makes the malware harder to be analyzed and detected.
--remove       self remove this file after work
Identify processes related to backups, antivirus/anti-spyware,
the DLL will find the address of an export function called SVP7, which contains the entry point of the malware,
S0495 RDAT
S0371 POWERTON
Persistence via Scheduled Task
Side loaded malicious DLL 
usually the encrypted payload
The actors manually disabled Windows Defender via the GUI.
The bytes of the encrypted section is a specific index on the byte map
the different processes they injected into
actors used a legitimate admin account to remotely log on to the domain controller
Cleans  API functions potentially hooked by security solutions
S0672 Zox
fetching the next stage payload
attempt to compromise the victim’s login credentials for webmail services
which enables an HTTPS connection.
API functions.
S0261 Catchamas
With the domain names decrypted, the DLL Loader decrypts 10 strings that should be URIs to be appended to the domains.
The decryptor program appears unique and is linked to one victim specifically. In our example, it only decrypts the files
the encrypted payload
S0263 TYPEFRAME
injected into notepad.exe, where the ransomware logic begins.
Can You See It Now An Emerging LockBit Campaign
For instance, immediately after execution, it loads itself in memory, and deletes itself from the disk.
Once decrypted,
loader with rundll32
S0275 UPPERCUT
C0034 2022 Ukraine Electric Power Attack
downloads a payload
keylogging
malware aims to deactivate User Account Control (UAC) on the target system
the threat actor deployed several Atera/Splashtop remote access tools across the environment as an alternative means of access to the environment
Exfiltration over C2 channel
launched on every startup by rundll32.exe
normal protocol uses raw TCP sockets and a custom message format
DLL is run with rundll32
S0234 Bandook
Potential hidden files
conceal the utilization of potentially suspicious APIs (functions) from static detection
dynamically loads the library
DLL Side-Loading
They utilized RDP,
The decoded PowerShell function
Function and variable names are obfuscated
the malware then proceeds to gather basic system information, including username, computer name, and OS version,
compromised administrative [T1078.001] accounts
cmd /C "C: & cd \ & arp -a"
purpose of domain fronting is to connect to a restricted host while pretending to communicate with an allowed host
decode
hiding the rest of its files from the user.
retrieving malware from C2
use system calls
S0534 Bazar
The payload contains two additional base64 encoded scripts
Username
the scheduled task will trigger 30 minutes after the malware execution.
can use additional payload types
Remote Command Line
S0661 FoggyWeb
is injected into notepad.exe
NotPetya Technical Analysis  A Triple Threat File Encryption MFT Encryption Credential Theft
schtasks /run
logicaldisk get caption,description,drivetype,providername,volumename
to run the subsequent BAT scripts
actors used tools such as PCHunter, PowerTool, GMER, and Process Hacker to disable any security-related services running in the system.
HttpWebRequest and HttpListener from .NET Framework are used for client and server implementations
String decryption of the DLL names
sends emails pretending to be related to a shipment notice for the target which contain a malicious attachment.
that stages execution of further payloads downloaded from the internet
conducted credential harvesting\nvia dumping LSASS memory.
G0062 TA459
Capture the screen area around mouse click locations
Activity from a password-spray associated IP address.
that embeds the Crypter with the payload.
C:\Windows\system32\cmd.exe /C
run from their interactive RDP session
have used malware that deletes itself from the system
the obfuscation techniques used
The decryption function
the lsass.exe beacon
S0433 Rifdoor
systeminfo
G0034 Sandworm Team
keystrokes
ipconfig /all
S0235 CrossRAT
designed to lure unsuspecting victims into executing the loader.
using the callback function pointer in CallWindowProc
C:\Windows\system32\cmd.exe /C dir /s *file/
obfuscated the loader with many calls to a function that just prints some hardcoded values
Decryption function
file downloads relating to tooling/scripts.
The encryption algorithm\nis HC-128,
attached to spearphishing emails
cyber actors used the Server Message Block (SMB) protocol to import tools into victim networks.
the malware retrieves information on the infected machine and sends it to the C&C
using rundll32.exe
the corresponding APIs in the appropriate library.
to register a scheduled task used to launch the ransomware payload.
dispatch an asynchronous procedure call (APC) to the APC queue of a target process thread using NtQueueApcThread
create a reverse shell.
can modify registry entries
Creates registry key for persistence only
creates a task with schtasks for persistence
pc.exe decrypts AddSecurityPackage64.dll and pc.dll using the AES encryption algorithm
After decrypting the pyc file,
The actors were able to proxy [T1090] RDP sessions,
recently opened documents
then iterates over each volume to find files
the documents were exfiltrated over one of the encrypted C2 channels.
then the payload is executed using Windows API functions (VirtualProtect).
UPX is an open-source packing algorithm
S0343 Exaramel
createTS—creates scheduled task. createLG—creates scheduled task at logon 
PDF file attached
The original libpng13.dll is also included in the installer package (renamed to what appears to be a random name) because the malicious DLL forwards its exported functions to the original DLL.
The padded i2pd Mach-O file
recon for interesting hostnames
0x0AInject and execute received module in specified process
dropping and the execution of several payloads using multiple techniques
C0002 Night Dragon
Configured for WMI persistence
In some instances, they used Windows Management Instrumentation (WMI) Event Subscriptions
decrypting database passwords from Windows registry values
G0131 Tonto Team
more sophisticated encryption
chaining together a series of scripts to decode
payload and intermediate library are deleted before completion
Using the Cobalt Strike beacon, the threat actors transferred AnyDesk (1).exe file from the beachhead to a server:
operators used Splashtop – a remote access and management (RMM) tool – to transfer the following malware into the target’s environment.
download of a batch (.bat) file.
These batch scripts’ purposes
It checks running processes
SSL encrypted traffic
The intrusion began when a user double clicked a LNK file, which then executed encoded Powershell commands
The process list checked is as follows
S0532 Lucifer
Keys found in CurrentVersion\Run contain references to programs that will execute when a user logs in.
S0496 REvil
delete important files
;Moving across the victim’s network and deploying ransomware involves copying related tools to the host.
a batch file
CreateProcessInternalW creates a new process
and the use of valid accounts
malicious actors behaving in predictable ways once they gain access to customer Microsoft 365 environment.
The team used domain fronting to disguise outbound traffic in order to diversify the domains with which the persistent beacons were communicating.
This value is decoded
Threat actors executed this tool on patient 0 with low-level privileges multiple times
injected into
T1056.001
The HTA file uses curl utility to download
cmd /C
executes one of the dropped batch files
injecting itself into a running explorer.exe process
domains for domain fronting may indicate an interest in the geopolitics of this area of the world.
Decompiled decryption function
The red team used and identified several standard user accounts with administrative access from a Windows Server 2012 R2 SharePoint server.
Screen capture
malware\nalso checks that the operating system version
T1140
cmd.exe /C
The team used these platforms to create flexible and dynamic redirect servers to send traffic to the team’s Cobalt Strike servers
VirtualAlloc used for allocating memory in the current process
TA0001
G1006 Earth Lusca
It creates a new Shell in the registry.
and inject it into winver.exe for the next-stage payload
It usually pretends to be a legitimate file, such as an Adobe PDF or Dropbox file,
remotedesktop mode = enable cmd
install additional malware
Disabling this security control
Captured data stored in the uploader C2
has some simple but clever obfuscation in place.
decrypt the MFT,
found in the sideloaded DLL.
this encrypted file is
use of the same DeviceControl API methods
File deletion functions
keylogging every tap
may save recording files in the working directory
can be configured to create a service for persistence.
To obtain authentication data, the attackers may dump the LSASS process using legitimate tools (procdump, comsvcs.dll).
reads pixels from an image contained in the first binary
collect information about loaded modules for each of the running processes
T1005
the computer name is sent to the C2
This could cause the file to run when double-clicked instead of opening it with a PDF viewer.
Creates a memory section with the DES-encrypted malware configuration
being invoked by rundll32.exe.
S0397 LoJax
"cmd.exe
Threat actors used the lolbin wmic.exe in order to execute PowerShell Cobalt Strike beacons on multiple workstations and servers
and only decoded as needed.
Embedded data in Data object
used for HTTP client requests
downloads
Try to disable Windows Defender service “WinDefend”
Modify Registry
PE injection
the threat actors moved to install AnyDesk on several servers including a backup management host, likely as a further means of persistence or later command and control.
the hooked process creation function clears a possible hook of the  NtQueueAPCThread function and then uses it to create an APC procedure in the new process.
VirtualAlloc used for allocating memory in the current process
the batch file
The Granted Access level matches know indicators for Mimikatz
S1042 SUGARDUMP
the ransomware uses the FindFirstVolumeW() and FindNextVolumeW() API functions
S0691 Neoichor
Password spraying
Malicious documents that implement this technique require users to double-click a document element.
modifies registry keys to maintain persistence,
T1518.001
using the default factory credentials.
which are typically transferred as an encrypted 7zip file.
can obtain file and directory listings.
S0225 sqlmap
Potential Process Hollowing
G0077 Leafminer
injecting it into legitimate processes.
Uses encoded PowerShell commands.
the encrypted data
To optimize brute forcing efforts, the malware compares the server prompt upon connection to a hardcoded list of strings
configured to proxy C2 traffic
Each email has an HTML attachment.
executed using remote WMI commands
is executed as a command line argument
delivered to the victim, commonly through a phishing mail
Reflective PE injection
The unpacked sample is approximately 540 KB
stealing sensitive data from the victim’s networks.
exploited the Microsoft SharePoint vulnerability\nCVE-2019-0604 to install web shells
The first four bytes of the decrypted buffer will contain the project identifier
Adversary browsed several locations to search for the data they were after.
CreateProcessInternalW API function
Logfiles on the Linux-system show traces which can be attributed to a credential stuffing or password spraying attack.
This payload is decrypted, decompressed, and then copied into memory
using low level APIs: NtCreateSection, NtMapViewOfSection
calling the RegisterClass function prior to calling CreateWindow.
Once decoded, the loader's execution jumps to the beginning of the DLL
Drop and execute the legitimate installer in C:\Program Files\Common Files (see CommonFiles64Folder).
decrypts a third component
the malware creates 2 scheduled tasks
configured to run the payloads in the startup folder of the victim’s machine
They then opened an RDP connection back to the primary domain controller
Calls CryptEncrypt
opened it would initiate the download of a batch (.bat) file.
S0361 Expand
S0252 Brave Prince
by modifying the Registry.
Download and run
Crosswalk and Metasploit injectors
legitimate WMI persistence
service was installed in the system
S0622 AppleSeed
used various RATs that can collect the IP address of the victim machine
Other commands can be used to retrieve a detailed list of available services and currently running processes.
GetComputerName API
Batch files are used
slightly obfuscated URL address
It makes direct system calls using the “syscall” instruction.
The second scheduled task created attempts to execute the payload downloaded by the other task: \n"C:\Windows\System32\schtasks.exe" /create /sc MINUTE /mo 20 /TN
It downloads and runs an executable payload
data to be exfiltrated to the C2 server
Stops the WinDefend service (Windows Defender)
ipconfig /all
usernames/passwords,
Recent TZW Campaigns Revealed As Part of GlobeImposter Malware Family
API call attempts to processes:
TA0007
three layers where one decodes content for the next
Mimikatz – a credential theft tool.
The scripts are encoded using different techniques,
shared with the C2 server on the initial check-in request (Figure 11) for encrypting subsequent data communicated between the agent and C2 server with AES-256-CTR.
executes the compiled AutoIt script
use AES-128 in CFB mode as the encryption algorithm
Dead or Alive An Emotet Story
AA20258A Chinese Ministry of State SecurityAffiliated Cyber Threat Actor Activity
attackers was to establish a Remote Desktop session
three sections are extracted
With the config decrypted
undocumented Windows API that causes
was to start a program as a service
AES-128-CBC for encryption.
makes use of API GetTickCount / QueryPerformanceCounter
after a user opened an Excel document and enabled macros.
This file is an obfuscated .NET file
Windows discovery commands
the Windows task XML
Uses NtSetInformationThread API
Affiliates have been seen brute forcing exposed RDP services and compromising accounts with weak passwords.
sends it to the C2 server.
used various RATs that exfiltrate data over the same channel used for C&C
on the API calls QueryPerformanceFrequency and QueryPerformanceCounter
Disables Windows Defender Attack Surface Reduction (ASR) rules
writes it as encrypted data.
the execution of the batch file
New Horabot campaign targets the Americas
this key is typically obfuscated with AES 256 encryption.
The injected code loads the same backdoor (rescure.dat) into the process’s memory and calls its startModule export to finish the installation.
with batch scripts
use HTTP/HTTPS for C2 connections
it queues an APC into the patched GlobalGetAtomA to get the payload running.
download and run the Horabot “au” using the URL
S0370 SamSam
Adversary exploited a web-facing server with application
trying to open either of the shortcuts
VirtualProtect changes the permissions of the given virtual address
uses a temporary scheduled task to start after installation.
downloads the payload from the Internet and executes on the target system.
When decoded
obfuscated
PsExec for lateral movement
the malware can disable the functionalities of EDR/AV products.
the payload downloaded by the PowerShell script was a .NET downloader, which would subsequently retrieve an encrypted payload from the command-and-control (C&C) server
remote process the payload gets injected to.
Powershell will be invoked and it fetch the Qakbot payload from Internet
designed to hamper Windows Defender
It copies the headers, maps the individual PE sections,  processes any relocations,  loads the PE’s imports, and then executes the PE from its internally specified entry point.
an injected Cobalt Strike beacon
has an embedded malicious URL
On one machine, we found that the malware injected itself, using process hollowing, into ielowutil.exe
they decrypted the cookies file using the user’s DPAPI key.
for process hollowing from a WoW64 process into a 64-bit svchost.exe
the threat actors leveraged RDP for access into the account.
threat actors using reverse proxy
use this technique to inject themselves into other processes
Upload, download
removing their entries from the ActiveProcessLinks list of the undocumented KPROCESS kernel structure.
a base64 encoded string is used to specify various parameters
Inside the Mind of a Cyber Attacker from Malware creation to Data Exfiltration Part 1
Lateral tool transfers have been used to move tools and files from one compromised system to another, including SMB and RDP.
elevate its privileges by executing the mw_UAC_bypass function
base64 encoded with some string modifications
The batch file
irrelevant code
S0352 OSX_OCEANLOTUS.D
obfuscated code
G0124 Windigo
Uninstall the backdoor.
S0657 BLUELIGHT
Capture screenshots of victims’ system
can execute shell commands
obfuscated with FinSpy VM.
DLLs with the names ualapi.dll and ncobjapi.dll being sideloaded
The threat actors used C:\MS_DATA as their main working directory for storing malware and staging data for exfiltration
Heavy obfuscation in a simple but useful anti-analysis approach makes it difficult for security products to detect their scripts.
download multiple tools 
the threat actor moved on to downloading a variety of beacon executables
the encrypted with AES-128 beacon
drops the DLL
S0500 MCMD
The attachment, if opened,
malware dynamically calls the API NtAllocateVirtualMemory
then executed via WMI.
S0012 PoisonIvy
the embedded Windows executable
ipconfig
makes a copy of itself, places it in the “Temp” folder (C:\Users\<user>\AppData\Local\Temp), and changes the name to a known Windows application/process.
S0103 route
Reflective PE injection is a technique used by malware or advanced attackers to inject a Portable Executable (PE) file directly into the memory of a running process without the need for writing the file to disk
S0181 FALLCHILL
shows that this connection was likely HTTPS
C:\Windows\system32\cmd.exe /C
The current system username
suspicious email attachments or other phishing techniques.
The module creates a new process using the same executable and performs process injection on it, redirecting the existing thread to the written code region.
exploit targeting a public-facing appliance vulnerability.
0x10000012inject and execute received module in specified process
Both the IP and the server directory path are encrypted with AES-128 using a base64 encoded key stored in the backdoor’s image.
Credentials In Files
Prilex Brazilian PoS malware evolution
T1071\nApplication Layer Protocol: Web Protocols
an obfuscator resembling OLLVM or both these protectors
loader is executed through rundll32.exe
using the API RegisterServiceHandlerA then SetServiceStatus, and finally CreateEventA.
S0604 Industroyer
The content is encrypted using AES CBC with random 16-byte keys and IVs,
Get configuration file and decrypt it
decrypt the payload
Creating a scheduled task to execute the malware using PowerShell.
Create file listing recordings
It removes log files and temporary files from the root directory.
It spreads to Microsoft Windows machines using several propagation methods, including the EternalBlue exploit for the CVE-2017-0144 vulnerability in the SMB service.
Steal files which are printed by the victim
downloader contains an encrypted configuration at the end of the file.
sends an HTTP POST request with the name of the victim's computer to a server
The decryption key and IV are\ngenerated using the same unique host properties
used various RATs that can browse file systems
Returns the path to the ‘Program Files’ folder.
features multiple flags that could be set as command line arguments
They then returned 18 hours later to install further malware
a decompression utility to extract the ransomware
S0236 Kwampirs
S0259 InnaputRAT
Decodes sensitive memory regions in the current process with the same XOR key
It uses the cpuinfo Python module to retrieve information about the CPU.
the script retrieves the Cobalt Strike payload
S0442 VBShower
Windows Service Creation
removed mde.ps1 from the disk
push Polar ransomware to computers and run it,
protected with an obfuscator
persistence was achieved by creating a ‘Run’ key
S1104 SLOWPULSE
decrypted and decoded version
Adversary installed custom backdoor as a service
tries to enumerate the current directory
passes the PE payload to it, which the shellcode then loads and executes.
File Deletion
one to get processes
resolves hashed Windows APIs
write the batch file on the remote system.
The PDF and executable files have numerous spaces before the file extension to hide it and allay suspicions.
To avoid detection, attackers renamed Windows administrative tools like adfind.exe which were then used for domain enumeration
obfuscation of the GuLoader shellcode and payloads
cmd /C
decrypted Ransom Cartel configuration
the adversary identifies data of interest from the network of the victim
the Windows Command Processor was used
the SMB Beacon is communicating over the network with a parent Beacon using named pipes.
Recursive directory listing functions
downloads and executes
The metadata included TA machine’s hostname,
S0068 httpclient
Both of them are encrypted,
S0338 Cobian RAT
S0196 PUNCHBUGGY
S0696 Flagpro
packed using NSIS installer.
S0608 Conficker
have used various layers of packers for obfuscating their droppers.
To deobfuscate the document the tool xlmdeobfuscator was used with the following output.
Chinese Threat Actor Used Modified Cobalt Strike Variant to Attack Taiwanese Critical Infrastructure
collects browser history and passwords from the following browsers
the sideloaded DLL),
".bat" files designed to disable Cisco AMP / Microsoft Defender
operators use Splashtop to transfer malicious tools from computer to computer in the victim’s environment.
the adversary copying results of the discovery phase, like file- and directory lists from local systems,
S0139 PowerDuke
uses HTTPS to communicate with its C2 servers
creating an APC (Asynchronous Procedure Call) with the procedure address pointing to the start of the shellcode.
C:\Windows\system32\cmd.exe /C
Log keystrokes
creating the registry key
Full path to file and hidden files
The decrypted data
to run this executable as a Windows Service.
were observed using the 7-Zip utility to unzip imported tools and malware files onto the victim device.
the actor introduced a downloader to fetch and spawn the next stage payload
spear phishing emails pretending to be from financial vendors or partners to trick users into opening the malicious attachments in the emails.
Windows APIs are obfuscated via a hashing function and dynamically resolved in the run-time.
connect to a certain URL every 60 minutes using the normal Windows file mshta.exe.
execution using scheduled tasks
G0005 APT12
S0368 NotPetya
S0098 T9000
"cmd"  /c
used process hollowing to launch under the context of the Dllhost.exe process
brute-force passwords.
“Who and What Threatens the World (Column).exe” and is designed to deceive users by using an icon that is similar to that of Hancom Office.
3CXDesktopApp Backdoored in a Suspected Lazarus Campaign  
then iterates over each volume to search for specific files related to virtual machines.
The Task Scheduler launches it at system startup
Brute Force
via a Windows batch script file
it will parse the AES IV (Initialization vector) and the encrypted password
If the API fails to execute, the malware calls InitiateSystemShutdownExW
Common injection methods used by banking Trojans involve writing a mapped PE into a remote process using WriteProcessMemory
relies on XOR’ing each byte with a hard-coded
use system calls
C:\Windows\system32\cmd.exe /C
malicious encoded .ico payload
  Upload file function 
yielding a PE file that is loaded and run in memory with .NET.
This packer has been around for many years
S0654 ProLock
encrypted header
an embedded executable
from an injected process
G0059 Magic Hound
LSASS Dump
The decoded PowerShell instructions
C:\Windows\System32\cmd.exe /c start rundll32 namr.dll,IternalJob
NetSupport Manager, used maliciously or otherwise, provides full and complete control over the target device.
Phishing Campaign Targets Chinese Nuclear Energy Industry
domain and local accounts
A second config block, which is decrypted separately
decoded command
S0553 MoleNet
stub is a small part of code that implements the decompression (and decryption) of the originally packed file
Malicious OneNote attachment
Keystrokes and windows monitoring
After gaining initial access to an organization by exploiting a vulnerability with a public POC,
the threat actor connected via RDP to a user’s workstation
Keylogging
have used scheduled tasks in their droppers and payloads to achieve persistence
brute forcing
waits for data collection tasks to complete,
then proceeds to gather basic system information, including username, computer name, and OS version, which it then encrypts using AES-256-CBC and the generated,
creates a persistence via Registry Run Keys under HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
Threat actors strive to cause Tax Day headaches
String decryption for the DLL names needed for execution.
executes another BAT script
S0118 Nidiran
S0117 XTunnel
Decryptor download
sending basic host info to the C2
into the shellcode that will decompress and load the Korplug payload.
the threat actor accessing the wiki as users who would be considered “non-privileged”
Evasive Process Hollowing by Entrypoint Patching
Lists internal IP addresses
PE reflective injection.
collect and upload information about the device
using a combination of eight common usernames and 130 passwords
a tool called “anti.exe”\nto stop Windows Update service and terminate EDR and Antivirus\nrelated services.
using the Microsoft Graph API
the threat actors checked running processes on the accessed hosts via taskmanager
heavily obfuscated batch file is hidden and automatically executed when launched.
G0089 The White Company
multi-hop proxies
executes a PowerShell command
To determine the command and control (C2) servers waiting for the data to be sent to, the malware calls a decryption function that uses the RC4 algorithm
transfers them to the C2 address
tool can be used as a persistence mechanism and remote accessing
The specific mechanism used to inject into a foreign process, was injecting arbitrary code into its memory space, and executing it as a remotely created thread
tries to make users run malicious .lnk, .chm, and .exe files
The system’s network interfaces (name, MacAddress, description)
Uses Mimikatz to harvest credentials.
The Scheduled Task was named RuntimeBrokerService.exe
S0245 BADCALL
ability to download and execute other malware
Get content list from a specified directory
Too Log Didnt Read  Unknown Actor Using CLFS Log Files for Stealth
archive contains a bait PDF document
C:\Windows\system32\cmd.exe /C
decrypting and executing the shellcode
contains shellcode and an embedded DLL file that loads FatalRAT
ExConti and FIN7 Actors Collaborate with New Domino Backdoor
S0340 Octopus
G0067 APT37
G0068 PLATINUM
G1008 SideCopy
Reverse proxy tool
taking screenshots
New RapperBot Campaign  We Know What You Bruting for this Time
remove all existing shadow copies via vssadmin on command line
Embedded .NET injector and payload(s) are encoded with Base64 and encrypted with Rijndael.
uses a custom algorithm which XOR’s multiple values together.
has operated sites on the Tor network using the following .onion
the file is deleted to remove evidence from the machine.
C0032 C0032
this executable then downloads and executes additional payloads
performs the antivirus checks
decrypts that specific payload code
takes screenshots at regular intervals.
also leveraging steganography to locate the start of the encoded payload
The malware can deliver payloads from the command and control (C2) server
The driver collects information about installed AV filters
when the malicious Word document opens it fetches the next payload from the remote server:
decryption and decompression
S0019 Regin
embedded binary files
a legitimate tool which is frequently used by bad actors for malicious purposes in ways similar to TeamViewer
steal credentials by decrypting them from registry values.
AnyDesk has been the most common legitimate desktop software used to establish an interactive command and control channel, with ConnectWise seen slightly less frequently.
Base64 encoded string, and in the other as a hexadecimal string
decrypted
S1040 Rclone
Disable Windows update services such as (“wuauserv”, “WaaSMedicSvc”, “UsoSvc”)
Legitimate processes have been corrupted by Vice Society via code injection, as a means to evade defenses.
the threat actor connected into the victim’s environment via a VPN
S0061 HDoor
S1099 Samurai
Following HTTPS activity,
the user the threat actor used to RDP
S0543 Spark
0x10000013data for C&C server (execution logs, stolen data, …)
to identify if privileged users are active on the systems
execute a payload via Windows Service Creation on target workstations and the DC.
reg.exe query
sends a GET request to  https://api[.]telegram[.]org/bot{token}/getUpdates to retrieve the command
S0052 OnionDuke
collect information about the name of the current user
attacker also used the "proxychains" utility, which is often employed to redirect network traffic
S0038 Duqu
The actors could also gain access to other systems where individuals may have reused their passwords.
launched by cmd.exe
the malware retrieves information on the infected machine and sends it to the C&C encrypted with DES.
T1095
the threat actors used PowerShell to download multiple malware and archives from the server
Sets Network Protection to audit mode in Windows Defender
they always have used DLL sideloading as their major technique to launch their malware.
Uninstall a plugin from the machine
BumbleBee Roasts Its Way to Domain Admin
the decrypted payload
Try to disable Tamper Protection settings of Windows Defender
Remote access tools were used for command and control, such as Tactical RMM and Anydesk.
to distribute password-protected weaponized Office documents
The threat actors, however, proceeded along a more traditional path, using SMB file transfers and remote services to move laterally across domain controllers and several other servers
threat actors using this tool are very quick to update their lures and find ways to entice their victims into installing the malicious remote control software.
The task’s description is PythonUpdateSrvc and it runs either on Windows startup when a user logs in or when one of two system events get created:
Most of the strings are de-XOR’d in a function
A local account was used by the Threat Actor
decrypts the string
performed via the following command-line syntax
Current process ID
obfuscated code
contains some junk code and data in HEX format.
DLL Side-Loading
we discovered several tools used for UAC bypass in Windows 10.
C0029 Cutting Edge
Decryption exclusion list
methodDescriptionUDP_LEGITSends UDP packets without data
download, upload
Web Protocols
To launch the shellcode, the loader calls ZwCreateThreadEx to create a new suspended injection thread hidden from debuggers using the THREAD_CREATE_FLAGS_CREATE_SUSPENDED (0x01) and THREAD_CREATE_FLAGS_HIDE_FROM_DEBUGGER (0x4) thread creation flags.
The Windows service was configured with the following options:Service Type: user mode service Service Start Type
S0443 MESSAGETAP
Network shellcode registry keys
It contains a very similar function dedicated to decrypting and loading the final payload
three ways to connect to the C2 server
“intelligent brute forcing”
the code of the decryption algorithm used by RedLine Stealer to decrypt its initial configuration data
command uses the Windows Management Instrumentation Command-line (WMIC)
C:\Windows\system32\cmd.exe /C
RDP traffic and minimize external RDP access
the username
C:\Windows\system32\cmd.exe /C
archive contains the files,
Command Line Arguments
decrypting and running the ransomware
hooks the kernel’s PsCreateSystemThread function
can use the Active Directory database to access credentials for users’ accounts.
Read a binary from its resource section, write it to disk and execute it
that pulls the written data from the registry under HKEY_CURRENT_USER\Software\AppDataLow\Software\Microsoft\<registry_value>>
S1039 Bumblebee
A user had to click on this in order to execute the malware.
the download and launch of a suspicious batch file.
the decryption routine
the payload which will be\ndecrypted.
web application vulnerabilities
its C2 server via a\nsubsequent HTTP POST request.
As soon as the unpacked executable is running
which is stored immediately before the encrypted config block.
Spearphishing Attachment
cyber threat actors using external proxy tools
Functions are always the same – dedicated to reading the file from the disk: CreateFileW, GetTempPathW, lstrcatW, ReadFile, VirtualAlloc, GetTempPathW.
the threat actor was observed attempting to dump the Local Security Authority Subsystem Service (LSASS) process
System info, including both hardware and OS info.
SMBv1 Exploitation via EternalBlue
the service account password was weak and cracked offline by threat actors.
S0640 Avaddon
S0165 OSInfo
The threat actors consistently perform extensive lateral movement actions using the acquired credentials within a targeted environment.
were able to be decrypted by leveraging the decryption script
S0243 DealersChoice
the decrypted memory structure
S0697 HermeticWiper
G0103 Mofang
the encrypted payload
SMB Copy and Remote Execution
the threat actors executed a PowerShell command to disable Windows Defender Antivirus on the host
can search through connected file systems and obtain directory listings.
Using the pattern discovered in these credentials, the team was able to crack the user’s workstation account password
Manual interactions are required
Returns the current domain SID
a threat actor abusing a sideloading vulnerability
HackTool.Win32.ABPASS is a tool used to bypass UAC in Windows 10.
The team cracked a user’s workstation account password after learning the user’s patterns from plaintext credentials.
MERCURY and DEV1084 Destructive attack on hybrid environment
An instance of cmd.exe was launched through explorer.exe which ran the following command
loading an encrypted payload from its resources
de-obfuscated strings:
This occurred from rundll32.exe, which was previously used to execute and run Cobalt Strike.
Retrieve the user domain name, username
The actors were observed trying to dump LSASS process.
Screen Capture
use of three base64 encoded echo commands
cracking browser sensitive information like passwords
prefix is used to hide files, directories, NamedPipes, scheduled tasks, processes, registry keys/values, and services.
S0283 jRAT
is decoded and unarchived
S0009 Hikit
G0026 APT18
G0094 Kimsuky
uses steganography
Increasing The Sting of HIVE Ransomware
ease of batch file execution.
the standard Windows command line tool cmd.exe.
S0473 Avenger
Routes traffic over TOR and VPN servers to obfuscate their activities.
and Remote Desktop user sessions.
The decryption algorithm
It then sets registry entries
a number of WMI requests via DCERPC from one endpoint to a target endpoint based on the ports.
read from a file on disk or a registry key.
decryption procedure
Decryption shellcode execution flow
which unpacks
S0276 Keydnap
S1058 Prestige
threat actor used the Windows command-line arguments
Operating system version
Query Registry
creates the registry key
resulted in confirmed compromises of internet-facing Federal Government agency systems.
Sample string deobfuscation
Cyber threat actors also continue to identify large repositories of credentials that are available on the internet to enable brute-force attacks.
using Windows utilities like ping and tasklist.
Encrypts a provided payload
S1043 ccf32
unpack any additional payloads,
Parse all installed application in the compromised host by querying 'SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall' registry
It then adds the extensions such as exe and DLL as exclusions to Windows Defender.
G0078 Gorgon Group
hash of the dropped loader to change with each execution,
Non-Application Layer Protocol
This service has the highest privileges that can be abused for Windows 10 UAC bypass.
Data from Local System
reg.exe ADD\n'HKLM\SOFTWARE\Microsoft\Windows\nNT\CurrentVersion\Winlogon\SpecialAccounts\UserList
the DLL was injected into the memory of the svchost.exe process
keylogger
The DLL embeds several obfuscated strings
S0658 XCSSET
G0009 Deep Panda
leverages SOCKS5 proxies to hide malicious traffic
threat actors remotely dropped AnyDesk binary on a server from the beachhead:
communicates with the C2 server specified in the configuration via HTTP or HTTPS POST requests
SeroXen RAT for sale
The malware decompresses its resource named
Use Windows API functions to inject DLL
decompress data blobs
remote access and surveillance features
Registry keys changed
involves sideloading DLLs along
advapi32.CryptHashData
WMI was used for running commands on remote systems
list of connected disks and starts recursive traversal of directories
password spraying attack against the victim’s remote services,
The use of shellcode, encoding, compression, obfuscated strings
injection of the payload
to discover information relating to the user
S0194 PowerSploit
Checking the number of processors
decrypted, and executed the backdoor code
S0351 Cannon
Try to Disable AntiSpyware, Real Time Protection and notification of Windows Defender.
ransomware uses Native API.
S0030 Carbanak
encoded shellcode
S0388 YAHOYAH
compromised devices that act as proxies for their C&C servers
the threat actors exploited Log4Shell [T1190] for initial access [TA0001] to the organization’s unpatched VMware Horizon server
During the defense evasion phase, anti-malware and monitoring software is often disabled.
S0367 Emotet
This campaign began with thread hijacked emails which contained HTML attachments.
The loader injects an orchestrator into memory in a svchost.exe process.
Regardless of whether the file content is compressed or not, it will be encrypted in XOR operations with a specific string
wrote a registry run key for persistence
side-loads malicious WDLocal.dll The side-loaded DLL
S0538 Crutch
it will install a fake Windows service called “windowsupdate”
Indicators, such as logs in Windows Event Logs or malicious files, are typically removed using wevtutil, a batch script, or CCleaner.
Computer name
creates another batch file, system.bat,
The Microsoft WinCrypt library is used for AES encryption and
S0253 RunningRAT
is a .NET DLL library (compiled on April 29, 2020) imported when GDFInstall.exe is run
Capture keystrokes
OS version and system type
G1024 Akira
via ZwMapViewOfSection calls
seemingly legitimate executables and their respective sideloaded files
Creating a WMI permanent event subscription
the decompiled code used to decrypt strings
This function obtains the username,
[sic] section of a decoded FlowCloud config
the scheduled task is set to trigger 60 minutes after the malware execution by default.
the rootkit module is decrypted
creates a scheduled task on the system that provides persistence.
IP address space
Process Hollowing – one of the classic methods of PE injection
LSASS Dumping
The encrypted VFS file.
Removal of artefacts from the system
write module to the encrypted storage
enumerates all running processes
They may also use the wmiexec module from Impacket to execute commands and move across the network.
ipconfig /all
At the end of the decryption process, the program indicates the number of decrypted files
the command-line syntax used
uses KCP on top of a TCP connection
The computer name and the username is also sent to the C2.
HTTP traffic to C2
The actors used Mimikatz
As tasklist uses WMI “under the hood,
NetServerGetInfoto retrieve the current configuration for the local server
malicious dynamic link library (DLL) file that’s eventually side-loaded to the application.
Privilege Escalation
downloading files from a URL
to search machines for certain files
S1047 Mori
as outgoing HTTPS port 443 connections
This was double base64 encoded.
keylogging
Each block is then\nre-encrypted with the new key material as follows:\n The encryption key is the 16-byte GUID
leads to a function that iterates over a call
G0011 PittyTiger
the second option is used with the PID of explorer.exe to load the ComRAT payload reflectively into the process.
OS Credential Dumping: LSASS Memory
contains the ability to inject .NET assemblies into unmanaged processes.
adds an additional layer of obfuscation to the code
decrypted using DPAPI
obtains a list of installed security software.
Packed DLL analysis
S0021 Derusbi
the file is a 32-bit Windows executable packed using the UPX (Ultimate Packer for Executables) packer (https://en.wikipedia.org/wiki/UPX) to compress and make it more difficult to analyze.
decrypts the password
Use Windows API functions
adversary using Windows Batch files
lures them to click an embedded malicious hyperlink which
moved laterally and\ndeployed their signature malware
be injected into a new process or loaded in the same process space
bat file format
had been archived
the team uploaded and executed well-known malicious files
obtaining relevant device data, such as OS version and architecture, hardware ID, CPU, RAM, screen resolution, system language, etc.
reaching out to the server to obtain a further payload.
run it in an active process
using a variety of encryption schemes and symmetric keys.
This pattern of decrypting strings
Threat actor uploaded the fast reverse proxy (FRP) binary
victim controlled hostnames were revealed
The threat actor was observed process injecting into legitimate process
activity from Tor
C:\Windows\system32\cmd.exe /C
used to send program execution DEBUG and Telegram to deliver payloads and send commands.
the actors manually disabled Windows Defender via the Graphical User Interface (GUI)
S0390 SQLRat
other compromised host running the parent HTTP Beacon
enumerate running processes and send a list of process names and IDs back to the C2
G0044 Winnti Group
which were started via their interactive RDP session
The script will decode itself
and enumerating files and drives
S0462 CARROTBAT
commands to download an Emotet DLL onto the computer.
File enumeration
G0135 BackdoorDiplomacy
The embedded DLL
S0650 QakBot
the encrypted data
Operation Harvest A Deep Dive into a Longterm Campaign
operators use UPX to pack DC2.exe and DC4.exe to avoid static signature detection.
When opened, the user sees a social engineering image telling them that they must click the “Enable editing” button to see the document’s contents.
Persistence for the RAT is achieved via registry entry, and a shortcut to the installed RAT executable is written to the Startup folder.
SetRegistryValue
Encrypted and compressed payload
rundll32 locker_32.dll,run
S0057 Tasklist
used HTTPS reverse proxies to redirect C2 traffic.
tasklist
actors gain initial access through exploiting public-facing applications 
Disable Automatic Update and change Windows configurations related to Windows Update 
make the malicious payload smaller and avoid detection based on static malware analysis techniques
the submitter collected the files from different places
Monitor keystrokes and windows
OS uptime
C:\Windows\system32\cmd.exe /C gpupdate 
plugins such as a keylogger,
When executed, mde.ps1 downloaded  from  and removed  from the disk
directory listings
employs a forged document linked to G7 to target various governments within the G20 forum.
S0346 OceanSalt
G1020 Mustard Tempest
Username
T1106
Threat actors used two scripts named s.bat (for servers) and w.bat
TeamViewer
C:\Windows\system32\cmd.exe /C systeminfo
powershell.exe Uninstall-WindowsFeature -Name Windows-Defender-GUI
HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware \nDeleteValue 
The backdoor periodically checks and creates its own persistence by making sure that Step 1 of the loader is run every time the system is started, via a registry Run value, in the same way as in the installer:\nHKCU\Software\Microsoft\Windows\CurrentVersion\Run\<random_run_name>\”%appdata%\Python27({32|64})\pythonw.exe” “<loader_step_1>” “<loader_encrypted_step_2>”
To bypass UAC, BlackCat ransomware may escalate privileges using the ICMLuaUtil COM interface, as well as use the Masquerade PEB method.
and execute the file using CreateProcessA.
Although the decoding algorithm of the C2 response looks quite complex, it is actually Base64 decoding, followed by an XOR operation using the key 0x7A.
decrypts strings
S0679 Ferocious
the ability to log keystrokes
A lookback under the TA410 umbrella Its cyberespionage TTPs and activity
These emails may contain a malicious link or files that will provide the cyber actor access to the victim’s device
The following files are downloaded and written to disk:
the actors using Mimikatz during their operations.
DLL was executed using rundll32.exe :\nC:\Windows\system32\cmd.exe /c D:\max\eyewear.bat\n\t➝ rundll32
This remote process listing
deobfuscate the file
It checks that the status of certain services belonging to security-related software meets certain conditions (e.g., windefend, sense, cavp)
and 2638
Embedded Executable Objects In OneNote  
encrypted using its own XOR key
The config is decrypted using XOR and a 16-byte key
its resource section are decompressed and written to disk
Attempted to blend in with a file name that matched the system name it resided on
API calls
custom decryption algorithm is being applied on the buffer
an encrypted configuration.
establish persistence by creating a registry key under \SOFTWARE\Microsoft\Windows\CurrentVersion\Run only if the victim’s machine name differs.
It attempts to specifically gain root access to these devices via a default password
the imported code dynamically calls VirtualAlloc to allocate a new region of memory in which a new PE file is copied.
a spoof of the legitimate ‘PerfectData’ software designed to masquerade a malicious application as legitimate
credential stuffing
target for DLL side-loading
The email text employs scare tactics, such as evidence of a traffic violation, prompting the user to open the HTML attachment
via reverse proxy.
to download and execute additional\nPowerShell code and Windows binaries
decoding function
such as schtask or crontab to create and schedule tasks that enumerate victim devices and networks.
brute forcing tool called FSCAN.
C:\Windows\system32\cmd.exe /C
The output of this decryption
To remotely access the compromised infrastructure, the attackers may use the legitimate tools TeamViewer and ScreenConnect.
func_ListProcesses()
The Decryption Shellcode
T1543.003
Allows severe/high/moderate/low-level threats to execute
the victim’s hostname is captured in this logon event
SSL can be used to complicate command-and-control (C2) traffic analysis
the ransomware modifies specific registry values
For example,\nto open a registry key in a transaction, the functions\nRegCreateKeyTransacted(), RegOpenKeyTransacted(), and\nRegDeleteKeyTransacted() are available.
deletes them from the original location.
contains the original MBR that was encoded by XORing
System Information Discovery
The actors used Mimikatz to harvest credentials.
delete its process file
attack of a Remote Desktop Protocol on a public-facing server.
exfiltrated to the attacker-controlled server through an HTTP POST request to the URL
Keylogger
The malware was injected into a SVCHOST process where a driver location pointed to the config file
Fetch the payload with cURL command
The second shellcode revealed after the unpacking algorithm finished processing
Uses AnyDesk to remotely connect and transfer files.
Disabling Windows Defender notifications, Task Manager and Command Prompt
obtains the IP address, location, and other relevant network information from the victim’s machine.
searched files on the server, and found plaintext credentials
to authenticate to the site behind the onion link on the TOR network
masquerades as a legitimate word document
method names contain junk.
invoked the wave 2 ransomware immediately from the command line
accepts commands from a Telegram channel,
a remote service was created with random alphanumeric characters, service name and service file name
execute a payload via SMB and Windows Service Creation, respectively, on a target DC.
Emotet Strikes Again  LNK File Leads to Domain Wide Ransomware  The DFIR Report
Enumerates running processes
When opened, the OneNote document instructed the recipient to "open" the document by double-clicking the button displayed in the OneNote document.
decrypt it
S0618 FIVEHANDS
The threat actor also engaged in brute-forcing against the victim's internal web services
the attacker downloads files,
finds the relevant syscall numbers for NT APIs,
and hostnames collected
The usage of a proxy allows authors to control all of their mining implants and their target pools via a centralized console
the processes used for injection
The attackers may use wmic to obtain information and run various commands,
S0488 CrackMapExec
the file will be deleted
S0051 MiniDuke
LSASS dump in the WebDAV detected
extraction of sensitive API Keys
reusing multiple code chunks from DEP-allowed memory pages, called ROP gadgets.
S0158 PHOREAL
then sign on as a legitimate user
S0475 BackConfig
employ the remote template injection method to retrieve the next stage of the malware from the TA’s Command-and-Control (C&C) server.
used VMProtect to obfuscate one of them.
GPO was leveraged again to register a scheduled task used to launch the ransomware payload.
execute a method from the .NET assembly
SFX archive
four scheduled tasks are created:
to locate certain files, paths,
S0336 NanoCore
The server contained HTTP header data (SimpleHTTP/0.6 Python/3.8.10), indicating the use of a Python library called SIMPLEHTTPSERVER
they disabled Windows Defender via a group policy modification.
SMB beacons open a local port on the target host and listen for incoming communication from a parent beacon
In some cases, batch (.bat) scripts were created
and encrypted QuasarRAT payload
contains another payload that is XOR-encrypted
Downloading and executing PowerShell code
S0125 Remsec
It is encrypted with a 256-byte RC4 key.
logging keystrokes via polling and application hooks
tasklist was also used in order to enumerate processes on multiple hosts remotely
Directory listing functions
process creation library functions
the accounts that were used to authenticate to the cloud.
executed when the victim opens the contents of the file
Supply Chain Risk from Gigabyte App Center Backdoor  Eclypsium  Supply Chain Security for the Modern Enterprise
The malware then abuses the MSDTC service, manipulating the permissions and startup parameters.
or password spraying.
to enable offline password cracking.
S0278 iKitten
sends an HTTP request that will contain the encrypted bot response.
systeminfo
to download next stage and execute it
it prompts the user with a fake message to double-click on open to view the attachment.
SysUpdate and HyperBro backdoors were installed
T1570
packaged into an obfuscated PowerShell batch file
S1113 RAPIDPULSE
S1044 FunnyDream
deletes it as soon as the utility is running
created a Scheduled Task
exfiltrate proprietary or confidential information,
The PowerShell script decoded from the Ir8 variable uses Reflection.
both use batch files that run via the Windows command shell.
downloads and executes
C:\Windows\system32\cmd.exe /C
fetches a payload from the embedded URL and loads it.
modules spread the malware laterally across a network by abusing the SMB Protocol.
Returns the current user’s name
removes virus definitions and disables all portions of Windows Defender and other common antivirus programs in the system registry
S0688 Meteor
the threat actors used a service account to execute a Cobalt Strike beacon remotely on a Domain Controller.
wrote the encrypted and base64-encoded PowerShell\nbackdoor code
This parses command-line options
used RATs that implement UAC bypassing.
screenshots
Zerobot HTTP requests
delete itself from the target systems after infection
calling an export function of the DLL
The actual bytes of the decrypted shellcode
SMB copy and remote execution
G0050 APT32
S0593 ECCENTRICBANDWAGON
Checks the registry keys to detect virtual environments such as VMWare, Virtual Box, Wine, Microsoft Hyper-V or Windows Virtual PC.
LSASS was accessed by an unusual process “runonce.exe” on multiple hosts, including a domain controller.
“BfeOnServiceStartTypeChange” WMI\nQuery Language (WQL) filter condition\nThe BfeOnServiceStartTypeChange Filter was\nbound to the CommandLineEventConsumer WindowsParentalControlsMigration.
located in the data sections
The persistence technique is simply adding a run registry key for persistence
strings decoded when running
Attempts to disable or modify endpoint security, such as Microsoft Defender, on compromised devices.
the raw disk driver was embedded inside the malware
The threat actors managed to get access to the beachhead host after the successful execution of a lnk file within an ISO, which are usually distributed through email campaigns.
Decryption of the config buffer in the Forked Loader.
S0491 StrongPity
to execute the Mimikatz commands ‘privilege::debug sekurlsa::logonpasswords “lsadump::lsa /patch”‘ in-memory
file was executed by the injected Rundll32.exe process.
Delete file
PE injection, manual loading into the parent process
S1050 PcShare
customized for the HTTP-POST Block
They used multiple malicious PDFs and MS Office documents during the campaign.
S0484 Carberp
S0151 HALFBAKED
Exposed RDP servers are also abused by threat actors to gain initial access into a targets network.
When the executable is run, the DLL next to it is loaded.
The emails were sent through various compromised email accounts, propagating additional malicious xls files
S0148 RTM
stored as obfuscated data in the registry
wmic  /node
S0632 GrimAgent
S0264 OopsIE
S0218 SLOWDRIFT
encoded email addresses are exfiltrated
uses TCP for C&C communications.
The two ".bat" files that were sent
S0690 Green Lambert
the malware proceeds to identify files and directories for encryption by iterating through them
Decrypted payload 
the attacker leveraging Windows Remote Desktop Connections to pivot to additional systems in the environment.
a given command line.
modifies the Windows Registry to allow remote desktop connections
same IP address was used as C2 server
the folder C:\Users\Public
IronNetInjector is made of an IronPython script that contains a .NET injector and one or more payloads.
Because rundll32.exe executed PowerShell, we can see that rundll32.exe created
is injected in a similar way
These files are all self-deleted after launch
Downloads a file from the given URL and executes it with the given arguments.
decodes the embedded shellcode
Upon execution, the ransomware binary deletes itself
S1081 BADHATCH
has been observed in multiple ISO files masquerading as legitimate software,
a base64 encoded argument
only uses one code obfuscation technique: API hashing.
C:\Windows\system32\cmd.exe /C
or command line interface tools
As a second argument, the macro passes the entry function “DllUnregisterServer” to rundll32.exe so that the execution starts correctly.
They then force updated the GPO on all clients using Cobalt Strike.
can run commands that will download files
decodes it
S1073 Royal
The function GetTempPathW is used
two shellcodes contained in the compiled AutoIt script
executed via dllhost.exe using process hollowing techniques.
whoami.exe
cmd.exe /C rundll32.exe
to download the malicious update.bat file from the C2 domain
Base64 encoded script
S1118 BUSHWALK
be based on an encryption algorithm used previously in
the user account was known to have recently been abused by the threat actor
keystrokes
Threat actors also created a remote thread in svchost.exe
It also deletes the ransomware, script file, and ransom note (index.html), ensuring that no evidence remains on the compromised system.
Furthermore, since the data to be decrypted is in another file, the routine becomes even more difficult to investigate, as analysts would need the correct pair for decryption.
Clicking on the LNK file executes the batch file
90 other encrypted
S0154 Cobalt Strike
Upon opening the malicious document
download this RAT,
pc.dll decrypts,
Two ".bat" files were sent throughout the organization.
using the functions “SHGetFolderPathlW” and “CreateFileW”
Tools were transferred to a compromised web-facing server
C0013 Operation Sharpshooter
S0374 SpeakUp
the download of wed.hta
attempt to obtain system information
Obfuscated HTA script
a different method of fetching and executing the next stage payload
a hidden directory
unpacks
computer name
binary unpacks a customized Mach-O
installs the payload as a service
recursively removes the implementation of Windows Defender IOfficeAntiVirus
constructs an email with a hardcoded subject and body and attaches the HTML file from the “fb” folder.
get decoded and decrypted
creating a registry key HKCU\Control Panel\Desktop
by sending a specially crafted TCP packet
the decrypted HTTPS traffic.
use Registry Run key for persistence
uses PsExec to modify the system registry parameter MaxMpxCt
AES Cryptographic Provider from WinCrypt APIs
identify the system’s manufacturer
by writing to specific registry keys.
resolves the function\naddress for the ServiceMain export function
comes with an embedded PE payload
These messages used Microsoft OneNote attachments (.one) to execute a malicious HTA file
a reverse proxy
they’re downloaded from the C2
decrypts them
an obfuscated .NET program.
By extracting the syscalls, and executing them manually, the malware can use the API of the operating system,
used to download files…
When executed on a Windows Domain Controller (DC), the ransomware automatically creates a Group Policy, spreading itself to other machines within the domain.
The redirectors used HTTPS reverse proxies to redirect C2 traffic between the target organization’s network and the Cobalt Strike team servers
Once the data has been written to the registry
This function is responsible for deleting all files and directories in the user’s trash folder.
a given user account was also authenticating to Active Directory from a given source IP address two years prior
It uses a different custom packer
hop points to enable their cyber operations while remaining anonymous.
LLMNR/NBT-NS Poisoning and SMB Relay
used by various actors to disable endpoint protection tools.
threat actors obtain initial access to networks is through the use of compromised valid credential pairs
It included a standalone file padded with over 200MB of blank spaces, likely to impede analysis of the decompressed ISO file.
C:\Windows\System32\cmd.exe /C
persists on infected machines by creating new services
the script retrieves NSudo and modifies Windows UAC prompt behavior by allowing administrators to perform operations without authentication or consent prompts
cyber actors used valid accounts to log into a service specifically designed to accept remote connections, such as telnet, SSH, RDP, and Virtual Network Computing (VNC).
Once the encoded payload has been located
0x0BInject and execute received module in specified process
uses a custom crypter leveraging Microsoft’s CryptoAPI to encrypt C2 traffic.
continues to use older vulnerabilities, especially Log4Shell, to compromise unpatched devices
S0246 HARDRAIN
C0022 Operation Dream Job
distributed in a RAR archive
ARP table
The FileData member of the FileDataStoreObject is the key member that holds the embedded data in the OneNote document.
S0081 Elise
OpenSource Gh0st RAT Still Haunting Inboxes 15 Years After Release
NetServerEnum to get a list
Hungry for data ModPipe backdoor hits POS software used in hospitality sector
S0354 Denis
decodes the next element:
perform process injection to masquerade as harmless processes.
run the scheduled task every 2 minutes is  start.
Write in the registry
retrieves a decoy tax document and VBS script.
gaining credential access into victim networks by using legitimate, but compromised credentials to access OWA servers, corporate login portals, and victim networks.
S0029 PsExec
decrypt
sideload the DLL
It will then decrypt the encrypted payload with the predefined RC4 key
downloads a RAR file.
S0031 BACKSPACE
the decrypted config contains two pipe-delimited IP addresses
several files were staged for possible, but unconfirmed exfiltration
It supports proxy (Socks5),
by querying the Software\SimonTatham\Putty\Sessions registry key.
TA0002
that is abused to side-load a malicious DLL
Use scheduled tasks
HTTP variant
cmd /C
S1023 CreepyDrive
S0349 LaZagne
S0201 JPIN
Decryptor has finished the decryption process
In addition to file encryption and obfuscation,
This data is then encrypted using AES and returned to the C2.
The malware implemented a series of Mimikatz modifications on closed-source tooling
The actors were able to proxy
Evasive Process
has been known to self-propagate via SMB.
using a variety of software packers
T1552.001
Creates benign-looking services for the ransomware binary.
S0673 DarkWatchman
the orchestrator injects the network component into memory
The actors downloaded malware and multiple tools to the network
which is then injected into svchost and dllhost.
take screenshots
The decryptor is delivered in a zip archive containing the decryptor executable
batch files for automation.
 LockBit Ransomware 20 Resurfaces
command line argument
S0150 POSHSPY
usernames
Name of the hardcoded directory where files are copied
extract data and files from endpoint devices.
FinSpy unseen findings
to download a next stage EXE payload using cURL
Process injections in svchost process via CreateRemoteThread, Default named pipes, etc
executing malware shellcode and batch files
G0096 APT41
G0123 Volatile Cedar
MPRESS is a free packer.
the customized packet size using a XOR value.
identify the architecture
used various RATs that retrieve the current username during initial infection
cmd.exe /c
and then decrypts them
Creates a scheduled task that runs at system startup
the UPX packed sample
malicious OneNote documents to entice users to click on an embedded file to download and execute
Loader removes evidence of injection by using the following methods:\nUpdate the LDR data table entry to match the injected PE.\nRemove the injected PE headers from memory.
creates three more Windows shortcut files in the victim’s machine startup folder,
Egress communications over HTTP, HTTPS
injecting into multiple other processes, such as explorer.exe and svchost.exe, to execute further payloads.
The malware is a DLL that is launched using rundll32.exe:
S0115 Crimson
makes use of the technique “DLL Sideloading”
C:\Windows\system32\cmd.exe /C
G0108 Blue Mockingbird
S0101 ifconfig
G1021 Cinnamon Tempest
S0078 Psylo
Delete the dropper executable
encoded malware
downloads the next stage from a public file storage service
using a renamed copy of rundll32.
copy each PE section one at a time
The malware decompresses a resource
Process Injection via Hooking
encrypts data with a custom encryption algorithm before it is sent to the C&C server.
Base64 decodes the payload content
Infected email attachments
As attackers can quickly change spear phishing attachments
the threat actors conducted further discovery tasks running find.bat and p.bat,
S0645 Wevtutil
C2 is transmitted as a zip file during the POST request.
C0030 Triton Safety Instrumented System Attack
DLL side-loading
Afterward, the shellcode will then decrypt and load the main ViperSoftX DLL embedded within the carrier.
the actors leveraged RDP to propagate to several hosts within the network.
S0250 Koadic
decodes the base64-encoded strings and initializes them
injecting the shellcode into rundll32.exe
it creates a scheduled task that runs the Rust executable by passing it as an argument to rhc.exe.
attacker disabling Windows Defender
The batch file
UAC BYPASS
Earth Zhulong Familiar Patterns Target Southeast Asian Firms
G0086 Stolen Pencil
decompress and decrypt the final payload
This file was opened during their RDP session and contained the PowerShell commands used to launch a new beacon:
the threat actor managed to continue to access the victim’s cloud environment
accessible through API functions.
is distributed through exposed Remote Desktop Protocol (RDP) setups
stored as a list of registry keys, yet we also observed a variant in which similar content was written into a TXT file.
deobfuscated code of GuLoader’s shellcode.
We observed a process created by Cobalt Strike accessing lsass.exe
critical APIs
Decryption of the URI within
PowerShell de-obfuscation routine
This executable binary insecurely downloads and executes additional payloads from the Internet.
files dropped in the Windows startup folder are run
wmic  /node
S0018 Sykipot
The loaded shellcode is a self-decrypting DLL.
WMI query
then launched by cmd.exe
The phishing email with the malicious attachment
S0644 ObliqueRAT
generated based on the computer architecture.
S0467 TajMahal
the malware to unpack
Creating the HKCU\Software\Zeppelin registry key
encoded payload
First-stage legitimate executable for DLL sideloading
AtomBombing is a technique that allows malware to inject code while avoiding calling suspicious APIs
S0180 Volgmer
cmd.exe /c
Named pipes were created in order to establish communication between CS processes
and the built-in Windows user account DefaultAccount [T1078.001] to move laterally
The script will then execute the downloaded file
S0111 schtasks
it enumerates several known Crypto Wallet directories and looks for files related to crypto currencies by looking for files having “wallet” substring on its file name.
ProcDump deletion from the ProgramData folder of all targeted workstations after dumping their LSASS process:
S0160 certutil
collects and sends system information
Example use of direct syscall.
that pulls the Cobalt Strike payload from a fake JPG file.
used RATs that persist by creating a Run registry key or by creating a copy of the malware in the Startup folder
decrypt network traffic
base64-encoded argument
send phishing emails with malicious HTML attachments
G0008 Carbanak
it then checks the amount of IPs found in the ARP table
S0437 Kivars
After the writing in the registry has been completed
Banking Trojan Techniques How Financially Motivated Malware Became Infrastructure
OS version
C:\Windows\system32\cmd.exe /c
An Examination of its Unpacking Routine
Bypassing Intel CET with Counterfeit Objects  OffSec
is injected into one of the processes specified by the C&C
is gzip-decompressed and executed
a single Rundll32.exe process
The actors used RDP to move laterally to multiple hosts on the network.
using the API NtRaiseHardError
files are distributed and stored in encrypted form.
valid accounts
fetches IcedID from a remote resource
It checks for the number of processors in the infected system
can check whether specific security software is installed on the machine it tries to compromise,
This can be anything from file and directory-listings,
The task is used to start an IronPython script
enable RDP connections.
"C:\Windows\System32\schtasks.exe" /create /sc MINUTE /mo 15 /TN
triggered when the user starts the presentation mode and moves the mouse
the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.
the running processes using  CreateToolhelp32Snapshot and  Process32Next
delete key files
domain fronting
Compromised accounts may be used to maintain access to the network.
Base64 decoding this value
an embedded URL is launched in the victim’s browser,
enumerating current directory 
the NtTerminateProcess and ExitProcess functions
HTTP stream containing the content
the malware executes a command to delete itself from the system
DLL sideloadingThis
Create scheduled tasks to execute the loader and updater components
unpacks an HTML
malware exfiltrated data towards a C2
is packed with CyaX
Malware Reverse Engineering for Beginners  Part 2
Execution
reg.exe ADD\n'HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server' /v\nfDenyTSConnections /t REG_DWORD /d 0 /f
to fool potential victims into opening them.
PowerShell Script uses Base64 and hexadecimal encoding and XOR-encryption
stored in the working directory
To establish persistent remote access on the victim device, the threat actor abused Windows services to install modified version of Cobalt Strike payload
replace the “ServiceManager.exe” file from the driver folder with a malicious file to trick the driver into running the tainted file
phishing emails that were used as lures to deliver the files
The first find.bat was used to run
G0051 FIN10
systeminfo
S0520 BLINDINGCAN
Add the process to a startup registry key
a batch file
S0579 Waterbear
ipconfig /all
After the download, another button appeared, which, when clicked, executed the file.
which in turn injects the payload(s) into its own or a remote process.
ipconfig /all
threat actor had knowledge of these accounts and used them on the correct systems
S0597 GoldFinder
the adversary attempting to exfiltrate sensitive information over SMB (TCP/445) directly from a compromised domain controller.
obfuscated with legitimate resources
used Rotten/Bad Potato to elevate user rights by abusing API calls in the Operating System.
downloading and executing specific utilities
Copying of files across SMB shares
A benign, legitimate executable abused to side-load the malicious DLL
the obfuscation technique for the dropped files being hex-encoding vs. string concatenation
It also uses the command “CopyFromScreen” to capture a screenshot.
its abuse of the legitimate MSDTC service,
Shell\nExecute a specified command via CMD
The threat actors then used these credentials to pivot from the on-premises environment to the Azure AD environment.
Installation of malicious Windows service.
The Telnet brute forcing code is designed primarily for self-propagation
allows cyber threat actors to execute arbitrary system commands,
RAR archive is downloaded
the payload decryption key
Due to TCP port 2222’s common use as an alternate port for SSH communication, the Malware Analyst recorded a manual SSH connection to the emulated C2 host
shellcode is to inject the decrypted payload within the currently running process (itself).
Once deobfuscated,
WMI Persistence
reading files
exfiltrates data to Google Drive storage
S0417 GRIFFON
cmd.exe session
The decrypted payload
compressed and exfiltrated to the attacker via Telegram
process injection
uses Mimikatz to dump passwords.
abused group policy objects (GPO) to install loaders
S0350 zwShell
starts by enumerating *.blf files in the default user’s profile\ndirectory
encrypted stack strings
S0446 Ryuk
the embedded files in the scripts
Threat actors performed the first lateral movement from the beachhead to the server using RDP with an Administrator account
Similar to decoding strings, the binary payload is extracted by decoding the data using Base64 and adding 35.
uses wmic to obtain the
unpacks with aPLib
to download and execute a payload
information is sent to the C&C, encrypted with a hardcoded key and DES CBC algorithm:
GoBruteforcer GolangBased Botnet Actively Harvests Web Servers
POST request with push operation
which is also embedded inside the CHM file
sets the following registry entry to open the downloaded PDF file every time the computer boots
sets up its working directory
upon initiation of the WMI service
Process hollowing is a process injection technique that creates a new legitimate process in a suspended mode, unmaps its main image and replaces it with malicious code.
Communication with the C&C is encrypted using AES in CBC mode
After hijacking the aforementioned drivers, the rootkit erases the DLL names associated with them from internal structures used to display device drivers.
CVE-2018-12613, a phpMyAdmin vulnerability that could allow threat actors to view or execute files
the encoded data in the BSS section
NtTestAlert function
to load the final payload into memory from a Registry value without
S0023 CHOPSTICK
As a command line argument
The team obtained the cached credentials from a SharePoint server account by taking a snapshot of lsass.exe with a tool called nanodump, exporting the output and processing the output offline with Mimikatz.
the user will be encouraged to download a malicious installer
They then repeated the install of the remote access software package.
Windows APIs
WMI persistence.
decrypts them locally.
insights on anti-virus software present on the machine
brute-force attacks on systems
AA21200A Tactics Techniques and Procedures of Indicted APT40 Actors Associated with Chinas MSS Hainan State Security Department
post-exploit tool that leverages HTTP protocols for C2 traffic.
then deletes the files.
there are two domains that are decrypted:
S0157 SOUNDBITE
configuring autorun entries,
to proxy the miner’s network communications.
systeminfo.exe
Controlling attached camera devices to take pictures of the compromised computer’s surroundings.
unpacks it with aPLib.
creates a scheduled task for persistence.
RedirSuiteServiceProxy.aspx is a legitimate file name available in the Exchange server.
Get list of drives
the installer opens and decrypts the\ncontents of the file passed as an argument
Identify a domain that uses the same CDN to ensure that the traffic will be forwarded to the correct resource.
G0075 Rancor
adding itself to the startup folder
S0592 RemoteUtilities
:taking full control of the infected machinerecording keystrokes in real time with
The DNS request for the initial host resolves to a Cloudflare-owned IP address that allows the attacker to employ domain fronting and send the traffic to the actual C2 host
use various encryption algorithms to hide payloads and strings.
spam email comprising an attached MS Office document
"cmd"  /c
decrypts and executes in memory
Data from Local System
using a batch file named find.bat.
PE is stored as a Base64 encoded string
It created a Run key in the Registry
DISABLING ANTIVIRUS/MALWARE SOFTWARE USING ".BAT" FILES
and injects it into iexplore.exe using WriteProcessMemory.
decrypted using the RC4 algorithm with a hard-coded key in the resource.
Establish a session that originates from a target Domain Controller system directly to an external host over a clear text protocol, such as HTTP.
fetching a remote payload
Detect and Identify source IP
threat actors used the dir command
Tool Used to Steal Sensitive Information
to run bruteforcing offline.
the threat actor leveraged different credentials for each step while moving laterally through the victim’s network
the file deletion functions
S0357 Impacket
process hollowing was used to inject a malicious PE file into the legitimate process called aspnet_compiler.exe.
each string is therefore\nencrypted with a unique byte stream.
task scheduling
encrypted with RC4
Screen Logger
The backdoor may also download and execute\nadditional PowerShell commands from its command and control (C2) server.
the threat actor’s RDP session.
created a persistence mechanism for UltraVNC by adding the\napplication to the ConhostNT value under the current users Run\nregistry key.
cmd.exe /C
S0219 WINERACK
writes another batch file
With this valid admin account, a Cobalt Strike beacon is loaded into memory of patient zero.
the threat actor leveraged one of the most popular dual-use agents, AnyDesk, to provide persistent remote access into the affected organization on multiple systems.
the files are sent through an HTTP POST request.
Once the master key is decrypted,
reads data from its own resource section and decrypts a payload.
S0382 ServHelper
Credential and Browser Data Theft
Windows Defender, other anti-malware solutions and monitoring tools are disabled utilizing a process explorer tool,
G0016 APT29
C:\Windows\system32\cmd.exe /C
reading/writing registry keys
S1041 Chinoxy
the decrypted content
Collects the configuration of active connector instances other than the RPCConnector and RPCBindConnector classes.
to gather basic system information.
This script called a combination of QueueUserAPC, GetCurrentThreadId, OpenThread, and VirtualAlloc
The configuration is stored as a base64-encoded blob, whereby the first 16 bytes of the base64-encoded blob is the RC4 key
Each manager stores collected data in its own SQLite database, while data that is collected on demand is returned directly to the C&C server
T1012
send phishing emails with malicious HTML attachments to all addresses in the victim’s mailbox.
leverages a custom packer to obfuscate its functionality.
stealer,
encrypted with XOR and compressed with aPLib.
S0092 Agent.btz
adds it to the HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run key
an increasing number of obfuscations are being adopted to thwart static analysis.
use TCP and UDP for C2 connections
resulted in confirmed compromises of internet-facing Federal Government agency systems.
collect information about the IP and MAC addresses of the infected machine
creates a registry key
G0082 APT38
a version of the malware that was injected into a victim’s system
RDP traffic
has installed and used legitimate tools such as TeamViewer and AnyConnect on targeted systems.
using a batch script
embedded payloads of one of the IronPython scripts.
Keylogging
It decrypts and loads
This line uses the ShellExecute method of the Shell.Application object to execute the downloaded file.
allows for lateral movement leveraging RPC to create SMB traffic.
exploits CVE-2015-2291, an Intel driver vulnerability, to load a malicious driver designed to reduce the token integrity of Microsoft Defender.
If a user with administrative access is compromised, an actor can access servers without needing to elevate privileges
The adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.
which the actor took after logging in to a user’s Microsoft 365 account
It then calls CallWindowProcW API.
just C2 communications; until around 3 hours later, Bumblebee dropped a Cobalt Strike beacon
The attackers may use RDP to move across the network.
used droppers that check for security software present in a victim’s computer
Carbon Blacks TrueBot Detection
which is used for the first sideloading.
a file downloaded from the internet,
S0071 hcdLoader
stores every pixel as three numbers according to its red, green and blue components
C0012 Operation CuckooBees
the batch file
encrypted
As NetSupport Manager is a legitimate tool that has a long history of development, it is highly attractive to attackers as it can be relied on to work ‘out of the box’.
S0168 Gazer
sends this information to its C2 server
use process hollowing to inject decrypted payload into child process and resolves its Import Address Table.
in a specified separate process that is created and injected.
Xollam the Latest Face of TargetCompany
executes a malicious script
the download and execution
G0105 DarkVishnya
can obtain passwords stored in files
spawned with PowerShell via Task Scheduler
password-protected executables to obfuscate malware
using the remote process execution tool PSExec to execute batch files
C:\Windows\system32\cmd.exe /C gpupdate 
did RDP to a few other servers
All data is then sent back to the attacker's C2
domain fronting
the installer\ngenerates and prints out encryption keys that the actor uses to\npre-encrypt the payload before it is written to disk
The threat actor connected via Remote Desktop
data is encrypted in the standard way
RDP is used by the group for lateral movement.
S0625 Cuba
emails have a PDF document attached
ipconfig /all
S0207 Vasport
passes the execution to the region of memory in which the copied PE is allocated
"cmd"  /c
S1020 Kevin
This function scans a specified path by finding all files within the given directory and its subdirectories.
shows that the directory listing function
The dll is run using the command “rundll32.exe
the username is also sent to the C2.
the computer architecture
The HTTP protocol uses the message format detailed in the previous paragraph, but it adds a few extra steps to disguise its traffic as legitimate HTTP
used CMD-based scripts
checking for security products
RAR file contains a batch file with a CMD extension
The user is then prompted to open the single visible shortcut (2) file.
The archives often include a JavaScript (.js) file
after the user clicks on the malicious link or opens the attachment.
S1048 macOS.OSAMiner
sending additional phishing emails to the victim’s contacts
executing a launcher utility with the filename System.Mail.Service.dll (MD5: 5F9020983A61446A77AF1976247C443D) through the command line as a service.
This shows the decoded and uncompressed data.
the ransomware drops a batch file
it can create a service
the attacker’s BAT file to run
which was then fed to a batch script
malware disguised as Hancom Office document files.
shellcode decrypts
in return receives an AES encrypted payload.
the threat actors who perform brute-force attacks on MS SQL Servers.
S0694 DRATzarus
create scheduled tasks for persistence.
to exfiltrate data directly to C2 servers.
it took 148 packets containing DNS requests and responses to finish the task and send back the data to the Cobalt Strike Server.
use brute force password attacks
S0387 KeyBoy
distributed to victims via phishing attempts
implanted Ngrok reverse proxies
The common processes observed were two injected processes
S0595 ThiefQuest
S0646 SpicyOmelette
If the user opens it directly
used API calls in their droppers, such as  CreateProcessA, WriteProcessMemory and ResumeThread, to load and execute shellcode in memory
sideloading to legitimate executables
threat actors use their beacon sessions to establish RDP access
The second encoded Base64 string was not only base64 but also Gziped for size and obfuscation.
hid the installer for Advanced Port Scanner within Inno Setup installer to evade static signature detection.
It copies other malicious batch and EXE files from a compromised internal Server Message Block (SMB) server to the newly created temp folder
We observed the threat actors deleting their tools (Procdump, Network scanning scripts, etc.) from hosts.
S0623 Siloscape
using the Administrator account each time
S0628 FYAnti
get information about processes running on a system
G0127 TA551
Ngrok – a reverse proxy tool for proxying an internal service out onto an Ngrok domain
G0032 Lazarus Group
Thread Execution Hijacking
targeted vulnerabilities in Microsoft SQL (MS SQL) Server for initial access
This vulnerability allows for a threat actor to obtain system privileges
MAC addresses of network adapters
a fake message to lure users to execute the HTA  file 
HTTPS and other protocols built on SSL have
can modify group policy for privilege escalation and defense evasion.
Firewall rules have occasionally been seen being disabled as well.
a batch file.
loader establishes a connection with a C&C server in the final stage of the attack.
T1003.001
through legitimate remote access software such as AnyDesk
Information such as operating system architecture, framework version, operating system version, etc.
the malware proceeds to decrypt the PowerShell code
Window titles to keylog
The domain name of the device
decompressing
The default configuration allows unprivileged users to query group membership of local administrator groups
GetExtendedTcpTable to retrieve a list of TCP endpoints\nGetIpNetTable to retrieve
Exploitation of Remote Services
entry point of the original file is relocated, and so is the Import Address Table (IAT).
performs the injection and execution of the payload
connects to a configured C2 server using HTTPS for communication.
AnyDesk was used to move laterally between a workstation and a backup server
its contents are decrypted\nusing the HC-128 encryption algorithm
Decryption of “Lite Loader”" domains.
It is encrypted using the AES algorithm
is injected into all running processes.
has used RDP for lateral movement.
messages are exchanged in the original TCP connection (without TLS encryption).
sent as a POST request
with a tool called nanodump, exported the output, and processed the output offline with Mimikatz.
S0389 JCry
tries to start its defined shell which has been swapped to a batch script (file2.bat) by the malicious actor.
These encrypted strings,
The public-facing application compromise approach
DLL Side-Loading
attempts to fetch another stage of the payload to run in memory,
The file is then deleted from the disk
prompting the user to open the HTML attachment
opts to obfuscate their ransomware much more heavily
S0394 HiddenWasp
Exploit Public-Facing Application
S1066 DarkTortilla
or unpack the final payload
schtasks /run
by capturing the CredEnumerateA API.
Decryption of “Lite Loader” filenames.
the attackers would launch a lateral movement phase, using default Windows credentials
It also checks the victim’s hostname
passes the obfuscated string to a function that strips the arbitrary string and delivers the original string
attacker’s Kali Linux host to RDP into our target’s environment
deliver more malware,
when using the HTTPS-enabled options
S0049 GeminiDuke
Modifies the Registry to disable UAC remote restrictions by setting SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy to 1.
The email is directed to “Non-Resident Alien” tax payers to have them fill out a PDF file (that is attached to the email)
S1112 STEADYPULSE
From a persistence point of view, scheduled tasks
threat actors using Mimikatz in conjunction with coin miner protocols and software.
a reverse proxy tool for proxying an internal service
It checks that there are no drivers loaded from security-related software (e.g., groundling32.sys)
After obtaining a valid account, they use this account to access the victim’s VPN, Citrix or another remote service that allows access to the network of the victim.
Conducting discovery indirectly via schedule tasks named “Windows Update”
wmic product get name,version
call RtlAddVectoredExceptionHandler API
first interfered with security tools using Group Policy Objects (GPO).
S0513 LiteDuke
C0015 C0015
wmic  /node:<
The team discovered several standard user accounts that have local administrator access to critical servers.
exfiltrates the email address to the C2 server using an HTTP POST request
use a set of tools via remote desktop
execute the command systeminfo on the compromised host.
S0256 Mosquito
When it detects a starting first (or a stopping last) instance of a process from the list
The threat actor established RDP sessions to internal servers
runs rundll32.exe to load the malware.
In other cases, the adversary moved laterally to another system with a domain admin logged in.
cyber actors were observed Base64 encoding files and command strings to evade security measures.
configured to proxy C2 traffic
The identical encrypted file
.NET packer known as CyaX
Almost every post-exploitation job was launched from an injected process.
simple stager download of an .exe file and its execution.
S0638 Babuk
G0129 Mustang Panda
Process to inject into
secure communication through TLS encryption.
S0230 ZeroT
run a network recognition process to find the IP address of each of the ATMs
These payloads are compressed inside RAR files, this helps avoid static analysis techniques
S0099 Arp
Obfuscation is one of the most popular methods to achieve this.
deleted the LaZagne binary after execution to avoid detection from the user's side.
the loader decrypts and parses the embedded installation configuration
S0255 DDKONG
batch file downloads the PowerShell downloaderThe
to steal system information like machine details
establishes persistence by creating an autostart service that allows it to run whenever the machine boots.
S0365 Olympic Destroyer
crawl the filesystem
With some further process injection
Sets various registry values
contains several benign files that are written to disk (they are not part of NSIS binaries and they are not used at all by the installer) and two files that are malicious
contains three identical executable files
multiple POST requests to the “c2/sock” address
G0130 Ajax Security Team
Disables the User Account Control (UAC)
PowerShell initiated the\nfirst connection to the fronted domain
keylogging
this CMD file calls the "db" file. In both samples,
Collection of information about the system in HTML format
shellcode control flow obfuscation
Cobalt Strike was used to enable RDP,
documents sent to the printer.
the use of a PowerShell script to execute Mimikatz in-memory
S0585 Kerrdown
Get the user name of the compromised host
S1110 SLIGHTPULSE
This proxied traffic
has the capability of sending additional payloads to the hosts
to connect via SMB to targeted users, and then copy their Chrome profile directories as well as data protection API (DPAPI) data.
obfuscated information,
file injection capability
force a group policy update
Exploitation for Privilege Escalation
is generated from the system username
data that will be decrypted
creating a hash of the collected data, to which it then appends its current process id.
executes the shell (file2.bat),
and lateral movement/execution of files
Place a value on RunOnce key
G0072 Honeybee
S0331 Agent Tesla
the HTTPS beacon
is encrypted in the file
the tool downloads the files
executes a file using ShellExecute
Keylogging
IPv4 addresses
the most popular obfuscation techniques is execution of Base64-encoded malicious code
S0653 xCaon
Ingress Tool Transfer
S0582 LookBack
C:\Windows\system32\cmd.exe /C
Lateral Tool Transfer
used various RATs that use TCP for C&C communications
S1091 Pacu
to download additional malicious files
Windows Service Creation
icon files with encrypted data appended to the end of the files.
obfuscated with junk instructions and inverted conditional jumps (combinations of jle/jg and the like).
The batch file would download and execute
Initial Compromise Through Exploiting Publicly Facing Applications
an encrypted shellcode payload.
S1037 STARWHALE
the Windows Registry or NTFS Extended Attributes to hide their data,
they used compromised workstation and domain admin accounts
S0213 DOGCALL
Like the domain, the URI is composed using a set of hardcoded keywords and paths, which are chosen partly at random and partly based on the type of HTTP request that is being sent out.
After decrypting and decompressing the payload
The malware then decrypts the received payload using AES and the shared key.
S1064 SVCReady
the Windows payload was named “IntelUpdater.exe”
As the hosts receive the task through GPO
The exclusion rule allowlisted the entire , enabling threat actors to download tools to the  without virus scans.
S0499 Hancitor
processes which threat actors injected into:
downloads three components from
Malware Spotlight Camaro Dragons TinyNote Backdoor
similar screen captures
A new service was created
systems injected the Conti DLL into memory
proxy server
Security Software Discovery
Valid Accounts: Default Accounts
bat script:
decrypted using the RC4 algorithm with a hardcoded key in the resource.
S0141 Winnti for Windows
Whos swimming in South Korean waters Meet ScarCrufts Dolphin
registry key where each embedded resource is to be written
executes another dropped batch file,
sends a hardcoded TDS 4.2 & 5.0 Login Packet (Figure 6) to the specified IP address on port 2638
this is done via the popen API
The ProxyShell elevation of privilege on the Exchange PowerShell Backend (CVE-2021-34523), Windows Background Intelligent Transfer Service (BITS) improperly handling symbolic links (CVE-2020-0787), and abusing the CMSTPLUA COM interface have all been seen as methods of privilege escalation.
T1219
to steal Outlook data such as server, user, and password from POP3, SMPT, and IMAP registry keys
shellcode injection
its injection into one of the following processes
uses a variation of AtomBombing that queues an APC to call memset to clean an RW region in ntdll.dll.
attackers placed
actors may misuse various content delivery networks (CDNs) to set up redirects of serving content to the content served by attacker-controlled C2 hosts.
Returns the short form of the user’s profile folder
Valid Accounts
logging keystrokes
S0447 Lokibot
runs in a new process
is injected only into processes running under WOW64.
S0200 Dipsind
domain name, Hostname and OS Version
recording files to be uploaded when their download is requested by the C2 server.
group utilizes sideloading
using three possible types of messages to try to get a target to open the email and malicious attachment.
dumped lsass memory on the domain controller.
Mimikatz, which is a tool used for extracting sensitive information such as passwords and authentication credentials from a Windows operating system.
S0224 Havij
At first glance, the files within the directory may seem legitimate
looks for the Outlook data files from the victim profile’s Outlook application data folder.
using the clfsw32.dll API function
that registers a scheduled task which runs immediately and upon user logon,
C:\Windows\system32\wbem\wmic.exe /node
Base64-decodes
G0070 Dark Caracal
stage the execution of additional plugins in memory,
the malware tries to remove itself from the machine to avoid being detected and analyzed by security researchers
Detecting Credential Stealing Attacks Through Active InNetwork Defense
The shellcode is then executed in a new thread.
S0242 SynAck
Encrypted Channel: Symmetric Cryptography
S0564 BlackMould
reg  add "HKLM\SYSTEM\CurrentControlSet\Services\iscsiwmi\Parameters" /
C:\Windows\system32\cmd.exe /C
employing a combination of outdated Microsoft Office document vulnerabilities
loads the resources using the API calls LdrFindResource_U and LdrAccessResource
creates a group policy
Embedding of EldoS RawDisk driver inside the wiper malware
S0633 Sliver
Installing legitimate remote access tools, such as RPort, Ligolo and eHorus
T1190
junk code created by the ProcessWorm loader
system directories are targeted
decrypted through an AES-256-CBCdecryption algorithm
this includes VPN accounts
G0118 UNC2452
executed when the victim double-clicked on the shortcut file
domain fronting possible by allowing the operators to configure related settings via the malleable C2 profiles
a technique leveraging the Windows Management Instrumentation (WMI) service to execute malicious code.
S1012 PowerLess
S0204 Briba
began sending spam emails, mailing new malicious attachments to continue spreading.
domain name also resembled the legitimate Mexican Tax Agency domain, a tactic the attacker likely adopted to disguise malicious traffic.
were both designed to turn off Antivirus and Antimalware software.
WDSyncService.exe executable abused to side-load a malicious DLL 
This uses a mixture of disguising the ASCII as UTF-16 via manipulating the start of the file, as well as obfuscating the data using a simple cypher.
Decrypt the request received using AES algorithm
to disable UAC remote restrictions by setting SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy to 1.
executes it using rundll32.exe
with the function “WriteFile”.
for initial access is RDP compromise.
Embedded Resource
threat actors use their beacon sessions to establish RDP access through a reverse proxy
the ability to run a SOCKS proxy server on the team server.
payload decoder from Github
The batch script
drop batch files
they suspend the remote process threads
The emails included an attachment named ‘Credit Transfer Copy.html’
decrypt
delete files upon completion—including
after reaching the local DC, the attacker was able to gain a better lay of the land and observe the presence of the other two domains.
launch of a suspicious batch file.
S0020 China Chopper
backdoors can list running processes.
S1106 NGLite
The subsequent functions collect additional information such as the machine’s public IP address
The threat actor kept the remote desktop session alive
 Malicious actors typically gain entry to organizations’ Microsoft 365 environments by abusing either stolen account credentials
This misconfiguration allowed the team to use the low-level access of a phished user to move laterally to an Unconstrained Delegation host and compromise the entire domain.
The base64 encoding starts with JAB that is a common pattern for UTF-16 starting with $
Commands are used to download and install plugins
S0434 Imminent Monitor
passing the path to the encrypted component as a parameter.
Parse browser application and browser version installed in the compromised host by querying "SOFTWARE\WOW6432Node\Clients\StartMenuInternet" or "SOFTWARE\Clients\StartMenuInternet" registry
The decryption of the cookies
to download and execute a remote “note.hta”:
Read (IRP_MJ_READ) for the keyboard driver (kbdclass or KeyboardClass0)
Phishing emails spoof legitimate senders to deliver RokRAT via LNK files
writes its configuration to registry,\nthis value is set to “default” and is later manually changed by the\nactor
The script concatenates hundreds of smaller strings into a single variable which ultimately builds and executes
that makes the HTTP request.
Persistence is maintained after boot/reboot via malicious autostart registry keys.
S0607 KillDisk
The malware also established persistence on the host with the creation of a registry run key.
modification of Registry Keys/Startup folder for persistence
G0116 Operation Wocao
G0101 Frankenstein
threat actors used CS as the main Command and Control tool, dropped several payloads,
Bash script
S1029 AuTo Stealer
enumerate files and folders
frequently called API function
resolves the given API hash and retrieves the address of an exported function
If Windows Defender or Bitdefender Antivirus is installed on the victim’s computer
RtlDecompressBuffer decompresses the provided buffer.
used various RATs that gather system information such as computer name and operating system during the initial infection
The decryption routine shared between the BADCALL for Linux and targeted destructive malware for Windows from 2014
Logged Processes
download a backdoor module.
S1072 Industroyer2
S0453 Pony
attempts to clear file system cache memory, and self-deletes
injects it into a process.
The Powershell script, when double clicked (executed),
service was installed in the system
S0024 Dyre
S0589 Sibot
S1019 Shark
C0011 C0011
include exfiltrating system information
G0125 HAFNIUM
Evasive Process Hollowing By Entrypoint Patching
keystroke capture
The Microsoft WinCrypt library is used for AES encryption and decryption by both
The BAT script
it download and execute yet another Python script
S0415 BOOSTWRITE
to download the second stage.
when .NET framework APIs are used in the code
Command Line Execution
collects system information and browser history, then sends it to the C2 server.
inject it into some process
hashed with MD5
starting the RDP session
S0385 njRAT
by exploiting the following vulnerabilities against Microsoft Exchange servers
The decoded base 64 content
have used droppers that inject the payload into legitimate processes
establishes a TCP connection
The paths and registry keys to use
threat actors use multi-layered AES encryption and base64 encoding to obfuscate
added to the email address collection array.
The WMI component of the POSHSPY backdoor leverages a Filter to\nexecute the PowerShell component of the backdoor on a regular basis.
From the two phishing emails, both attachments contain similar malware.
injecting it to the address space of another process.
transmitted using the lightweight networking module,
injects the Trojan loader into exe.
obtained the credentials of a domain administration at headquarters
These credentials are generated and stored in the memory of the LSASS process
deleting files
Execution of FRP reverse SOCKS proxy on infected host.
S0072 OwaAuth
uses Run keys for persistence of its loader
large volumes of files have been stolen from victims' MOVEit transfer systems.
decrypted file contents
S0503 FrameworkPOS
reflective PE injection allows the malware to load and execute its code directly from memory
whoami  /groups
Decompresses a local buffer
As LSASS dumps are nowadays recognized by the dump file itself
different variants of a packer
Windows API
The services running on the compromised system are checked against the following list
Process Injection method
decoded by Shellcode
The Logic Pro X dropper binary is deleted with the /tmp/ bundle
The GPG decryption routine
After execution, the output of commands is uploaded.
WMI permanent event subscriptions can be used to trigger actions\nwhen specified conditions are met.
Earth Pretas Cyberespionage Campaign Hits Over 200
by brute-forcing them
steal database passwords and configuration information
iterate through the entire file system,
the threat actors leveraged highly privileged credentials and access to domain controllers
exfiltrate contacts’ email addresses
cmd.exe /C
Decoded from Base64:
The malware can extract this information and send it to its command and control (C2) server
DbgBreakPoint and DbgUiRemoteBreakin API
a batch file
S0596 ShadowPad
obfuscated Powershell script that runs another Base64 obfuscated layer that finally decodes the .NET payload.
$BASE64 encoded payload
S0116 UACMe
S0004 TinyZBot
deletes the following registry keys:\nHKCR\.EXE\nHKCR\.dll\nHKCR\*
decryption
the email and malicious attachment.
S0648 JSS Loader
The names of the registry values changed
The backdoor writes captured\nkeystrokes to memory and uploads them to its C2 server
using NetWkstaGetInfo() API.
heavily obfuscated with random symbols that substitute the instructions during the run-time and base64-encoded strings.
an exported function from one of the Windows libraries
to load an assembly into an unmanaged process.
and executing via a remote service on another workstation.
detect when TLS connections are being initiated and log the symmetric keys generated for the SSL/TLS connection
Uses batch scripts
domains give attackers the ability to mask malicious traffic as legitimate activity within the company
service is then created
S0239 Bankshot
calling the API
Enumerates all running processes
abusing exception mechanisms to obfuscate the execution flow of programs and Windows API hashing.
After choosing a new server and connecting via RDP,
The threat actors dropped the first of their ransomware binaries on the fourth day of the intrusion
decrypt,
implement different obfuscation techniques of varying intensities, for example, simple function name malformation and dynamic string resolution.
running commands
CreateFile and WriteFile are used
downloads and runs
Register a new service
API hashing
it starts payload execution using the ZwCreateThreadEx API.
additional beacons executed using remote WMIC commands,
G0052 CopyKittens
Adversary ran scheduled tasks for persistence of certain malware samples
Victims will receive and interact with a decoy document containing a Google Drive link and a corresponding password instead of an archive download link embedded in the email.
that decompresses and loads the first stage in memory.
AA22320A Iranian GovernmentSponsored APT Actors Compromise Federal Network Deploy Crypto Miner Credential Harvester
the communication is consistent with HTTP/S traffic.
It then runs Stage 2 via process hollowing.
Network adapter details are pulled via GetAdaptersAddresses
S0144 ChChes
Windows Command Shell
data exfiltration over a hardcoded C2 server
compress (and if it has the functionality of a crypter also encrypts) the original executable, which is saved in one of the sections of the final packed file.
then determines the processor architecture
S0216 POORAIM
The threat actor used both privileged and non-privileged accounts for RDP throughout the environment, depending on the target system
S0452 USBferry
The Data field may contain RC4-encrypted, Base64-encoded command
retrieves and executes the runanddelete.bat and scripttodo.ps1 scripts from the C2
check if it is connected to the internet by making a request
The malware also decrypts
will be loaded with the help of the APC injection loader.
its C2 server every five\nseconds via HTTP POST requests.
has utilized a UAC bypass tool.
the mining proxy
Injected Process Name
Sending back the result of the command’s execution to the C2 server.
Access to local password managers and databases to obtain further credentials
If TrendMicro, BitDefender, or Windows Defender products are installed
by calling WinHTTPGetProxyForUrlEx and WinHTTPCreateProxyResolver
the actors gained access to a VMware service account with administrator and system level access
wmic  /node
execute an encrypted payload located in the embedded DLL
They also retrieve networking information, like network adapters, specific machines, and network services like  Remote Desktop Protocol (RDP).
The decrypted payload
the Loader overwrites the current PE with the final payload’s PE
The threat actor was observed deleting files that had been dropped to disk
the threat actors began to review sensitive documents
it uses the following command to delete the data in PSReadline
API function
decrypting,
the supplied encrypted decoy document.
that added an exclusion rule to Windows Defender
G0128 ZIRCONIUM
the file is deleted
to download the XMRig payload.
S0279 Proton
S0454 Cadelspy
executed by the user clicking a shortcut file
the function CreateProcessWithLogonW.
can be executed via scheduled tasks.
the malware decrypts the payload with a delivered 64-byte RC4 key.
NtTestAlert function
S0086 ZLib
the SMB lateral transfer of one of the Atera Agent MSI installers (1.msi) used to gain access laterally on a host and provide persistence for later access.
reg.exe add\nHKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
the malware starts a function called bypassSMADAV
G0012 Darkhotel
Lots of custom scripts dropped by threat actors
C&C server responds with the next stage executable
System Owner/User Discovery
vfgadget address,
using Windows Command Shell to execute the initial dropper.
The threat actors used the compromised administrator account
obtains various system information including OS version, computer name and RAM size.
G0033 Poseidon Group
SFX archiveWhen unpacked
wiping traces of malware from the system
Take a NetWalk on the Wild Side
encrypt
to delete any remaining FOCUSFJORD\nforensic evidence, including files on disk, configuration data\nencrypted in the registry, and related services and registry keys\nused for persistence.
Analysis on recent wiper attacks examples and how wiper malware works
the new stealer is downloaded and executed
decrypts the DLL strings to be used later to resolve handles to the DLLs needed
the use of RDP by the Threat Actor
VirtualProtect changes the permissions of the given virtual address.
Deletes some of its files used during operations as part of cleanup, including removing applications such as 7z.exe, tor.exe, ssh.exe
It sets up a run key for via the command C:\ProgramData\GoogleUpdate\googleupdate.exe work for persistence.
performing remote directory listings.
obfuscated JavaScript code
utilizes a unique onion domain
credential-based deception is to stage the deceptive credentials in LSASS process memory.
ipconfig
default or weak credentials
S0170 Helminth
This module is embedded in the library’s resource section and encrypted with an algorithm similar to RC4
HTTP POST request (type 27 / data exfiltration).
Returns information about the computer system
Though this is a very rigid method of hiding its codes,
G0134 Transparent Tribe
S0526 KGH_SPY
UAC bypass will be executed via the AppInfo RPC service.
passes this command line as an argument
when the WMI service was initiated
account of the compromised domain admin
malware hidden inside the Python compiled byte code
Disabling Windows Defender notifications, Disabling Task Manager, Disabling command prompt, Preventing users from accessing Windows registry tools, Disabling Run command, Modifying the display timeout
Andromeda is a custom packer
That node contains the encoded payload.
whoami
this shellcode is responsible for fetching Remcos RAT
API obfuscation, and execution flow obfuscation
S0185 SEASHARPEE
Disables the startup of the WinDefend service
files transferred via SMB as SYSTEM on remote hosts.
The malware checks if there are monitoring tools, specifically Process Monitor, running in the current machine with the following strings:\nprocmon\nprocmon64\nprocmon64a
queried a number of target hosts to determine the host disk drive configuration
directory listings were harvested as a result.
exfiltrates data over the same channel used for C&C
After injecting into various processes on the host,
screenshotting,
communicates with its C2 server using HTTPS
setup a Registry Run Key to maintain persistence on the beachhead host.
capturing screenshots
exploiting vulnerabilities in the remote desktop protocol (RDP).
to decrypt the payload
S0404 esentutl
lures the user to open a document.lnk file which will execute the malicious DLL loader
Showing the Transfer of Cobalt Strike Beacons using RDPClip:
Both HTTP and HTTPS were observed to be used.
the execution of several functions in the EFI Boot Services Table, namely AllocatePool, CreateEventEx and ExitBootServices
the GPG-encrypted files:
S0002 Mimikatz
copying the current process command line as a new argument
cmd.exe /C whoami
cmd /C
a single-byte XOR algorithm.
captures screenshots
UAC bypass will be executed
decrypted and injected
proxy
The traffic beaconing contains the following pattern that will be encrypted with the AES key extracted from the compressed blob
Execute commands via Command Prompt
Proxying RDP traffic via a processes such as a Cobalt Strike beacon reduces the exposure of the threat actor’s own infrastructure, and blends RDP activity to those of internal hosts on the network.
the payload that is decoded using the first byte as a key,
Once the command line arguments are generated
executes an embedded batch file.
S1015 Milan
executed the "tasklist /SVC" command to list all running processes on the victim device.
The unpacked malware
Deobfuscated HTA content
File-packed Magniber ransomware
batch file
and injects Qakbot into wermgr.exe.
search, delete files.
the PID of the process in which the orchestrator is running.
DLL that will be loaded and called in the same address space
have very few imports as they don’t rely on external libraries
S0155 WINDSHIELD
Decompressing the compressed file
S0508 Ngrok
Inject and execute DLLs
S1100 Ninja
S0152 EvilGrab
its attempts to steal credentials and browser data.
host,
we can see decryption of the next stage with the help of a custom algorithm
Obtains the IP address from the ClientIpAddress field
Disables the "administrator in Admin Approval Mode" user type (disables UAC prompts)
a string that will be decrypted
ReadRegistryValue
Latin American Governments Targeted By Ransomware
wmic  /node
Mimikatz is a key player in dumping credentials but LockBit 2.0 has been occasionally seen utilizing MiniDump as well.
Decrypted strings
passes the obfuscated string to a function that strips the arbitrary string and delivers the original string.
creating another PE in memory,
A threat actor could establish an administrator session
the payload most likely arrives by exploiting public-facing websites and domains.
Downloaded VBScript and PowerShell
triggered when the user starts the presentation mode and moves the mouse
used to proxy RDP connections and connect to another computer.
S0167 Matryoshka
JavaScript is the module that has to be manually executed by the victim,
PsExec has also been used to aid lateral movement
which prompted DC authentication to the SharePoint server using the server’s NTLM hash. The team then deployed Rubeus to capture the incoming DC TGT
whoami.exe
It enumerates files and directories
making a HTTP GET request
Unpacked file names
a service that launches the moved executable rc.exe with one parameter.
Exploitation of Remote Services
to download and install payloads
The mounted file contains a hidden folder
used DLL sideloading to launch their malware
cmd /c
continuously captures keystrokes
after completing RDP connections to various hosts on the network
JavaScript fetched from the C2 server
G0102 Wizard Spider
The backdoor uses an RC4 key\nconfigured by an earlier stage of execution to encrypt and decrypt the\nData field
“When a victim opens the HTML file attachment, an embedded URL is launched in the victim’s browser, redirecting to another malicious HTML file from an attacker-controlled AWS EC2 instance
the injector process dispatches another APC using NtQueueApcThread to force the remote process to execute NtSetContextThread.
The batch script
have been routinely observed using a VPS as an encrypted proxy.
downloads an infostealer and starts it.
hardware information.
and the built-in Windows user account  [T1078.001] to move laterally
the user clicks on the malicious link or opens the attachment.
This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intellectual property (IP), and data scraped from memory.
using a domain administrator’s account.
S0649 SMOKEDHAM
S0244 Comnie
The actors used Ngrok to proxy
an embedded file gets executed by the user
the threat actors had the clear text credentials for one of the domain administrator accounts and began moving lateral to other systems
S0600 Doki
utilizing the “rundll32.exe” command
User execution [T1204] of malicious files
The decoded payload
with the keylogger component of the driver (described in the next section) by reading data from the \\.\pipe\namedpipe_keymousespy_english named pipe.
Remote Desktop Protocol (RDP), and the threat actor was able to move freely across the network
each data byte in the HTTP based C2 communication,
including adding more command-line arguments
Hafniuminspired cyberattacks neutralized by AI
been obfuscated in order to hide its real intentions
encrypts the collected information using RC4 encryption with the key “xkYgv127” and encodes it using base64.
The threat actor used accounts with Delegated Administrator rights to access other O365 tenants
this executable is an archive that can be unpacked with the help of 7zip
an encrypted decoy document
injected and executed within the normal Windows process called mstsc.exe.
the adversary also searches for VPN and firewall configs,
it decrypts the c2 URL
inject shellcode into the process
used to retrieve a payload package containing the second stage PowerShell and two shellcode buffers
used to inject a new beacon or a specific program to another process on the victim’s computer.
used to download and execute an IcedID loader.
operators attempted to use cached credentials from local accounts to gain initial access to additional systems within an internal network.
Using compromised credentials to access corporate VPNs.
downloads the contents of an HTML file stored in an attacker-controlled server
RPC (Pipe)
obfuscating malicious elements.
The actors exploited Log4Shell for initial access to the organization’s VMware Horizon server.
targets for phishing emails containing this type of decoy document.
The batch file name
enumerating the processes’ threads,
packed by noted tools
often will search for directories on the network
is a memory-only DLL that runs as a service
HTTP POST request (type 27 / data exfiltration).
that contains the library mapistub.dll,
created a new\nWMI class and added a text property to it in order to store a string\nvalue.
process of downloading and setting persistence of some other file.
Operation CMDStealer Financially Motivated Campaign Leverages CMDBased Scripts and LOLBaS for Online Banking Theft in Portugal Peru and Mexico
"C:\Windows\syswow64\cmd.exe" /C
module uses HTTP and port 80.
command line arguments
then proceeded to dump credentials from LSASS.
S0610 SideTwist
S0511 RegDuke
The injected process
contains just one file:
Once the executable starts running, it side-loads the malicious DLL
cloud drive, or other cloud resources accessible by the compromised account.
S1122 Mispadu
Decrypts the Trojan with a XOR-based cipher
The content of the MachineGuid registry value from the key HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography
G0045 menuPass
The last registry key was used to store additional PowerShell code.
The image’s pixels are an actual binary representation of the payload.
it installs itself to %programdata% and then sets the registry run key for persistence.
Using cmd.exe,
S0186 DownPaper
extracts email addresses from the emails’ sender, recipients, CC and BCC fields.
S0113 Prikormka
writes the path of the executable file, “_upyqta2_Ji7.exe”, to the class’s registry key “HKEY_CURRENT_USER\software\Classes\ms-settings\shell\open\command”
The “Forked” version of the malware loader first appeared in February 2023, distributed directly through thousands of personalized invoice-themed phishing emails.
Creating a registry key to store the malware code
injects into the svchost.exe process
abused to side-load
bypass user account control (UAC) using only two remote procedure call (RPC) requests
S0106 cmd
S1065 Woody RAT
enumerates system information such as hostname, shares, and domain information.
The malware then de-XORs other strings, with the hard-coded key
the threat actors were observed using compromised credentials to access the Azure AD Connect device.
Once it has decrypted the embedded DLL
deleted every time
various injections across hosts
Encrypting and encoding the data with XOR mask and random key
By extracting the syscalls, and executing them manually, the malware can use the API of the operating system, without a need of calling functions from the DLL.
with names invoking popular videogames such as Fortnite, Valorant, Roblox or Warzone2.
HTTP communication between the Beacon and the Cobalt Strike server
S1086 Snip3
scheduled task entry,
These proxy tools may be commercially available infrastructure as a service (IaaS) or software as a service (SaaS) in the form of a web browser promising anonymity on the internet.
Remote Task Creation/Update using Schtasks Process
The payload would then be decrypted through XOR
The next stage, injected into iexplore.exe
The phishing attachment was submitted to the target in a response to an ongoing conversation
common native Windows tools and commands such as netstat
The actors’ exploit payload created Scheduled Task RuntimeBrokerService.exe, which executed RuntimeBroker.exe daily as SYSTEM.
running a command that extracts a Base64-encoded CAB archive from the body of the LNK file,
malicious archive,
attempted to masquerade dropped files as legitimate Microsoft Windows executables
S0373 Astaroth
creates a registry Run key to achieve persistence
PowerShell one-liner that can be used to download and execute a remote .ps1 or .exe file:
invoked from the command line
Contains the imported unmanaged function declarations and win32 structures/constants.
the file to be downloaded.
This type of threats is usually delivered as email attachments.
embedded inside as a base64 encoded buffer
S0665 ThreatNeedle
collects information, primarily system information
to execute malicious code in the context of LSASS.
used various RATs that can access the local file system and upload, download or delete files
The injection\nprocess
decompresses it using the GZipStream API,
can communicate over HTTP or via its “normal protocol”.
http/https data transfer
stealing credentials from the Local Security Authority Subsystem Service (LSASS) process.
layers of encryption, obfuscation or anti-analysis
GetTickCount Windows API
use locally configured proxies.
S0372 LockerGoga
The malware will first start enumerating files in the directory it is being executed from.
The threat actor was observed creating remote services in order to execute beacon DLL files
self-written extensions that obfuscate the PHP scripts.
func_ScanScreen() is the one responsible for this screen capture capability
S0121 Lslsass
inject and execute received module in specified process
script to restore deobfuscate control flow.
S0464 SYSCON
A scheduled task was created at that time to maintain persistence on this host
operators delete files such as mim.exe, mim32.exe, zam.exe and zam.bat to cover their tracks
systeminfo
Symmetric Cryptography
Email attachments mimic legitimate documents
regular RAR archives that have an executable file inside.
Several more beacons were also loaded on the host using DLLs and PowerShell.
Operating system version and whether it is 32-bit or 64-bit
G0093 GALLIUM
backdoor that supports commands, including screen capture
decrypts the payload
Logfiles on the Linux-system show traces which can be attributed to a credential stuffing or password spraying attack.
The batch script will delete the malware sample with its path using the command “del” and finally delete the bat file with the command “del %0%”.
obscure the call by wiping artifacts from the buffer, such as wiping the PE header.
G0106 Rocke
batch script
S0153 RedLeaves
The injection is also visible from memory dumps
S0164 TDTESS
S1090 NightClub
injects the fetched payload into the explorer.exe process
connect to a certain URL every 60 minutes using the normal Windows file mshta.exe.
Exfiltrate screenshots
KCP protocol
they will be able to download the decryptor
S0193 Forfiles
stored in the Windows registry.
Once the execution completes, the file is deleted to leave no evidence on the machine.
AnyDesk and its installation as a service was used
The threat actors also transferred ProcDump from the beachhead to multiple workstations:
compression using QuickLZ
The area after this contains encrypted data.
have attempted to get users to execute malicious files masquerading as documents
G0142 Confucius
G0115 GOLD SOUTHFIELD
the batch file makes the following changes to the system
These arent the apps youre looking for fake installers targeting Southeast and East Asia
If it fails, it sets in the registry
downloading itself from malicious servers
The data in the HTTP body is the same as the past variant,
An encrypted additional shellcode
S0627 SodaMaster
most of the strings used by\nPRIVATELOG and STASHLOG are obfuscated
T1548.002
Process dump of the LSASS process
S0652 MarkiRAT
keyloggers
a 200+MB padded file
Decompiled code responsible for loading the payload from the binary’s resources,
the decoded command line parameter
where they were previously injected into
an additional BAT file contained in the body of the ransomware.
Adds registry run keys to achieve persistence.
The threat actor executed two actions to bypass Windows Defender
the malicious library is the same and serves to load and execute shellcode from a file that is stored under the same name as the DLL
C0007 FunnyDream
Encoded shellcode in Project File
this loader prepends a stub containing 79 bytes of junk instructions before the actual payload shellcode.
S0215 KARAE
Returns the list of running processes
Microsoft Outlook Messaging API (MAPI) module
registers two scheduled tasks:
S0531 Grandoreiro
During these RDP sessions,
.]net via HTTP Get and POST metadata specified in the beacon's configuration.
injected into multiple processes on different hosts.
a process where Cobalt Strike was injected into
and inject    shellcode,
a process injection in one of the svchost processes
we find an XOR loop
The ISO file was delivered as a ZIP archive via a malicious spam mail campaign.
parsing payload received in the C&C responses
the team leveraged compromised workstation and domain admin accounts to execute a payload
using multiple stages and encrypted/obfuscated payloads
Reconfigures Windows Defender to exclude the user profile path and the entire system drive from scanning.
the actors leveraging CVE-2019-19781 to compromise Citrix Application Delivery Controllers.
computer name, domain name, locale and product name.
uploads, downloads a file
hide a second stage payload in registry transaction files
cmd /C
GPG decryption
and then self-deletes.
their initial exploitation of vulnerable internet-facing applications,
File deletion
have used various encryption algorithms in their droppers to hide strings and payloads
The threat actors then executed Mimikatz on VDI-KMS to harvest credentials
When decoded, a backdoor is revealed
Exfiltration
Contains code to decrypt strings and domains
enumerate files and registry keys
sending an HTTP POST request
The Decryption shellcode
Before exfiltration, the attackers may put collected data in 7Zip archives.
decrypt these database passwords
access to system APIs,
the help of ShellExecute API
a lot of junk code
The team performed an NTLM-relay attack to obtain the DC’s TGT, followed by a golden ticket attack on a SharePoint server with Unconstrained Delegation to gain the ability to impersonate any Site 1 AD account.
cmd /C
Screenshots are also taken at a configurable interval; the default is once every 30 seconds.
obtain logs of the infected machine’s keystrokes
S0391 HAWKBALL
reflective DLL loading, to inject a DLL from memory.
"cmd"  /c
A service was also created for the agent.
Drop a file named ossutilconfig in the %USERPROFILE% directory
the payload of the malware can be part of the loader’s file
drops and executes Cobalt Strike in the memory space of “rundll32.exe.”
removing files from the system.
C&C traffic of the PUBLOAD HTTP variant
This file extracts credentials from LSASS similar to Mimikatz.
The message above the ‘Open’ button instructs the user to “double click” in order to receive the attachment.
, it extracts, decrypts, and decompresses the data to be executed as shellcode.
S0659 Diavol
G0080 Cobalt Group
the malicious actor retrieved system administration tools and malicious payloads by using the Background Intelligent Transfer Service
gather database passwords
Babadeda Crypter targeting crypto NFT and DeFi communities
credential extraction tool Mimikatz
previously injected into
patch the integrity level of the Microsoft defender (MsMpEng.exe) and forcibly reduce it from system to untrusted integrity.
S0082 Emissary
Windows Management Instrumentation (WMI) to launch commands on devices
APC injections
In reflective PE injection, the PE file is parsed and its sections are reconstructed in the target process’s memory.
This process can be summarized as Exe -> Resources -> BMP with embedded data in pixels fetched
S1025 Amadey
Threat Assessment Black Basta Ransomware
It then attempts to connect to the C2 via TCP port 443
compares each hash with 3 hardcoded hashes:\n\n0x6403527E → avp.exe associated with Kaspersky AV\n0x23214B44  → ns.exe associated with Norton Security\n0x651B3005 → ccSvcHst.exe associated with Symantec
loaded with VirtualAlloc and executed
This technique leverages CDNs associated with high-reputation domains so that the malicious traffic appears to be directed towards a reputation domain but is actually redirected to the red team-controlled Cobalt Strike servers.
The commands executed included directory traversal,
the malware calls a decryption function
KiUserExceptionDispatcher function
The payload is implanted into a newly created suspended process (a new instance of the current executable) using one of the most popular techniques of PE injection: Process Hollowing
modifying\nTerminal Server registry key values
G1023 APT5
multi-layer obfuscation
the executable ‘3ujwy2rz7v.exe’ was downloaded
the Forked Loader decrypts and copies strings into global variables where they will be later used to resolve required functions.
G0071 Orangeworm
C:\Windows\system32\cmd.exe /C
Exploit Public-Facing Application
G0126 Higaisa
executes an embedded PowerShell command to download the next-stage PowerShell script from the server and execute it on the victim’s machine.
domain fronting
“cmd” /c
S0095 ftp
only decrypts the first matching\nblock
wmic /node
malicious oci.dll into the service’s executable
to search for ones relating to security
The decryption key is passed as an argument
It disguises itself as a legitimate Google Update executable.
indicating the use of Remote Desktop Protocol.[
download and execute binaries of various architectures until it succeeds
perform WMI queries
then decodes and executes it.
This attacker utilized an additional keylogging utility
decrypting them on the fly.
Uses Rundll32 to load and execute malicious DLL.
The target would then, naturally, double click the other file in the Zip archive
Injects the rootkit to a newly created process by another process and updates the callee via NamedPipe
The actors removed malicious file mde.ps1 from the dis.
executes OSSUTIL (included in the installer package as ssu.exe) to download files
machine names
S0512 FatDuke
S1088 Disco
Creates two registry keys for persistence
The adversary uses the command and control channel to exfiltrate small amounts of data.
DLL sideloading,
thus requires two rounds of decoding using certutil.
NBTScan for network reconnaissance
encodes it using XOR encoding with key
S0651 BoxCaon
creating scheduled tasks
The only difference is that the malware replaces the thread context with the downloaded executable and resumes it afterwards.
the task or service attains persistence by being set to start automatically on boot
The threat used valid accounts against remote services:
use of various obfuscation techniques in malware
which will then send the results to the C2 server
C0017 C0017
used various RATs with modules that show running processes
previously written Base64 file
S0037 HAMMERTOSS
cmd /C
acting as proxies to relay\ncommunications to their C2 servers.
The HTA file contains obfuscated script
S1016 MacMa
G0083 SilverTerrier
dropped and executed on the server
cmd /C
The actors added an exclusion rule to Windows Defender.
sends them back to the server in POST request:
decryption function decrypts the URL pointing to the attacker-controlled server
Disabling Windows event logging in an attempt to evade detection
use several highly obfuscated and underdevelopment custom loaders
The computer name
S0146 TEXTMATE
Tailoring Sandbox Techniques to Hidden Threats
it creates a scheduled task that executes the updated routine, which triggers at log-on and every 30 minutes.
upload data to C&C
cyber actors have been observed deleting files using rm or del commands.
Windows Batch script
various WinAPI functions.
The actors downloaded malware and multiple tools to the network, including PsExec, Mimikatz, and Ngrok.
service is then created to run that module and is immediately started
kernel32.VirtualProtect,
bat script:
Tactical RMM Agent was installed by the threat actor on a server to ensure remote access
Victims can be lured into clicking executable content including binaries, scripts or shortcut files masquerading as benign filetypes such as PDFs or folders.
the executable decodes and drops the next stage
TcpConnector/TcpBindConnector
S0238 Proxysvc
Horabot campaign targeted businesses for more than two years before finally being discovered
enumerates all folders and emails in the victim’s Outlook data file
to install AnyDesk and provide remote access for the “technician” to install the malware.
RC4-decrypts command data returned in\nthe Data field.
Take screenshots with a specified frame rate, and livestream or record them.
are downloaded and executed in the victim's system
It collects a list of fixed drives but excludes the drive where the %WINDOWS% directory exists.
re-encrypted and saved in the same location
utilizes legitimate programs to side-load the group’s own DLL to execute their payload.
decrypts a shellcode
query the Windows registry
establish C2 connections via a peer-to-peer network of infected hosts
performs the download of a file
using an obfuscated Meterpreter stager
try to hide these system calls
Akira Ransomware is bringin 1988 back
downloaded from the C&C along with the ModScan module
using the command line
the files were exfiltrated over the backdoor
stealing multiple types of data
a BAT file (4.2) to be run on logon as another UI shell
